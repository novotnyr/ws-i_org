<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3c.org/TR/1999/REC-html401-19991224/loose.dtd">

<HTML                                     ><HEAD><TITLE>Basic Security Profile - Version 1.0 (WGD) 2005-08-10</TITLE>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<STYLE type=text/css>BODY {
	BACKGROUND: white; MARGIN: 16pt 24pt; COLOR: black; FONT-FAMILY: sans-serif
}
DT {
	PADDING-TOP: 0.5em; FONT-STYLE: italic
}
H4 {
	FONT-WEIGHT: normal; FONT-SIZE: 0.8em; MARGIN-BOTTOM: 0px; FONT-STYLE: italic
}
.refinement {
	MARGIN: 18pt 0em
}
.statement {
	MARGIN: 0.5em 5.5em; TEXT-INDENT: -4em; FONT-STYLE: italic
}
.statement-id {
	PADDING-RIGHT: 0.3em; PADDING-LEFT: 0.3em; PADDING-BOTTOM: 0em; PADDING-TOP: 0em; FONT-STYLE: normal; BACKGROUND-COLOR: #ffa
}
.statement-target {
	FONT-WEIGHT: bold; FONT-STYLE: normal
}
.statement-type {
	PADDING-RIGHT: 0.3em; PADDING-LEFT: 0.3em; FONT-SIZE: 0.7em; PADDING-BOTTOM: 0em; VERTICAL-ALIGN: text-top; PADDING-TOP: 0em; FONT-STYLE: normal; BACKGROUND-COLOR: #ccf
}
.statement-origin {
	PADDING-RIGHT: 0.3em; PADDING-LEFT: 0.3em; FONT-SIZE: 0.7em; PADDING-BOTTOM: 0em; VERTICAL-ALIGN: text-top; PADDING-TOP: 0em; FONT-STYLE: normal; BACKGROUND-COLOR: #fcc
}
.rationale {
	MARGIN: 0.5em 0em
}
.explanation {
	MARGIN: 0.5em 0em
}
.definition {
	MARGIN: 0.5em 5.5em
}
.explanation P {
	MARGIN: 0.25em 0px
}
.rationale P {
	MARGIN: 0.25em 0px
}
.practice {
	BACKGROUND-COLOR: green
}
.example {
	PADDING-RIGHT: 0.5em; PADDING-LEFT: 0.5em; PADDING-BOTTOM: 0.5em; MARGIN: 0.5em 2em; PADDING-TOP: 0.5em; BACKGROUND-COLOR: #eee
}
.example-banner {
	MARGIN: 0px
}
.example PRE {
	MARGIN: 0px
}
.correct {
	FONT-WEIGHT: bold; FONT-SIZE: 0.9em; MARGIN: 0px; FONT-FAMILY: sans-serif
}
.incorrect {
	FONT-WEIGHT: bold; FONT-SIZE: 0.9em; MARGIN: 0px; FONT-FAMILY: sans-serif
}
.correct {
	COLOR: #090
}
.incorrect {
	COLOR: #900
}
.specification {
	PADDING-RIGHT: 0.5em; PADDING-LEFT: 0.5em; PADDING-BOTTOM: 0.5em; MARGIN: 0.5em 2em; PADDING-TOP: 0.5em; BACKGROUND-COLOR: #ffa
}
.ednote {
	PADDING-RIGHT: 1.2em; PADDING-LEFT: 1.2em; PADDING-BOTTOM: 1.2em; MARGIN: 1.2em; PADDING-TOP: 1.2em; BACKGROUND-COLOR: #fcc
}
.note {
	MARGIN-LEFT: 1.5em; BACKGROUND-COLOR: #fcc
}
.toc {
	MARGIN-LEFT: 2em
}
.subtoc {
	MARGIN-LEFT: 3em
}
.subsubtoc {
	MARGIN-LEFT: 4em
}
.chg {
	BACKGROUND-COLOR: orange; TEXT-DECORATION: underline
}
.add {
	BACKGROUND-COLOR: green; TEXT-DECORATION: underline
}
.del {
	BACKGROUND-COLOR: red; TEXT-DECORATION: line-through
}

media Print    
{
A.offsite:unknown {
	FONT-WEIGHT: lighter; FONT-SIZE: 85%;}
    }
UNKNOWN {
	FONT-SIZE: 50%; COLOR: #ccc; TEXT-DECORATION: none;}
</STYLE>

<META content="MSHTML 6.00.2800.1515" name=GENERATOR></HEAD>
<BODY>
<DIV class=head>
<P><A href="http://www.ws-i.org/"><IMG height=88 alt=WS-I 
src="http://www.ws-i.org/images/WS-I-logo.gif" width=107 
border=0> </A></P>
<H1>Basic Security Profile Version 1.0</H1>
<H2>Working Group Draft</H2>
<H2>2005-08-10</H2>
<DL>
  <DT>This revision: 
  <DD><a href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-08-10.html">http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-08-10.html
							</a> 
  <DT>Latest revision: 
  <DD><a href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0.html">http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0.html
							</a>
  <DT>Editors: 
  <DD>Abbie Barbir, Nortel Networks 
  <DD>Martin Gudgin, Microsoft 
  <DD>Michael McIntosh, IBM 
  <DD>K. Scott Morrison, Layer 7 
  <DT>Administrative contact: 
  <DD><A href="mailto:secretary@ws-i.org">secretary@ws-i.org</A> </DD></DL>
<P class=copyright id=copyright>Copyright © 2002-2005 by <A 
href="http://www.ws-i.org/">The Web Services-Interoperability Organization</A> 
(<ABBR 
title="Web Services Interoperability&#13;&#10;&#9;&#9;&#9;Organization">WS-I</ABBR>) 
and Certain of its Members. All Rights Reserved.</P></DIV>
<HR>

<H2 id=abstract>Abstract</H2>
<P>This document defines the WS-I Basic Security Profile 1.0, based on a set of 
non-proprietary Web services specifications, along with clarifications and 
amendments to those specifications which promote interoperability.</P>
<H2 id=status>Status of this Document</H2>
<P>This document is an editors' copy that has no official standing; it is not 
complete. Other documents may supersede this document. Discussion of this 
document takes place on the Member-only mailing list, <A 
href="mailto:wsi_secprofile@lists.ws-i.org">wsi_secprofile@lists.ws-i.org</A>. 
</P>
<H2 id=license>Notice</H2>
<P>The material contained herein is not a license, either expressly or 
impliedly, to any intellectual property owned or controlled by any of the 
authors or developers of this material or WS-I. The material contained herein is 
provided on an &quot;AS IS&quot; basis and to the maximum extent permitted by applicable 
law, this material is provided AS IS AND WITH ALL FAULTS, and the authors and 
developers of this material and WS-I hereby disclaim all other warranties and 
conditions, either express, implied or statutory, including, but not limited to, 
any (if any) implied warranties, duties or conditions of merchantability, of 
fitness for a particular purpose, of accuracy or completeness of responses, of 
results, of workmanlike effort, of lack of viruses, and of lack of negligence. 
ALSO, THERE IS NO WARRANTY OR CONDITION OF TITLE, QUIET ENJOYMENT, QUIET 
POSSESSION, CORRESPONDENCE TO DESCRIPTION OR NON-INFRINGEMENT WITH REGARD TO 
THIS MATERIAL. </P>
<P>IN NO EVENT WILL ANY AUTHOR OR DEVELOPER OF THIS MATERIAL OR WS-I BE LIABLE 
TO ANY OTHER PARTY FOR THE COST OF PROCURING SUBSTITUTE GOODS OR SERVICES, LOST 
PROFITS, LOSS OF USE, LOSS OF DATA, OR ANY INCIDENTAL, CONSEQUENTIAL, DIRECT, 
INDIRECT, OR SPECIAL DAMAGES WHETHER UNDER CONTRACT, TORT, WARRANTY, OR 
OTHERWISE, ARISING IN ANY WAY OUT OF THIS OR ANY OTHER AGREEMENT RELATING TO 
THIS MATERIAL, WHETHER OR NOT SUCH PARTY HAD ADVANCE NOTICE OF THE POSSIBILITY 
OF SUCH DAMAGES.</P>
<H2 id=feedback>Feedback</H2>
<P>The Web Services-Interoperability Organization (WS-I) would like to receive 
input, suggestions and other feedback (&quot;Feedback&quot;) on this work from a wide 
variety of industry participants to improve its quality over time. </P>
<P>By sending email, or otherwise communicating with WS-I, you (on behalf of 
yourself if you are an individual, and your company if you are providing 
Feedback on behalf of the company) will be deemed to have granted to WS-I, the 
members of WS-I, and other parties that have access to your Feedback, a 
non-exclusive, non-transferable, worldwide, perpetual, irrevocable, royalty-free 
license to use, disclose, copy, license, modify, sublicense or otherwise 
distribute and exploit in any manner whatsoever the Feedback you provide 
regarding the work. You acknowledge that you have no expectation of 
confidentiality with respect to any Feedback you provide. You represent and 
warrant that you have rights to provide this Feedback, and if you are providing 
Feedback on behalf of a company, you represent and warrant that you have the 
rights to provide Feedback on behalf of your company. You also acknowledge that 
WS-I is not required to review, discuss, use, consider or in any way incorporate 
your Feedback into future versions of its work. If WS-I does incorporate some or 
all of your Feedback in a future version of the work, it may, but is not 
obligated to include your name (or, if you are identified as acting on behalf of 
your company, the name of your company) on a list of contributors to the work. 
If the foregoing is not acceptable to you and any company on whose behalf you 
are acting, please do not provide any Feedback.</P>
<P>Feedback on this document should be directed to <A 
href="mailto:wsi_secprofile_comment@lists.ws-i.org">wsi_secprofile_comment@lists.ws-i.org</A>.</P>
<HR>

<H2 id=toc>Table of Contents</H2>
<P class=toc>1. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#introduction">Introduction</A><BR><SPAN 
class=subtoc>1.1. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#philosophy">Guiding 
Principles</A></SPAN><BR>2. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#documentConventions">Document 
Conventions</A><BR><SPAN class=subtoc>2.1. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#SecurityConsiderations">Security 
Considerations</A></SPAN><BR><SPAN class=subtoc>2.2. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#conventions">Notational 
Conventions</A></SPAN><BR><SPAN class=subtoc>2.3. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#versioning">Profile 
Identification and Versioning</A></SPAN><BR>3. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#conformance">Profile 
Conformance</A><BR><SPAN class=subtoc>3.1. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#conformance_requirements">Conformance 
Requirements</A></SPAN><BR><SPAN class=subtoc>3.2. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#conformance_targets">Conformance 
Targets</A></SPAN><BR><SPAN class=subtoc>3.3. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#conformance_scope">Conformance 
Scope</A></SPAN><BR><SPAN class=subtoc>3.4. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#conformance_claims">Claiming 
Conformance</A></SPAN><BR>4. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#transportsec">Transport 
Layer Security</A><BR><SPAN class=subtoc>4.1. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#SSLTLS">SSL 
and TLS</A></SPAN><BR><SPAN class=subsubtoc>4.1.1. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#Use_of_SSL_2.0">Use 
of SSL 2.0</A></SPAN><BR>5. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#msgsec">SOAP 
Message Security</A><BR><SPAN class=subtoc>5.1. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#WSSST">Security 
Tokens</A></SPAN><BR><SPAN class=subsubtoc>5.1.1. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#Binary_Security_Token_EncodingType_Attribute">Binary 
Security Token EncodingType Attribute</A></SPAN><BR><SPAN class=subsubtoc>5.1.2. 
<A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#Binary_Security_Token_ValueType_Attribute">Binary 
Security Token ValueType Attribute</A></SPAN><BR><SPAN class=subtoc>5.2. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#WSSTokenReferences">SecurityTokenReferences</A></SPAN><BR><SPAN 
class=subsubtoc>5.2.1. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#Internal_References">Internal 
References</A></SPAN><BR><SPAN class=subsubtoc>5.2.2. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#Shorthand_XPointer_References">Shorthand 
XPointer References</A></SPAN><BR><SPAN class=subsubtoc>5.2.3. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#References_to_Preceding_Security_Tokens">References 
to Preceding Security Tokens</A></SPAN><BR><SPAN class=subsubtoc>5.2.4. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#Direct_Preferred_to_Embedded_for_Internal_References">Direct 
Preferred to Embedded for Internal References</A></SPAN><BR><SPAN 
class=subsubtoc>5.2.5. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#Direct_Required_When_Possible_for_External_References">Direct 
Required When Possible for External References</A></SPAN><BR><SPAN 
class=subsubtoc>5.2.6. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#Format_of_Embedded_References">Format 
of Embedded References</A></SPAN><BR><SPAN class=subsubtoc>5.2.7. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#Key_Name_References_Prohibited">Key 
Name References Prohibited</A></SPAN><BR><SPAN class=subsubtoc>5.2.8. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#KeyIdentifier/@ValueType_Attribute">http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#KeyIdentifier/@ValueType_Attribute</A></SPAN><BR><SPAN 
class=subsubtoc>5.2.9. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#KeyIdentifier/@EncodingType_Attribute">http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#KeyIdentifier/@EncodingType_Attribute</A></SPAN><BR><SPAN 
class=subsubtoc>5.2.10. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#References_from_within_Embedded_Tokens">References 
from within Embedded Tokens</A></SPAN><BR><SPAN class=subsubtoc>5.2.11. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#Embedded_Token_Content">Embedded 
Token Content</A></SPAN><BR><SPAN class=subsubtoc>5.2.12. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#Reference_from_wsse_SecurityTokenReference_to_wsse_SecurityTokenReference">Reference 
from wsse:SecurityTokenReference to 
wsse:SecurityTokenReference</A></SPAN><BR><SPAN class=subsubtoc>5.2.13. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#wsse_SecurityTokenReference/Reference_ValueType_Attribute">wsse:SecurityTokenReference/Reference 
ValueType Attribute</A></SPAN><BR><SPAN class=subsubtoc>5.2.14. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#wsse_SecurityTokenReference_content">wsse:SecurityTokenReference 
content</A></SPAN><BR><SPAN class=subsubtoc>5.2.15. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#wsse_SecurityTokenReference/Reference_requires_URI_attribute">wsse:SecurityTokenReference/Reference 
requires URI attribute</A></SPAN><BR><SPAN class=subsubtoc>5.2.16. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#wsse_SecurityTokenReference_Dereferencing_Transform">wsse:SecurityTokenReference 
Dereferencing Transform</A></SPAN><BR><SPAN class=subsubtoc>5.2.17. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#Security_Token_References_across_security_headers_prohibited">Security 
Token References across security headers prohibited</A></SPAN><BR><SPAN 
class=subtoc>5.3. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#WSSTimeStamp">Timestamps</A></SPAN><BR><SPAN 
class=subsubtoc>5.3.1. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#wsu_Timestamp/wsu_Created">wsu:Timestamp/wsu:Created</A></SPAN><BR><SPAN 
class=subsubtoc>5.3.2. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#Occurence_constraints_onwsu_Created_and_wsu_Expires_">Occurence 
constraints on wsu:Created and wsu:Expires </A></SPAN><BR><SPAN 
class=subsubtoc>5.3.3. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#Leap_Seconds_Not_Allowed">Leap 
Seconds Not Allowed</A></SPAN><BR><SPAN class=subsubtoc>5.3.4. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#Timestamp_ValueType">Timestamp 
ValueType</A></SPAN><BR><SPAN class=subsubtoc>5.3.5. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#Timestamp_Format">Timestamp 
Format</A></SPAN><BR><SPAN class=subsubtoc>5.3.6. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#Timestamp_Resolution">Timestamp 
Resolution</A></SPAN><BR><SPAN class=subsubtoc>5.3.7. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#wsu_Timestamp_inside_wsse_Security_header_">wsu:Timestamp 
inside wsse:Security header </A></SPAN><BR><SPAN class=subtoc>5.4. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#WSSReferences">wsu:Id 
References</A></SPAN><BR><SPAN class=subsubtoc>5.4.1. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#wsu_Id_Attribute_Uniqueness">wsu:Id 
Attribute Uniqueness</A></SPAN><BR><SPAN class=subtoc>5.5. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#WSSProcessing">wsse:Security 
Processing Order</A></SPAN><BR><SPAN class=subsubtoc>5.5.1. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#Order_of_Processing">Order 
of Processing</A></SPAN><BR><SPAN class=subtoc>5.6. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#WSSActor">SOAP 
Actor</A></SPAN><BR><SPAN class=subsubtoc>5.6.1. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#SOAP_Actor_Value">SOAP 
Actor Value</A></SPAN><BR>6. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#usernametoken">Username 
Token Profile</A><BR><SPAN class=subtoc>6.1. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#tokenusage">Token 
Usage</A></SPAN><BR><SPAN class=subsubtoc>6.1.1. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#wsse_UsernameToken/wsse_Password/@Type">http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#wsse_UsernameToken/wsse_Password/@Type</A></SPAN><BR><SPAN 
class=subsubtoc>6.1.2. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#PasswordDigest">PasswordDigest</A></SPAN><BR><SPAN 
class=subsubtoc>6.1.3. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#ValueType_attribute">ValueType 
attribute</A></SPAN><BR><SPAN class=subsubtoc>6.1.4. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#EncodingType_attribute">EncodingType 
attribute</A></SPAN><BR><SPAN class=subsubtoc>6.1.5. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#Reference_by_KeyIdentifier">Reference 
by KeyIdentifier</A></SPAN><BR><SPAN class=subsubtoc>6.1.6. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#Key_Derivation">Key 
Derivation</A></SPAN><BR>7. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#x509token">X.509 
Certificate Token Profile</A><BR><SPAN class=subtoc>7.1. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#x509tokentypes">Token 
Types</A></SPAN><BR><SPAN class=subsubtoc>7.1.1. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#Certificate_Path_Format">Certificate 
Path Format</A></SPAN><BR><SPAN class=subsubtoc>7.1.2. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#Key_Identifier_for_External_References">Key 
Identifier for External References</A></SPAN><BR><SPAN class=subsubtoc>7.1.3. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#KeyIdentifier">KeyIdentifier</A></SPAN><BR><SPAN 
class=subsubtoc>7.1.4. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#KeyIdentifier_EncodingType">KeyIdentifier 
EncodingType</A></SPAN><BR>8. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#xmlSignature">XML-Signature</A><BR><SPAN 
class=subtoc>8.1. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#xmlSignatureGeneral">General 
Constraints on XML Signature</A></SPAN><BR><SPAN class=subsubtoc>8.1.1. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#Signature_Content">Signature 
Content</A></SPAN><BR><SPAN class=subsubtoc>8.1.2. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#Signature_Types">Signature 
Types</A></SPAN><BR><SPAN class=subtoc>8.2. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#WSSIDRef">Element 
References in XML Signature</A></SPAN><BR><SPAN class=subsubtoc>8.2.1. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#Reference_to_Elements_by_Shorthand_XPointer_(XMLDSIG)">Reference 
to Elements by Shorthand XPointer (XMLDSIG)</A></SPAN><BR><SPAN 
class=subsubtoc>8.2.2. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#Reference_to_Elements_by_XPath_Expression">Reference 
to Elements by XPath Expression</A></SPAN><BR><SPAN class=subtoc>8.3. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#xmlSignatureAlgorithms">XML 
Signature Algorithms</A></SPAN><BR><SPAN class=subsubtoc>8.3.1. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#Use_Exclusive_C14N">Use 
Exclusive C14N</A></SPAN><BR><SPAN class=subsubtoc>8.3.2. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#Transforms_Element">Transforms 
Element</A></SPAN><BR><SPAN class=subsubtoc>8.3.3. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#Transform_Element">Transform 
Element</A></SPAN><BR><SPAN class=subsubtoc>8.3.4. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#Digest_Algorithm">Digest 
Algorithm</A></SPAN><BR><SPAN class=subsubtoc>8.3.5. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#Key_Signature_Algorithms">Key 
Signature Algorithms</A></SPAN><BR><SPAN class=subsubtoc>8.3.6. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#Transform_Algorithm">Transform 
Algorithm</A></SPAN><BR><SPAN class=subtoc>8.4. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#xmlSignatureSyntax">XML 
Signature Syntax</A></SPAN><BR><SPAN class=subsubtoc>8.4.1. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#ds_HMACOutputLength">ds:HMACOutputLength</A></SPAN><BR><SPAN 
class=subsubtoc>8.4.2. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#ds_KeyInfo_with_ds_Signature">ds:KeyInfo 
with ds:Signature</A></SPAN><BR><SPAN class=subsubtoc>8.4.3. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#ds_Manifest">ds:Manifest</A></SPAN><BR><SPAN 
class=subsubtoc>8.4.4. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#Encrypting_signatures">Encrypting 
signatures</A></SPAN><BR>9. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#xmlEncryption">XML 
Encryption</A><BR><SPAN class=subtoc>9.1. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#xmlEncryptProcessing">XML 
Encryption Processing Model</A></SPAN><BR><SPAN class=subsubtoc>9.1.1. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#xenc_ReferenceList">xenc:ReferenceList</A></SPAN><BR><SPAN 
class=subsubtoc>9.1.2. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#xenc_EncryptedKey">xenc:EncryptedKey</A></SPAN><BR><SPAN 
class=subtoc>9.2. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#xmlEncryptionKeys">XML 
Encryption Syntax</A></SPAN><BR><SPAN class=subsubtoc>9.2.1. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#Placement">Placement</A></SPAN><BR><SPAN 
class=subsubtoc>9.2.2. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#Prohibited_xenc_EncryptedKey_attributes">Prohibited 
xenc:EncryptedKey attributes</A></SPAN><BR><SPAN class=subsubtoc>9.2.3. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#xenc_EncryptedData_contents">xenc:EncryptedData 
contents</A></SPAN><BR><SPAN class=subsubtoc>9.2.4. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#xenc_EncryptedData_attributes">xenc:EncryptedData 
attributes</A></SPAN><BR><SPAN class=subsubtoc>9.2.5. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#References_from_xenc_EncryptedData">References 
from xenc:EncryptedData</A></SPAN><BR><SPAN class=subsubtoc>9.2.6. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#xenc_EncryptionMethod_mandatory">xenc:EncryptionMethod 
mandatory</A></SPAN><BR><SPAN class=subsubtoc>9.2.7. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#xenc_EncryptedKey/@Recipient">http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#xenc_EncryptedKey/@Recipient</A></SPAN><BR><SPAN 
class=subsubtoc>9.2.8. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#ds_KeyInfo_with_Encryption">ds:KeyInfo 
with Encryption</A></SPAN><BR><SPAN class=subsubtoc>9.2.9. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#xenc_EncryptedData">xenc:EncryptedData</A></SPAN><BR><SPAN 
class=subsubtoc>9.2.10. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#SOAP_Envelope">SOAP 
Envelope</A></SPAN><BR><SPAN class=subtoc>9.3. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#ElementReferencesinXMLEncryption">Element 
References in XML Encryption</A></SPAN><BR><SPAN class=subsubtoc>9.3.1. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#Reference_to_Elements_by_Shorthand_XPointer_(XMLENC)">Reference 
to Elements by Shorthand XPointer (XMLENC)</A></SPAN><BR><SPAN class=subtoc>9.4. 
<A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#xmlEncryptionAlgorithms">XML 
Encryption Algorithms</A></SPAN><BR><SPAN class=subsubtoc>9.4.1. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#Data_Encryption_Algorithms">Data 
Encryption Algorithms</A></SPAN><BR><SPAN class=subsubtoc>9.4.2. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#Key_Transport_Algorithms">Key 
Transport Algorithms</A></SPAN><BR><SPAN class=subsubtoc>9.4.3. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#Key_Wrap_Algorithms">Key 
Wrap Algorithms</A></SPAN><BR>10. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#algorithms">Algorithms</A><BR><SPAN 
class=subtoc>10.1. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#tlssslalg">Transport 
Level Security Algorithms</A></SPAN><BR><SPAN class=subsubtoc>10.1.1. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#Mandatory_ciphersuites">Mandatory 
ciphersuites</A></SPAN><BR><SPAN class=subsubtoc>10.1.2. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#Recommended_ciphersuites">Recommended 
ciphersuites</A></SPAN><BR><SPAN class=subsubtoc>10.1.3. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#Discouraged_ciphersuites">Discouraged 
ciphersuites</A></SPAN><BR><SPAN class=subsubtoc>10.1.4. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#Prohibited_ciphersuites">Prohibited 
ciphersuites</A></SPAN><BR>11. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#reltoBasicProfile">Relationship 
of Basic Security Profile as an Extension to Basic Profile</A><BR><SPAN 
class=subtoc>11.1. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#bpclarify">Basic 
Profile Clarifications</A></SPAN><BR><SPAN class=subsubtoc>11.1.1. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#BP_Requirement_R2301">BP 
Requirement R2301</A></SPAN><BR><SPAN class=subsubtoc>11.1.2. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#BP_Requirement_R2710">BP 
Requirement R2710</A></SPAN><BR><SPAN class=subsubtoc>11.1.3. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#BP_Requirement_R2712">BP 
Requirement R2712</A></SPAN><BR><SPAN class=subsubtoc>11.1.4. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#BP_Requirement_R2724">BP 
Requirement R2724</A></SPAN><BR><SPAN class=subsubtoc>11.1.5. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#BP_Requirement_R2725">BP 
Requirement R2725</A></SPAN><BR><SPAN class=subsubtoc>11.1.6. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#BP_Requirement_R2729">BP 
Requirement R2729</A></SPAN><BR><SPAN class=subsubtoc>11.1.7. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#BP_Requirement_R2738">BP 
Requirement R2738</A></SPAN><BR><SPAN class=subsubtoc>11.1.8. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#BP_Requirement_R1029">BP 
Requirement R1029</A></SPAN><BR>12. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#attachsec">Attachment 
Security</A><BR><SPAN class=subtoc>12.1. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#swa">SOAP 
with Attachments</A></SPAN><BR><SPAN class=subsubtoc>12.1.1. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#Conformance">Conformance</A></SPAN><BR><SPAN 
class=subsubtoc>12.1.2. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#Relationship_between_Parts">Relationship 
between Parts</A></SPAN><BR><SPAN class=subsubtoc>12.1.3. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#Encryption_and_Root_Part">Encryption 
and Root Part</A></SPAN><BR><SPAN class=subtoc>12.2. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#signedAttachments">Signed 
Attachments</A></SPAN><BR><SPAN class=subsubtoc>12.2.1. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#Reference_to_Signed_Attachments">Reference 
to Signed Attachments</A></SPAN><BR><SPAN class=subsubtoc>12.2.2. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#Attachment_Transforms">Attachment 
Transforms</A></SPAN><BR><SPAN class=subsubtoc>12.2.3. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#Canonicalization">Canonicalization</A></SPAN><BR><SPAN 
class=subsubtoc>12.2.4. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#Digest_Values">Digest 
Values</A></SPAN><BR><SPAN class=subsubtoc>12.2.5. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#Content-Type">Content-Type</A></SPAN><BR><SPAN 
class=subtoc>12.3. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#encryptedAttachments">Encrypted 
Attachments</A></SPAN><BR><SPAN class=subsubtoc>12.3.1. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#References_to_Encrypted_Attachments">References 
to Encrypted Attachments</A></SPAN><BR><SPAN class=subsubtoc>12.3.2. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#Type_attribute">Type 
attribute</A></SPAN><BR><SPAN class=subsubtoc>12.3.3. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#Reference_URIs">Reference 
URIs</A></SPAN><BR><SPAN class=subsubtoc>12.3.4. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#Content">Content</A></SPAN><BR>13. 
<A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#seccon">Security 
Considerations</A><BR><SPAN class=subtoc>13.1. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#transportsecConsiderations">SOAPAction 
Header</A></SPAN><BR><SPAN class=subsubtoc>13.1.1. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#SOAPAction_header">SOAPAction 
header</A></SPAN><BR><SPAN class=subtoc>13.2. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#clockSynch">Clock 
Synchronization</A></SPAN><BR><SPAN class=subtoc>13.3. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#bindSTtoSigs">Security 
Token Substitution</A></SPAN><BR><SPAN class=subsubtoc>13.3.1. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#Security_Token_Substitution">Security 
Token Substitution</A></SPAN><BR><SPAN class=subsubtoc>13.3.2. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#Security_Token_Reference_in_Subsequent_Messages">Security 
Token Reference in Subsequent Messages</A></SPAN><BR><SPAN class=subtoc>13.4. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#removalModXML">Protecting 
against removal and modification of XML Elements</A></SPAN><BR><SPAN 
class=subtoc>13.5. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#uniqueIds">Uniqueness 
of ID attributes</A></SPAN><BR><SPAN class=subtoc>13.6. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#signSTs">Signing 
Security Tokens</A></SPAN><BR><SPAN class=subtoc>13.7. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#signUTs">Signing 
Username Tokens</A></SPAN><BR><SPAN class=subtoc>13.8. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#signBTs">Signing 
Binary Tokens</A></SPAN><BR><SPAN class=subtoc>13.9. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#signXTs">Signing 
XML Tokens</A></SPAN><BR><SPAN class=subtoc>13.10. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#replayUTs">Replay 
of Username Token</A></SPAN><BR><SPAN class=subsubtoc>13.10.1. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#Replay_of_Username_Token">Replay 
of Username Token</A></SPAN><BR><SPAN class=subtoc>13.11. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#digVClearPass">Use 
of Digest vs. Cleartext Password</A></SPAN><BR><SPAN class=subtoc>13.12. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#encSig">Encryption 
with Signatures</A></SPAN><BR><SPAN class=subsubtoc>13.12.1. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#Encrypt_DigestValue">Encrypt 
DigestValue</A></SPAN><BR><SPAN class=subtoc>13.13. <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#operr">Possible 
Operational Errors</A></SPAN><BR>Appendix A: <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#references">Referenced 
Specifications</A><BR>Appendix B: <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#points">Extensibility 
Points</A><BR>Appendix C: <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#acks">Acknowledgements</A><BR></P>
<H2 id=introduction>1. Introduction</H2>
<P><SPAN class=statement-target></SPAN>This document defines the WS-I Basic 
Security Profile 1.0 (hereafter, &quot;Profile&quot;), consisting of a set of 
non-proprietary Web services specifications, along with clarifications to and 
amplifications of those specifications which promote interoperability.</P>
<P><SPAN class=statement-target></SPAN>Section 1, <EM><SPAN 
class=statement-target></SPAN>&quot;Introduction,&quot;</EM><SPAN 
class=statement-target></SPAN> introduces the Basic Security Profile 1.0 and 
relates the philosophy that it takes with regard to interoperability.</P>
<P><SPAN class=statement-target></SPAN>Section 2, <EM><SPAN 
class=statement-target></SPAN>&quot;Document Conventions,&quot;</EM><SPAN 
class=statement-target></SPAN> describes notational conventions utilized by the 
Basic Security Profile 1.0.</P>
<P><SPAN class=statement-target></SPAN>Section 3, <EM><SPAN 
class=statement-target></SPAN>&quot;Profile Conformance,&quot;</EM><SPAN 
class=statement-target></SPAN> explains what it means to be conformant to the 
Basic Security Profile 1.0. </P>
<P><SPAN class=statement-target></SPAN>Each subsequent section addresses a 
component of the Basic Security Profile 1.0, and consists of two parts: an 
overview detailing the component specifications and their extensibility points, 
followed by subsections that address individual parts of the component 
specifications. Note that there is no relationship between the section numbers 
in this document and those in the referenced specifications.</P>
<H3 id=philosophy>1.1 Guiding Principles</H3>
<P><SPAN class=statement-target></SPAN>The Profile was developed according to a 
set of principles that, together, form the philosophy of the Basic Security 
Profile 1.0, as it relates to bringing about interoperability. This section 
documents these guidelines.</P>
<DL>
  <DT><SPAN class=statement-target></SPAN>No guarantee of interoperability 
  <DD><SPAN class=statement-target></SPAN>Although it is impossible to 
  completely guarantee the interoperability of a particular service, the Basic 
  Security Profile 1.0 attempts to increase interoperability by addressing the 
  most common problems that implementation experience has revealed to date. 
  <DT><SPAN class=statement-target></SPAN>Focus profiling effort 
  <DD><SPAN class=statement-target></SPAN>The focus of the Basic Security 
  Profile 1.0 is the specifications that are explicitly defined as in-scope for 
  the Basic Security Profile 1.0. Other specifications are profiled to the 
  minimal extent necessary to allow meaningful profiling of the scoped 
  specifications. This allows an in-depth profile of the scoped specifications 
  with reduced constraining of other specifications. 
  <DT><SPAN class=statement-target></SPAN>Application semantics 
  <DD><SPAN class=statement-target></SPAN>Although communication of application 
  semantics can be facilitated by the technologies that comprise the Basic 
  Security Profile 1.0, assuring the common understanding of those semantics is 
  not addressed by it. 
  <DT><SPAN class=statement-target></SPAN>Testability 
  <DD><SPAN class=statement-target></SPAN>When possible, the Basic Security 
  Profile 1.0 makes statements that are testable. However, such testability is 
  not required. Preferably, testing is achieved in a non-intrusive manner (e.g., 
  examining artifacts &quot;on the wire&quot;). Note: Due to the nature of cryptographic 
  security, non-intrusive testing may not be possible. 
  <DT><SPAN class=statement-target></SPAN>Strength of requirements 
  <DD><SPAN class=statement-target></SPAN>The Profile makes strong requirements 
  (e.g., MUST, MUST NOT) wherever feasible; if there are legitimate cases where 
  such a requirement cannot be met, conditional requirements (e.g., SHOULD, 
  SHOULD NOT) are used. Optional and conditional requirements introduce 
  ambiguity and mismatches between implementations. 
  <DT><SPAN class=statement-target></SPAN>Restriction vs. relaxation 
  <DD><SPAN class=statement-target></SPAN>When amplifying the requirements of 
  referenced specifications (including the Basic Profile 1.0 ), the Basic 
  Security Profile 1.0 may restrict them, but does not relax them (e.g., change 
  a MUST to a MAY). 
  <DT><SPAN class=statement-target></SPAN>Multiple mechanisms 
  <DD><SPAN class=statement-target></SPAN>If a referenced specification allows 
  multiple mechanisms to be used interchangeably to achieve the same goal, the 
  Basic Security Profile 1.0 selects those that are well-understood, widely 
  implemented and useful. Extraneous or underspecified mechanisms and extensions 
  introduce complexity and therefore reduce interoperability. 
  <DT><SPAN class=statement-target></SPAN>Future compatibility 
  <DD><SPAN class=statement-target></SPAN>When possible, the Basic Security 
  Profile 1.0 aligns its requirements with in-progress revisions to the 
  specifications it references (e.g., Web Services Security). This aids 
  implementers by enabling a graceful transition, and assures that WS-I does not 
  'fork' from these efforts. When the Basic Security Profile 1.0 cannot address 
  an issue in a specification it references, this information is communicated to 
  the appropriate body to assure its consideration. 
  <DT><SPAN class=statement-target></SPAN>Compatibility with deployed services 
  <DD><SPAN class=statement-target></SPAN>Backwards compatibility with deployed 
  Web services is not a goal for the Basic Security Profile 1.0, but due 
  consideration is given to it; the Profile does not introduce a change to the 
  requirements of a referenced specification unless doing so addresses specific 
  interoperability issues. 
  <DT><SPAN class=statement-target></SPAN>Focus on interoperability 
  <DD><SPAN class=statement-target></SPAN>Although there are potentially a 
  number of inconsistencies and design flaws in the referenced specifications, 
  the Basic Security Profile 1.0 only addresses those that affect 
  interoperability. 
  <DT><SPAN class=statement-target></SPAN>Conformance targets 
  <DD><SPAN class=statement-target></SPAN>Where possible, the Basic Security 
  Profile 1.0 places requirements on artifacts (e.g., WSDL descriptions, SOAP 
  messages) rather than the producing or consuming software's behaviors or 
  roles. Artifacts are concrete, making them easier to verify and therefore 
  making conformance easier to understand and less error-prone. 
  <DT><SPAN class=statement-target></SPAN>Lower-layer interoperability 
  <DD><SPAN class=statement-target></SPAN>The Profile speaks to interoperability 
  at the web-services layer only; it assumes that interoperability of 
  lower-layer protocols ( e.g. TCP, HTTP ) and technologies (e.g. encryption and 
  signature algorithms ) is adequate and well-understood. WS-I does not attempt 
  to assure the interoperability of these protocols and technologies as a whole. 
  This assures that WS-I's expertise in and focus on Web services standards is 
  used effectively. 
  <DT><SPAN class=statement-target></SPAN>Do no harm 
  <DD><SPAN class=statement-target></SPAN>Interoperability of security 
  technologies does not in and of itself ensure security, and the act of 
  combining new technologies and protocols is especially susceptible to security 
  threats. The profile takes steps to avoid introducing new security threats. 
  <DT><SPAN class=statement-target></SPAN>Best Practices 
  <DD><SPAN class=statement-target></SPAN>It is not the intent of the Basic 
  Security Profile 1.0 to define security best practices. However, when multiple 
  options exist, we may use known security weaknesses as a means of reducing 
  choice and thus enhancing interoperability. The Profile will offer 
  non-normative security considerations where the authors deem appropriate; 
  however, these are by no means exhaustive and should not be perceived as a 
  sanctioning of a security best practice. </DD></DL>
<H2 id=documentConventions>2. Document Conventions</H2>
<P><SPAN class=statement-target></SPAN>This document follows conventions common 
to all WS-I profiles. These are described in the following sections.</P>
<H3 id=SecurityConsiderations>2.1 Security Considerations</H3>
<P><SPAN class=statement-target></SPAN>In addition to interoperability 
recommendations (which are made in Rnnnn statements and intended to improve 
interoperability), the Basic Security Profile 1.0 makes a number of security 
recommendations intended to improve security. Security recommendations are 
presented as follows: </P>
<P><SPAN class=statement-target></SPAN>Security considerations are presented as 
follows:</P>
<P class=statement><SPAN class=statement-id><SPAN 
class=statement-target></SPAN>Cnnnn</SPAN><SPAN class=statement-target></SPAN> 
Statement text here. </P>
<P><SPAN class=statement-target></SPAN>where &quot;nnnn&quot; is replaced by a number that 
is unique among the security recommendations in the Basic Security Profile 1.0, 
thereby forming a unique security recommendation identifier. Each security 
recommendation contains a <EM><SPAN 
class=statement-target></SPAN>SHOULD</EM><SPAN class=statement-target></SPAN> to 
highlight exactly what is being recommended; however, these recommendations are 
informational only and are non-normative. Though security recommendations are 
expected to be tested by the test tools to highlight possible security problems, 
security recommendations have no impact on conformance.</P>
<P><SPAN class=statement-target></SPAN>It should be understood that, while a 
number of recommendations are made about security, adherence to these security 
recommendations does not guarantee security.</P>
<H3 id=conventions>2.2 Notational Conventions </H3>
<P>The keywords &quot;MUST&quot;, &quot;MUST NOT&quot;, &quot;REQUIRED&quot;, &quot;SHALL&quot;, &quot;SHALL NOT&quot;, &quot;SHOULD&quot;, 
&quot;SHOULD NOT&quot;, &quot;RECOMMENDED&quot;, &quot;MAY&quot;, and &quot;OPTIONAL&quot; in this document are to be 
interpreted as described in <A class=offsite 
href="http://www.ietf.org/rfc/rfc2119.txt">RFC2119</A>.</P>
<P>Normative statements of requirements in the Basic Security Profile 1.0 (i.e., 
those impacting conformance, as outlined in &quot;<A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#conformance_requirements">Conformance 
Requirements</A>&quot;) are presented in the following manner:</P>
<P class=statement><SPAN class=statement-id>Rnnnn</SPAN>Statement text here.</P>
<P>where &quot;nnnn&quot; is replaced by a number that is unique among the requirements in 
the Basic Security Profile 1.0, thereby forming a unique requirement 
identifier.</P>
<P>Requirement identifiers can be considered to be namespace qualified, in such 
a way as to be compatible with QNames from <A class=offsite 
href="http://www.w3.org/TR/REC-xml-names/">Namespaces in XML</A>. If there is no 
explicit namespace prefix on a requirement's identifier (e.g., &quot;R9999&quot; as 
opposed to &quot;bp10:R9999&quot;), it should be interpreted as being in the namespace 
identified by the conformance URI of the document section it occurs in. If it is 
qualified, the prefix should be interpreted according to the namespace mappings 
in effect, as documented below.</P>
<P>Some requirements clarify the referenced specification(s), but do not place 
additional constraints upon implementations. For convenience, clarifications are 
annotated in the following manner: <SPAN class=statement-type>C</SPAN></P>
<P>Some requirements are derived from ongoing standardization work on the 
referenced specification(s). For convenience, such forward-derived statements 
are annotated in the following manner: <SPAN class=statement-origin>xxxx</SPAN>, 
where &quot;xxxx&quot; is an identifier for the specification (e.g., &quot;WSDL20&quot; for WSDL 
Version 2.0). Note that because such work was not complete when this document 
was published, the specification that the requirement is derived from may 
change; this information is included only as a convenience to implementers.</P>
<P>Extensibility points in underlying specifications (see &quot;<A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#conformance_scope">Conformance 
Scope</A>&quot;) are presented in a similar manner:</P>
<P class=statement><SPAN class=statement-id>Ennnn</SPAN>Extensibility Point Name 
- Description</P>
<P>where &quot;nnnn&quot; is replaced by a number that is unique among the extensibility 
points in the Basic Security Profile 1.0. As with requirement statements, 
extensibility statements can be considered namespace-qualified.</P>
<P>This specification uses a number of namespace prefixes throughout; their 
associated URIs are listed below. Note that the choice of any namespace prefix 
is arbitrary and not semantically significant.</P>
<UL>
  <LI><STRONG>soap</STRONG> - &quot;http://schemas.xmlsoap.org/soap/envelope/&quot; 
  <LI><STRONG>xsd</STRONG> - &quot;http://www.w3.org/2001/XMLSchema&quot; 
  <LI><STRONG>wsi</STRONG> - &quot;http://www.ws-i.org/schemas/conformanceClaim&quot; 
  <LI><STRONG>ds</STRONG> - &quot;http://www.w3.org/2000/09/xmldsig#&quot;&quot; 
  <LI><STRONG>xenc</STRONG> - &quot;http://www.w3.org/2001/04/xmlenc#&quot; 
  <LI><STRONG>c14n</STRONG> - &quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot; 
  <LI><STRONG>wsse</STRONG> - 
  &quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd&quot; 

  <LI><STRONG>wsu</STRONG> - 
  &quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd&quot; 

  <LI><STRONG>b10</STRONG> - 
  &quot;http://www.ws-i.org/Profiles/Basic/2003-08/BasicProfile-1.0a.htm&quot; 
  <LI><STRONG>bp11</STRONG> - 
  &quot;http://www.ws-i.org/Profiles/BasicProfile-1.1.html&quot; </LI></UL>
<H3 id=versioning>2.3 Profile Identification and Versioning </H3>
<P>This document is identified by a name (in this case, Basic Security Profile) 
and a version number (here, 1.0). Together, they identify a particular 
<EM>profile instance</EM>.</P>
<P>Version numbers are composed of a major and minor portion, in the form 
&quot;major.minor&quot;. They can be used to determine the precedence of a profile 
instance; a higher version number (considering both the major and minor 
components) indicates that an instance is more recent, and therefore supersedes 
earlier instances.</P>
<P>Instances of profiles with the same name (e.g., &quot;Example Profile 1.1&quot; and 
&quot;Example Profile 5.0&quot;) address interoperability problems in the same general 
scope (although some developments may require the exact scope of a profile to 
change between instances).</P>
<P>One can also use this information to determine whether two instances of a 
profile are backwards-compatible; that is, whether one can assume that 
conformance to an earlier profile instance implies conformance to a later one. 
Profile instances with the same name and major version number (e.g., &quot;Example 
Profile 1.0&quot; and &quot;Example Profile 1.1&quot;) MAY be considered compatible. Note that 
this does not imply anything about compatibility in the other direction; that 
is, one cannot assume that conformance with a later profile instance implies 
conformance to an earlier one.</P>
<H2 id=conformance>3 Profile Conformance </H2>
<P>Conformance to the Basic Security Profile 1.0 is defined by adherence to the 
set of <EM>requirements</EM> defined for a specific <EM>target</EM>, within the 
<EM>scope</EM> of the Profile. This section explains these terms and describes 
how conformance is defined and used.</P>
<H3 id=conformance_requirements>3.1 Conformance Requirements </H3>
<P>Requirements state the criteria for conformance to the Profile. They 
typically refer to an existing specification and embody refinements, 
amplifications, interpretations and clarifications to it in order to improve 
interoperability. All requirements in the Basic Security Profile 1.0 are 
considered normative, and those in the specifications it references that are 
in-scope (see &quot;Conformance Scope&quot;) should likewise be considered normative. When 
requirements in the Basic Security Profile 1.0 and its referenced specifications 
contradict each other, the Basic Security Profile 1.0's requirements take 
precedence for purposes of Profile conformance.</P>
<P>Requirement levels, using <A class=offsite 
href="http://www.ietf.org/rfc/rfc2119.txt">RFC2119</A> language (e.g., MUST, 
MAY, SHOULD) indicate the nature of the requirement and its impact on 
conformance. Each requirement is individually identified (e.g., R9999) for 
convenience.</P>
<P>For example;</P>
<P class=statement><SPAN class=statement-id>R9999</SPAN> WIDGETs SHOULD be round 
in shape.</P>
<P>This requirement is identified by &quot;R9999&quot;, applies to the target WIDGET (see 
below), and places a conditional requirement upon widgets; i.e., although this 
requirement must be met to maintain conformance in most cases, there are some 
situations where there may be valid reasons for it not being met (which are 
explained in the requirement itself, or in its accompanying text).</P>
<P>Each requirement statement contains exactly one requirement level keyword 
(e.g., &quot;MUST&quot;) and one conformance target keyword (e.g., &quot;MESSAGE&quot;). The 
conformance target keyword appears in bold text (e.g. &quot;<B>MESSAGE</B>&quot;). Other 
conformance targets appearing in non-bold text are being used strictly for their 
definition and NOT as a conformance target. Additional text may be included to 
illuminate a requirement or group of requirements (e.g., rationale and 
examples); however, prose surrounding requirement statements must not be 
considered in determining conformance.</P>
<P>Definitions of terms in the Basic Security Profile 1.0 are considered 
authoritative for the purposes of determining conformance.</P>
<P>None of the requirements in the Basic Security Profile 1.0, regardless of 
their conformance level, should be interpreted as limiting the ability of an 
otherwise conforming implementation to apply security countermeasures in 
response to a real or perceived threat (e.g., a denial of service attack).</P>
<H3 id=conformance_targets>3.2 Conformance Targets </H3>
<P>Conformance targets identify what artifacts (e.g., SOAP message, WSDL 
description, UDDI registry data) or parties (e.g., SOAP processor, end user) 
requirements apply to. </P>
<P>This allows for the definition of conformance in different contexts, to 
assure unambiguous interpretation of the applicability of requirements, and to 
allow conformance testing of artifacts (e.g., SOAP messages and WSDL 
descriptions) and the behavior of various parties to a Web service (e.g., 
clients and service instances).</P>
<P>Requirements' conformance targets are physical artifacts wherever possible, 
to simplify testing and avoid ambiguity.</P>
<P>The following conformance targets are used in the Basic Security Profile 
1.0:</P>
<UL>
  <LI><STRONG>SECURE_ENVELOPE</STRONG> - a SOAP envelope that contains 
  sub-elements that have been subject to integrity and/or confidentiality 
  protection. A message is considered conformant when all of its contained 
  Artifacts are conformant with all Statements related to SECURE_ENVELOPE, 
  SECURE_MESSAGE, SECURITY_HEADER, REFERENCE, SIGNATURE, ENCRYPTED_KEY, 
  ENCRYPTION_REFERENCE_LIST, ENCRYPTED_KEY_REFERENCE_LIST, ENCRYPTED_DATA, 
  SECURITY_TOKEN_REFERENCE, INTERNAL_SECURITY_TOKEN and TIMESTAMP as appropriate 
  in the Basic Security Profile. Use of artifacts for which there are no 
  statements in the Basic Security Profile does not effect conformance. 
  <LI><STRONG>SECURE_MESSAGE</STRONG> - protocol elements that have WSS Security 
  applied to them. Protocol elements include a primary SOAP envelope and 
  optionally associated SwA attachments. 
  <LI><STRONG>SENDER</STRONG> - software that generates a message according to 
  the protocol(s) associated with it. A sender is considered conformant when all 
  of the messages it produces are conformant and its behavior is conformant with 
  all statements related to SENDER in the Basic Security Profile 1.0. (from 
  Basic Profile 1.0) 
  <LI><STRONG>RECEIVER</STRONG> - software that consumes a message according to 
  the protocol(s) associated with it. A receiver is considered conformant when 
  it is capable of consuming conformant messages containing the artifacts that 
  it supports and its behavior is conformant with all statements related to 
  RECEIVER in the Basic Security Profile 1.0. A conformant receiver need not 
  accept all possible conformant messages. A conformant receiver may choose not 
  to support artifacts that provide unneeded or undesired functionality. When a 
  receiver supports a specific artifact, and the Basic Security Profile 1.0 
  contains statements related to that artifact, a conformant receiver must 
  accept all required conformant forms of that artifact. (from Basic Profile 
  1.0) 
  <LI><STRONG>INSTANCE</STRONG> - software that implements a wsdl:port or a 
  uddi:bindingTemplate. (from Basic Profile 1.0) 
  <LI><STRONG>SECURITY_HEADER</STRONG> - an element included as a child of 
  soap:Envelope/soap:Header and named wsse:Security 
  <LI><STRONG>REFERENCE</STRONG> - a SIGNATURE ds:Reference element. 
  <LI><STRONG>SIGNATURE</STRONG> - an element included as a child of a 
  SECURITY_HEADER and named ds:Signature. 
  <LI><STRONG>ENCRYPTED_KEY</STRONG> - an element included as a child of a 
  SECURITY_HEADER and named xenc:EncryptedKey. 
  <LI><STRONG>ENCRYPTION_REFERENCE_LIST</STRONG> - an element which is included 
  as a child of a SECURITY_HEADER and named xenc:ReferenceList. 
  <LI><STRONG>ENCRYPTED_KEY_REFERENCE_LIST</STRONG> - an element which is 
  included as a child of an ENCRYPTED_KEY and named xenc:ReferenceList. 
  <LI><STRONG>ENCRYPTED_DATA</STRONG> - an element named xenc:EncryptedData 
  which is referenced by either an ENCRYPTED_KEY_REFERENCE_LIST or an 
  ENCRYPTION_REFERENCE_LIST. 
  <LI><STRONG>SECURITY_TOKEN_REFERENCE</STRONG> - an element included as a 
  descendant of a SECURITY_HEADER or an ENCRYPTED_DATA and is named 
  wsse:SecurityTokenReference. 
  <LI><STRONG>INTERNAL_SECURITY_TOKEN</STRONG> - a security token defined in a 
  security token profile and that is either a child of SECURITY_HEADER or a 
  child of a wsse:Embedded element in a SECURITY_TOKEN_REFERENCE. 
  <LI><STRONG>EXTERNAL_SECURITY_TOKEN</STRONG> - a security token defined in a 
  security token profile that is external to a SECURE_ENVELOPE. 
  <LI><STRONG>SECURITY_TOKEN</STRONG> - either an INTERNAL_SECURITY_TOKEN or an 
  EXTERNAL_SECURITY_TOKEN (e.g. UsernameToken, X.509 Certificate Token, REL 
  Token, SAML Token et.al.). 
  <LI><STRONG>TIMESTAMP</STRONG> - an element included as a child of a 
  SECURITY_HEADER and named wsu:Timestamp 
  <LI><STRONG>MIME_PART</STRONG> - the MIME-defined header fields and contents 
  of one of the parts in the body of a multipart entity in a SECURE_MESSAGE. 
  </LI></UL>
<H3 id=conformance_scope>3.3 Conformance Scope </H3>
<P>The scope of the Basic Security Profile 1.0 delineates the technologies that 
it addresses; in other words, the Basic Security Profile 1.0 only attempts to 
improve interoperability within its own scope. Generally, the Basic Security 
Profile 1.0's scope is bounded by the specifications referenced by it.</P>
<P>The Profile's scope is further refined by extensibility points. Referenced 
specifications often provide extension mechanisms and unspecified or open-ended 
configuration parameters; when identified in the Basic Security Profile 1.0 as 
an extensibility point, such a mechanism or parameter is outside the scope of 
the Basic Security Profile 1.0, and its use or non-use is not relevant to 
conformance.</P>
<P>Note that the Basic Security Profile 1.0 may still place requirements on the 
use of an extensibility point. Also, specific uses of extensibility points may 
be further restricted by other profiles, to improve interoperability when used 
in conjunction with the Basic Security Profile 1.0.</P>
<P>Because the use of extensibility points may impair interoperability, their 
use should be negotiated or documented in some fashion by the parties to a Web 
service; for example, this could take the form of an out-of-band agreement.</P>
<P>The Profile's scope is defined by the referenced specifications in <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#references">Appendix 
A</A>, as refined by the extensibility points in <A 
href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#points">Appendix 
B</A>.</P>
<H3 id=conformance_claims>3.4 Claiming Conformance </H3>
<P>Claims of conformance to the Basic Security Profile 1.0 can be made using the 
following mechanisms, as described in <A class=offsite 
href="http://www.ws-i.org/Profiles/ConformanceClaims-1.0.html">Conformance Claim 
Attachment Mechanisms</A>, when the applicable Profile requirements associated 
with the listed targets have been met:</P>
<P class=ednote>The CCAM URI may change before final publication.</P>
<UL></UL>
<P>The conformance claim URI for the Basic Security Profile 1.0 is 
&quot;http://ws-i.org/profiles/basic-security/core/1.0&quot; , with the following 
exceptions, which are associated with specific sections:</P>
<UL>
  <LI><A 
  href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#transportsec">Transport 
  Layer Security</A> - &quot;http://ws-i.org/profiles/basic-security/transport/1.0&quot; 
  <LI><A 
  href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#usernametoken">Username 
  Token Profile</A> - 
  &quot;http://ws-i.org/profiles/basic-security/username-token/1.0&quot; 
  <LI><A 
  href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#x509token">X.509 
  Certificate Token Profile</A> - 
  &quot;http://ws-i.org/profiles/basic-security/x.509-certificate-token/1.0&quot; 
  <LI><A 
  href="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/Basic+Security+Profile+1.0+ED+Copy#attachsec">Attachment 
  Security</A> - &quot;http://ws-i.org/profiles/basic-security/swa/1.0&quot; </LI></UL>
<P>If a claim of conformance is made as described in CCAM to BSP 1.0 
(&quot;http://ws-i.org/profiles/basic-security/core/1.0&quot;), then the claim MUST also 
specify which tokens, be they BSP profile tokens or other mutually agreed upon 
tokens, are supported.</P>
<P>The conformance URI for transport level security 
(&quot;http://ws-i.org/profiles/basic-security/transport/1.0&quot;) can be used in 
isolation or in combination with other conformance URIs.</P>
<H2 id=transportsec>4. Transport Layer Security</H2>
<P>This section of the Basic Security Profile 1.0 incorporates the following 
specifications by reference, and defines extensibility points within them: </P>
<UL>
  <LI><A class=offsite href="http://www.ietf.org/rfc/rfc2818.txt">HTTP over 
  TLS</A> 
  <LI><A class=offsite href="http://www.ietf.org/rfc/rfc2246.txt">The TLS 
  Protocol Version 1.0</A> <BR>Extensibility points: 
  <UL>
    <LI><SPAN class=statement-id id=E0009>E0009</SPAN> - TLS Ciphersuites - TLS 
    allows for the use of arbitrary encryption algorithms. Note that while 
    section 10.1 of the Basic Security Profile 1.0 mandates, recommends, and 
    discourages support for certain ciphersuites, the Basic Security Profile 1.0 
    does not prohibit use of any specific ciphersuite.
    <LI><SPAN class=statement-id id=E0010>E0010</SPAN> - TLS Extensions - TLS 
    allows for extensions during the handshake phase.</LI></UL>
  <LI><A class=offsite href="http://wp.netscape.com/eng/ssl3/ssl-toc.html">The 
  SSL Protocol Version 3.0</A> <BR>Extensibility points: 
  <UL>
    <LI><SPAN class=statement-id id=E0011>E0011</SPAN> - SSL Ciphersuites - SSL 
    allows for the use of arbitrary encryption algorithms. Note that while 
    section 10.1 of the Basic Security Profile 1.0 mandates, recommends, and 
    discourages support for certain ciphersuites, the Basic Security Profile 1.0 
    does not prohibit use of any specific ciphersuite.</LI></UL></LI></UL>
<H3 id=SSLTLS>4.1 SSL and TLS</H3>
<P>The following specifications (or sections thereof) are referred to in this 
section of the Basic Security Profile 1.0:</P>
<UL>
  <LI><A class=offsite href="http://www.ietf.org/rfc/rfc2818.txt">HTTP over TLS: 
  Section 2.2.1</A> </LI></UL>
<P><SPAN class=statement-target></SPAN>SSL and TLS are both used as underlying 
protocols for HTTP/S. The Profile places the following constraints on those 
protocols:</P>
<DIV class=refinement>
<H4 id=Use_of_SSL_2.0>4.1.1 Use of SSL 2.0</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>SSL 2.0 has known security issues and all 
current implementations of HTTP/S support more recent protocols. Therefore the 
Basic Security Profile 1.0 prohibits use of SSL 2.0.</P></DIV>
<P class=statement><SPAN class=statement-id><A name=R2001>R2001</A> </SPAN>A 
<SPAN class=statement-target>SENDER</SPAN> MUST NOT use SSL 2.0 as the 
underlying protocol for HTTP/S</P>
<P class=statement><SPAN class=statement-id><A name=R2002>R2002</A> </SPAN>A 
<SPAN class=statement-target>RECEIVER</SPAN> MUST NOT use SSL 2.0 as the 
underlying protocol for HTTP/S</P></DIV>
<H2 id=msgsec>5. SOAP Message Security</H2>
<P>This section of the Basic Security Profile 1.0 incorporates the following 
specifications by reference, and defines extensibility points within them: </P>
<UL>
  <LI><A class=offsite 
  href="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0.pdf">Web 
  Services Security: SOAP Message Security 1.0 (WS-Security 2004) OASIS Standard 
  200401, March 2004</A> <BR>Extensibility points: 
  <UL>
    <LI><SPAN class=statement-id id=E0002>E0002</SPAN> - Security Tokens - 
    Security tokens may be specified in additional security token 
  profiles.</LI></UL>
  <LI><A class=offsite 
  href="http://www.oasis-open.org/committees/download.php/11146/oasis-200401-wss-soap-message-security-1.0-errata-004.pdf">Web 
  Services Security: SOAP Message Security 1.0 (WS-Security 2004) Errata 1.0 
  Committee Draft 200401, October 2004</A> </LI></UL>
<H3 id=WSSST>5.1 Security Tokens</H3>
<P>The following specifications (or sections thereof) are referred to in this 
section of the Basic Security Profile 1.0:</P>
<UL>
  <LI><A class=offsite 
  href="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0.pdf">Web 
  Services Security: SOAP Message Security Section 6</A> </LI></UL>
<P><SPAN class=statement-target></SPAN>In some areas the Basic Security Profile 
allows limited flexibility and extensibility in the application of security to 
messages. Some agreement between the SENDER and RECEIVER over which mechanisms 
and choices should be used for message exchanges is necessary. Since no security 
policy description language or negotiation mechanism is in scope for the Basic 
Security Profile, some out of band agreement must be reached for which security 
tokens should be used. </P>
<P><SPAN class=statement-target></SPAN>The Basic Security Profile 1.0 places the 
following constraints on the use of Security Tokens:</P>
<DIV class=refinement>
<H4 id=Binary_Security_Token_EncodingType_Attribute>5.1.1 Binary Security Token 
EncodingType Attribute</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>Base64Binary is the only encoding type 
specified by Web Services Security: SOAP Message Security. Explicit 
specification of attribute values simplifies XML processing requirements and as 
a general principle the Basic Security Profile 1.0 requires that attributes be 
explicitly specified rather than relying on default values. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R3029>R3029</A> </SPAN>A 
<SPAN class=statement-target>SECURITY_TOKEN</SPAN> named 
wsse:BinarySecurityToken MUST specify an EncodingType attribute. </P>
<P class=statement><SPAN class=statement-id><A name=R3030>R3030</A> </SPAN>An 
EncodingType attribute of a <SPAN class=statement-target>SECURITY_TOKEN</SPAN> 
named wsse:BinarySecurityToken MUST have a value of 
&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;. 
</P>
<DIV class=explanation>
<P><SPAN class=statement-target></SPAN>A BinarySecurityToken may specify its 
encoding type. The Profile restricts the encoding type to Base64Binary and 
requires its explicit specification. </P></DIV>
<P class=example-banner>For example,</P>
<DIV class=example>
<P class=incorrect>INCORRECT: </P><PRE>&lt;!-- This example is incorrect because the wsse:BinarySecurityToken element is missing an EncodingType attribute --&gt;

&lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                          ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0##X509v3&quot;&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
&lt;/wsse:BinarySecurityToken&gt;
</PRE></DIV>
<DIV class=example>
<P class=correct>CORRECT: </P><PRE>&lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                          ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;
                          EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
&lt;/wsse:BinarySecurityToken&gt;
</PRE></DIV></DIV>
<DIV class=refinement>
<H4 id=Binary_Security_Token_ValueType_Attribute>5.1.2 Binary Security Token 
ValueType Attribute</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>There is no appropriate default for 
ValueType so the Basic Security Profile 1.0 mandates that an explicit value be 
provided. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R3031>R3031</A> </SPAN>A 
<SPAN class=statement-target>SECURITY_TOKEN</SPAN> named 
wsse:BinarySecurityToken MUST specify a ValueType attribute. </P>
<P class=statement><SPAN class=statement-id><A name=R3032>R3032</A> </SPAN>A 
ValueType attribute of a <SPAN class=statement-target>SECURITY_TOKEN</SPAN> 
named wsse:BinarySecurityToken MUST have a value specified by the related 
security token profile. </P>
<P class=statement><SPAN class=statement-id><A name=R3033>R3033</A> </SPAN>A 
<SPAN class=statement-target>SECURITY_TOKEN</SPAN> named 
wsse:BinarySecurityToken containing a single X.509 Certificate MUST specify a 
ValueType attribute with the value 
&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;. 
</P>
<DIV class=explanation>
<P><SPAN class=statement-target></SPAN>Web Services Security: SOAP Message 
Security allows for a BinarySecurityToken to optionally specify its ValueType. 
The Profile restricts the ValueType to one of those specified by a security 
token profile and requires its specification. </P></DIV>
<P class=example-banner>For example,</P>
<DIV class=example>
<P class=incorrect>INCORRECT: </P><PRE>&lt;!-- This example is incorrect because the wsse:BinarySecurityToken element is missing a ValueType attribute --&gt;

&lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                          EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
&lt;/wsse:BinarySecurityToken&gt;
</PRE></DIV>
<DIV class=example>
<P class=incorrect>INCORRECT: </P><PRE>&lt;!-- This example is incorrect because the ValueType attribute on the wsse:BinarySecurityToken element has an incorrect value. --&gt;

&lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                          ValueType=&quot;http://www.mta.org/NYC#SubwayToken&quot;
                          EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
&lt;/wsse:BinarySecurityToken&gt;
</PRE></DIV>
<DIV class=example>
<P class=correct>CORRECT: </P><PRE>&lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                          ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;
                          EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
&lt;/wsse:BinarySecurityToken&gt;
</PRE></DIV></DIV>
<H3 id=WSSTokenReferences>5.2 SecurityTokenReferences</H3>
<P>The following specifications (or sections thereof) are referred to in this 
section of the Basic Security Profile 1.0:</P>
<UL>
  <LI><A class=offsite 
  href="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0.pdf">Web 
  Services Security: SOAP Message Security Section 7</A> </LI></UL><SPAN 
class=statement-target></SPAN>Web Services Security: SOAP Message Security 
defines a wsse:SecurityTokenReference element for use in SOAP messages. The 
Profile places the following constraints on its use: 
<DIV class=refinement>
<H4 id=Internal_References>5.2.1 Internal References</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>Web Services Security: SOAP Message 
Security provides a list of reference mechanisms in preferred order (i.e., most 
specific to least specific). This adds ambiguity and complexity, which 
discourages interoperability. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R3022>R3022</A></SPAN> When 
a <SPAN class=statement-target>SECURITY_TOKEN_REFERENCE</SPAN> references an 
INTERNAL_SECURITY_TOKEN which has a wsu:Id attribute, the reference MUST use 
either a Direct Reference or an Embedded Reference. </P>
<DIV class=explanation>
<P><SPAN class=statement-target></SPAN>The recommendation does not allow the use 
of Key Identifier and Key Name references due to possible ambiguities. Direct 
References and Embedded References are to be used instead of these. This reduces 
complexity and improves interoperability. </P></DIV>
<P class=example-banner>For example,</P>
<DIV class=example>
<P class=incorrect>INCORRECT: </P><PRE>&lt;!-- This example is incorrect because it refers to a wsse:BinarySecurityToken element which specifies a wsu:id
     attribute using a wsse:KeyIdentifier element rather than a wsse:Reference or wsse:Embedded element --&gt;

&lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd' 
               xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd' 
               xmlns:xenc='http://www.w3.org/2001/04/xmlenc#' 
               xmlns:ds='http://www.w3.org/2000/09/xmldsig#' &gt;
   &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                             ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;
                             EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
   &lt;/wsse:BinarySecurityToken&gt;
   &lt;wsse:SecurityTokenReference&gt;
      &lt;wsse:KeyIdentifier EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;
                          ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509SubjectKeyIdentifier&quot;&gt;
         MIGfMa0GCSq
      &lt;/wsse:KeyIdentifier&gt;
   &lt;/wsse:SecurityTokenReference&gt;
&lt;/wsse:Security&gt;
</PRE></DIV>
<DIV class=example>
<P class=correct>CORRECT: </P><PRE>&lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd' 
               xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd' 
               xmlns:xenc='http://www.w3.org/2001/04/xmlenc#' 
               xmlns:ds='http://www.w3.org/2000/09/xmldsig#' &gt;
   &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                             ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;
                             EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
   &lt;/wsse:BinarySecurityToken&gt;
   &lt;wsse:SecurityTokenReference&gt;
      &lt;wsse:Reference URI='#SomeCert'
                      ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot; /&gt;
   &lt;/wsse:SecurityTokenReference&gt;
&lt;/wsse:Security&gt;
</PRE></DIV>
<DIV class=example>
<P class=correct>CORRECT: </P><PRE>&lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd' 
               xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd' 
               xmlns:xenc='http://www.w3.org/2001/04/xmlenc#' 
               xmlns:ds='http://www.w3.org/2000/09/xmldsig#' &gt;
   &lt;wsse:SecurityTokenReference&gt;
      &lt;wsse:Embedded wsu:Id=&quot;TheEmbeddedElementAroundSomeCert&quot;&gt;
         &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                                   ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;
                                   EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
         &lt;/wsse:BinarySecurityToken&gt;
      &lt;/wsse:Embedded&gt;
   &lt;/wsse:SecurityTokenReference&gt;
&lt;/wsse:Security&gt;
</PRE></DIV></DIV>
<DIV class=refinement>
<H4 id=Shorthand_XPointer_References>5.2.2 Shorthand XPointer References</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>Constraining the number of referencing 
mechanisms reduces complexity and thus improves interoperability. The 
wsse:BinarySecurityToken has a wsu:Id attribute allowing references to this 
token to use the relatively efficient and unambiguous Shorthand XPointer 
Reference mechanism. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R5204>R5204</A></SPAN> When 
a <SPAN class=statement-target>SECURITY_TOKEN_REFERENCE</SPAN> uses a Direct 
Reference to an INTERNAL_SECURITY_TOKEN, it MUST use a Shorthand XPointer 
Reference. </P>
<DIV class=explanation>
<P><SPAN class=statement-target></SPAN>The Profile requires the use of Shorthand 
XPointer Reference to ensure that the URI efficiently references the correct 
token. </P></DIV>
<P class=example-banner>For example,</P>
<DIV class=example>
<P class=correct>CORRECT: </P><PRE>&lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd' 
               xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd' 
               xmlns:xenc='http://www.w3.org/2001/04/xmlenc#' 
               xmlns:ds='http://www.w3.org/2000/09/xmldsig#' &gt;
 &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                           ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;
                           EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
 &lt;/wsse:BinarySecurityToken&gt;
 &lt;xenc:EncryptedKey&gt;
   &lt;xenc:EncryptionMethod Algorithm='http://www.w3.org/2001/04/xmlenc#rsa-1_5' /&gt;
   &lt;ds:KeyInfo&gt;
    &lt;wsse:SecurityTokenReference&gt;
     &lt;wsse:Reference
       URI='#SomeCert'
       ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;/&gt;
    &lt;/wsse:SecurityTokenReference&gt;
   &lt;/ds:KeyInfo&gt;
   &lt;xenc:CipherData&gt;
     &lt;xenc:CipherValue&gt;
       XZEEVABD3L9G+VNTCDiDTE7WB1a4kILtz5f9FT747eE=       
     &lt;/xenc:CipherValue&gt;
   &lt;/xenc:CipherData&gt;
 &lt;/xenc:EncryptedKey&gt;
&lt;/wsse:Security&gt;
</PRE></DIV>
<DIV class=example>
<P class=correct>CORRECT: </P><PRE>&lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd' 
               xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd' 
               xmlns:xenc='http://www.w3.org/2001/04/xmlenc#' 
               xmlns:ds='http://www.w3.org/2000/09/xmldsig#' &gt;
 &lt;rel:license xmlns:rel='urn:mpeg:mpeg21:2003:01-REL-R-NS'
              wsu:Id='SomeLic' 
              licenseId='uuid:3D680C71-177B-40cc-84C1-123B02503524' &gt;
 . . .
 &lt;/rel:license&gt;
 &lt;ds:Signature&gt;
   . . .
   &lt;ds:KeyInfo&gt;
    &lt;wsse:SecurityTokenReference&gt;
     &lt;wsse:Reference
       URI='#SomeLic'
       ValueType=&quot;http://docs.oasis-open.org/wss/2004/##/oasis-####-wss-REL-token-profile-1.0#license&quot; /&gt;
    &lt;/wsse:SecurityTokenReference&gt;
   &lt;/ds:KeyInfo&gt;
 &lt;/ds:Signature&gt;
&lt;/wsse:Security&gt;
</PRE></DIV></DIV>
<DIV class=refinement>
<H4 id=References_to_Preceding_Security_Tokens>5.2.3 References to Preceding 
Security Tokens</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>Security token references are intended to 
provide access to security tokens residing anywhere in a document. However, 
token placement can have a significant affect on processing efficiency when the 
document is processed in a stream-oriented fashion. For example, resolving a 
forward reference to a token may require significant subsequent document parsing 
that could otherwise be eliminated. This need to satisfy random access to 
security tokens adds complexity to implementations that works against 
interoperability. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R5205>R5205</A></SPAN> An 
<SPAN class=statement-target>INTERNAL_SECURITY_TOKEN</SPAN> that is not an 
embedded security token MUST precede the first SECURITY_TOKEN_REFERENCE that 
references it. </P>
<DIV class=explanation>
<P><SPAN class=statement-target></SPAN>Ensuring that a security token element 
appears before it is referenced, when processing in document order, means that 
implementations have access to the token content referenced from a 
wsse:SecurityTokenReference element when it is needed to verify a signature or 
perform decryption. </P></DIV>
<P class=example-banner>For example,</P>
<DIV class=example>
<P class=incorrect>INCORRECT: </P><PRE>&lt;!-- This example is incorrect because the wsse:BinarySecurityToken with the wsu:Id of SomeCert appears after it is 
     referenced from within the xenc:EncryptedKey element --&gt; 

&lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd' 
               xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd' 
               xmlns:xenc='http://www.w3.org/2001/04/xmlenc#' 
               xmlns:ds='http://www.w3.org/2000/09/xmldsig#' &gt;
 &lt;xenc:EncryptedKey&gt;
   &lt;xenc:EncryptionMethod Algorithm='http://www.w3.org/2001/04/xmlenc#rsa-1_5' /&gt;
   &lt;ds:KeyInfo&gt;
     &lt;wsse:SecurityTokenReference&gt;
       &lt;wsse:Reference
         URI='#SomeCert'
         ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;/&gt;
     &lt;/wsse:SecurityTokenReference&gt;
   &lt;/ds:KeyInfo&gt;
   &lt;xenc:CipherData&gt;
     &lt;xenc:CipherValue&gt;
       XZEEVABD3L9G+VNTCDiDTE7WB1a4kILtz5f9FT747eE=       
     &lt;/xenc:CipherValue&gt;
   &lt;/xenc:CipherData&gt;
 &lt;/xenc:EncryptedKey&gt;
 &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                           ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;
                           EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
 &lt;/wsse:BinarySecurityToken&gt;
&lt;/wsse:Security&gt;
</PRE></DIV>
<DIV class=example>
<P class=correct>CORRECT: </P><PRE>&lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd' 
               xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd' 
               xmlns:xenc='http://www.w3.org/2001/04/xmlenc#' 
               xmlns:ds='http://www.w3.org/2000/09/xmldsig#' &gt;
 &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                           ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;
                           EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
 &lt;/wsse:BinarySecurityToken&gt;
 &lt;xenc:EncryptedKey&gt;
   &lt;xenc:EncryptionMethod Algorithm='http://www.w3.org/2001/04/xmlenc#rsa-1_5' /&gt;
   &lt;ds:KeyInfo&gt;
     &lt;wsse:SecurityTokenReference&gt;
       &lt;wsse:Reference
         URI='#SomeCert'
         ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;/&gt;
     &lt;/wsse:SecurityTokenReference&gt;
   &lt;/ds:KeyInfo&gt;
   &lt;xenc:CipherData&gt;
     &lt;xenc:CipherValue&gt;
       XZEEVABD3L9G+VNTCDiDTE7WB1a4kILtz5f9FT747eE=       
     &lt;/xenc:CipherValue&gt;
   &lt;/xenc:CipherData&gt;
 &lt;/xenc:EncryptedKey&gt;
&lt;/wsse:Security&gt;
</PRE></DIV></DIV>
<DIV class=refinement>
<H4 id=Direct_Preferred_to_Embedded_for_Internal_References>5.2.4 Direct 
Preferred to Embedded for Internal References</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>Since multiple security elements may 
reference a single security token and processing of those elements may result in 
the removal of the element, consistent use of direct rather than embedded 
references simplifies processing. Direct references are encouraged, embedded 
references are discouraged. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R3023>R3023</A></SPAN> Each 
<SPAN class=statement-target>SECURITY_TOKEN_REFERENCE</SPAN> that refers to an 
INTERNAL_SECURITY_TOKEN that is referenced several times SHOULD be a direct 
reference rather than an embedded reference. </P>
<DIV class=explanation>
<P><SPAN class=statement-target></SPAN>The Profile encourages the consistent use 
of Direct Reference to security tokens. </P></DIV>
<P class=example-banner>For example,</P>
<DIV class=example>
<P class=incorrect>INCORRECT: </P><PRE>&lt;!-- This example is incorrect because it uses a wsse:Embedded element for the wsse:BinarySecurityToken 
     with the wsu:Id of SomeCert. It is assumed that this token is referred to from several places elsewhere
     in the SOAP envelope ( not shown )  --&gt;

&lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd' 
               xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd' 
               xmlns:xenc='http://www.w3.org/2001/04/xmlenc#' 
               xmlns:ds='http://www.w3.org/2000/09/xmldsig#' &gt;
   &lt;wsse:SecurityTokenReference&gt;
      &lt;wsse:Embedded wsu:Id=&quot;TheEmbeddedElementAroundSomeCert&quot;&gt;
         &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                                   ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;
                                   EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
         &lt;/wsse:BinarySecurityToken&gt;
      &lt;/wsse:Embedded&gt;
   &lt;/wsse:SecurityTokenReference&gt;
&lt;/wsse:Security&gt;
</PRE></DIV>
<DIV class=example>
<P class=correct>CORRECT: </P><PRE>&lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd' 
               xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd' 
               xmlns:xenc='http://www.w3.org/2001/04/xmlenc#' 
               xmlns:ds='http://www.w3.org/2000/09/xmldsig#' &gt;
   &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                             ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;
                             EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
   &lt;/wsse:BinarySecurityToken&gt;
   &lt;wsse:SecurityTokenReference&gt;
      &lt;wsse:Reference URI='#SomeCert'
                      ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot; /&gt;
   &lt;/wsse:SecurityTokenReference&gt;
&lt;/wsse:Security&gt;
</PRE></DIV></DIV>
<DIV class=refinement>
<H4 id=Direct_Required_When_Possible_for_External_References>5.2.5 Direct 
Required When Possible for External References</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>Since multiple security elements may 
reference a single external security token, consistent use of direct references 
simplifies processing. Direct references are encouraged. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R3024>R3024</A></SPAN> When 
a <SPAN class=statement-target>SECURITY_TOKEN_REFERENCE</SPAN> references an 
EXTERNAL_SECURITY_TOKEN that can be referred to using a Direct Reference, a 
Direct Reference MUST be used. </P>
<DIV class=explanation>
<P><SPAN class=statement-target></SPAN>The Profile encourages the use of Direct 
Reference in order to minimize ambiguity. </P></DIV>
<P class=example-banner>For example,</P>
<DIV class=example>
<P class=correct>CORRECT: </P><PRE>&lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd' 
               xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd' 
               xmlns:xenc='http://www.w3.org/2001/04/xmlenc#' 
               xmlns:ds='http://www.w3.org/2000/09/xmldsig#' &gt;

   &lt;wsse:SecurityTokenReference&gt;
      &lt;wsse:Reference URI='http://www.ws-i.org/CertStore/Examples/BSP.PEM'
                      ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot; /&gt;
   &lt;/wsse:SecurityTokenReference&gt;
&lt;/wsse:Security&gt;
</PRE></DIV></DIV>
<DIV class=refinement>
<H4 id=Format_of_Embedded_References>5.2.6 Format of Embedded References</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>Using a single consistent format for 
security tokens, regardless of reference mechanism, ensures consistent 
processing. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R3025>R3025</A></SPAN> When 
a wsse:Embedded element in a <SPAN 
class=statement-target>SECURITY_TOKEN_REFERENCE</SPAN> is used to specify an 
INTERNAL_SECURITY_TOKEN, its format MUST be the same as if the token were a 
child of a SECURITY_HEADER. </P>
<P class=example-banner>For example,</P>
<DIV class=example>
<P class=incorrect>INCORRECT: </P><PRE>&lt;!-- This example is incorrect because the wsse:Embedded element carries the data for the X.509 certificate
     directly rather than as a wsse:BinarySecurityToken element  --&gt;

&lt;wsse:SecurityTokenReference&gt;
   &lt;wsse:Embedded wsu:Id=&quot;SomeCert&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
   &lt;/wsse:Embedded&gt;
&lt;/wsse:SecurityTokenReference&gt;
</PRE></DIV>
<DIV class=example>
<P class=correct>CORRECT: </P><PRE>&lt;wsse:SecurityTokenReference&gt;
   &lt;wsse:Embedded wsu:Id=&quot;TheEmbeddedElementAroundSomeCert&quot;&gt;
      &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                                ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;
                                EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
      &lt;/wsse:BinarySecurityToken&gt;
   &lt;/wsse:Embedded&gt;
&lt;/wsse:SecurityTokenReference&gt;
</PRE></DIV></DIV>
<DIV class=refinement>
<H4 id=Key_Name_References_Prohibited>5.2.7 Key Name References Prohibited</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>Key Name References may be ambiguous. 
</P></DIV>
<P class=statement><SPAN class=statement-id><A name=R3027>R3027</A></SPAN> A 
<SPAN class=statement-target>SECURITY_TOKEN_REFERENCE</SPAN> MUST NOT use a Key 
Name to reference a SECURITY_TOKEN. </P>
<DIV class=explanation>
<P><SPAN class=statement-target></SPAN>In any case where a security token would 
be refered to by Key Name, it would also be possible to refer to it by a more 
efficient and/or less ambiguous mechanism (e.g. Direct, Key Identifier and/or 
Issuer and Serial Number). Thus, the Basic Security Profile 1.0 disallows the 
use of Key Name References </P></DIV>
<P class=example-banner>For example,</P>
<DIV class=example>
<P class=incorrect>INCORRECT: </P><PRE>&lt;!-- This example is incorrect because it uses a ds:KeyName element to refer to an X.509 certificate  --&gt;

&lt;wsse:SecurityTokenReference&gt;
   &lt;ds:KeyName&gt;CN=Security WG, OU=BSP, O=WS-I, C=US&lt;/ds:KeyName&gt;
&lt;/wsse:SecurityTokenReference&gt;
</PRE></DIV></DIV>
<DIV class=refinement>
<H4 id=KeyIdentifier/@ValueType_Attribute>5.2.8 KeyIdentifier/@ValueType 
Attribute</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>Having an explicit ValueType removes 
ambiguity about the format of the KeyIdentifier. The Profile restricts the value 
to that specified in the security token profile that is associated with the 
security token. The ValueType attribute in a KeyIdentifier is optional. This can 
cause ambiguity when it is not explicitly stated. Furthermore, interoperability 
is discouraged if a ValueType is specified but does not correspond to the value 
associated with that token as stated in its security token profile. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R3054>R3054</A></SPAN> A 
wsse:KeyIdentifier element in a <SPAN 
class=statement-target>SECURITY_TOKEN_REFERENCE</SPAN> MUST specify a ValueType 
attribute. </P>
<P class=statement><SPAN class=statement-id><A name=R3063>R3063</A></SPAN> A 
ValueType attribute on a wsse:KeyIdentifier element in a <SPAN 
class=statement-target>SECURITY_TOKEN_REFERENCE</SPAN> MUST contain a value 
specified within the security token profile associated with the referenced 
SECURITY_TOKEN. </P>
<DIV class=explanation>
<P><SPAN class=statement-target></SPAN>Having an explicit ValueType removes 
ambiguity about the format of the KeyIdentifier and enhances processing 
efficiency. The Profile restricts the value to that specified in the security 
token profile that is associated with the security token. </P></DIV>
<P class=example-banner>For example,</P>
<DIV class=example>
<P class=incorrect>INCORRECT: </P><PRE>
&lt;!-- This example is incorrect because the wsse:KeyIdentifier element is missing a ValueType attribute --&gt;

&lt;wsse:SecurityTokenReference&gt;
   &lt;wsse:KeyIdentifier EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;&gt;
      MIGfMa0GCSq
   &lt;/wsse:KeyIdentifier&gt;
&lt;/wsse:SecurityTokenReference&gt;
</PRE></DIV>
<DIV class=example>
<P class=correct>CORRECT: </P><PRE>&lt;wsse:SecurityTokenReference&gt;
   &lt;wsse:KeyIdentifier EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;
                       ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509SubjectKeyIdentifier&quot; &gt;
      MIGfMa0GCSq
   &lt;/wsse:KeyIdentifier&gt;
&lt;/wsse:SecurityTokenReference&gt;
</PRE></DIV></DIV>
<DIV class=refinement>
<H4 id=KeyIdentifier/@EncodingType_Attribute>5.2.9 KeyIdentifier/@EncodingType 
Attribute</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>Base64Binary is the only encoding type 
specified by Web Services Security: SOAP Message Security. Explicit 
specification of attribute values simplifies XML processing requirements and as 
a general principle the Basic Security Profile 1.0 requires that attributes be 
explicitly specified rather than relying on default values. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R3070>R3070</A></SPAN> A 
wsse:KeyIdentifier element in a <SPAN 
class=statement-target>SECURITY_TOKEN_REFERENCE</SPAN> MUST specify an 
EncodingType attribute. </P>
<P class=statement><SPAN class=statement-id><A name=R3071>R3071</A></SPAN> An 
EncodingType attribute on a wsse:KeyIdentifier element in a <SPAN 
class=statement-target>SECURITY_TOKEN_REFERENCE</SPAN> MUST have a value of 
&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;. 
</P>
<DIV class=explanation>
<P><SPAN class=statement-target></SPAN>A wsse:KeyIdentifier may specify its 
encoding type. The Profile restricts the encoding type to Base64Binary and 
requires its explicit specification. </P></DIV>
<P class=example-banner>For example,</P>
<DIV class=example>
<P class=incorrect>INCORRECT: </P><PRE>&lt;!-- This example is incorrect because the wsse:KeyIdentifier element is missing an EncodingType attribute
&lt;wsse:SecurityTokenReference&gt;
   &lt;wsse:KeyIdentifier ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509SubjectKeyIdentifier&quot; &gt;
      MIGfMa0GCSq
   &lt;/wsse:KeyIdentifier&gt;
&lt;/wsse:SecurityTokenReference&gt;
</PRE></DIV>
<DIV class=example>
<P class=correct>CORRECT: </P><PRE>&lt;wsse:SecurityTokenReference&gt;
   &lt;wsse:KeyIdentifier EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;
                       ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509SubjectKeyIdentifier&quot; &gt;
      MIGfMa0GCSq
   &lt;/wsse:KeyIdentifier&gt;
&lt;/wsse:SecurityTokenReference&gt;
</PRE></DIV></DIV>
<DIV class=refinement>
<H4 id=References_from_within_Embedded_Tokens>5.2.10 References from within 
Embedded Tokens</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>Embedded security tokens can potentially 
chain to other security tokens, which adds complexity to processing and 
discourages interoperability. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R3055>R3055</A></SPAN> A 
wsse:Embedded element in a <SPAN class=statement-target>SECURE_ENVELOPE</SPAN> 
MUST NOT contain a wsse:SecurityTokenReference child element. </P>
<DIV class=explanation>
<P><SPAN class=statement-target></SPAN>Eliminating redirection from within 
embedded elements reduces required complexity in handling embedded security 
tokens. </P></DIV>
<P class=example-banner>For example,</P>
<DIV class=example>
<P class=incorrect>INCORRECT: </P><PRE>&lt;!-- This example is incorrect because the wsse:Embedded element contains a wsse:SecurityTokenReference element --&gt;

&lt;wsse:SecurityTokenReference&gt;
   &lt;wsse:Embedded wsu:Id=&quot;TheEmbeddedElementAroundSomeSTR&quot;&gt;
      &lt;wsse:SecurityTokenReference&gt;
         &lt;wsse:Reference URI='#SomeCert'
                         ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot; /&gt;
      &lt;/wsse:SecurityTokenReference&gt;
   &lt;/wsse:Embedded&gt;
&lt;/wsse:SecurityTokenReference&gt;
</PRE></DIV></DIV>
<DIV class=refinement>
<H4 id=Embedded_Token_Content>5.2.11 Embedded Token Content</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>Embedded elements can contain multiple 
binary security token elements, which creates ambiguity about which token should 
be processed. Furthermore, the security token may be a type that is not defined 
within a security token profile. This can cause problems with interoperability 
</P></DIV>
<P class=statement><SPAN class=statement-id><A name=R3060>R3060</A></SPAN> A 
wsse:Embedded element in a <SPAN class=statement-target>SECURE_ENVELOPE</SPAN> 
MUST contain a single child element containing a security token defined in a 
security token profile. </P>
<DIV class=explanation>
<P><SPAN class=statement-target></SPAN>In order to reduce ambiguity surrounding 
which token to process, the Basic Security Profile 1.0 restricts embedded 
security tokens to contain exactly one security token element. It also restricts 
tokens to those defined in a token profile; this establishes a defined scope of 
profiles and thus allows for interoperability between implementations. 
</P></DIV>
<P class=example-banner>For example,</P>
<DIV class=example>
<P class=incorrect>INCORRECT: </P><PRE>&lt;!-- This example is incorrect because the wsse:Embedded element has multiple element children --&gt;

&lt;wsse:SecurityTokenReference&gt;
   &lt;wsse:Embedded wsu:Id=&quot;TheEmbeddedElementAroundSomeCerts&quot;&gt;
      &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                                ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;
                                EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
      &lt;/wsse:BinarySecurityToken&gt;
      &lt;wsse:BinarySecurityToken wsu:Id='SomeOtherCert'
                                ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;
                                EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
      &lt;/wsse:BinarySecurityToken&gt;
   &lt;/wsse:Embedded&gt;
&lt;/wsse:SecurityTokenReference&gt;
</PRE></DIV>
<DIV class=example>
<P class=correct>CORRECT: </P><PRE>&lt;wsse:SecurityTokenReference&gt;
   &lt;wsse:Embedded wsu:Id=&quot;TheEmbeddedElementAroundSomeCert&quot;&gt;
      &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                                ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;
                                EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
      &lt;/wsse:BinarySecurityToken&gt;
   &lt;/wsse:Embedded&gt;
&lt;/wsse:SecurityTokenReference&gt;
</PRE></DIV></DIV>
<DIV class=refinement>
<H4 
id=Reference_from_wsse_SecurityTokenReference_to_wsse_SecurityTokenReference>5.2.12 
Reference from wsse:SecurityTokenReference to wsse:SecurityTokenReference</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>Security Token References are expected to 
refer to security tokens, not to other security token references. Hence the 
Basic Security Profile 1.0 disallows chained references. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R3056>R3056</A></SPAN> A 
<SPAN class=statement-target>SECURITY_TOKEN_REFERENCE</SPAN> MUST NOT use a 
Direct Reference to another SECURITY_TOKEN_REFERENCE that does not have a 
wsse:Embedded child element. </P>
<P class=statement><SPAN class=statement-id><A name=R3064>R3064</A></SPAN> When 
a <SPAN class=statement-target>SECURITY_TOKEN_REFERENCE</SPAN> uses a Direct 
Reference to an INTERNAL_SECURITY_TOKEN contained within an wsse:Embedded 
element of another SECURITY_TOKEN_REFERENCE, the reference MUST be to the 
contained INTERNAL_SECURITY_TOKEN not to the wsse:Embedded element. </P>
<DIV class=explanation>
<P><SPAN class=statement-target></SPAN>If more than one Security Token Reference 
intends to refer to the same security token, they can use the same reference 
mechanism and therefore don't need to chain references. Chaining of references 
creates unnecessary complexity. </P></DIV>
<P class=example-banner>For example,</P>
<DIV class=example>
<P class=incorrect>INCORRECT: </P><PRE>&lt;!-- This example is incorrect because the second wsse:SecurityTokenReference element refers to the 
     wsse:SecurityTokenReference with an wsu:Id of TheFirstSTR  --&gt;
     
&lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                          ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;
                          EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
&lt;/wsse:BinarySecurityToken&gt;
&lt;wsse:SecurityTokenReference wsu:Id=&quot;TheFirstSTR&quot;&gt;
   &lt;wsse:Reference URI='#SomeCert'
                   ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot; /&gt;
&lt;/wsse:SecurityTokenReference&gt;
&lt;wsse:SecurityTokenReference&gt;
   &lt;wsse:Reference URI='#TheFirstSTR'
                   ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot; /&gt;
&lt;/wsse:SecurityTokenReference&gt;
</PRE></DIV>
<DIV class=example>
<P class=correct>CORRECT: </P><PRE>&lt;wsse:SecurityTokenReference&gt;
   &lt;wsse:Embedded wsu:Id=&quot;TheEmbeddedElementAroundSomeCert&quot;&gt;
      &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                                ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;
                                EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
      &lt;/wsse:BinarySecurityToken&gt;
   &lt;/wsse:Embedded&gt;
&lt;/wsse:SecurityTokenReference&gt;
&lt;wsse:SecurityTokenReference&gt;
   &lt;wsse:Reference URI='#SomeCert'
                   ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot; /&gt;
&lt;/wsse:SecurityTokenReference&gt;
</PRE></DIV></DIV>
<DIV class=refinement>
<H4 id=wsse_SecurityTokenReference/Reference_ValueType_Attribute>5.2.13 
wsse:SecurityTokenReference/Reference ValueType Attribute</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>The ValueType attribute in a security 
token reference is optional and has no accepted default value. This creates 
ambiguity between implementations when it is missing. Furthermore, security 
tokens similarly have ValueType attributes, which creates the possibility of 
contradiction between the reference and the token. There is no accepted 
processing model to resolve this. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R3059>R3059</A></SPAN> A 
wsse:Reference element in a <SPAN 
class=statement-target>SECURITY_TOKEN_REFERENCE</SPAN> MUST specify a ValueType 
attribute. </P>
<P class=statement><SPAN class=statement-id><A name=R3058>R3058</A></SPAN> A 
wsse:Reference element in a <SPAN 
class=statement-target>SECURITY_TOKEN_REFERENCE</SPAN> MUST specify a ValueType 
attribute that matches a ValueType specified by a security token profile for the 
the referenced SECURITY_TOKEN. </P>
<DIV class=explanation>
<P><SPAN class=statement-target></SPAN>Requiring that Security Token References 
carry a ValueType attribute makes it clear what type of security token is being 
referenced enabling security token specific reference mechanisms and aiding in 
error detection. </P></DIV></DIV>
<DIV class=refinement>
<H4 id=wsse_SecurityTokenReference_content>5.2.14 wsse:SecurityTokenReference 
content</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>Web Services Security: SOAP Message 
Security allows for a single SecurityTokenReference to include multiple 
reference mechanisms to the same security token. The Profile requires that only 
one be used. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R3061>R3061</A></SPAN> A 
<SPAN class=statement-target>SECURITY_TOKEN_REFERENCE</SPAN> MUST have exactly 
one child element. </P>
<DIV class=explanation>
<P><SPAN class=statement-target></SPAN>Restricting the number of reference 
mechanisms reduces complexity. </P></DIV></DIV>
<DIV class=refinement>
<H4 id=wsse_SecurityTokenReference/Reference_requires_URI_attribute>5.2.15 
wsse:SecurityTokenReference/Reference requires URI attribute</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>Web Services Security: SOAP Message 
Security treats the URI attribute as optional allowing for extensibility in the 
reference mechanism. However, the only fully specified mechanism which uses the 
Reference element requires a URI value. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R3062>R3062</A></SPAN> A 
wsse:Reference element in a <SPAN 
class=statement-target>SECURITY_TOKEN_REFERENCE</SPAN> MUST specify a URI 
attribute. </P>
<DIV class=explanation>
<P><SPAN class=statement-target></SPAN>Eliminating underspecified functionality 
removes complexity. </P></DIV></DIV>
<DIV class=refinement>
<H4 id=wsse_SecurityTokenReference_Dereferencing_Transform>5.2.16 
wsse:SecurityTokenReference Dereferencing Transform</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>The Security Token Dereferencing 
Transform allows for the optional specification of a canonicalization algorithm. 
</P></DIV>
<P class=statement><SPAN class=statement-id><A name=R3065>R3065</A></SPAN> When 
a <SPAN class=statement-target>SIGNATURE</SPAN> uses the SecurityTokenReference 
Dereferencing Transform, the ds:CanonicalizationMethod element MUST be present 
and wrapped in a wsse:TransformationParameters element. </P>
<DIV class=explanation>
<P><SPAN class=statement-target></SPAN>Consistent processing of data to be 
signed, including security token content, reduces complexity. </P></DIV></DIV>
<DIV class=refinement>
<H4 id=Security_Token_References_across_security_headers_prohibited>5.2.17 
Security Token References across security headers prohibited</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>The potential exists for the same 
security token to be referenced from multiple security headers. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R3066>R3066</A></SPAN> A 
<SPAN class=statement-target>SECURITY_TOKEN_REFERENCE</SPAN> MUST NOT use a 
Shorthand XPointer Reference to refer to an INTERNAL_SECURITY_TOKEN located in 
another SECURITY_HEADER. </P>
<DIV class=explanation>
<P><SPAN class=statement-target></SPAN>Since processing of security header 
elements can result in the removal of those elements, references to elements in 
another header may not correctly resolve. If an internal security token is 
referenced from multiple security headers it should be copied into each 
referencing header. </P></DIV></DIV>
<H3 id=WSSTimeStamp>5.3 Timestamps</H3>
<P>The following specifications (or sections thereof) are referred to in this 
section of the Basic Security Profile 1.0:</P>
<UL>
  <LI><A class=offsite 
  href="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0.pdf">Web 
  Services Security: SOAP Message Security Section 10</A></LI></UL>
<P><SPAN class=statement-target></SPAN>Web Services Security: SOAP Message 
Security defines a Timestamp element for use in SOAP messages. The Profile 
places the following constraints on its use: </P>
<DIV class=refinement>
<H4 id=wsu_Timestamp/wsu_Created>5.3.1 wsu:Timestamp/wsu:Created</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>The wsu:Created element represents the 
creation time of the security semantics. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R3203>R3203</A></SPAN> A 
<SPAN class=statement-target>TIMESTAMP</SPAN> MUST have exactly one wsu:Created 
element child. </P>
<DIV class=explanation>
<P><SPAN class=statement-target></SPAN>This element is REQUIRED and can only be 
specified once in a Timestamp element. Within the SOAP processing model, 
creation is the instant that the Infoset is serialized for transmission. 
</P></DIV>
<P class=example-banner>For example,</P>
<DIV class=example>
<P class=incorrect>INCORRECT: </P><PRE>&lt;!-- This example is incorrect because the wsu:Timestamp element is missing a wsu:Created child element --&gt;

&lt;wsu:Timestamp wsu:Id=&quot;timestamp&quot;&gt;
   &lt;wsu:Expires&gt;2001-10-13T09:00:00Z&lt;/wsu:Expires&gt;
&lt;/wsu:Timestamp&gt;
</PRE></DIV>
<DIV class=example>
<P class=correct>CORRECT: </P><PRE>&lt;wsu:Timestamp wsu:Id=&quot;timestamp&quot;&gt;
   &lt;wsu:Created&gt;2001-09-13T08:42:00Z&lt;/wsu:Created&gt;
   &lt;wsu:Expires&gt;2001-10-13T09:00:00Z&lt;/wsu:Expires&gt;
 &lt;/wsu:Timestamp&gt;
</PRE></DIV></DIV>
<DIV class=refinement>
<H4 id="Occurence_constraints_on&#9;wsu_Created_and_wsu_Expires_">5.3.2 
Occurence constraints on wsu:Created and wsu:Expires </H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>A timestamp may optionally contain an 
expires element. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R3224>R3224</A></SPAN> A 
<SPAN class=statement-target>TIMESTAMP</SPAN> MUST NOT contain more than one 
wsu:Expires element. </P>
<P class=statement><SPAN class=statement-id><A name=R3221>R3221</A></SPAN> If a 
<SPAN class=statement-target>TIMESTAMP</SPAN> contains a wsu:Expires element it 
MUST appear after the wsu:Created element. </P>
<DIV class=explanation>
<P><SPAN class=statement-target></SPAN>Preventing multiple expires elements and 
enforcing the order of elements reduces complexity. </P></DIV></DIV>
<DIV class=refinement>
<H4 id=Leap_Seconds_Not_Allowed>5.3.3 Leap Seconds Not Allowed</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>Leap seconds are allowed by the 
underlying specifications. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R3213>R3213</A></SPAN> A 
<SPAN class=statement-target>TIMESTAMP</SPAN> MUST NOT include wsu:Created or 
wsu:Expires values that specify leap seconds. </P>
<DIV class=explanation>
<P><SPAN class=statement-target></SPAN>Leap second processing is complex and 
error prone. The Profile disallows specification of leap seconds. 
</P></DIV></DIV>
<DIV class=refinement>
<H4 id=Timestamp_ValueType>5.3.4 Timestamp ValueType</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>The underlying specifications allow for 
the specification of a timestamp ValueType. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R3225>R3225</A></SPAN> A 
wsu:Created element within a <SPAN class=statement-target>TIMESTAMP</SPAN> MUST 
NOT include a ValueType attribute. </P>
<P class=statement><SPAN class=statement-id><A name=R3226>R3226</A></SPAN> A 
wsu:Expires element within a <SPAN class=statement-target>TIMESTAMP</SPAN> MUST 
NOT include a ValueType attribute. </P>
<DIV class=explanation>
<P><SPAN class=statement-target></SPAN>There is no specified set of values for 
the ValueType attribute so the Basic Security Profile 1.0 disallows its use. 
</P></DIV></DIV>
<DIV class=refinement>
<H4 id=Timestamp_Format>5.3.5 Timestamp Format</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>The underlying specifications allow for a 
variety of timestamp formats. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R3217>R3217</A></SPAN> A 
<SPAN class=statement-target>TIMESTAMP</SPAN> MUST only contain time values in 
UTC format as specified by the XML Schema type (dateTime). </P>
<DIV class=explanation>
<P><SPAN class=statement-target></SPAN>Limiting timestamp values to UTC time 
eliminates complexity. </P></DIV></DIV>
<DIV class=refinement>
<H4 id=Timestamp_Resolution>5.3.6 Timestamp Resolution</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>The underlying specifications do not 
limit the resolution of timestamp values. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R3220>R3220</A></SPAN> A 
<SPAN class=statement-target>RECEIVER</SPAN> MUST be capable of processing 
wsu:Created and wsu:Expires values upto and including milliseconds. </P>
<DIV class=explanation>
<P><SPAN class=statement-target></SPAN>Since implementations have practical 
limits on resolution of time values the Profile requires a reasonable processing 
capability. </P></DIV></DIV>
<DIV class=refinement>
<H4 id=wsu_Timestamp_inside_wsse_Security_header_>5.3.7 wsu:Timestamp inside 
wsse:Security header </H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>The underlying specifications do not 
specify semantics for timestamps other than those that are children of the 
security header. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R3218>R3218</A></SPAN> A 
<SPAN class=statement-target>SECURITY_HEADER</SPAN> MUST NOT contain a 
wsu:timestamp that is not its immediate child. </P>
<P class=statement><SPAN class=statement-id><A name=R3219>R3219</A></SPAN> A 
<SPAN class=statement-target>SECURITY_HEADER</SPAN> MUST NOT contain more than 
one TIMESTAMP. </P>
<DIV class=explanation>
<P><SPAN class=statement-target></SPAN>The Profile does not allow inclusion of 
timestamp elements with unspecified semantics. </P></DIV></DIV>
<H3 id=WSSReferences>5.4 wsu:Id References</H3>
<P>The following specifications (or sections thereof) are referred to in this 
section of the Basic Security Profile 1.0:</P>
<UL>
  <LI><A class=offsite 
  href="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0.pdf">Web 
  Services Security: SOAP Message Security</A></LI></UL>
<P><SPAN class=statement-target></SPAN>Web Services Security: SOAP Message 
Security defines a wsu:Id element for use in SOAP messages. The Profile places 
the following constraints on its use: </P>
<DIV class=refinement>
<H4 id=wsu_Id_Attribute_Uniqueness>5.4.1 wsu:Id Attribute Uniqueness</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>One of the principles of the underlying 
specifications is that processing of messages should not require schema 
validation. However, without schema processing it is not possible to determine 
whether individual attributes are of type ID and must therefore be unique. 
</P></DIV>
<P class=statement><SPAN class=statement-id><A name=R3204>R3204</A></SPAN> Two 
wsu:Id attributes within any <SPAN class=statement-target>SECURE_ENVELOPE</SPAN> 
MUST NOT have the same value. </P>
<DIV class=explanation>
<P><SPAN class=statement-target></SPAN>Since verification of signatures 
typically requires dereferencing of elements based on ID attribute values, these 
values are required to be unique within a message. </P></DIV></DIV>
<H3 id=WSSProcessing>5.5 wsse:Security Processing Order</H3>
<P>The following specifications (or sections thereof) are referred to in this 
section of the Basic Security Profile 1.0:</P>
<UL>
  <LI><A class=offsite 
  href="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0.pdf">Web 
  Services Security: SOAP Message Security</A></LI></UL>
<P><SPAN class=statement-target></SPAN>Web Services Security: SOAP Message 
Security defines the order for processing signature and encryption blocks within 
wsse:Security headers. The Profile provides the following guidance: </P>
<DIV class=refinement>
<H4 id=Order_of_Processing>5.5.1 Order of Processing</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>Messages may be signed and encrypted, 
potentially with by multiple entities signing and encrypting overlapping 
elements. A signature applied before encryption has different security 
properties than encryption applied before a signature. Which security properties 
should be used requires an out-of-band agreement. </P>
<P><SPAN class=statement-target></SPAN>With signature before encryption, the 
signer is known to have created or vouched for the plaintext data. It is not 
known to the receiver whether the signer performed the encryption. The potential 
exists for the identity of the signer to remain confidential except to the 
receiver by encryption of the signature and signer's security token. </P>
<P><SPAN class=statement-target></SPAN>With encryption before signature, the 
signer is known to have created or vouched for the ciphertext data, but it is 
not known whether the signer was aware of the plaintext. It is known that the 
signer was aware that the data was encrypted and intended to be delivered to the 
receiver. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R3212>R3212</A></SPAN> 
Within a <SPAN class=statement-target>SECURITY_HEADER</SPAN>, all SIGNATURE, 
ENCRYPTED_KEY, and ENCRYPTION_REFERENCE_LIST elements MUST be ordered so a 
receiver will get the correct result by processing the elements in the order 
they appear. </P>
<DIV class=explanation>
<P><SPAN class=statement-target></SPAN>As signature and encryption elements are 
added to a security header they must be ordering in a way that ensures that if a 
receiver of the message processing the elements in the order they appear they 
will achieve the correct result. </P></DIV></DIV>
<H3 id=WSSActor>5.6 SOAP Actor</H3>
<P>The following specifications (or sections thereof) are referred to in this 
section of the Basic Security Profile 1.0:</P>
<UL>
  <LI><A class=offsite 
  href="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0.pdf">Web 
  Services Security: SOAP Message Security</A></LI></UL>
<P><SPAN class=statement-target></SPAN>SOAP defines an actor attribute for use 
in SOAP headers. The Profile places the following constraints on its use:</P>
<DIV class=refinement>
<H4 id=SOAP_Actor_Value>5.6.1 SOAP Actor Value</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>The actor attribute allows a security 
header to be targeted to a specific processing component or node. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R3206>R3206</A></SPAN> 
Within a <SPAN class=statement-target>SECURE_ENVELOPE</SPAN> there MUST be at 
most one SECURITY_HEADER with the actor attribute omitted. </P>
<P class=statement><SPAN class=statement-id><A name=R3210>R3210</A></SPAN> 
Within a <SPAN class=statement-target>SECURE_ENVELOPE</SPAN> there MUST NOT be 
more than one SECURITY_HEADER with the same actor attribute value. </P>
<DIV class=explanation>
<P><SPAN class=statement-target></SPAN>Correct security header processing is 
order dependent. Eliminating potential ambiguity caused by ordering dependencies 
between headers targeted to the same actor eliminates complexity. 
</P></DIV></DIV>
<H2 id=usernametoken>6. Username Token Profile</H2>
<P>This section of the Basic Security Profile 1.0 incorporates the following 
specifications by reference: </P>
<UL>
  <LI><A class=offsite 
  href="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0.pdf">Web 
  Services Security UsernameToken Profile 1.0 OASIS Standard 200401, March 
  2004</A>
  <LI><A class=offsite 
  href="http://www.oasis-open.org/committees/download.php/11143/oasis-200401-wss-username-token-profile-1.0-errata-003.pdf">Web 
  Services Security: UsernameToken Profile 1.0 Errata 1.0 Committee Draft 
  200401, September 2004</A></LI></UL>
<H3 id=tokenusage>6.1 Token Usage</H3>
<DIV class=refinement>
<H4 id=wsse_UsernameToken/wsse_Password/@Type>6.1.1 
wsse:UsernameToken/wsse:Password/@Type</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>Passwords may be present in a variety of 
formats. The Type attribute specifies the format of the Password value. 
</P></DIV>
<P class=statement><SPAN class=statement-id><A name=R4201>R4201</A></SPAN> A 
wsse:UsernameToken/wsse:Password element in a <SPAN 
class=statement-target>SECURITY_HEADER</SPAN> MUST specify a Type attribute. 
</P>
<DIV class=explanation>
<P><SPAN class=statement-target></SPAN>To avoid ambiguity, the Type attribute 
must be specified on the wsse:Password element of a wsse:UsernameToken. 
</P></DIV>
<P class=example-banner>For example,</P>
<DIV class=example>
<P class=incorrect>INCORRECT: </P><PRE>&lt;!-- This example is incorrect because the wsse:Password element is missing a Type attribute with a value of 
     http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText --&gt;

&lt;wsse:UsernameToken
   xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd' &gt;
   &lt;wsse:Username&gt;Bert&lt;/wsse:Username&gt;
   &lt;wsse:Password&gt;Ernie&lt;/wsse:Password&gt;
&lt;/wsse:UsernameToken&gt;
</PRE></DIV>
<DIV class=example>
<P class=incorrect>INCORRECT: </P><PRE>&lt;
&lt;!-- This example is incorrect because the wsse:Password element is missing a Type attribute with a value of 
     http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordDigest --&gt;

&lt;wsse:UsernameToken
   xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd' &gt;
   &lt;wsse:Username&gt;Bert&lt;/wsse:Username&gt;
   &lt;wsse:Password&gt;B5twk47KwSrjeg==&lt;/wsse:Password&gt;
&lt;/wsse:UsernameToken&gt;
</PRE></DIV>
<DIV class=example>
<P class=correct>CORRECT: </P><PRE>&lt;wsse:UsernameToken
   xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd' &gt;
   &lt;wsse:Username&gt;Bert&lt;/wsse:Username&gt;
   &lt;wsse:Password
      Type='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText'&gt;
      Ernie
   &lt;/wsse:Password&gt;
&lt;/wsse:UsernameToken&gt;
</PRE></DIV>
<DIV class=example>
<P class=correct>CORRECT: </P><PRE>&lt;wsse:UsernameToken xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd' &gt;
   &lt;wsse:Username&gt;Bert&lt;/wsse:Username&gt;
   &lt;wsse:Password
      Type='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordDigest'&gt;
      B5twk47KwSrjeg==
   &lt;/wsse:Password&gt;
&lt;/wsse:UsernameToken&gt;
</PRE></DIV></DIV>
<DIV class=refinement>
<H4 id=PasswordDigest>6.1.2 PasswordDigest</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>The underlying specifications specify a 
Type value for password digests but there is ambiguity in the algorithm to be 
used to calculate the digest. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R4212>R4212</A></SPAN> When 
a wsse:Password element with a Type attribute with a value of 
&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordDigest&quot; 
is used within a <SPAN class=statement-target>SECURITY_TOKEN</SPAN>, its value 
MUST be computed using the following formula, where &quot;+&quot; indicates concatenation: 
Password_Digest = Base64 ( SHA-1 ( nonce + created + password ) ). That is, 
concatenate the text forms of the nonce, creation timestamp, and the password 
(or shared secret or password equivalent), digest the combination using the 
SHA-1 hash algorithm, then include the Base64 encoding of that result as the 
password (digest). Any elements that are not present are simply omitted from the 
concatenation. </P>
<DIV class=explanation>
<P><SPAN class=statement-target></SPAN>The Profile describes the digest 
calculation details to eliminate ambiguity. </P></DIV></DIV>
<DIV class=refinement>
<H4 id=ValueType_attribute>6.1.3 ValueType attribute</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>The underlying specifications do not 
fully describe the proper ValueType for UsernameToken. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R4214>R4214</A></SPAN> Any 
<SPAN class=statement-target>SECURITY_TOKEN_REFERENCE</SPAN> which directly 
references a SECURITY_TOKEN named wsse:UsernameToken MUST have a 
wsse:Reference/@ValueType attribute with a value of 
&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#UsernameToken&quot;. 
</P>
<DIV class=explanation>
<P><SPAN class=statement-target></SPAN>The Profile requires a specific value for 
the ValueType. </P></DIV></DIV>
<DIV class=refinement>
<H4 id=EncodingType_attribute>6.1.4 EncodingType attribute</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>Base64Binary is the only encoding type 
specified by Web Services Security: SOAP Message Security. Explicit 
specification of attribute values simplifies XML processing requirements and as 
a general principle the Basic Security Profile 1.0 requires that attributes be 
explicitly specified rather than relying on default values. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R4220>R4220</A></SPAN> A 
<SPAN class=statement-target>SECURITY_TOKEN</SPAN> named wsse:UsernameToken MUST 
specify an EncodingType attribute. </P>
<P class=statement><SPAN class=statement-id><A name=R4221>R4221</A></SPAN> An 
EncodingType attribute of a <SPAN class=statement-target>SECURITY_TOKEN</SPAN> 
named wsse:UsernameToken MUST have a value of 
&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;. 
</P>
<DIV class=explanation>
<P><SPAN class=statement-target></SPAN>A UsernameToken may specify its encoding 
type. The Profile restricts the encoding type to Base64Binary and requires its 
explicit specification. </P></DIV></DIV>
<DIV class=refinement>
<H4 id=Reference_by_KeyIdentifier>6.1.5 Reference by KeyIdentifier</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>The underlying specifications do not 
describe a mechanism for generating a KeyIdentifier for a UsernameToken. 
</P></DIV>
<P class=statement><SPAN class=statement-id><A name=R4215>R4215</A></SPAN> When 
a <SPAN class=statement-target>SECURITY_TOKEN_REFERENCE</SPAN> refers to a 
wsse:UsernameToken, a KeyIdentifier reference MUST NOT be used. </P>
<DIV class=explanation>
<P><SPAN class=statement-target></SPAN>The Profile disallows the use of 
unspecified mechanisms for generation of KeyIdentifier values. </P></DIV></DIV>
<DIV class=refinement>
<H4 id=Key_Derivation>6.1.6 Key Derivation</H4>
<DIV class=explanation>
<P><SPAN class=statement-target></SPAN>The Username Token profile does not 
currently define a key derivation algorithm. The OASIS WSS TC is expected to 
address this issue in a subsequent specification. </P></DIV></DIV>
<H2 id=x509token>7. X.509 Certificate Token Profile</H2>
<P>This section of the Basic Security Profile 1.0 incorporates the following 
specifications by reference, and defines extensibility points within them: </P>
<UL>
  <LI><A class=offsite 
  href="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0.pdf">Web 
  Services Security X.509 Certificate Token Profile OASIS Standard 200401, March 
  2004</A>
  <LI><A class=offsite 
  href="http://www.oasis-open.org/committees/download.php/11145/oasis-200401-x509-token-profile-1.0-errata-004.pdf">Web 
  Services Security: X.509 Token Profile 1.0 Errata 1.0 Committee Draft 200401, 
  October 2004</A>
  <LI><A class=offsite href="http://www.ietf.org/rfc/rfc2459.txt">RFC2459: 
  Internet X.509 Public Key Infrastructure Certificate and CRL 
  Profile</A><BR>Extensibility points: 
  <UL>
    <LI><SPAN class=statement-id id=E0012>E0012</SPAN> - Certificate Authority - 
    The choice of the Certificate Authority is a private agreement between 
    parties.
    <LI><SPAN class=statement-id id=E0013>E0013</SPAN> - Certificate Extensions 
    - X.509 allows for arbitrary certificate extensions.</LI></UL>
  <LI><A class=offsite 
  href="http://www.itu.int/rec/recommendation.asp?type=items&amp;lang=e&amp;parent=T-REC-X.509-200110-I!Cor1">Information 
  technology &quot;Open Systems Interconnection&quot; The Directory: Public-key and 
  attribute certificate frameworks Technical Corrigendum 1</A></LI></UL>
<H3 id=x509tokentypes>7.1 Token Types</H3>
<P>The following specifications (or sections thereof) are referred to in this 
section of the Basic Security Profile 1.0:</P>
<UL>
  <LI><A class=offsite 
  href="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0.pdf">Web 
  Services Security: X.509 Token Profile Section 3.1</A></LI></UL>
<P><SPAN class=statement-target></SPAN>In some areas the Basic Security Profile 
allows limited flexibility and extensibility in the application of security to 
messages. Some agreement between the SENDER and RECEIVER over which mechanisms 
and choices should be used for message exchanges is necessary. Since no security 
policy description language or negotiation mechanism is in scope for the Basic 
Security Profile, some out of band agreement must be reached for which 
certificate extensions and issuers should be used. </P>
<P><SPAN class=statement-target></SPAN>Web Services Security: X.509 Token 
Profile defines 3 token types: X509v3; x509PKIPathv1; and PKCS7. The Profile 
places the following constraints on their use: </P>
<DIV class=refinement>
<H4 id=Certificate_Path_Format>7.1.1 Certificate Path Format</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>The underlying specifications allow 
certificate path information to be provided via either X509PKIPathv1 or PKCS7 
formats. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R5201>R5201</A></SPAN> When 
certificate path information is provided, a <SPAN 
class=statement-target>SENDER</SPAN> MUST provide one of the X509PKIPathv1 or 
PKCS7 token types. </P>
<P class=statement><SPAN class=statement-id><A name=R5202>R5202</A></SPAN> When 
certificate path information is provided, a <SPAN 
class=statement-target>SENDER</SPAN> SHOULD provide the X509PKIPathv1 token 
type. </P>
<P class=statement><SPAN class=statement-id><A name=R5203>R5203</A></SPAN> When 
certificate path information is provided, a <SPAN 
class=statement-target>RECEIVER</SPAN> MUST accept X509PKIPathv1 and PKCS7 token 
types. </P>
<DIV class=explanation>
<P><SPAN class=statement-target></SPAN>Interoperability issues may arise if 
different forms of certificate path information are used when not expected. 
X509PKIPathv1 is preferred because it allows more efficient certificate path 
processing. PKCS7 is a more mature and widely implemented standard so it is also 
allowed. Section 3.1 of X.509 Token Profile incorrectly defines #X509PKIPathv1 
as a PKIPath. Section 3.1 should define #X509PKIPathv1 as a PkiPath (note case), 
which X.509 defect report 279 defines as an ordered collection of certificates 
beginning with the most significant. </P></DIV></DIV>
<DIV class=refinement>
<H4 id=Key_Identifier_for_External_References>7.1.2 Key Identifier for External 
References</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>Web Services Security: SOAP Message 
Security provides a list of reference mechanisms in preferred order (i.e., most 
specific to least specific). Direct References are prefered, but when they 
cannot be used Key Identifier or Issuer and Serial Number is required. 
</P></DIV>
<P class=statement><SPAN class=statement-id><A name=R5209>R5209</A></SPAN> When 
a <SPAN class=statement-target>SECURITY_TOKEN_REFERENCE</SPAN> references an 
EXTERNAL_SECURITY_TOKEN that cannot be referred to using a Direct Reference but 
can be referred to using a Key Identifier or ds:X509Data/ds:X509IssuerSerial, a 
Key Identifier or ds:X509Data/ds:X509IssuerSerial MUST be used. </P>
<DIV class=explanation>
<P><SPAN class=statement-target></SPAN>In the event that Direct References are 
not possible, the Basic Security Profile 1.0 encourages the usage of mechanisms 
that are most likely to be unique. </P></DIV>
<P class=example-banner>For example,</P>
<DIV class=example>
<P class=correct>CORRECT: </P><PRE>&lt;wsse:SecurityTokenReference&gt;
   &lt;wsse:KeyIdentifier EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;
                       ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509SubjectKeyIdentifier&quot; &gt;
      MIGfMa0GCSq
   &lt;/wsse:KeyIdentifier&gt;
&lt;/wsse:SecurityTokenReference&gt;
</PRE></DIV>
<DIV class=example>
<P class=correct>CORRECT: </P><PRE>&lt;wsse:SecurityTokenReference&gt;
   &lt;ds:X509Data&gt;
      &lt;ds:X509IssuerSerial&gt;
         &lt;ds:X509IssuerName&gt;CN=Security WG, OU=BSP, O=WS-I, C=US&lt;/ds:X509IssuerName&gt;
         &lt;ds:X509SerialNumber&gt;54A4E9&lt;/ds:X509SerialNumber&gt;
      &lt;/ds:X509IssuerSerial&gt;
   &lt;/ds:X509Data&gt;
&lt;/wsse:SecurityTokenReference&gt;
</PRE></DIV></DIV>
<DIV class=refinement>
<H4 id=KeyIdentifier>7.1.3 KeyIdentifier</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>The underlying specifications do not 
fully describe the proper ValueType for X.509 SubjectKeyIdentifier. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R5206>R5206</A></SPAN> When 
the wsse:KeyIdentifier element is used within a <SPAN 
class=statement-target>SECURITY_TOKEN_REFERENCE</SPAN> to specify a reference to 
an X.509 Certificate Token, the wsse:KeyIdentifier element MUST have a ValueType 
attribute with the value 
&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509SubjectKeyIdentifier&quot; 
</P>
<P class=statement><SPAN class=statement-id><A name=R5208>R5208</A></SPAN> When 
the wsse:KeyIdentifier element is used within a <SPAN 
class=statement-target>SECURITY_TOKEN_REFERENCE</SPAN> to specify a reference to 
an X.509 Certificate Token its contents MUST be the value of the certificate's 
X.509 SubjectKeyIdentifier extension. </P>
<DIV class=explanation>
<P><SPAN class=statement-target></SPAN>The Profile requires a specific value for 
the ValueType. </P></DIV></DIV>
<DIV class=refinement>
<H4 id=KeyIdentifier_EncodingType>7.1.4 KeyIdentifier EncodingType</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>This requirement addresses the provisions 
of SOAP Message Security 1.0 Errata that recommends that the optional 
EncodingType attribute be encoded in base64. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R5207>R5207</A></SPAN> When 
the wsse:KeyIdentifier element is used within a <SPAN 
class=statement-target>SECURITY_TOKEN_REFERENCE</SPAN> to specify a reference to 
an X.509 Certificate Token, the wsse:KeyIdentifier element MUST have an 
EncodingType attribute with the value 
&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot; 
</P>
<DIV class=explanation>
<P><SPAN class=statement-target></SPAN>The Profile requires specifying the 
encoding type and restricts it to base64. </P></DIV></DIV>
<H2 id=xmlSignature>8. XML-Signature</H2>
<P><SPAN class=statement-target></SPAN>Web Services Security: SOAP Message 
Security builds on XML Signature, defining usage of various elements from XML 
Signature and a processing model. The Profile places the constraints defined in 
this section on the use of XML Signature with Web Services Security: SOAP 
Message Security. The Profile places no constraints on other use of XML 
Signature. </P>
<P><SPAN class=statement-target></SPAN>In some areas the Basic Security Profile 
allows limited flexibility and extensibility in the application of security to 
messages. Some agreement between the SENDER and RECEIVER over which mechanisms 
and choices should be used for message exchanges is necessary. Since no security 
policy description language or negotiation mechanism is in scope for the Basic 
Security Profile, some out of band agreement must be reached for which elements 
should be signed and which signature algorithms should be used. </P>
<P>This section of the Basic Security Profile 1.0 incorporates the following 
specifications by reference: </P>
<UL>
  <LI><A class=offsite href="http://www.w3.org/TR/xmldsig-core/">XML-Signature 
  Syntax and Processing</A></LI></UL>
<H3 id=xmlSignatureGeneral>8.1 General Constraints on XML Signature</H3>
<DIV class=refinement>
<H4 id=Signature_Content>8.1.1 Signature Content</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>Partners in a message exchange must agree 
which elements must be signed and which elements may be signed. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R3105>R3105</A></SPAN> 
SENDERs and RECEIVERs can agree in out of band fashion on required and allowed 
signed message content. </P>
<DIV class=explanation>
<P><SPAN class=statement-target></SPAN>Some vendors have strict implementation 
of what message content must be signed. Some other vendors are more tolerent to 
receiving additional signed content in a message. The Profile allows for an out 
of band agreement between vendors on how to address this issue. </P></DIV></DIV>
<DIV class=refinement>
<H4 id=Signature_Types>8.1.2 Signature Types</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>Due to the nature of the SOAP processing 
model, which is based on recognising the elements that are children of 
soap:Header and/or soap:Body, use of enveloping signatures, where the signed XML 
is encapsulated in a ds:Signature element, is inappropriate. Enveloped 
signatures, where the ds:Signature element is a descendant of the signed 
element, limit the ability of intermediaries to process messages and should be 
avoided unless said limitation is the desired effect. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R3102>R3102</A></SPAN> A 
<SPAN class=statement-target>SIGNATURE</SPAN> MUST NOT be an Enveloping 
Signature as defined by the XML Signature specification. </P>
<P class=statement><SPAN class=statement-id><A name=R3103>R3103</A></SPAN> A 
<SPAN class=statement-target>SIGNATURE</SPAN> SHOULD be a Detached Signature as 
defined by the XML Signature specification. </P>
<P class=statement><SPAN class=statement-id><A name=R3104>R3104</A></SPAN> A 
<SPAN class=statement-target>SIGNATURE</SPAN> SHOULD NOT be an Enveloped 
Signature as defined by the XML Signature Specification. </P>
<DIV class=explanation>
<P><SPAN class=statement-target></SPAN>Detached signatures are encouraged. 
Enveloped signatures are discouraged. Enveloping signatures are not allowed. 
</P></DIV>
<P class=example-banner>For example,</P>
<DIV class=example>
<P class=incorrect>INCORRECT: </P><PRE>&lt;!-- This example is incorrect because it contains an enveloping signature around the SomeSecurityToken element --&gt;

&lt;ds:Signature Id='TheSig' xmlns:ds='http://www.w3.org/2000/09/xmldsig#'&gt;
   &lt;ds:SignedInfo&gt;
      &lt;ds:CanonicalizationMethod Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#&quot; '&gt;
         &lt;c14n:InclusiveNamespaces xmlns:c14n='http://www.w3.org/2001/10/xml-exc-c14n#' PrefixList='wsse soap' /&gt;
      &lt;/ds:CanonicalizationMethod&gt;
      &lt;ds:SignatureMethod Algorithm='http://www.w3.org/2000/09/xmldsig#rsa-sha1' /&gt;
      &lt;ds:Reference URI='#SigPropBody'&gt;
         &lt;ds:Transforms&gt;
            &lt;ds:Transform Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#'&gt;
               &lt;c14n:InclusiveNamespaces xmlns:c14n='http://www.w3.org/2001/10/xml-exc-c14n#' PrefixList='' /&gt;
            &lt;/ds:Transform&gt;
         &lt;/ds:Transforms&gt;
         &lt;ds:DigestMethod Algorithm='http://www.w3.org/2000/09/xmldsig#sha1' /&gt;
         &lt;ds:DigestValue&gt;i3qi5GjhHnfoBn/jOjQp2mq0Na4=&lt;/ds:DigestValue&gt;
      &lt;/ds:Reference&gt;
   &lt;/ds:SignedInfo&gt;
   &lt;ds:SignatureValue&gt;oxNwoqGbzqg1YBliz+PProgcjw8=&lt;/ds:SignatureValue&gt;
   &lt;ds:KeyInfo&gt;
      &lt;wsse:SecurityTokenReference&gt;
         &lt;wsse:Reference
            URI='#SomeCert'
            ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;/&gt;
      &lt;/wsse:SecurityTokenReference&gt;
   &lt;/ds:KeyInfo&gt;
   &lt;ds:Object&gt;
      &lt;ds:SignatureProperties&gt;
         &lt;ds:SignatureProperty Id='SigPropBody' Target='#TheSig'&gt;
            &lt;SomeSecurityToken/&gt;
         &lt;/ds:SignatureProperty&gt;
      &lt;/ds:SignatureProperties&gt;
   &lt;/ds:Object&gt;
&lt;/ds:Signature&gt;
</PRE></DIV>
<DIV class=example>
<P class=correct>CORRECT: </P><PRE>&lt;ds:Signature xmlns:ds='http://www.w3.org/2000/09/xmldsig#'&gt;
   &lt;ds:SignedInfo&gt;
      &lt;ds:CanonicalizationMethod Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#&quot; '&gt;
         &lt;c14n:InclusiveNamespaces xmlns:c14n='http://www.w3.org/2001/10/xml-exc-c14n#'
                                   PrefixList='wsse soap' /&gt;
      &lt;/ds:CanonicalizationMethod&gt;
      &lt;ds:SignatureMethod Algorithm='http://www.w3.org/2000/09/xmldsig#rsa-sha1' /&gt;
      &lt;ds:Reference URI='#TheBody'&gt;
         &lt;ds:Transforms&gt;
            &lt;ds:Transform Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#'&gt;
               &lt;c14n:InclusiveNamespaces xmlns:c14n='http://www.w3.org/2001/10/xml-exc-c14n#'
                                         PrefixList='soap wsu m' /&gt;
            &lt;/ds:Transform&gt;
         &lt;/ds:Transforms&gt;
         &lt;ds:DigestMethod Algorithm='http://www.w3.org/2000/09/xmldsig#sha1' /&gt;
         &lt;ds:DigestValue&gt;i3qi5GjhHnfoBn/jOjQp2mq0Na4=&lt;/ds:DigestValue&gt;
      &lt;/ds:Reference&gt;
   &lt;/ds:SignedInfo&gt;
   &lt;ds:SignatureValue&gt;PipXJ2Sfc+LTDnq4pM5JcIYt9gg=&lt;/ds:SignatureValue&gt;
   &lt;ds:KeyInfo&gt;
      &lt;wsse:SecurityTokenReference&gt;
         &lt;wsse:Reference URI='#SomeCert'
                         ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot; /&gt;
      &lt;/wsse:SecurityTokenReference&gt;
   &lt;/ds:KeyInfo&gt;
&lt;/ds:Signature&gt;
</PRE></DIV></DIV>
<H3 id=WSSIDRef>8.2 Element References in XML Signature</H3>
<P>The following specifications (or sections thereof) are referred to in this 
section of the Basic Security Profile 1.0:</P>
<UL>
  <LI><A class=offsite 
  href="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0.pdf">Web 
  Services Security: SOAP Message Security Section 4</A></LI></UL>
<P><SPAN class=statement-target></SPAN>Element references are used to specify 
which portions of a SECURE_ENVELOPE are integrity protected. The Basic Security 
Profile 1.0 places the following constraints on the use of element 
references:</P>
<DIV class=refinement>
<H4 id=Reference_to_Elements_by_Shorthand_XPointer_(XMLDSIG)>8.2.1 Reference to 
Elements by Shorthand XPointer (XMLDSIG)</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>Processing of Shorthand XPointer 
References requires knowledge of which attributes are IDs. Since the underlying 
specifications strive to allow message processing without schema processing, 
some non-schema aware method for identifying ID attributes must be used. 
</P></DIV>
<P class=statement><SPAN class=statement-id><A name=R3001>R3001</A></SPAN> When 
a ds:Reference in a <SPAN class=statement-target>SIGNATURE</SPAN> refers to an 
element that carries a wsu:Id attribute or a Local ID attribute defined by XML 
Signature or XML Encryption, a Shorthand XPointer Reference MUST be used to 
refer to that element. </P>
<P class=statement><SPAN class=statement-id><A name=R3003>R3003</A></SPAN> When 
a ds:Reference/@URI in a <SPAN class=statement-target>SIGNATURE</SPAN> is a 
Shorthand XPointer Reference to an XML Signature element, the reference value 
MUST be a Local ID defined by XML Signature. </P>
<P class=statement><SPAN class=statement-id><A name=R3004>R3004</A></SPAN> When 
a ds:Reference/@URI in a <SPAN class=statement-target>SIGNATURE</SPAN> is a 
Shorthand XPointer Reference to an XML Encryption element, the reference value 
MUST be a Local ID defined by XML Encryption. </P>
<P class=statement><SPAN class=statement-id><A name=R3005>R3005</A></SPAN> When 
a ds:Reference/@URI in a <SPAN class=statement-target>SIGNATURE</SPAN> is a 
Shorthand XPointer Reference to an element not defined by XML Signature or XML 
Encryption, the reference value SHOULD be a wsu:Id. </P>
<DIV class=explanation>
<P><SPAN class=statement-target></SPAN>The underlying specifications define well 
known ID attributes. Limiting references to those well known attributes reduces 
complexity and the reliance on schema processing. </P></DIV></DIV>
<DIV class=refinement>
<H4 id=Reference_to_Elements_by_XPath_Expression>8.2.2 Reference to Elements by 
XPath Expression</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>Elements that do not have an attribute of 
type ID cannot be referred to by Shorthand XPointer References so a different 
referencing mechanism is needed. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R3002>R3002</A></SPAN> When 
referring to an element in a SECURE_ENVELOPE that does NOT carry an attribute of 
type ID from a ds:Reference in a <SPAN class=statement-target>SIGNATURE</SPAN> 
the XPath Filter 2.0 Transform (http://www.w3.org/2002/06/xmldsig-filter2) MUST 
be used to refer to that element. </P>
<DIV class=explanation>
<P><SPAN class=statement-target></SPAN>The XPath Filter 2.0 transform is more 
efficient than the original XPath transform from XML Digital Signature Syntax 
and Processing. </P></DIV>
<P class=example-banner>For example,</P>
<DIV class=example>
<P class=incorrect>INCORRECT: </P><PRE>&lt;!-- This example is incorrect because it uses the http://www.w3.org/TR/1999/REC-xpath-19991116 transform instead of the http://www.w3.org/2002/06/xmldsig-filter2 transform --&gt;


&lt;soap:Envelope xmlns:soap='http://schemas.xmlsoap.org/soap/envelope' &gt;
 &lt;soap:Header&gt;
   &lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd'
                  xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd'&gt;
     &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                               ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
     &lt;/wsse:BinarySecurityToken&gt;
     &lt;ds:Signature xmlns:ds='http://www.w3.org/2000/09/xmldsig#'&gt;
       &lt;ds:SignedInfo&gt;
         &lt;ds:CanonicalizationMethod Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#&quot; '&gt;
           &lt;c14n:InclusiveNamespaces xmlns:c14n='http://www.w3.org/2001/10/xml-exc-c14n#'
                                     PrefixList='wsse soap wsu' /&gt;
         &lt;/ds:CanonicalizationMethod&gt;
         &lt;ds:SignatureMethod Algorithm='http://www.w3.org/2000/09/xmldsig#rsa-sha1' /&gt;
         &lt;ds:Reference URI=''&gt;
           &lt;ds:Transforms&gt;
             &lt;ds:Transform Algorithm='http://www.w3.org/TR/1999/REC-xpath-19991116'&gt;
               &lt;ds:XPath&gt;/soap:Envelope/soap:Body/*&lt;/ds:XPath&gt;
             &lt;/ds:Transform&gt;
             &lt;ds:Transform Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#'&gt;
               &lt;c14n:InclusiveNamespaces xmlns:c14n='http://www.w3.org/2001/10/xml-exc-c14n#'
                                         PrefixList='soap wsu m' /&gt;
             &lt;/ds:Transform&gt;
           &lt;/ds:Transforms&gt;
           &lt;ds:DigestMethod Algorithm='http://www.w3.org/2000/09/xmldsig#sha1' /&gt;
           &lt;ds:DigestValue&gt;VEPKwzfPGOxh2OUpoK0bcl58jtU=&lt;/ds:DigestValue&gt;
         &lt;/ds:Reference&gt;
       &lt;/ds:SignedInfo&gt;
       &lt;ds:SignatureValue&gt;+diIuEyDpV7qxVoUOkb5rj61+Zs=&lt;/ds:SignatureValue&gt;
       &lt;ds:KeyInfo&gt;
         &lt;wsse:SecurityTokenReference&gt;
            &lt;wsse:Reference
              URI='#SomeCert'
              ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot; /&gt;
         &lt;/wsse:SecurityTokenReference&gt;
       &lt;/ds:KeyInfo&gt;
     &lt;/ds:Signature&gt;
   &lt;/wsse:Security&gt;
 &lt;/soap:Header&gt;
 &lt;soap:Body xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd'
            wsu:Id='TheBody'&gt;
   &lt;m:SomeElement xmlns:m='http://example.org/ws' /&gt;
 &lt;/soap:Body&gt;
&lt;/soap:Envelope&gt;
</PRE></DIV>
<DIV class=example>
<P class=correct>CORRECT: </P><PRE>&lt;soap:Envelope xmlns:soap='http://schemas.xmlsoap.org/soap/envelope' &gt;
  &lt;soap:Header&gt;
    &lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd'
                   xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd'&gt;
      &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                                ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
      &lt;/wsse:BinarySecurityToken&gt;
      &lt;ds:Signature xmlns:ds='http://www.w3.org/2000/09/xmldsig#'&gt;
        &lt;ds:SignedInfo&gt;
          &lt;ds:CanonicalizationMethod Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#&quot; '&gt;
            &lt;c14n:InclusiveNamespaces xmlns:c14n='http://www.w3.org/2001/10/xml-exc-c14n#'
                                      PrefixList='wsse soap wsu' /&gt;
          &lt;/ds:CanonicalizationMethod&gt;
          &lt;ds:SignatureMethod Algorithm='http://www.w3.org/2000/09/xmldsig#rsa-sha1' /&gt;
          &lt;ds:Reference URI=''&gt;
            &lt;ds:Transforms&gt;
              &lt;ds:Transform Algorithm='http://www.w3.org/2002/06/xmldsig-filter2'
                            xmlns:dsxp='http://www.w3.org/2002/06/xmldsig-filter2'&gt;
                &lt;dsxp:XPath Filter='intersect'&gt;/soap:Envelope/soap:Body/*&lt;/dsxp:XPath&gt;
              &lt;/ds:Transform&gt;
              &lt;ds:Transform Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#'&gt;
                &lt;c14n:InclusiveNamespaces xmlns:c14n='http://www.w3.org/2001/10/xml-exc-c14n#'
                                          PrefixList='soap wsu m' /&gt;
              &lt;/ds:Transform&gt;
            &lt;/ds:Transforms&gt;
            &lt;ds:DigestMethod Algorithm='http://www.w3.org/2000/09/xmldsig#sha1' /&gt;
            &lt;ds:DigestValue&gt;VEPKwzfPGOxh2OUpoK0bcl58jtU=&lt;/ds:DigestValue&gt;
          &lt;/ds:Reference&gt;
        &lt;/ds:SignedInfo&gt;
        &lt;ds:SignatureValue&gt;+diIuEyDpV7qxVoUOkb5rj61+Zs=&lt;/ds:SignatureValue&gt;
        &lt;ds:KeyInfo&gt;
          &lt;wsse:SecurityTokenReference&gt;
            &lt;wsse:Reference
              URI='#SomeCert'
              ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot; /&gt;
          &lt;/wsse:SecurityTokenReference&gt;
        &lt;/ds:KeyInfo&gt;
      &lt;/ds:Signature&gt;
    &lt;/wsse:Security&gt;
  &lt;/soap:Header&gt;
  &lt;soap:Body xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd'
             wsu:Id='TheBody'&gt;
    &lt;m:SomeElement xmlns:m='http://example.org/ws' /&gt;
  &lt;/soap:Body&gt;
&lt;/soap:Envelope&gt;
</PRE></DIV></DIV>
<H3 id=xmlSignatureAlgorithms>8.3 XML Signature Algorithms</H3>
<DIV class=refinement>
<H4 id=Use_Exclusive_C14N>8.3.1 Use Exclusive C14N</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>Unless proper canonicalization is 
performed, verification of signatures may not work due to changes to the 
elements in the containing scope. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R5404>R5404</A></SPAN> Any 
ds:CanonicalizationMethod/@Algorithm attribute in a <SPAN 
class=statement-target>SIGNATURE</SPAN> MUST have a value of 
&quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot; indicating that is uses Exclusive C14N 
without comments for canonicalization. </P>
<P class=statement><SPAN class=statement-id><A name=R5406>R5406</A></SPAN> Any 
ds:CanonicalizationMethod element within a <SPAN 
class=statement-target>SIGNATURE</SPAN> that has an @Algorithm attribute whose 
value is &quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot; MUST have a 
c14n:InclusiveNamespaces child element with an @PrefixList attribute unless the 
PrefixList is empty. </P>
<P class=statement><SPAN class=statement-id><A name=R5407>R5407</A></SPAN> Any 
ds:Transform element within a <SPAN class=statement-target>SIGNATURE</SPAN> that 
has an @Algorithm attribute whose value is 
&quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot; MUST have a c14n:InclusiveNamespaces 
child element with an @PrefixList attribute unless the PrefixList is empty. </P>
<P class=statement><SPAN class=statement-id><A name=R5409>R5409</A></SPAN> Any 
ds:CanonicalizationMethod element within a <SPAN 
class=statement-target>SIGNATURE</SPAN> that has an @Algorithm attribute whose 
value is &quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot; MUST have an 
c14n:InclusiveNamespaces child element without an @PrefixList attribute if the 
PrefixList would be empty. </P>
<P class=statement><SPAN class=statement-id><A name=R5410>R5410</A></SPAN> Any 
ds:Transform element within a <SPAN class=statement-target>SIGNATURE</SPAN> that 
has an @Algorithm attribute whose value is 
&quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot; MUST have a c14n:InclusiveNamespaces 
child element without an @PrefixList attribute if the PrefixList is would be 
empty. </P>
<P class=statement><SPAN class=statement-id><A name=R5405>R5405</A></SPAN> Any 
c14n:InclusiveNamespaces/@PrefixList attribute within a <SPAN 
class=statement-target>SIGNATURE</SPAN> MUST contain the prefix of all in-scope 
namespaces for the element being signed and its descendants that are not visibly 
utilized, per Exclusive XML Canonicalization Version 1.0. </P>
<P class=statement><SPAN class=statement-id><A name=R5408>R5408</A></SPAN> Any 
c14n:InclusiveNamespaces/@PrefixList attribute within a <SPAN 
class=statement-target>SIGNATURE</SPAN> MUST contain the string &quot;#default&quot; if a 
default namespace is in-scope for the element being signed but is not visibly 
utilized, per Exclusive XML Canonicalization Version 1.0. </P>
<P class=statement><SPAN class=statement-id><A name=R5413>R5413</A></SPAN> When 
the STR-Transform is used the 
ds:Transform/wsse:TransformationParameters/ds:CanonicalizationMethod/ec:InclusiveNamespaces 
element MUST be provided. </P>
<P class=statement><SPAN class=statement-id><A name=R5414>R5414</A></SPAN> A 
RECEIVER MUST be capable of accepting and processing a 
ec:InclusiveNamespaces/@PrefixList containing prefixes in any order within the 
string. </P>
<P class=statement><SPAN class=statement-id><A name=R5415>R5415</A></SPAN> A 
RECEIVER MUST be capable of accepting and processing a 
ec:InclusiveNamespaces/@PrefixList containing arbitrary whitespace before, after 
and between the prefixes within the string. </P>
<DIV class=explanation>
<P><SPAN class=statement-target></SPAN>The use of Exclusive Canonicalization 
with c14n:InclusiveNamespaces/@Prefix addresses problems with both Inclusive 
Canonicalization and Exclusive Canonicalization without 
c14n:InclusiveNamespaces/@Prefix. </P></DIV>
<P class=example-banner>For example,</P>
<DIV class=example>
<P class=incorrect>INCORRECT: </P><PRE>&lt;!-- This example is incorrect because it uses the http://www.w3.org/TR/2001/REC-xml-c14n-20010315
canonicalization algorithm --&gt;

&lt;ds:CanonicalizationMethod Algorithm='http://www.w3.org/TR/2001/REC-xml-c14n-20010315' /&gt;
</PRE></DIV>
<DIV class=example>
<P class=incorrect>INCORRECT: </P><PRE>&lt;!-- This example is incorrect because the ds:CanonicalizationMethod elements are missing a c14n:InclusiveNamespaces child element --&gt;

&lt;ds:CanonicalizationMethod Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#&quot; ' /&gt;
</PRE></DIV>
<DIV class=example>
<P class=incorrect>INCORRECT: </P><PRE>&lt;!-- This example is incorrect because the PrefixList of the first c14n:InclusiveNamespaces element does not contain the 
     correct list of prefixes. It should contain the soap and wsu prefixes in addition to the wsse prefix. --&gt;

&lt;soap:Envelope xmlns:soap='http://schemas.xmlsoap.org/soap/envelope' &gt;
  &lt;soap:Header&gt;
    &lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd'
                   xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd'&gt;
      &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                                ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
      &lt;/wsse:BinarySecurityToken&gt;
      &lt;ds:Signature xmlns:ds='http://www.w3.org/2000/09/xmldsig#'&gt;
        &lt;ds:SignedInfo&gt;
          &lt;ds:CanonicalizationMethod Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#&quot; '&gt;
            &lt;c14n:InclusiveNamespaces xmlns:c14n='http://www.w3.org/2001/10/xml-exc-c14n#'
                                      PrefixList='wsse' /&gt;
          &lt;/ds:CanonicalizationMethod&gt;
          &lt;ds:SignatureMethod Algorithm='http://www.w3.org/2000/09/xmldsig#rsa-sha1' /&gt;
          &lt;ds:Reference URI='#TheBody'&gt;
            &lt;ds:Transforms&gt;
              &lt;ds:Transform Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#'&gt;
                &lt;c14n:InclusiveNamespaces xmlns:c14n='http://www.w3.org/2001/10/xml-exc-c14n#'
                                          PrefixList='soap wsu m' /&gt;
              &lt;/ds:Transform&gt;
            &lt;/ds:Transforms&gt;
            &lt;ds:DigestMethod Algorithm='http://www.w3.org/2000/09/xmldsig#sha1' /&gt;
            &lt;ds:DigestValue&gt;VEPKwzfPGOxh2OUpoK0bcl58jtU=&lt;/ds:DigestValue&gt;
          &lt;/ds:Reference&gt;
        &lt;/ds:SignedInfo&gt;
        &lt;ds:SignatureValue&gt;+diIuEyDpV7qxVoUOkb5rj61+Zs=&lt;/ds:SignatureValue&gt;
        &lt;ds:KeyInfo&gt;
          &lt;wsse:SecurityTokenReference&gt;
            &lt;wsse:Reference
              URI='#SomeCert'
              ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot; /&gt;
          &lt;/wsse:SecurityTokenReference&gt;
        &lt;/ds:KeyInfo&gt;
      &lt;/ds:Signature&gt;
    &lt;/wsse:Security&gt;
  &lt;/soap:Header&gt;
  &lt;soap:Body xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd'
             wsu:Id='TheBody'&gt;
    &lt;m:SomeElement xmlns:m='http://example.org/ws' /&gt;
  &lt;/soap:Body&gt;
&lt;/soap:Envelope&gt;
</PRE></DIV>
<DIV class=example>
<P class=correct>CORRECT: </P><PRE>&lt;soap:Envelope xmlns:soap='http://schemas.xmlsoap.org/soap/envelope' &gt;
  &lt;soap:Header&gt;
    &lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd'
                   xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd'&gt;
      &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                                ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
      &lt;/wsse:BinarySecurityToken&gt;
      &lt;ds:Signature xmlns:ds='http://www.w3.org/2000/09/xmldsig#'&gt;
        &lt;ds:SignedInfo&gt;
          &lt;ds:CanonicalizationMethod Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#&quot; '&gt;
            &lt;c14n:InclusiveNamespaces xmlns:c14n='http://www.w3.org/2001/10/xml-exc-c14n#'
                                      PrefixList='wsse soap wsu' /&gt;
          &lt;/ds:CanonicalizationMethod&gt;
          &lt;ds:SignatureMethod Algorithm='http://www.w3.org/2000/09/xmldsig#rsa-sha1' /&gt;
          &lt;ds:Reference URI='#TheBody'&gt;
            &lt;ds:Transforms&gt;
              &lt;ds:Transform Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#'&gt;
                &lt;c14n:InclusiveNamespaces xmlns:c14n='http://www.w3.org/2001/10/xml-exc-c14n#'
                                          PrefixList='soap wsu m' /&gt;
              &lt;/ds:Transform&gt;
            &lt;/ds:Transforms&gt;
            &lt;ds:DigestMethod Algorithm='http://www.w3.org/2000/09/xmldsig#sha1' /&gt;
            &lt;ds:DigestValue&gt;VEPKwzfPGOxh2OUpoK0bcl58jtU=&lt;/ds:DigestValue&gt;
          &lt;/ds:Reference&gt;
        &lt;/ds:SignedInfo&gt;
        &lt;ds:SignatureValue&gt;+diIuEyDpV7qxVoUOkb5rj61+Zs=&lt;/ds:SignatureValue&gt;
        &lt;ds:KeyInfo&gt;
          &lt;wsse:SecurityTokenReference&gt;
            &lt;wsse:Reference
              URI='#SomeCert'
              ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot; /&gt;
          &lt;/wsse:SecurityTokenReference&gt;
        &lt;/ds:KeyInfo&gt;
      &lt;/ds:Signature&gt;
    &lt;/wsse:Security&gt;
  &lt;/soap:Header&gt;
  &lt;soap:Body xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd'
             wsu:Id='TheBody'&gt;
    &lt;m:SomeElement xmlns:m='http://example.org/ws' /&gt;
  &lt;/soap:Body&gt;
&lt;/soap:Envelope&gt;
</PRE></DIV></DIV>
<DIV class=refinement>
<H4 id=Transforms_Element>8.3.2 Transforms Element</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>At a minimum an XML Canonicalization 
Algorithm needs to be specified for each Reference, necessitating a 
ds:Transforms element. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R5410>R5410</A></SPAN> Any 
ds:Reference element in a <SPAN class=statement-target>SIGNATURE</SPAN> MUST 
have a ds:Transforms child element. </P></DIV>
<DIV class=refinement>
<H4 id=Transform_Element>8.3.3 Transform Element</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>Canonicalization is critical to ensuring 
signatures are processed correctly, thus each ds:Reference will need at least 
one ds:Transform to specify the Exclusive C14N Canonicalization transform or a 
transform which itself incorporates Exclusive C14N Canonicalization. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R5411>R5411</A></SPAN> Any 
ds:Transforms element in a <SPAN class=statement-target>SIGNATURE</SPAN> MUST 
have at least one ds:Transform child element. </P>
<P class=statement><SPAN class=statement-id><A name=R5412>R5412</A></SPAN> Any 
ds:Transforms element in a <SPAN class=statement-target>SIGNATURE</SPAN> MUST 
have as its last child a ds:Transform element which specifies 
&quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot; or 
&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#STR-Transform&quot; 
or 
&quot;http://docs.oasis-open.org/wss/2004/XX/oasis-2004XX-wss-swa-profile-1.0#Attachment-Content-Signature-Transform&quot; 
or 
&quot;http://docs.oasis-open.org/wss/2004/XX/oasis-2004XX-wss-swa-profile-1.0#Attachment-Complete-Signature-Transform&quot; 
</P>
<P class=example-banner>For example,</P>
<DIV class=example>
<P class=incorrect>INCORRECT: </P><PRE>&lt;!-- This example is incorrect because the ds:Reference element does not have a ds:Transforms child element --&gt;

&lt;ds:Reference URI='#TheBody'&gt;
   &lt;ds:DigestMethod Algorithm='http://www.w3.org/2000/09/xmldsig#sha1' /&gt;
   &lt;ds:DigestValue&gt;VEPKwzfPGOxh2OUpoK0bcl58jtU=&lt;/ds:DigestValue&gt;
&lt;/ds:Reference&gt;
</PRE></DIV>
<DIV class=example>
<P class=correct>CORRECT: </P><PRE>&lt;ds:Reference URI='#TheBody'&gt;
   &lt;ds:Transforms&gt;
      &lt;ds:Transform Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#'&gt;
         &lt;c14n:InclusiveNamespaces xmlns:c14n='http://www.w3.org/2001/10/xml-exc-c14n#'
                                   PrefixList='' /&gt;
      &lt;/ds:Transform&gt;
   &lt;/ds:Transforms&gt;
   &lt;ds:DigestMethod Algorithm='http://www.w3.org/2000/09/xmldsig#sha1' /&gt;
   &lt;ds:DigestValue&gt;+VTJraRYFT3pl7Z4uAWhmr5+bf4=&lt;/ds:DigestValue&gt;
&lt;/ds:Reference&gt;
</PRE></DIV></DIV>
<DIV class=refinement>
<H4 id=Digest_Algorithm>8.3.4 Digest Algorithm</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>The SHA1 Digest algorithm is 
widely-implemented and interoperable hence the requirement that it be used for 
signature digests. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R5420>R5420</A></SPAN> Any 
ds:DigestMethod/@Algorithm element in a <SPAN 
class=statement-target>SIGNATURE</SPAN> MUST have the value 
&quot;http://www.w3.org/2000/09/xmldsig#sha1&quot; </P></DIV>
<DIV class=refinement>
<H4 id=Key_Signature_Algorithms>8.3.5 Key Signature Algorithms</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>The two algorithms listed are 
widely-implemented and interoperable. Two algorithms are needed, one symmetric, 
one asymmetric. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R5421>R5421</A></SPAN> Any 
ds:SignatureMethod/@Algorithm element in a <SPAN 
class=statement-target>SIGNATURE</SPAN> MUST have a value of 
&quot;http://www.w3.org/2000/09/xmldsig#hmac-sha1&quot; or 
&quot;http://www.w3.org/2000/09/xmldsig#rsa-sha1&quot; </P></DIV>
<DIV class=refinement>
<H4 id=Transform_Algorithm>8.3.6 Transform Algorithm</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>These algorithms are chosen for their 
cryptographic strength, utility or because they address some security concern. 
</P></DIV>
<P class=statement><SPAN class=statement-id><A name=R5423>R5423</A></SPAN> Any 
ds:Transform/@Algorithm attribute in a <SPAN 
class=statement-target>SIGNATURE</SPAN> MUST have a value of 
&quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot; or 
&quot;http://www.w3.org/2002/06/xmldsig-filter2&quot; or 
&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#STR-Transform&quot; 
or &quot;http://www.w3.org/2000/09/xmldsig#enveloped-signature&quot; or 
&quot;http://docs.oasis-open.org/wss/2004/XX/oasis-2004XX-wss-swa-profile-1.0#Attachment-Content-Signature-Transform&quot; 
or 
&quot;http://docs.oasis-open.org/wss/2004/XX/oasis-2004XX-wss-swa-profile-1.0#Attachment-Complete-Signature-Transform&quot; 
</P>
<P class=example-banner>For example,</P>
<DIV class=example>
<P class=correct>CORRECT: </P><PRE>&lt;soap:Envelope xmlns:soap='http://schemas.xmlsoap.org/soap/envelope' &gt;
  &lt;soap:Header&gt;
    &lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd'
                   xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd'&gt;
      &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                                ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
      &lt;/wsse:BinarySecurityToken&gt;
      &lt;xenc:EncryptedKey xmlns:xenc='http://www.w3.org/2001/04/xmlenc#' &gt;
        &lt;xenc:EncryptionMethod Algorithm='http://www.w3.org/2001/04/xmlenc#rsa-1_5' /&gt;
        &lt;ds:KeyInfo xmlns:ds='http://www.w3.org/2000/09/xmldsig#'&gt;
          &lt;wsse:SecurityTokenReference&gt;
            &lt;wsse:Reference
              URI='#SomeCert'
              ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot; /&gt;
          &lt;/wsse:SecurityTokenReference&gt;
        &lt;/ds:KeyInfo&gt;
        &lt;xenc:CipherData&gt;
          &lt;xenc:CipherValue&gt;
            XZEEVABD3L9G+VNTCDiDTE7WB1a4kILtz5f9FT747eE=       
          &lt;/xenc:CipherValue&gt;
        &lt;/xenc:CipherData&gt;
      &lt;/xenc:EncryptedKey&gt;
      &lt;ds:Signature xmlns:ds='http://www.w3.org/2000/09/xmldsig#'&gt;
        &lt;ds:SignedInfo&gt;
          &lt;ds:CanonicalizationMethod Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#&quot; '&gt;
            &lt;c14n:InclusiveNamespaces xmlns:c14n='http://www.w3.org/2001/10/xml-exc-c14n#'
                                      PrefixList='wsse soap' /&gt;
          &lt;/ds:CanonicalizationMethod&gt;
          &lt;ds:SignatureMethod Algorithm='http://www.w3.org/2000/09/xmldsig#hmac-sha1' /&gt;
          &lt;ds:Reference URI='#TheBody'&gt;
            &lt;ds:Transforms&gt;
              &lt;ds:Transform Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#'&gt;
                &lt;c14n:InclusiveNamespaces xmlns:c14n='http://www.w3.org/2001/10/xml-exc-c14n#'
                                          PrefixList='' /&gt;
              &lt;/ds:Transform&gt;
            &lt;/ds:Transforms&gt;
            &lt;ds:DigestMethod Algorithm='http://www.w3.org/2000/09/xmldsig#sha1' /&gt;
            &lt;ds:DigestValue&gt;+VTJraRYFT3pl7Z4uAWhmr5+bf4=&lt;/ds:DigestValue&gt;
          &lt;/ds:Reference&gt;
        &lt;/ds:SignedInfo&gt;
        &lt;ds:SignatureValue&gt;+diIuEyDpV7qxVoUOkb5rj61+Zs=&lt;/ds:SignatureValue&gt;
      &lt;/ds:Signature&gt;
    &lt;/wsse:Security&gt;
  &lt;/soap:Header&gt;
  &lt;soap:Body xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd'
             wsu:Id='TheBody'&gt;
    &lt;m:SomeElement xmlns:m='http://example.org/ws' /&gt;
  &lt;/soap:Body&gt;
&lt;/soap:Envelope&gt;
</PRE></DIV>
<DIV class=example>
<P class=correct>CORRECT: </P><PRE>&lt;soap:Envelope xmlns:soap='http://schemas.xmlsoap.org/soap/envelope' &gt;
  &lt;soap:Header&gt;
    &lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd'
                   xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd'&gt;
      &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                                ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
      &lt;/wsse:BinarySecurityToken&gt;
      &lt;ds:Signature xmlns:ds='http://www.w3.org/2000/09/xmldsig#'&gt;
        &lt;ds:SignedInfo&gt;
          &lt;ds:CanonicalizationMethod Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#&quot; '&gt;
            &lt;c14n:InclusiveNamespaces xmlns:c14n='http://www.w3.org/2001/10/xml-exc-c14n#'
                                      PrefixList='wsse soap' /&gt;
          &lt;/ds:CanonicalizationMethod&gt;
          &lt;ds:SignatureMethod Algorithm='http://www.w3.org/2000/09/xmldsig#rsa-sha1' /&gt;
          &lt;ds:Reference URI='#TheBody'&gt;
            &lt;ds:Transforms&gt;
              &lt;ds:Transform Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#'&gt;
                &lt;c14n:InclusiveNamespaces xmlns:c14n='http://www.w3.org/2001/10/xml-exc-c14n#'
                                          PrefixList='' /&gt;
              &lt;/ds:Transform&gt;
            &lt;/ds:Transforms&gt;
            &lt;ds:DigestMethod Algorithm='http://www.w3.org/2000/09/xmldsig#sha1' /&gt;
            &lt;ds:DigestValue&gt;+VTJraRYFT3pl7Z4uAWhmr5+bf4=&lt;/ds:DigestValue&gt;
          &lt;/ds:Reference&gt;
        &lt;/ds:SignedInfo&gt;
        &lt;ds:SignatureValue&gt;+diIuEyDpV7qxVoUOkb5rj61+Zs=&lt;/ds:SignatureValue&gt;
        &lt;ds:KeyInfo&gt;
          &lt;wsse:SecurityTokenReference&gt;
            &lt;wsse:Reference
              URI='#SomeCert'
              ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot; /&gt;
          &lt;/wsse:SecurityTokenReference&gt;
        &lt;/ds:KeyInfo&gt;
      &lt;/ds:Signature&gt;
    &lt;/wsse:Security&gt;
  &lt;/soap:Header&gt;
  &lt;soap:Body xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd'
             wsu:Id='TheBody'&gt;
    &lt;m:SomeElement xmlns:m='http://example.org/ws' /&gt;
  &lt;/soap:Body&gt;
&lt;/soap:Envelope&gt;
</PRE></DIV>
<P class=ednote><STRONG>Editors' note:</STRONG>Update the SwA Profile URIs when 
final.</P></DIV>
<H3 id=xmlSignatureSyntax>8.4 XML Signature Syntax</H3>
<P><SPAN class=statement-target></SPAN>XML-Signature Syntax and Processing 
defines many elements and attributes. The Basic Security Profile 1.0 places the 
following constraints on the syntax of signatures:</P>
<DIV class=refinement>
<H4 id=ds_HMACOutputLength>8.4.1 ds:HMACOutputLength</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>The ds:HMACOutputLength provides an input 
parameter to the HMAC-SHA1 algorithm specifying how many bits of the output to 
use. Disallowing use of this element results in ALL the bits of the output being 
used. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R5401>R5401</A></SPAN> The 
ds:HMACOutputLength element MUST NOT appear in a <SPAN 
class=statement-target>SIGNATURE</SPAN>. </P>
<P class=example-banner>For example,</P>
<DIV class=example>
<P class=incorrect>INCORRECT: </P><PRE>&lt;!-- This example is incorrect because the ds:SignatureMethod element has a ds:HMACOutputLength child element --&gt;
&lt;ds:SignatureMethod Algorithm='http://www.w3.org/2000/09/xmldsig#hmac-sha1'&gt;
   &lt;ds:HMACOutputLength&gt;128&lt;/ds:HMACOutputLength&gt;
&lt;/ds:SignatureMethod&gt;
</PRE></DIV>
<DIV class=example>
<P class=correct>CORRECT: </P><PRE>&lt;ds:SignatureMethod Algorithm='http://www.w3.org/2000/09/xmldsig#hmac-sha1' /&gt;
</PRE></DIV></DIV>
<DIV class=refinement>
<H4 id=ds_KeyInfo_with_ds_Signature>8.4.2 ds:KeyInfo with ds:Signature</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>The ds:KeyInfo element allows for many 
different child elements. The Profile mandates a single element, 
wsse:SecurityTokenReference, which is needed to reference security tokens. 
</P></DIV>
<P class=statement><SPAN class=statement-id><A name=R5402>R5402</A></SPAN> A 
ds:KeyInfo element in a <SPAN class=statement-target>SIGNATURE</SPAN> MUST have 
exactly one child element. </P>
<P class=statement><SPAN class=statement-id><A name=R5409>R5409</A></SPAN> The 
child element of a ds:KeyInfo element in a <SPAN 
class=statement-target>SIGNATURE</SPAN> MUST be a SECURITY_TOKEN_REFERENCE 
element. </P>
<P class=example-banner>For example,</P>
<DIV class=example>
<P class=correct>CORRECT: </P><PRE>&lt;ds:KeyInfo xmlns:ds='http://www.w3.org/2000/09/xmldsig#' &gt;
   &lt;wsse:SecurityTokenReference&gt;
      &lt;wsse:Reference URI='#SomeCert'
                      ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot; /&gt;
   &lt;/wsse:SecurityTokenReference&gt;
&lt;/ds:KeyInfo&gt;
</PRE></DIV></DIV>
<DIV class=refinement>
<H4 id=ds_Manifest>8.4.3 ds:Manifest</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>The ds:Manifest element is designed for 
specific application level use cases that do not apply to the use of XML 
Signature in SOAP Message Security.</P></DIV>
<P class=statement><SPAN class=statement-id><A name=R5403>R5403</A></SPAN> A 
<SPAN class=statement-target>SIGNATURE</SPAN> MUST NOT contain a ds:Manifest 
element. </P>
<P class=example-banner>For example,</P>
<DIV class=example>
<P class=incorrect>INCORRECT: </P><PRE>&lt;!-- This example is incorrect because the ds:Signature element has a ds:Manifest grandchild element --&gt;

&lt;ds:Signature xmlns:ds='http://www.w3.org/2000/09/xmldsig#'&gt;
   &lt;ds:SignedInfo&gt;
      &lt;ds:CanonicalizationMethod Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#&quot; '&gt;
         &lt;c14n:InclusiveNamespaces xmlns:c14n='http://www.w3.org/2001/10/xml-exc-c14n#'
                                   PrefixList='wsse soap' /&gt;
      &lt;/ds:CanonicalizationMethod&gt;
      &lt;ds:SignatureMethod Algorithm='http://www.w3.org/2000/09/xmldsig#rsa-sha1' /&gt;
      &lt;ds:Reference URI='#TheManifest'&gt;
         &lt;ds:Transforms&gt;
            &lt;ds:Transform Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#'&gt;
               &lt;c14n:InclusiveNamespaces xmlns:c14n='http://www.w3.org/2001/10/xml-exc-c14n#'
                                         PrefixList='' /&gt;
            &lt;/ds:Transform&gt;
         &lt;/ds:Transforms&gt;
         &lt;ds:DigestMethod Algorithm='http://www.w3.org/2000/09/xmldsig#sha1' /&gt;
         &lt;ds:DigestValue&gt;OVuYKGY6KCGB0l0XHS3krj8vjek=&lt;/ds:DigestValue&gt;
      &lt;/ds:Reference&gt;
   &lt;/ds:SignedInfo&gt;
   &lt;ds:SignatureValue&gt;L7X0Zw23/zYQnX4+Z+p0gCygKQ0=&lt;/ds:SignatureValue&gt;
   &lt;ds:KeyInfo&gt;
      &lt;wsse:SecurityTokenReference&gt;
         &lt;wsse:Reference URI='#SomeCert'
                         ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot; /&gt;
      &lt;/wsse:SecurityTokenReference&gt;
   &lt;/ds:KeyInfo&gt;
   &lt;ds:Object&gt;
      &lt;ds:Manifest Id='TheManifest'&gt;
         &lt;ds:Reference URI='#TheBody'&gt;
            &lt;ds:Transforms&gt;
               &lt;ds:Transform Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#'&gt;
                  &lt;c14n:InclusiveNamespaces xmlns:c14n='http://www.w3.org/2001/10/xml-exc-c14n#'
                                            PrefixList='' /&gt;
               &lt;/ds:Transform&gt;
            &lt;/ds:Transforms&gt;
            &lt;ds:DigestMethod Algorithm='http://www.w3.org/2000/09/xmldsig#sha1' /&gt;
            &lt;ds:DigestValue&gt;+VTJraRYFT3pl7Z4uAWhmr5+bf4=&lt;/ds:DigestValue&gt;
         &lt;/ds:Reference&gt;
      &lt;/ds:Manifest&gt;
   &lt;/ds:Object&gt;
&lt;/ds:Signature&gt;
</PRE></DIV></DIV>
<DIV class=refinement>
<H4 id=Encrypting_signatures>8.4.4 Encrypting signatures</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>If the value of a ds:DigestValue element 
in a SIGNATURE needs to be encrypted the entire parent ds:Signature element MUST 
be encrypted.</P></DIV>
<P class=statement><SPAN class=statement-id><A name=R5440>R5440</A></SPAN> A 
<SPAN class=statement-target>SIGNATURE</SPAN> MUST NOT have any 
xenc:EncryptedData elements amongst its descendants.</P></DIV>
<H2 id=xmlEncryption>9. XML Encryption</H2>
<P><SPAN class=statement-target></SPAN>Web Services Security: SOAP Message 
Security builds on XML Encryption, defining usage of various elements from XML 
Encryption and a processing model. The Basic Security Profile 1.0 places the 
constraints defined in this section on the use of XML Encryption with Web 
Services Security: SOAP Message Security. The Basic Security Profile 1.0 places 
no constraints on other use of XML Encryption. </P>
<P><SPAN class=statement-target></SPAN>In some areas the Basic Security Profile 
allows limited flexibility and extensibility in the application of security to 
messages. Some agreement between the SENDER and RECEIVER over which mechanisms 
and choices should be used for message exchanges is necessary. Since no security 
policy description language or negotiation mechanism is in scope for the Basic 
Security Profile, some out of band agreement must be reached for which elements 
should be encrypted and which data encryption, key transport and/or key wrap 
algorithms should be used. </P>
<P>This section of the Basic Security Profile 1.0 incorporates the following 
specifications by reference: </P>
<UL>
  <LI><A class=offsite 
  href="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0.pdf">Web 
  Services Security: SOAP Message Security Section 9</A>
  <LI><A class=offsite href="http://www.w3.org/TR/xmlenc-core/">XML Encryption 
  Syntax and Processing</A></LI></UL>
<H3 id=xmlEncryptProcessing>9.1 XML Encryption Processing Model</H3>
<DIV class=refinement>
<H4 id=xenc_ReferenceList>9.1.1 xenc:ReferenceList</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>Some encryption steps might not produce 
an xenc:ReferenceList. For those that do produce an xenc:ReferenceList, there 
must be a separate xenc:ReferenceList for each such encryption step. When there 
is a xenc:ReferenceList either as a child of wsse:Security or as a child of 
xenc:EncryptedKey it must list all the corresponding xenc:EncryptedData elements 
by using xenc:DataReference elements.</P></DIV>
<P class=statement><SPAN class=statement-id><A name=R3205>R3205</A></SPAN> Each 
<SPAN class=statement-target>ENCRYPTION_REFERENCE_LIST</SPAN> produced as part 
of an encryption step MUST use a single key. </P>
<P class=statement><SPAN class=statement-id><A name=R3215>R3215</A></SPAN> An 
<SPAN class=statement-target>ENCRYPTION_REFERENCE_LIST</SPAN> MUST contain an 
xenc:DataReference element for each ENCRYPTED_DATA produced in the associated 
encryption step. </P>
<P class=statement><SPAN class=statement-id><A name=R3214>R3214</A></SPAN> An 
<SPAN class=statement-target>ENCRYPTED_KEY_REFERENCE_LIST</SPAN> MUST contain a 
xenc:DataReference for each ENCRYPTED_DATA produced in the associated encryption 
step. </P></DIV>
<DIV class=refinement>
<H4 id=xenc_EncryptedKey>9.1.2 xenc:EncryptedKey</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>To facilitate ease of processing, keys 
are required to appear inside wsse:Security headers and to appear before they 
are required for decryption of elements inside a wsse:Security header.</P></DIV>
<P class=statement><SPAN class=statement-id><A name=R3208>R3208</A></SPAN> An 
<SPAN class=statement-target>ENCRYPTED_KEY</SPAN> MUST precede any 
ENCRYPTED_DATA in the same SECURITY_HEADER referenced by the associated 
ENCRYPTED_KEY_REFERENCE_LIST. </P>
<P class=example-banner>For example,</P>
<DIV class=example>
<P class=incorrect>INCORRECT: </P><PRE>&lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd'
               xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd' 
               xmlns:xenc='http://www.w3.org/2001/04/xmlenc#' 
               xmlns:ds='http://www.w3.org/2000/09/xmldsig#' &gt;
  &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                            ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
  &lt;/wsse:BinarySecurityToken&gt;
  &lt;xenc:EncryptedData Id='Enc1'&gt;
    &lt;xenc:EncryptionMethod Algorithm='http://www.w3.org/2001/04/xmlenc#tripledes-cbc' /&gt;
    &lt;xenc:CipherData&gt;
      &lt;xenc:CipherValue&gt;
9jFtYcLSlDZQBMjKfT7ctg6Jy+6sC8YORhiPeTvOjug7ozY2SRHGuLt8G/vf2f/f4IdF0ewiDOpq...
   &lt;/xenc:CipherValue&gt;
 &lt;/xenc:CipherData&gt;
&lt;/xenc:EncryptedData&gt;
&lt;xenc:EncryptedKey&gt;
  &lt;xenc:EncryptionMethod Algorithm='http://www.w3.org/2001/04/xmlenc#rsa-1_5' /&gt;
  &lt;ds:KeyInfo&gt;
    &lt;wsse:SecurityTokenReference&gt;
      &lt;wsse:Reference
        URI='#SomeCert'
        ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot; /&gt;
    &lt;/wsse:SecurityTokenReference&gt;
  &lt;/ds:KeyInfo&gt;
  &lt;xenc:CipherData&gt;
    &lt;xenc:CipherValue&gt;
      XZEEVABD3L9G+VNTCDiDTE7WB1a4kILtz5f9FT747eE=
    &lt;/xenc:CipherValue&gt;
    &lt;xenc:ReferenceList&gt;
      &lt;xenc:DataReference URI='#Enc1' /&gt;
    &lt;/xenc:ReferenceList&gt;
  &lt;/xenc:CipherData&gt;
&lt;/xenc:EncryptedKey&gt;
&lt;/wsse:Security&gt;
</PRE></DIV>
<DIV class=example>
<P class=correct>CORRECT: </P><PRE>&lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd'
               xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd' 
               xmlns:xenc='http://www.w3.org/2001/04/xmlenc#' 
               xmlns:ds='http://www.w3.org/2000/09/xmldsig#' &gt;
  &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                            ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
  &lt;/wsse:BinarySecurityToken&gt;
  &lt;xenc:EncryptedKey&gt;
   &lt;xenc:EncryptionMethod Algorithm='http://www.w3.org/2001/04/xmlenc#rsa-1_5' /&gt;
   &lt;ds:KeyInfo&gt;
     &lt;wsse:SecurityTokenReference&gt;
       &lt;wsse:Reference
         URI='#SomeCert'
         ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot; /&gt;
     &lt;/wsse:SecurityTokenReference&gt;
   &lt;/ds:KeyInfo&gt;
   &lt;xenc:CipherData&gt;
     &lt;xenc:CipherValue&gt;
       XZEEVABD3L9G+VNTCDiDTE7WB1a4kILtz5f9FT747eE=       
     &lt;/xenc:CipherValue&gt;
   &lt;/xenc:CipherData&gt;
   &lt;xenc:ReferenceList&gt;
     &lt;xenc:DataReference URI='#Enc1' /&gt;
   &lt;/xenc:ReferenceList&gt;
  &lt;/xenc:EncryptedKey&gt;
  &lt;xenc:EncryptedData Id='Enc1'&gt;
   &lt;xenc:EncryptionMethod Algorithm='http://www.w3.org/2001/04/xmlenc#tripledes-cbc' /&gt;
   &lt;xenc:CipherData&gt;
     &lt;xenc:CipherValue&gt;
9jFtYcLSlDZQBMjKfT7ctg6Jy+6sC8YORhiPeTvOjug7ozY2SRHGuLt8G/vf2f/f4IdF0ewiDOpq...
     &lt;/xenc:CipherValue&gt;
   &lt;/xenc:CipherData&gt;
  &lt;/xenc:EncryptedData&gt;
&lt;/wsse:Security&gt;
</PRE></DIV></DIV>
<H3 id=xmlEncryptionKeys>9.2 XML Encryption Syntax</H3>
<P>The following specifications (or sections thereof) are referred to in this 
section of the Basic Security Profile 1.0:</P>
<UL>
  <LI><A class=offsite href="http://www.w3.org/TR/xmlenc-core/">XML Encryption 
  Syntax and Processing</A></LI></UL>
<P><SPAN class=statement-target></SPAN>XML Encryption Syntax and Processing 
defines many elements and attributes. The Basic Security Profile 1.0 places the 
following constraints on their use:</P>
<DIV class=refinement>
<H4 id=Placement>9.2.1 Placement</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>Mandating that an xenc:EncryptedKey 
element contain a refernce list detailing which message parts were encrypted 
under that key aids message processing. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R3216>R3216</A></SPAN> Any 
<SPAN class=statement-target>ENCRYPTED_KEY</SPAN> that is used in an encryption 
step MUST contain a ENCRYPTED_KEY_REFERENCE_LIST. </P>
<P class=example-banner>For example,</P>
<DIV class=example>
<P class=incorrect>INCORRECT: </P><PRE>&lt;!-- This example is incorrect because the xenc:EncryptedKey element is missing an xenc:ReferenceList child element --&gt;

&lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd'
               xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd' 
               xmlns:xenc='http://www.w3.org/2001/04/xmlenc#' 
               xmlns:ds='http://www.w3.org/2000/09/xmldsig#' &gt;
  &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                            ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
  &lt;/wsse:BinarySecurityToken&gt;
  &lt;xenc:EncryptedKey&gt;
    &lt;xenc:EncryptionMethod Algorithm='http://www.w3.org/2001/04/xmlenc#rsa-1_5' /&gt;
    &lt;ds:KeyInfo&gt;
      &lt;wsse:SecurityTokenReference&gt;
        &lt;wsse:Reference
          URI='#SomeCert'
          ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot; /&gt;
      &lt;/wsse:SecurityTokenReference&gt;
    &lt;/ds:KeyInfo&gt;
    &lt;xenc:CipherData&gt;
      &lt;xenc:CipherValue&gt;
        XZEEVABD3L9G+VNTCDiDTE7WB1a4kILtz5f9FT747eE=       
      &lt;/xenc:CipherValue&gt;
    &lt;/xenc:CipherData&gt;
  &lt;/xenc:EncryptedKey&gt;
  &lt;xenc:ReferenceList&gt;
    &lt;xenc:DataReference URI='#Enc1' /&gt;
  &lt;/xenc:ReferenceList&gt;
  &lt;xenc:EncryptedData Id='Enc1'&gt;
    &lt;xenc:EncryptionMethod Algorithm='http://www.w3.org/2001/04/xmlenc#tripledes-cbc' /&gt;
    &lt;xenc:CipherData&gt;
      &lt;xenc:CipherValue&gt;
9jFtYcLSlDZQBMjKfT7ctg6Jy+6sC8YORhiPeTvOjug7ozY2SRHGuLt8G/vf2f/f4IdF0ewiDOpq...
      &lt;/xenc:CipherValue&gt;
    &lt;/xenc:CipherData&gt;
  &lt;/xenc:EncryptedData&gt;
&lt;/wsse:Security&gt;
</PRE></DIV>
<DIV class=example>
<P class=correct>CORRECT: </P><PRE>&lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd'
               xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd' 
               xmlns:xenc='http://www.w3.org/2001/04/xmlenc#' 
               xmlns:ds='http://www.w3.org/2000/09/xmldsig#' &gt;
  &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                            ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
  &lt;/wsse:BinarySecurityToken&gt;
  &lt;xenc:EncryptedKey&gt;
    &lt;xenc:EncryptionMethod Algorithm='http://www.w3.org/2001/04/xmlenc#rsa-1_5' /&gt;
    &lt;ds:KeyInfo&gt;
      &lt;wsse:SecurityTokenReference&gt;
        &lt;wsse:Reference
          URI='#SomeCert'
          ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot; /&gt;
      &lt;/wsse:SecurityTokenReference&gt;
    &lt;/ds:KeyInfo&gt;
    &lt;xenc:CipherData&gt;
      &lt;xenc:CipherValue&gt;
        XZEEVABD3L9G+VNTCDiDTE7WB1a4kILtz5f9FT747eE=       
      &lt;/xenc:CipherValue&gt;
    &lt;/xenc:CipherData&gt;
    &lt;xenc:ReferenceList&gt;
      &lt;xenc:DataReference URI='#Enc1' /&gt;
    &lt;/xenc:ReferenceList&gt;
  &lt;/xenc:EncryptedKey&gt;
  &lt;xenc:EncryptedData Id='Enc1'&gt;
    &lt;xenc:EncryptionMethod Algorithm='http://www.w3.org/2001/04/xmlenc#tripledes-cbc' /&gt;
    &lt;xenc:CipherData&gt;
      &lt;xenc:CipherValue&gt;
9jFtYcLSlDZQBMjKfT7ctg6Jy+6sC8YORhiPeTvOjug7ozY2SRHGuLt8G/vf2f/f4IdF0ewiDOpq...
      &lt;/xenc:CipherValue&gt;
    &lt;/xenc:CipherData&gt;
  &lt;/xenc:EncryptedData&gt;
&lt;/wsse:Security&gt;
</PRE></DIV></DIV>
<DIV class=refinement>
<H4 id=Prohibited_xenc_EncryptedKey_attributes>9.2.2 Prohibited 
xenc:EncryptedKey attributes</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>These prohibited attributes are not 
needed for xenc:EncryptedKey elements used to secure SOAP messages. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R3209>R3209</A></SPAN> Any 
<SPAN class=statement-target>ENCRYPTED_KEY</SPAN> MUST NOT specify a Type 
attribute. </P>
<P class=statement><SPAN class=statement-id><A name=R5622>R5622</A></SPAN> Any 
<SPAN class=statement-target>ENCRYPTED_KEY</SPAN> MUST NOT specify a MimeType 
attribute. </P>
<P class=statement><SPAN class=statement-id><A name=R5623>R5623</A></SPAN> Any 
<SPAN class=statement-target>ENCRYPTED_KEY</SPAN> MUST NOT specify a Encoding 
attribute. </P></DIV>
<DIV class=refinement>
<H4 id=xenc_EncryptedData_contents>9.2.3 xenc:EncryptedData contents</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>The ds:KeyInfo element is useful for 
determining the security token with which the relevant key material is 
associated. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R5629>R5629</A></SPAN> An 
<SPAN class=statement-target>ENCRYPTED_DATA</SPAN> which is not referenced from 
an ENCRYPTED_KEY MUST contain a ds:KeyInfo </P></DIV>
<DIV class=refinement>
<H4 id=xenc_EncryptedData_attributes>9.2.4 xenc:EncryptedData attributes</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>All xenc:EncryptedData elements will be 
refered to from an xenc:Reference list. Such references use shorthand XPointers, 
hence this requirement. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R5624>R5624</A></SPAN> Any 
<SPAN class=statement-target>ENCRYPTED_DATA</SPAN> MUST have an Id attribute. 
</P></DIV>
<DIV class=refinement>
<H4 id=References_from_xenc_EncryptedData>9.2.5 References from 
xenc:EncryptedData</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>Security token references are intended to 
refer directly to security tokens. This requirement prohibits cases where a 
reference is made to a ds:KeyInfo which in turn contains another reference. 
</P></DIV>
<P class=statement><SPAN class=statement-id><A name=R3211>R3211</A></SPAN> Any 
SECURITY_TOKEN_REFERENCE inside an <SPAN 
class=statement-target>ENCRYPTED_DATA</SPAN> MUST NOT reference a ds:KeyInfo 
element. </P></DIV>
<DIV class=refinement>
<H4 id=xenc_EncryptionMethod_mandatory>9.2.6 xenc:EncryptionMethod 
mandatory</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>Specifying the encryption algorithm used 
to perform the encryption makes messages more self-describing and aids 
interoperability. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R5601>R5601</A></SPAN> Any 
<SPAN class=statement-target>ENCRYPTED_DATA</SPAN> MUST have an 
xenc:EncryptionMethod child element. </P>
<P class=statement><SPAN class=statement-id><A name=R5603>R5603</A></SPAN> Any 
<SPAN class=statement-target>ENCRYPTED_KEY</SPAN> MUST have an 
xenc:EncryptionMethod child element. </P>
<P class=example-banner>For example,</P>
<DIV class=example>
<P class=incorrect>INCORRECT: </P><PRE>&lt;!-- This example is incorrect because the xenc:EncryptedKey element is missing an xenc:EncryptionMethod child element --&gt;

&lt;xenc:EncryptedKey&gt;
   &lt;ds:KeyInfo&gt;
      &lt;wsse:SecurityTokenReference&gt;
         &lt;wsse:Reference URI='#SomeCert'
                         ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot; /&gt;
      &lt;/wsse:SecurityTokenReference&gt;
   &lt;/ds:KeyInfo&gt;
   &lt;xenc:CipherData&gt;
      &lt;xenc:CipherValue&gt;
         XZEEVABD3L9G+VNTCDiDTE7WB1a4kILtz5f9FT747eE=       
      &lt;/xenc:CipherValue&gt;
   &lt;/xenc:CipherData&gt;
   &lt;xenc:ReferenceList&gt;
      &lt;xenc:DataReference URI='#Enc1' /&gt;
   &lt;/xenc:ReferenceList&gt;
&lt;/xenc:EncryptedKey&gt;
</PRE></DIV>
<DIV class=example>
<P class=incorrect>INCORRECT: </P><PRE>&lt;!-- This example is incorrect because the xenc:EncryptedData element is missing an xenc:EncryptionMethod child element --&gt;

&lt;xenc:EncryptedData Id='Enc1'&gt;
   &lt;xenc:CipherData&gt;
      &lt;xenc:CipherValue&gt;
9jFtYcLSlDZQBMjKfT7ctg6Jy+6sC8YORhiPeTvOjug7ozY2SRHGuLt8G/vf2f/f4IdF0ewiDOpq...
      &lt;/xenc:CipherValue&gt;
   &lt;/xenc:CipherData&gt;
&lt;/xenc:EncryptedData&gt;
</PRE></DIV>
<DIV class=example>
<P class=correct>CORRECT: </P><PRE>&lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd'
               xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd' 
               xmlns:xenc='http://www.w3.org/2001/04/xmlenc#' 
               xmlns:ds='http://www.w3.org/2000/09/xmldsig#' &gt;
  &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                            ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
  &lt;/wsse:BinarySecurityToken&gt;
  &lt;xenc:EncryptedKey&gt;
    &lt;xenc:EncryptionMethod Algorithm='http://www.w3.org/2001/04/xmlenc#rsa-1_5' /&gt;
    &lt;ds:KeyInfo&gt;
      &lt;wsse:SecurityTokenReference&gt;
        &lt;wsse:Reference
          URI='#SomeCert'
          ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot; /&gt;
      &lt;/wsse:SecurityTokenReference&gt;
    &lt;/ds:KeyInfo&gt;
    &lt;xenc:CipherData&gt;
      &lt;xenc:CipherValue&gt;
        XZEEVABD3L9G+VNTCDiDTE7WB1a4kILtz5f9FT747eE=       
      &lt;/xenc:CipherValue&gt;
    &lt;/xenc:CipherData&gt;
    &lt;xenc:ReferenceList&gt;
      &lt;xenc:DataReference URI='#Enc1' /&gt;
    &lt;/xenc:ReferenceList&gt;
  &lt;/xenc:EncryptedKey&gt;
  &lt;xenc:EncryptedData Id='Enc1'&gt;
    &lt;xenc:EncryptionMethod Algorithm='http://www.w3.org/2001/04/xmlenc#tripledes-cbc' /&gt;
    &lt;xenc:CipherData&gt;
      &lt;xenc:CipherValue&gt;
9jFtYcLSlDZQBMjKfT7ctg6Jy+6sC8YORhiPeTvOjug7ozY2SRHGuLt8G/vf2f/f4IdF0ewiDOpq...
      &lt;/xenc:CipherValue&gt;
    &lt;/xenc:CipherData&gt;
  &lt;/xenc:EncryptedData&gt;
&lt;/wsse:Security&gt;
</PRE></DIV></DIV>
<DIV class=refinement>
<H4 id=xenc_EncryptedKey/@Recipient>9.2.7 xenc:EncryptedKey/@Recipient</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>This attribute is prohibited because the 
soap:actor attribute conveys the same information. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R5602>R5602</A></SPAN> Any 
<SPAN class=statement-target>ENCRYPTED_KEY</SPAN> MUST NOT contain a Recipient 
attribute. </P>
<P class=example-banner>For example,</P>
<DIV class=example>
<P class=incorrect>INCORRECT: </P><PRE>&lt;!-- This example is incorrect because the xenc:EncryptedKey element has a Recipient attribute  --&gt;

&lt;xenc:EncryptedKey Recipient='Bert'&gt;
   &lt;xenc:EncryptionMethod Algorithm='http://www.w3.org/2001/04/xmlenc#rsa-1_5' /&gt;
   &lt;ds:KeyInfo&gt;
      &lt;wsse:SecurityTokenReference&gt;
         &lt;wsse:Reference URI='#SomeCert'
                         ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot; /&gt;
      &lt;/wsse:SecurityTokenReference&gt;
   &lt;/ds:KeyInfo&gt;
   &lt;xenc:CipherData&gt;
      &lt;xenc:CipherValue&gt;
         XZEEVABD3L9G+VNTCDiDTE7WB1a4kILtz5f9FT747eE=       
      &lt;/xenc:CipherValue&gt;
   &lt;/xenc:CipherData&gt;
   &lt;xenc:ReferenceList&gt;
      &lt;xenc:DataReference URI='#Enc1' /&gt;
   &lt;/xenc:ReferenceList&gt;
&lt;/xenc:EncryptedKey&gt;
</PRE></DIV></DIV>
<DIV class=refinement>
<H4 id=ds_KeyInfo_with_Encryption>9.2.8 ds:KeyInfo with Encryption</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>The ds:KeyInfo element allows for many 
different child elements. The Profile mandates a single element, 
wsse:SecurityTokenReference, which is needed to reference security tokens. 
</P></DIV>
<P class=statement><SPAN class=statement-id><A name=R5424>R5424</A></SPAN> A 
ds:KeyInfo element in an <SPAN class=statement-target>ENCRYPTED_KEY</SPAN> MUST 
have exactly one child element. </P>
<P class=statement><SPAN class=statement-id><A name=R5425>R5425</A></SPAN> A 
ds:KeyInfo element in an <SPAN class=statement-target>ENCRYPTED_DATA</SPAN> MUST 
have exactly one child element. </P>
<P class=statement><SPAN class=statement-id><A name=R5426>R5426</A></SPAN> The 
child element of a ds:KeyInfo element in an <SPAN 
class=statement-target>ENCRYPTED_KEY</SPAN> MUST be a SECURITY_TOKEN_REFERENCE. 
</P>
<P class=statement><SPAN class=statement-id><A name=R5427>R5427</A></SPAN> The 
child element of a ds:KeyInfo element in an <SPAN 
class=statement-target>ENCRYPTED_DATA</SPAN> MUST be a SECURITY_TOKEN_REFERENCE. 
</P></DIV>
<DIV class=refinement>
<H4 id=xenc_EncryptedData>9.2.9 xenc:EncryptedData</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>In order for the data to be protected 
from inspection, it must be replaced with the corresponding encrypted content. 
</P></DIV>
<P class=statement><SPAN class=statement-id><A name=R5606>R5606</A></SPAN> 
Within a <SPAN class=statement-target>SECURE_ENVELOPE</SPAN>, encrypted element 
or element content encrypted as a result of an encryption step MUST be replaced 
by a corresponding ENCRYPTED_DATA. </P></DIV>
<DIV class=refinement>
<H4 id=SOAP_Envelope>9.2.10 SOAP Envelope</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>Encrypting any of the listed elements 
would break the SOAP processing model and so is prohibited. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R5607>R5607</A></SPAN> When 
encryption is used, the <SPAN class=statement-target>SECURE_ENVELOPE</SPAN> MUST 
still be a valid SOAP Envelope. Specifically, the Envelope, Header, or Body 
elements MUST NOT be encrypted. </P></DIV>
<H3 id=ElementReferencesinXMLEncryption>9.3 Element References in XML 
Encryption</H3>
<DIV class=refinement>
<H4 id=Reference_to_Elements_by_Shorthand_XPointer_(XMLENC)>9.3.1 Reference to 
Elements by Shorthand XPointer (XMLENC)</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>The above requirements ensure that 
Shorthand XPointer References are used where approriate and that they refer to 
the correct attribute values. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R5608>R5608</A></SPAN> When 
referring from an xenc:DataReference or xenc:KeyReference in an <SPAN 
class=statement-target>ENCRYPTION_REFERENCE_LIST</SPAN> to an element that 
carries a wsu:Id attribute or a Local ID attribute defined by either XML 
Signature or XML Encryption, a Shorthand XPointer Reference MUST be used to 
refer to that element. </P>
<P class=statement><SPAN class=statement-id><A name=R5613>R5613</A></SPAN> When 
referring from a an xenc:DataReference or xenc:KeyReference in an <SPAN 
class=statement-target>ENCRYPTED_KEY_REFERENCE_LIST</SPAN> to an element that 
carries a wsu:Id attribute or a Local ID attribute defined by either XML 
Signature or XML Encryption, a Shorthand XPointer Reference MUST be used to 
refer to that element. </P>
<P class=statement><SPAN class=statement-id><A name=R3006>R3006</A></SPAN> When 
a xenc:DataReference/@URI or xenc:KeyReference/@URI in a <SPAN 
class=statement-target>ENCRYPTION_REFERENCE_LIST</SPAN> is a Shorthand XPointer 
Reference to an XML Signature element, the reference value MUST be a Local ID 
defined by XML Signature. </P>
<P class=statement><SPAN class=statement-id><A name=R3007>R3007</A></SPAN> When 
a xenc:DataReference/@URI or xenc:KeyReference in a <SPAN 
class=statement-target>ENCRYPTED_KEY_REFERENCE_LIST</SPAN> is a Shorthand 
XPointer Reference to an XML Signature element, the reference value MUST be a 
Local ID defined by XML Signature. </P>
<P class=statement><SPAN class=statement-id><A name=R5609>R5609</A></SPAN> When 
an xenc:DataReference/@URI or xenc:KeyReference/@URI in an <SPAN 
class=statement-target>ENCRYPTION_REFERENCE_LIST</SPAN> is a Shorthand XPointer 
Reference to an XML Encryption element, the reference value MUST be a Local ID 
defined by XML Encryption. </P>
<P class=statement><SPAN class=statement-id><A name=R5610>R5610</A></SPAN> When 
an xenc:DataReference/@URI or xenc:KeyReference/@URI in an <SPAN 
class=statement-target>ENCRYPTED_KEY_REFERENCE_LIST</SPAN> is a Shorthand 
XPointer Reference to an XML Encryption element, the reference value MUST be a 
Local ID defined by XML Encryption. </P>
<P class=statement><SPAN class=statement-id><A name=R5611>R5611</A></SPAN> When 
an xenc:DataReference/@URI or xenc:KeyReference/@URI in an <SPAN 
class=statement-target>ENCRYPTION_REFERENCE_LIST</SPAN> is a Shorthand XPointer 
Reference to an element not defined by XML Signature or XML Encryption, the 
reference value SHOULD be a wsu:Id. </P>
<P class=statement><SPAN class=statement-id><A name=R5612>R5612</A></SPAN> When 
an xenc:DataReference/@URI or xenc:KeyReference/@URI in an <SPAN 
class=statement-target>ENCRYPTED_KEY_REFERENCE_LIST</SPAN> is a Shorthand 
XPointer Reference to an element not defined by XML Signature or XML Encryption, 
the reference value SHOULD be a wsu:Id. </P></DIV>
<H3 id=xmlEncryptionAlgorithms>9.4 XML Encryption Algorithms</H3>
<DIV class=refinement>
<H4 id=Data_Encryption_Algorithms>9.4.1 Data Encryption Algorithms</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>Data encryption algorithms are used for 
encrypting elements and element content. Industries, organizations, and 
application domains are currently choosing from a variety of data encryption 
algorithms based on reasons including performance, security characteristics, and 
regulatory compliance. A set of the most commonly chosen and widely deployed 
data encryption algorithms are supported by the Basic Security Profile in order 
to avoid disenfranchising existing applications. At some point in the future, if 
and when consensus is reached for a single data encryption algorithm the Basic 
Security Profile 1.0 may be revised to constrain instances to use only that 
algorithm. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R5620>R5620</A></SPAN> Any 
xenc:EncryptionMethod/@Algorithm attribute in an <SPAN 
class=statement-target>ENCRYPTED_DATA</SPAN> MUST have a value of 
&quot;http://www.w3.org/2001/04/xmlenc#tripledes-cbc&quot;, 
&quot;http://www.w3.org/2001/04/xmlenc#aes128-cbc&quot; or 
&quot;http://www.w3.org/2001/04/xmlenc#aes256-cbc&quot; </P>
<DIV class=explanation>
<P><SPAN class=statement-target></SPAN>The 3DES algorithm 
(&quot;http://www.w3.org/2001/04/xmlenc#tripledes-cbc&quot;) is widely implemented and 
deployed in existing practice. The AES algorithm is relatively new and becoming 
widely implemented and deployed. The 128-bit variation of AES 
(&quot;http://www.w3.org/2001/04/xmlenc#aes128-cbc&quot;) is relatively faster but weaker 
than the 256-bit variation (&quot;http://www.w3.org/2001/04/xmlenc#aes256-cbc&quot;). 
</P></DIV></DIV>
<DIV class=refinement>
<H4 id=Key_Transport_Algorithms>9.4.2 Key Transport Algorithms</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>Key transport algorithms are used for 
encrypting symmetric encryption keys, such as data encryption keys, with 
asymmetric encryption keys. This technique allows for encryption of relatively 
large amount of data with efficient symmetric encryption and securely 
transmitting the associated relatively small symmetric encryption key. 
Industries, organizations, and application domains are currently choosing from a 
variety of key transport algorithms based on reasons including performance, 
security characteristics, and regulatory compliance. A set of the most commonly 
chosen and widely deployed key transport algorithms are supported by the Basic 
Security Profile in order to avoid disenfranchising existing applications. At 
some point in the future, if and when consensus is reached for a single key 
transport algorithm the Basic Security Profile 1.0 may be revised to constrain 
instances to use only that algorithm. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R5621>R5621</A></SPAN> When 
used for Key Transport, any xenc:EncryptionMethod/@Algorithm attribute in an 
<SPAN class=statement-target>ENCRYPTED_KEY</SPAN> MUST have a value of 
&quot;http://www.w3.org/2001/04/xmlenc#rsa-1_5&quot; or 
&quot;http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p&quot; </P>
<DIV class=explanation>
<P><SPAN class=statement-target></SPAN>The RSA (PKCS#1.5) algorithm 
(&quot;http://www.w3.org/2001/04/xmlenc#rsa-1_5&quot;) is widely implemented and deployed 
in existing practice. The RSA-OAEP algorithm 
(&quot;http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p&quot;) is relatively new and 
becoming widely implemented and deployed. </P></DIV></DIV>
<DIV class=refinement>
<H4 id=Key_Wrap_Algorithms>9.4.3 Key Wrap Algorithms</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>Key wrap algorithms are used for 
encrypting symmetric encryption keys, such as data encryption keys, with 
symmetric encryption keys. Industries, organizations, and application domains 
are currently choosing from a variety of key wrap algorithms based on reasons 
including performance, security characteristics, and regulatory compliance. A 
set of the most commonly chosen and widely deployed key wrap algorithms are 
supported by the Basic Security Profile in order to avoid disenfranchising 
existing applications. At some point in the future, if and when consensus is 
reached for a single key wrap algorithm the Basic Security Profile 1.0 may be 
revised to constrain instances to use only that algorithm. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R5625>R5625</A></SPAN> When 
used for Key Wrap, any xenc:EncryptionMethod/@Algorithm attribute in an <SPAN 
class=statement-target>ENCRYPTED_KEY</SPAN> MUST have a value of 
&quot;http://www.w3.org/2001/04/xmlenc#kw-tripledes&quot;, 
&quot;http://www.w3.org/2001/04/xmlenc#kw-aes128&quot;, or 
&quot;http://www.w3.org/2001/04/xmlenc#kw-aes256&quot; </P>
<DIV class=explanation>
<P><SPAN class=statement-target></SPAN>The 3DES algorithm 
(&quot;http://www.w3.org/2001/04/xmlenc#kw-tripledes&quot;) is widely implemented and 
deployed in existing practice. The AES algorithm is relatively new and becoming 
widely implemented and deployed. The 128-bit variation of AES 
(&quot;http://www.w3.org/2001/04/xmlenc#kw-aes128&quot;) is relatively faster but weaker 
than the 256-bit variation (&quot;http://www.w3.org/2001/04/xmlenc#kw-aes256&quot;). 
</P></DIV></DIV>
<H2 id=algorithms>10. Algorithms</H2>
<P><SPAN class=statement-target></SPAN>This section provides guidance, and in 
some cases requirements, concerning the use of various categories of 
algorithms.</P>
<H3 id=tlssslalg>10.1 Transport Level Security Algorithms</H3>
<P><SPAN class=statement-target></SPAN>In SSL and TLS, choices of algorithms are 
expressed as ciphersuites. The following subsections specify ciphersuites that 
are required, recommended, discouraged and prohibited, respectively. The use of 
any other ciphersuite not discussed below is optional.</P>
<DIV class=refinement>
<H4 id=Mandatory_ciphersuites>10.1.1 Mandatory ciphersuites</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>The specified algorithm suites are 
considered to be widely-implemented, secure and interoperable. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R5701>R5701</A></SPAN> A 
TLS-capable <SPAN class=statement-target>INSTANCE</SPAN> that is not FIPS 
compliant MUST support TLS_RSA_WITH_3DES_EDE_CBC_SHA </P>
<P class=statement><SPAN class=statement-id><A name=R5702>R5702</A></SPAN> A 
SSL-capable <SPAN class=statement-target>INSTANCE</SPAN> that is not FIPS 
compliant MUST support SSL_RSA_WITH_3DES_EDE_CBC_SHA </P>
<P class=statement><SPAN class=statement-id><A name=R5703>R5703</A></SPAN> A 
TLS-capable <SPAN class=statement-target>INSTANCE</SPAN> that is FIPS compliant 
MUST support TLS_RSA_FIPS_WITH_3DES_EDE_CBC_SHA </P>
<P class=statement><SPAN class=statement-id><A name=R5704>R5704</A></SPAN> A 
SSL-capable <SPAN class=statement-target>INSTANCE</SPAN> that is FIPS compliant 
MUST support SSL_RSA_FIPS_WITH_3DES_EDE_CBC_SHA </P></DIV>
<DIV class=refinement>
<H4 id=Recommended_ciphersuites>10.1.2 Recommended ciphersuites</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>As the AES encryption algorithm is 
intended to supersede the 3DES algorithm, it is recommended that TLS-capable 
implementations implement TLS_RSA_WITH_AES_128_CBC_SHA or the FIPS equivalent, 
and SSL-capable implementations implement SSL_RSA_WITH_AES_128_CBC_SHA or the 
FIPS equivalent.</P></DIV></DIV>
<DIV class=refinement>
<H4 id=Discouraged_ciphersuites>10.1.3 Discouraged ciphersuites</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>The ciphersuites defined in the SSL and 
TLS specifications that use anonymous Diffie-Helman ( i.e. those that have 
DH_anon in their symbolic name ) are vulnerable to man-in-the-middle attacks. It 
is recommended that such ciphersuites be avoided.</P>
<P><SPAN class=statement-target></SPAN>The Profile recommends against the use of 
the following ciphersuites due to their lack of confidentiality services:</P>
<UL>
  <LI><SPAN class=statement-target></SPAN>SSL_RSA_WITH_NULL_SHA
  <LI><SPAN class=statement-target></SPAN>TLS_RSA_WITH_NULL_SHA
  <LI><SPAN class=statement-target></SPAN>SSL_RSA_WITH_NULL_MD5
  <LI><SPAN class=statement-target></SPAN>TLS_RSA_WITH_NULL_MD5</LI></UL>
<P><SPAN class=statement-target></SPAN>It is also recommended that ciphersuites 
that use 40 or 56 bit keys be avoided, due to their relative ease of compromise 
through brute-force attack.</P></DIV></DIV>
<DIV class=refinement>
<H4 id=Prohibited_ciphersuites>10.1.4 Prohibited ciphersuites</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>The Profile does not prohibit the use of 
any transport layer security ciphersuites, but careful thought should be given 
prior to the use of any ciphersuites discussed under &quot;Discouraged ciphersuites&quot;. 
</P></DIV></DIV>
<H2 id=reltoBasicProfile>11. Relationship of Basic Security Profile as an 
Extension to Basic Profile</H2>
<P><SPAN class=statement-target></SPAN>The Basic Security Profile is an 
extension profile to the Basic Profile. This means it is consistent with the 
Basic Profile but profiles additional functionality - how to add conformant 
security features to the Basic Profile when needed.</P>
<P><SPAN class=statement-target></SPAN>As an extension of the Basic Profile, the 
Basic Security Profile is designed to support the addition of security 
functionality to SOAP messaging, in an interoperable manner. One example of such 
functionality is the confidentiality of selected SOAP header blocks and SOAP 
body elements through the use of OASIS Web Services Security encryption. The 
intent of such techniques is to change the nature of the SOAP message so that 
unintended parties cannot read such content. This means that the secured SOAP 
message is no longer obviously related to the original WSDL description, and is 
not intelligible without decryption. Other security mechanisms such as 
signatures may also modify the content of SOAP envelopes.</P>
<P><SPAN class=statement-target></SPAN>The Basic Profile includes requirements 
on the content of SOAP envelopes (or in Basic Profile 1.0 the format of SOAP 
messages). Testing conformance to these statements by using a 
&quot;man-in-the-middle&quot; interceptor as outlined in the WS-I Monitor Tool Functional 
Specification will not be possible if encryption has been applied to portions of 
the SOAP envelope and have not yet been decrypted. Even if interception is 
possible, some messages may have a different structure due to security.</P>
<P><SPAN class=statement-target></SPAN>Such SOAP messages still conform to the 
Basic Profile, since conformance to the Basic Profile means conformance once a 
receiver has reversed security changes introduced by a message sender. This is 
not obvious in some Basic Profile requirements, so this document further 
clarifies these requirements in the normative &quot;Basic Profile Clarifications&quot; 
section below.</P>
<P><SPAN class=statement-target></SPAN>It is helpful to visualize a SOAP message 
in light of a protocol layering model, such as the ISO seven layer protocol 
model [ Tanenbaum ]. This model shows how a protocol is in fact composed of 
different layers, and how to a given layer underlying layers are transparent. 
The implementation of a given protocol layer at an endpoint may be modeled as 
that implementation consuming a service of the underlying protocol layer, and 
providing a service to the layer above it. In this model no protocol layer need 
be aware of layers above or below it, making the layer implementations 
independent. This is illustrated in Figure 1.</P>
<P><IMG 
src="Basic Security Profile - Version 1_0 (ED)_files/soap-stack-drawing.png"></P>
<P><SPAN class=statement-target></SPAN>Figure 1: Protocol Stack with SOAP 
Message Security</P>
<P><SPAN class=statement-target></SPAN>Traditionally, protocol layers have been 
distinguished by the use of protocol enveloping, where the message at one layer 
is conveyed as the body in the next lower layer. The sender passes a message to 
the lower level protocol implementation that packages it in a protocol envelope 
and sends it to the corresponding layer in the receiver. The sender and receiver 
at this lower layer perform whatever processing is necessary for delivery 
according to the specification of that layer, and finally the receiver passes 
the message up to the peer of the sender.</P>
<P><SPAN class=statement-target></SPAN>SOAP Security may be viewed as a lower 
layer with respect to the more general SOAP web services application layer. Thus 
a SOAP sender may pass a SOAP message to a lower layer SOAP security 
implementation that applies encryption (for example), and sends the message to 
the destination SOAP Security layer, which removes the encryption before passing 
the message up to the peer SOAP web services application layer.</P>
<P><SPAN class=statement-target></SPAN>Thus a Basic Profile interceptor and 
compliance monitoring activity should logically occur at a receiver at the 
interface between the SOAP security implementation and SOAP web services 
application layer.</P>
<P>This section of the Basic Security Profile 1.0 incorporates the following 
specifications by reference: </P>
<UL>
  <LI><A class=offsite 
  href="http://www.ws-i.org/Profiles/BasicProfile-1.0.html">Basic Profile 
  Version 1.0 (BP1.0)</A>
  <LI><A class=offsite 
  href="http://www.ws-i.org/Profiles/BasicProfile-1.0-errata.html">Basic Profile 
  Version 1.0 Errata</A>
  <LI><A class=offsite 
  href="http://www.ws-i.org/Profiles/BasicProfile-1.1.html">Basic Profile 
  Version 1.1 (BP1.1)</A>
  <LI><A class=offsite 
  href="http://www.ws-i.org/Profiles/SimpleSoapBindingProfile-1.0.html">Simple 
  SOAP Binding Profile Version 1.0 (SSBP1.0)</A></LI></UL>
<H3 id=bpclarify>11.1 Basic Profile Clarifications</H3>
<P><SPAN class=statement-target></SPAN>This section clarifies the BP1.0 
(including Errata), BP1.1, SSBP1.0, and AP1.0 statements that might be unclear 
when SOAP Message Security is applied in compliance with the Basic Security 
Profile.</P>
<P><SPAN class=statement-target></SPAN>This section lists each possibly 
confusing BP1.0, BP1.1, SSBP1.0, and AP1.0 requirement and an associated 
statement to clarify that requirement in the context of the basic security 
profile.</P>
<P><SPAN class=statement-target></SPAN>When these clarifying statements include 
the phrase &quot;reverse SOAP Message Security&quot; it means to remove various impacts of 
applying SOAP Message Security that may have been applied since the MESSAGE 
(BP1.0) or ENVELOPE (BP 1.1) was originally created for that recipient according 
to the BP. This may mean decrypting relevant portions of the XML or removing XML 
Signature elements or making other reverse transformations as appropriate to the 
aspects of SOAP Message Security that were applied in the specific circumstance. 
</P>
<P><SPAN class=statement-target></SPAN>Not all security must be reversed, only 
that for the intended recipient, as applied to the BP compliant envelope before 
sent to that recipient.</P>
<DIV class=refinement>
<H4 id=BP_Requirement_R2301>11.1.1 BP Requirement R2301</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>bp10:R2301 states &quot;The order of the 
elements in the soap:body of a MESSAGE MUST be the same as that of the 
wsdl:parts in the wsdl:message that describes it.&quot;</P>
<P><SPAN class=statement-target></SPAN>bp11:R2301 states &quot;The order of the 
elements in the soap:body of an ENVELOPE MUST be the same as that of the 
wsdl:parts in the wsdl:message that describes it.&quot;</P></DIV>
<P class=statement><SPAN class=statement-id><A name=R5800>R5800</A></SPAN> 
bp10:R2301 MUST be true after any SOAP Message Security has been reversed for 
the <SPAN class=statement-target>MESSAGE</SPAN> </P>
<P class=statement><SPAN class=statement-id><A name=R5801>R5801</A></SPAN> 
bp11:R2301 MUST be true after any SOAP Message Security has been reversed for 
the <SPAN class=statement-target>ENVELOPE</SPAN> </P></DIV>
<DIV class=refinement>
<H4 id=BP_Requirement_R2710>11.1.2 BP Requirement R2710</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>bp10:R2710 states &quot;The operations in a 
wsdl:binding in a DESCRIPTION MUST result in operation signatures that are 
different from one another.&quot;</P>
<P><SPAN class=statement-target></SPAN>bp11:R2710 states &quot;The operations in a 
wsdl:binding in a DESCRIPTION MUST result in operation signatures that are 
different from one another.&quot;</P></DIV>
<P class=statement><SPAN class=statement-id><A name=R5802>R5802</A></SPAN> 
bp10:R2710 MUST be true after SOAP Message Security processing has been reversed 
for the <SPAN class=statement-target>MESSAGE</SPAN> </P>
<P class=statement><SPAN class=statement-id><A name=R5803>R5803</A></SPAN> 
bp11:R2710 MUST be true after SOAP Message Security processing has been reversed 
for the <SPAN class=statement-target>ENVELOPE</SPAN> </P></DIV>
<DIV class=refinement>
<H4 id=BP_Requirement_R2712>11.1.3 BP Requirement R2712</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>bp10:R2712 states &quot;A document-literal 
binding MUST be serialized as a MESSAGE with a soap:Body whose child element is 
an instance of the global element declaration referenced by the corresponding 
wsdl:message part.&quot; </P>
<P><SPAN class=statement-target></SPAN>bp11:R2712 states &quot;A document-literal 
binding MUST be serialized as an ENVELOPE with a soap:Body whose child element 
is an instance of the global element declaration referenced by the corresponding 
wsdl:message part.&quot; </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R5804>R5804</A></SPAN> 
bp10:R2712 MUST be true after any SOAP Message Security has been reversed for 
the <SPAN class=statement-target>MESSAGE</SPAN> </P>
<P class=statement><SPAN class=statement-id><A name=R5805>R5805</A></SPAN> 
bp11:R2712 MUST be true after any SOAP Message Security has been reversed for 
the <SPAN class=statement-target>ENVELOPE</SPAN> </P></DIV>
<DIV class=refinement>
<H4 id=BP_Requirement_R2724>11.1.4 BP Requirement R2724</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>bp10:R2724 states &quot;If an INSTANCE 
receives a message that is inconsistent with its WSDL description, it SHOULD 
generate a soap:Fault with a faultcode of 'Client', unless a 'MustUnderstand' or 
'VersionMismatch' fault is generated.&quot; </P>
<P><SPAN class=statement-target></SPAN>bp11:R2724 states &quot;If an INSTANCE 
receives an envelope that is inconsistent with its WSDL description, it SHOULD 
generate a soap:Fault with a faultcode of 'Client', unless a 'MustUnderstand' or 
'VersionMismatch' fault is generated.&quot; </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R5806>R5806</A></SPAN> For 
bp10:R2724 &quot;Inconsistent&quot; MUST be taken to mean &quot;Inconsistent after SOAP Message 
security has been reversed&quot;, for the <SPAN class=statement-target>MESSAGE</SPAN> 
</P>
<P class=statement><SPAN class=statement-id><A name=R5807>R5807</A></SPAN> For 
bp11:R2724 &quot;Inconsistent&quot; MUST be taken to mean &quot;Inconsistent after SOAP Message 
security has been reversed&quot;, for the <SPAN 
class=statement-target>ENVELOPE</SPAN> </P></DIV>
<DIV class=refinement>
<H4 id=BP_Requirement_R2725>11.1.5 BP Requirement R2725</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>bp10:R2725 states &quot;If an INSTANCE 
receives a message that is inconsistent with its WSDL description, it MUST check 
for &quot;VersionMismatch&quot;, &quot;MustUnderstand&quot; and &quot;Client&quot; fault conditions in that 
order.&quot; </P>
<P><SPAN class=statement-target></SPAN>bp11:R2725 states &quot;If an INSTANCE 
receives an envelope that is inconsistent with its WSDL description, it MUST 
check for &quot;VersionMismatch&quot;, &quot;MustUnderstand&quot; and &quot;Client&quot; fault conditions in 
that order.&quot; </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R5808>R5808</A></SPAN> With 
respect to bp10:R2725 the <SPAN class=statement-target>INSTANCE</SPAN> must 
check for consistency of the MESSAGE per BP 1.0 after reversing SOAP Message 
Security. </P>
<P class=statement><SPAN class=statement-id><A name=R5809>R5809</A></SPAN> With 
respect to bp11:R2725 the <SPAN class=statement-target>INSTANCE</SPAN> must 
check for consistency of the ENVELOPE per BP 1.1 after reversing SOAP Message 
Security. </P></DIV>
<DIV class=refinement>
<H4 id=BP_Requirement_R2729>11.1.6 BP Requirement R2729</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>bp10:R2729 states &quot;A MESSAGE described 
with an rpc-literal binding that is a response message MUST have a wrapper 
element whose name is the corresponding wsdl:operation name suffixed with the 
string 'Response'.&quot; </P>
<P><SPAN class=statement-target></SPAN>bp11:R2729 states &quot;An ENVELOPE described 
with an rpc-literal binding that is a response MUST have a wrapper element whose 
name is the corresponding wsdl:operation name suffixed with the string 
'Response'.&quot; </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R5810>R5810</A></SPAN> With 
respect to bp10:R2729 the verification of the wrapper element name of the <SPAN 
class=statement-target>MESSAGE</SPAN> must be performed after reversing SOAP 
Message Security. </P>
<P class=statement><SPAN class=statement-id><A name=R5811>R5811</A></SPAN> With 
respect to bp11:R2729 the verification of the wrapper element name of the <SPAN 
class=statement-target>ENVELOPE</SPAN> must be performed after reversing SOAP 
Message Security. </P></DIV>
<DIV class=refinement>
<H4 id=BP_Requirement_R2738>11.1.7 BP Requirement R2738</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>bp10:R2738 states &quot;A MESSAGE MUST include 
all soapbind:headers specified on a wsdl:input or wsdl:output of a 
wsdl:operation of a wsdl:binding that describes it.</P>
<P><SPAN class=statement-target></SPAN>bp11:R2738 states &quot;An ENVELOPE MUST 
include all soapbind:headers specified on a wsdl:input or wsdl:output of a 
wsdl:operation of a wsdl:binding that describes it.&quot;</P></DIV>
<P class=statement><SPAN class=statement-id><A name=R5812>R5812</A></SPAN> With 
respect to bp10:R2738 verification of a <SPAN 
class=statement-target>MESSAGE</SPAN> must occur after SOAP Message Security has 
been reversed. </P>
<P class=statement><SPAN class=statement-id><A name=R5813>R5813</A></SPAN> With 
respect to bp11:R2738 verification of an <SPAN 
class=statement-target>ENVELOPE</SPAN> must occur after SOAP Message Security 
has been reversed. </P></DIV>
<DIV class=refinement>
<H4 id=BP_Requirement_R1029>11.1.8 BP Requirement R1029</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>This clarifies the Basic Profile's R1029 
to reflect the fact that transmission of security related faults may increase 
the vulnerablility to certain attacks and in some cases faults should not be 
transmitted. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R5814>R5814</A></SPAN> Where 
the normal outcome of processing a SECURE_ENVELOPE would have resulted in the 
transmission of a SOAP Response, but rather a fault is generated instead, a 
<SPAN class=statement-target>RECEIVER</SPAN> MAY transmit a fault or silently 
discard the message. </P></DIV>
<H2 id=attachsec>12. Attachment Security</H2>
<P>This section of the Basic Security Profile 1.0 incorporates the following 
specifications by reference: </P>
<UL>
  <LI><A class=offsite 
  href="http://www.ws-i.org/Profiles/Basic/2003-08/AttachmentsProfile-1.0.pdf">Attachments 
  Profile Version 1.0 (AP1.0)</A>
  <LI><A class=offsite 
  href="http://www.oasis-open.org/apps/org/workgroup/wss/download.php/10902/wss-swa-profile-1.0-cd-01.pdf">Web 
  Services Security: SOAP Messages with Attachments (SwA) Profile 
1.0</A></LI></UL>
<P><SPAN class=statement-target></SPAN>The section provides guidance for 
protecting attachments when they are used with SOAP Messages. As is explained in 
Section 3 Conformance all features described in the Basic Security Profile 1.0, 
including support for attachments and security for attachments in any form by 
any instance is not required. </P>
<P><SPAN class=statement-target></SPAN>SSL/TLS may be used to provide 
authentication, integrity and confidentiality protection, on a hop-by-hop basis, 
for an entire HTTP Message. This includes HTTP Headers, the SOAP Envelope, and 
all MIME_PARTs. </P>
<P><SPAN class=statement-target></SPAN>SSL/TLS does not provide protection, 
except between adjacent HTTP Nodes, for HTTP Messages when the SOAP Message Path 
contains SOAP Intermediaries. An instance should not use SSL/TLS without WSS 
with Message Exchange Patterns (MEPs) that may contain SOAP intermediaries or 
when these security functions are required to be performed independently of the 
connection. </P>
<P><SPAN class=statement-target></SPAN>WSS may be used to provide 
authentication, integrity and confidentiality protection for a subset of the 
SOAP Message and associated attachments. WSS provides protection for SOAP 
Messages and attachments when the SOAP Message Path contains SOAP 
Intermediaries. An instance should use WSS with MEPs that may contain SOAP 
Intermediaries or when these security functions are required to be performed 
independently of the transport layer connection. </P>
<P><SPAN class=statement-target></SPAN>An instance may use SSL/TLS in 
conjunction with WSS if warranted by application security requirements. This 
combination provides integrity and confidentiality protection for the entire 
HTTP Message (on a hop-by-hop basis) including HTTP Headers, SOAP Envelope, and 
all MIME_PARTs. </P>
<P><SPAN class=statement-target></SPAN>Application level security mechanisms, 
including XML Signature, XML Encryption, PKCS#7, S/MIME, etc. for attachment 
data may also be used by a instance where appropriate, but statements regarding 
the interoperability of such mechanisms are out of scope for the Basic Security 
Profile 1.0. </P>
<P><SPAN class=statement-target></SPAN>The Basic Security Profile 1.0 describes 
one attachment security mechanism and URI. </P>
<H3 id=swa>12.1 SOAP with Attachments</H3>
<P>The following specifications (or sections thereof) are referred to in this 
section of the Basic Security Profile 1.0:</P>
<UL>
  <LI><A class=offsite 
  href="http://www.ws-i.org/Profiles/Basic/2003-08/AttachmentsProfile-1.0.pdf">Attachments 
  Profile Version 1.0 (AP1.0)</A>
  <LI><A class=offsite 
  href="http://www.oasis-open.org/apps/org/workgroup/wss/download.php/10902/wss-swa-profile-1.0-cd-01.pdf">Web 
  Services Security: SOAP Messages with Attachments (SwA) Profile 
1.0</A></LI></UL>
<DIV class=refinement>
<H4 id=Conformance>12.1.1 Conformance</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>The Basic Security Profile is an 
extension profile to the Basic Profile, and thus this requirement makes it 
explicit that when using the WSS SwA profile in conformance to the BSP SwA 
profile section that the messages containing attachments must conform to the 
WS-I Attachments Profile 1.0. This is consistent with the WSS SwA profile and 
good practice. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R6001>R6001</A></SPAN> The 
<SPAN class=statement-target>SECURE_MESSAGE</SPAN> MUST conform to Attachments 
Profile 1.0. </P></DIV>
<DIV class=refinement>
<H4 id=Relationship_between_Parts>12.1.2 Relationship between Parts</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>The WSS SwA profile outlines how 
attachments may be secured when conveyed in conjunction with a primary SOAP 
envelope. The SOAP envelope is contained in a distinct MIME part. Attachment 
parts can contain arbitrary content as indicated by the MIME-Type, and an 
attachment could contain content with nested MIME parts. In order to enable 
interoperable processing at the SOAP messaging layer it is important to only 
secure the top-level MIME attachments that are in the same Multipart structure 
as the MIME part conveying the primary SOAP envelope. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R6002>R6002</A></SPAN> A 
signed and/or encrypted MIME_PART MUST be at the same MIME level as the root 
MIME_PART containing the SECURE_ENVELOPE. </P></DIV>
<DIV class=refinement>
<H4 id=Encryption_and_Root_Part>12.1.3 Encryption and Root Part</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>It is essential that SOAP processors 
(intermediaries and ultimate SOAP receiver) be able to process the primary SOAP 
envelope. For this reason, the MIME part containing the primary SOAP envelope 
must not be secured using the WSS SwA profile mechanisms. This includes 
encryption, since an encrypted SOAP structure cannot be processed, and signing, 
since this would preclude intermediary processing of the SOAP message, since 
this often involves adding, or removing headers. Note that WSS security may be 
applied to portions of the primary SOAP envelope in conformance with the BSP, 
but not by using attachment security mechanisms. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R6003>R6003</A></SPAN> A 
root MIME_PART MUST NOT be referenced by a REFERENCE, ENCRYPTION_REFERENCE_LIST, 
or ENCRYPTED_KEY_REFERENCE_LIST. </P></DIV>
<H3 id=signedAttachments>12.2 Signed Attachments</H3>
<DIV class=refinement>
<H4 id=Reference_to_Signed_Attachments>12.2.1 Reference to Signed 
Attachments</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>The WSS SwA profile requires that cid: 
references be used to refer to MIME attachment parts for signing. This BSP 
statement reiterates that requirement for testability. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R6100>R6100</A></SPAN> A 
REFERENCE to a signed MIME_PART MUST use a URI attribute of the form 
&quot;cid:partToBeSigned&quot;. </P></DIV>
<DIV class=refinement>
<H4 id=Attachment_Transforms>12.2.2 Attachment Transforms</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>The WSS SwA profile requires that a 
ds:Reference to an attachment part that is signed must use a transform 
specifying either the Attachment-Complete-Signature-Transform or the 
Attachment-Content-Signature-Transform URIs. This statement reiterates that 
requirement for testability. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R6101>R6101</A></SPAN> A 
REFERENCE to a MIME_PART MUST use a transform specifying by the URI 
&quot;...#Attachment-Content-Signature-Transform&quot; or 
&quot;...#Attachment-Complete-Signature-Transform&quot;. This transform and URI will be 
specified before the final version of the Basic Security Profile 1.0 is 
released. The anticipated venue to define this Transform is the OASIS WSS TC. 
</P></DIV>
<DIV class=refinement>
<H4 id=Canonicalization>12.2.3 Canonicalization</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>Signature digest calculations require 
that the exact same input be provided to the digest algorithm both when the 
signature is created and when it is verified. Canonicalization is required to 
ensure the same literal representation despite changes due to message 
transformation during transport. XML exclusive canonicalization is required as 
part of the Attachment-Complete-Signature-Transform or 
Attachment-Content-Signature-Transform processing. A separate transform for 
canonicalization should not be provided since it is already included as part of 
the processing associated with these transforms. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R6103>R6103</A></SPAN> The 
output of the Attachment-Content-Signature-Transform or the XML octet stream 
portion of the output of the Attachment-Complete-Signature-Transform must be 
consistent with Exclusive XML Canonicalization without comments having been 
performed when creating that output. </P></DIV>
<DIV class=refinement>
<H4 id=Digest_Values>12.2.4 Digest Values</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>Signature digest calculations require 
that the exact same input be provided to the digest algorithm both when the 
signature is created and when it is verified. Canonicalization is required to 
ensure the same literal representation despite changes due to message 
transformation during transport, for example line ending changes. MIME 
canonicalization algorithms are required for interoperability by WSS SwA 
profile. This statement reiterates that requirement for testability. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R6104>R6104</A></SPAN> A 
REFERENCE to a MIME_PART not containing XML MUST include a ds:DigestValue 
calculated using MIME canonicalization according to the requirements of the MIME 
Type. </P>
<P class=statement><SPAN class=statement-id><A name=R6108>R6108</A></SPAN> A 
REFERENCE to a MIME_PART containing the &quot;application/text&quot; content type MUST 
include a ds:DigestValue which is calculated after the text is canonicalized 
according to MIME canonicalization algorithm for text. </P>
<P class=statement><SPAN class=statement-id><A name=R6109>R6109</A></SPAN> A 
REFERENCE to a MIME_PART containing the an XML content type MUST include a 
ds:DigestValue which is calculated after the XML is canonicalized according to 
Exclusive XML Canonicalization without comments, as specified by the URI 
http://www.w3.org/2001/10/xml-exc-c14n# </P></DIV>
<DIV class=refinement>
<H4 id=Content-Type>12.2.5 Content-Type</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>Signature digest calculations require 
that the exact same input be provided to the digest algorithm both when the 
signature is created and when it is verified. Canonicalization is required to 
ensure the same literal representation despite changes due to message 
transformation during transport. It is essential to determine the correct type 
of canonicalization to perform, based on the MIME_PART content type. For this 
reason it is required that the Content-Type be explicitly stated with a 
Content-Type MIME header. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R6106>R6106</A></SPAN> A 
MIME_PART referenced by a REFERENCE which specifies 
&quot;...#Attachment-Complete-Signature-Transform&quot; MUST have a Content-Type 
MIME-header. </P>
<P class=statement><SPAN class=statement-id><A name=R6107>R6107</A></SPAN> A 
MIME_PART referenced by a REFERENCE which specifies 
&quot;...#Attachment-Content-Signature-Transform&quot; MUST have a Content-Type 
MIME-header. </P></DIV>
<H3 id=encryptedAttachments>12.3 Encrypted Attachments</H3>
<DIV class=refinement>
<H4 id=References_to_Encrypted_Attachments>12.3.1 References to Encrypted 
Attachments</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>The WSS SwA profile requires that an 
EncryptedData element in the primary SOAP envelope be used to reference the 
encrypted MIME part. This statement reiterates that requirement for testability. 
</P></DIV>
<P class=statement><SPAN class=statement-id><A name=R6200>R6200</A></SPAN> An 
encrypted MIME_PART MUST be referenced using an ENCRYPTED_DATA. </P></DIV>
<DIV class=refinement>
<H4 id=Type_attribute>12.3.2 Type attribute</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>The WSS SwA profile requires that an 
EncryptedData element in the primary SOAP envelope that references an encrypted 
MIME part specify the Type as either AttachmentFoo-Content-Only or 
AttachmentFoo-Complete so that it can be processed correctly upon decryption. 
This statement reiterates that requirement for testability. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R6201>R6201</A></SPAN> An 
ENCRYPTED_DATA that references a MIME_PART MUST include a Type attribute with 
the value &quot;...#AttachmentFoo-Content-Only&quot; or &quot;...#AttachmentFoo-Complete&quot;. 
</P></DIV>
<DIV class=refinement>
<H4 id=Reference_URIs>12.3.3 Reference URIs</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>The WSS SwA profile requires that the 
EncryptedData element in the primary SOAP envelope that references an encrypted 
MIME part must reference the Cipherdata using the same cid: as the original 
attachment cid:, simplifying processing. This statement reiterates that 
requirement for testability. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R6202>R6202</A></SPAN> An 
ENCRYPTED_DATA that references a MIME_PART MUST contain a 
xenc:CipherData/xenc:CipherReference element with a URI attribute having the 
same URI as the original MIME_PART. </P></DIV>
<DIV class=refinement>
<H4 id=Content>12.3.4 Content</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>The WSS SwA profile specifies that when 
an attachment is encrypted, the resulting EncryptedData element be placed in the 
wsse:Security header in the primary SOAP envelope and that the cipherdata be 
placed in the attachment part. This statement reiterates the requirement of 
replacing the content of the attachment with the cipherdata, for testability. 
</P></DIV>
<P class=statement><SPAN class=statement-id><A name=R6203>R6203</A></SPAN> The 
content of a MIME_PART encrypted according to the WSS SwA profile MUST be 
replaced by the cipher value that results from encrypting the MIME part and is 
referenced from the CipherReference in the EncryptedData element. </P></DIV>
<H2 id=seccon>13. Security Considerations</H2><SPAN 
class=statement-target></SPAN>This section lists a number of security 
considerations that should be taken into account when using one or more of the 
technologies discussed in the Basic Security Profile 1.0. 
<H3 id=transportsecConsiderations>13.1 SOAPAction Header</H3><SPAN 
class=statement-target></SPAN>The use of the SOAPAction header in situations 
where the message content is being integrity or confidentiality protected can 
result in security risks when the transport layer does not provide the same 
protection to the SOAPAction header. The most obvious risk is that the 
SOAPAction header can potentially expose sensitive information about a SOAP 
message such as the URI of the service, or the context of the transaction that 
is taking place. Another, more subtle risk occurs in a situation where message 
routing is done based on the value of the SOAPAction header. By modifying the 
value, an attacker could cause the message to be directed to a different 
receiver. This could potentially defeat a replay detection mechanism that was 
based on the assumption that the message would always be routed to the same 
place. Yet another risk occurs when intermediates are present. An intermediate 
might decide on a set of processing steps based on the value of SOAPAction or 
application/soap+xml, which is subject to tampering. A subsequent receiver might 
base its processing on the actual message content, which could be secured 
through XML signatures. Suppose that the intermediate was a security gateway. It 
could be tricked into allowing a payment operation through that had only query 
security. 
<DIV class=refinement>
<H4 id=SOAPAction_header>13.1.1 SOAPAction header</H4>
<P class=statement><SPAN class=statement-id><A name=C2010>C2010</A></SPAN> In a 
DESCRIPTION, the soapAction attibute of a soapbind:operation element MUST be 
either omitted, or have as its value an empty string. </P></DIV>
<H3 id=clockSynch>13.2 Clock Synchronization</H3><SPAN 
class=statement-target></SPAN>The specifications covered by the Basic Security 
Profile 1.0 use time-based mechanisms to prevent replay attacks. These 
mechanisms will be ineffective unless the system clocks of the various network 
nodes are synchronized. Since the technology to perform distributed clock 
synchronization are well known and widely available and are not among the 
technologies being profiled here, this document does not specify how clock 
synchronization should be done. However, the recommendation of the use of 
time-based security mechanisms implies that synchronization is being done. 
<H3 id=bindSTtoSigs>13.3 Security Token Substitution</H3><SPAN 
class=statement-target></SPAN>If a message is signed using a Security Token that 
binds a public verification key with other claims, and specific processing is 
performed based on those claims, then in order to protect against post-signature 
substitution of the Security Token with one that binds the same key to different 
claims, Security Token itself should be part of the signature computation. This 
can be acheived by putting a child ds:Reference element whose URI attribute 
contains a shorthand XPointer reference to the wsse:SecurityTokenReference that 
specifies the Security Token into the ds:SignedInfo element of a signature. 
<SPAN class=statement-target></SPAN>If a ds:SignedInfo contains one or more 
ds:Reference children whose URI attribute contains a shorthand XPointer 
reference to a wsse:SecurityTokenReference that uses a potentially ambiguous 
mechanism to refer to the Security Token (e.g. KeyIdentifier), then in order to 
protect against post-signature substitution of the Security Token with one that 
binds the same key to different claims, it is recommended that the content of 
the Security Token be signed either directly or using the Security Token 
Dereferencing Transform. 
<DIV class=refinement>
<H4 id=Security_Token_Substitution>13.3.1 Security Token Substitution</H4>
<P class=statement><SPAN class=statement-id><A name=C5440>C5440</A></SPAN> When 
the signer's SECURITY_TOKEN is an INTERNAL_SECURITY_TOKEN, the <SPAN 
class=statement-target>SIGNATURE</SPAN> MAY include a ds:Reference that refers 
to the signer's SECURITY_TOKEN in order to prevent substitution with another 
SECURITY_TOKEN that uses the same key. <SPAN class=statement-type>C</SPAN></P>
<P class=statement><SPAN class=statement-id><A name=C5441>C5441</A></SPAN> When 
the signer's SECURITY_TOKEN is an EXTERNAL_SECURITY_TOKEN, the <SPAN 
class=statement-target>SIGNATURE</SPAN> MAY include a ds:Reference that refers 
to the SECURITY_TOKEN_REFERENCE that refers to the signer's SECURITY_TOKEN using 
the Security Token Dereferencing Transform in order to prevent substitution of 
another SECURITY_TOKEN that uses the same key. <SPAN 
class=statement-type>C</SPAN></P></DIV><SPAN class=statement-target></SPAN>When 
a key is provided in band within a Security Token or otherwise for the purpose 
of specifying a key to be used by another node for encrypting information to be 
sent in a future message, it is recommended that the sender of the key 
cryptographicaly bind the key to the message in which it is transmitted. This 
can be done either by using the key to perform a Signature or HMAC over critical 
elements of the message body or by including the key under a signature covering 
critical elements of the message body which uses some other key. If a key is 
sent in a message which the receiver is expected to use to encrypt data in some 
future message, there is a risk that an attacker could substitute some other key 
and thereby be able to read unauthorized data. This is true even if the key is 
contained in a signed certificate, but is not bound to the current message in 
some way. If the future encryption key is used to sign the initial request, by 
verifying the signature, the receiver can determine that the key is the one that 
was intended. 
<DIV class=refinement>
<H4 id=Security_Token_Reference_in_Subsequent_Messages>13.3.2 Security Token 
Reference in Subsequent Messages</H4>
<P class=statement><SPAN class=statement-id><A name=C5442>C5442</A></SPAN> When 
an encryption key to be used in subsequent messages is provided in an 
INTERNAL_SECURITY_TOKEN, a <SPAN class=statement-target>SIGNATURE</SPAN> MAY 
include a ds:Reference that refers to the signer's SECURITY_TOKEN in order to 
prevent substitution with another SECURITY_TOKEN that uses the same key. <SPAN 
class=statement-type>C</SPAN></P></DIV>
<H3 id=removalModXML>13.4 Protecting against removal and modification of XML 
Elements</H3>
<P><SPAN class=statement-target></SPAN>XML Signatures using Shorthand XPointer 
References (AKA IDREF) protect against the removal and modification of XML 
elements; but do not protect the location of the element within the XML 
Document.</P>
<P><SPAN class=statement-target></SPAN>Whether or not this is security 
vulnerability depends on whether the location of the signed data within its 
surrounding context has any semantic import. This consideration applies to data 
carried in the SOAP Body or the Header. </P>
<P><SPAN class=statement-target></SPAN>Of particular concern is the ability to 
relocate signed data into a SOAP Header block which is unknown to the receiver 
and marked mustUnderstand=&quot;false&quot;. This could have the effect of causing the 
receiver to ignore signed data which the sender expected would either be 
processed or result in the generation of a mustUnderstand fault.</P>
<P><SPAN class=statement-target></SPAN>A similar exploit would involve 
relocating signed data into a SOAP Header block targeted to a S11:actor or 
S12:role other than that which the sender intended, and which the receiver will 
not process.</P>
<P><SPAN class=statement-target></SPAN>While these attacks could apply to any 
portion of the message, their effects are most pernicious with SOAP header 
elements which may not always be present, but must be processed whenever they 
appear.</P>
<P><SPAN class=statement-target></SPAN>In the general case of XML Documents and 
Signatures, this issue may be resolved by signing the entire XML Document and/or 
strict XML Schema specification and enforcement. However, because elements of 
the SOAP message, particularly header elements, may be legitimately modified by 
SOAP intermediaries, this approach is usually not appropriate. It is RECOMMENDED 
that applications signing any part of the SOAP body sign the entire body.</P>
<P><SPAN class=statement-target></SPAN>Alternatives countermeasures include (but 
are not limited to):</P>
<UL>
  <LI><SPAN class=statement-target></SPAN>References using XPath transforms with 
  Absolute Path expressions, 
  <LI><SPAN class=statement-target></SPAN>A Reference using an XPath transform 
  to include any significant location-dependent elements and exclude any 
  elements that might legitimately be removed, added, or altered by 
  intermediaries,
  <LI><SPAN class=statement-target></SPAN>Using only References to elements with 
  location-independent semantics,
  <LI><SPAN class=statement-target></SPAN>Strict policy specification and 
  enforcement regarding which message parts are to be signed. For example:
  <UL>
    <LI><SPAN class=statement-target></SPAN>Requiring that the entire SOAP Body 
    and all children of SOAP Header be signed,
    <LI><SPAN class=statement-target></SPAN>Requiring that SOAP header elements 
    which are marked mustUnderstand=&quot;false&quot; and have signed descendents MUST 
    include the mustUnderstand attribute under the signature.</LI></UL></LI></UL>
<H3 id=uniqueIds>13.5 Uniqueness of ID attributes</H3><SPAN 
class=statement-target></SPAN>XML 1.0 requires that all attributes of type ID in 
a given XML document have unique values, but only validating XML processors have 
such type information. As various aspects of SOAP Message Security use ID based 
references it is recommended that applications ensure that ID attributes are 
unique by some mechanism. 
<H3 id=signSTs>13.6 Signing Security Tokens</H3><SPAN 
class=statement-target></SPAN>In general, tokens contain claims made by an 
authority, usually about some system entity. Obviously a party relying on these 
claims must trust that authority to make them. The relying party must generally 
verify these claims. The method of doing this depends on the token type and is 
specified by the corresponding token profile. 
<H3 id=signUTs>13.7 Signing Username Tokens</H3><SPAN 
class=statement-target></SPAN>When a wsse:UsernameToken contains only a 
wsse:Username and wsse:PasswordText and is simply presented for Authentication 
where replay is not a concern, it does not need to be signed because the act of 
checking it against a stored value has the effect of verifying it. When a 
wsse:Nonce and/or wsu:Created are used with the wsse:Username and 
wsse:PasswordText to prevent replay, the wsse:UsernameToken must be signed to 
prevent undetected alteration of these fields. If a wsse:PasswordText is being 
used to derive a key for a subsequent encryption of a response, it should be 
signed to ensure that an attacker does not substitute an alternative, but valid 
wsse:Username and wsse:PasswordText. This is equivalent to the key substitution 
attack available when an X.509 Token is used for a similar purpose. 
<H3 id=signBTs>13.8 Signing Binary Tokens</H3><SPAN 
class=statement-target></SPAN>The content of a binary token will be a binary 
object which is integrity protected by a mechanism specific to the object type. 
For example, an X.509 certificate will be signed by the issuing authority. The 
outer wrapper of the binary token merely contains type indication information 
which does not have to be integrity protected in order to be able to rely in the 
claims. 
<H3 id=signXTs>13.9 Signing XML Tokens</H3><SPAN 
class=statement-target></SPAN>XML tokens should be digitally signed in a manner 
described by their profile (or documents referenced by it), or delivered 
directly from their issuer over an integrity protected channel. 
<H3 id=replayUTs>13.10 Replay of Username Token</H3>
<P><SPAN class=statement-target></SPAN>A sender that includes a Nonce child in a 
UsernameToken element should anticipate that the receiver may refuse to process 
the message due to either an accidental collision or transport layer delays. 
Therefore, if it decides to retry transmission, it should do so with a new 
Nonce.</P>
<P><SPAN class=statement-target></SPAN>Unless other mechanisms are used to 
protect against replay of the username token, service providers should retain 
nonces in a store that is shared between all SOAP nodes (and within a 
distributed SOAP node all &quot;components&quot;) that can be authorized using the same 
passwords.</P>
<P><SPAN class=statement-target></SPAN>The policy that allows service providers 
to forget nonces may be based on any considerations that the service considers 
relevant. When a nonce is forgotten the server should ensure that in the future 
it rejects UsernameTokens with a Created time that is earlier than the forgotten 
nonce.</P>
<DIV class=refinement>
<H4 id=Replay_of_Username_Token>13.10.1 Replay of Username Token</H4>
<P class=statement><SPAN class=statement-id><A name=C4210>C4210</A></SPAN> Any 
<SPAN class=statement-target>SECURITY_TOKEN</SPAN> named wsse:UsernameToken that 
contains a wsse:Nonce element and a wsse:Password element with a Type attribute 
value of 
&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText&quot; 
SHOULD be referenced by a ds:Reference in a SIGNATURE in order to prevent 
replay. </P>
<P class=statement><SPAN class=statement-id><A name=C4211>C4211</A></SPAN> Any 
<SPAN class=statement-target>SECURITY_TOKEN</SPAN> named wsse:UsernameToken that 
contains a wsu:Created element and a wsse:Password element with a Type attribute 
value of 
&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText&quot; 
SHOULD be referenced by a ds:Reference in a SIGNATURE in order to prevent 
replay. </P></DIV>
<H3 id=digVClearPass>13.11 Use of Digest vs. Cleartext Password</H3>
<P><SPAN class=statement-target></SPAN>A sending application utilizing password 
authentication must decide whether to use a cleartext password or a password 
digest (The sender needs to know via some out-of-band mechanism and/or prior 
arrangement which mechanisms the receiver supports). The digest should always be 
preferred if it can be used, as the digest algorithm does not reveal the 
password and can protect against replay of the password. (It does not however, 
protect against offline guessing or brute force attacks.)</P>
<P><SPAN class=statement-target></SPAN>Password digests can only be used in 
situations where both sender and receiver can start with the same secret value 
(e.g., the cleartext password or a hash of the password). The following are 
criteria for considering when to use digests vs. cleartext:</P>
<P><SPAN class=statement-target></SPAN>1. If the receiver can access the 
cleartext password, a digest may be used. </P>
<P><SPAN class=statement-target></SPAN>2. If the receiver can access a value 
that can be derived by the sender directly from the cleartext password (e.g., 
the receiver has access to a SHA1 hash of the password), the derived value (e.g. 
the hash) may be used in the digest. </P>
<P><SPAN class=statement-target></SPAN>3. If the sender needs extra information 
to derive the value available to the receiver, it will not be feasible to use 
password digest, even though the information is not intentionally secret. For 
example, UNIX systems add a salt value to each password before hashing it. It is 
infeasible for the sender to discover the salt value required for a specific 
username.</P>
<P><SPAN class=statement-target></SPAN>4. If the receiver does not have access 
to any password value, derived or otherwise, but merely the ability to test a 
username/password combination for validity, a digest may not be used. An example 
of this is when the username/password combination is presented to a database, 
directory or mainframe system for verification.</P>
<P><SPAN class=statement-target></SPAN>When sending any form of a password, 
cleartext or digest, confidentiality services are strongly recommended to 
prevent its value from being revealed or from offline guessing.</P>
<H3 id=encSig>13.12 Encryption with Signatures</H3>
<P><SPAN class=statement-target></SPAN>When a message contains a data value 
which does not have a significant number of probable variations and that data is 
signed and then encrypted, it is recommended that the sender either include some 
suitably random value such as a wsse:Nonce in the data, or encrypt the related 
ds:DigestValue element in order to protect the confidentiality of the data.</P>
<P><SPAN class=statement-target></SPAN>An adversary can compute the digest for 
each data values and compare them against the digests in the signature thereby 
deducing the encrypted data value. This type of attack is most likely to be 
successful when there are a relatively small set of probable data values. 
Therefore the threat can be mitigated by introduction of some random value into 
the original data or encryption of the digest.</P>
<DIV class=refinement>
<H4 id=Encrypt_DigestValue>13.12.1 Encrypt DigestValue</H4>
<P class=statement><SPAN class=statement-id><A name=C5630>C5630</A></SPAN> A 
<SPAN class=statement-target>SIGNATURE</SPAN> computed over data that is 
subsequently encrypted SHOULD also be encrypted in order to prevent plaintext 
guessing attacks when the probable set of data values is small. </P></DIV>
<H3 id=operr>13.13 Possible Operational Errors</H3>
<P><SPAN class=statement-target></SPAN>Under SOAP processing rules, there is no 
way a sender can be sure that a message containing a security header addressed 
to a given Role/Actor will ever reach a node that is taking on that Role/Actor. 
If not, the specified security processing will not occur.</P>
<P><SPAN class=statement-target></SPAN>Under SOAP processing rules, there is no 
way a sender can determine in what order nodes taking on specific Role/Actor's 
will be reached. If signatures and encryptions specified in different security 
headers overlap, verification and decryption operations may fail as a result of 
being processed in the wrong order. (Generally overlapping signatures will 
verify regardless of the order of verification.) This problem can be avoided by 
never specifying overlapping operations in distinct headers, however application 
requirements may not prevent this. For example, many senders may wish to include 
the entire Body under a signature, possibly before or after encrypting portions 
of it.</P>
<P><SPAN class=statement-target></SPAN>Under SOAP processing rules, there is no 
way a sender can determine which particular secrets are possessed by a node 
taking on a given Role/Actor. If a node is required to perform decryption or 
verify an HMAC and it does not posses the necessary secret, it will be unable to 
perform these operations. This will not only impact its operation, but in the 
case it is an intermedairy may make it possible for nodes receiving the message 
subsequently from performing security processing correctly due to overlapping 
operations, even when that node does posses the necessary secrets.</P>
<P><SPAN class=statement-target></SPAN>If a namespace that is in fact visibly 
used within some text to be Canonicalized via the Exclusive C14N Algorithm is 
included in the InclusiveNamespaces PrefixList, then under some valid 
transformations of the transmitted document signature verification may 
spuriously fail, because the Canonicalized form shifts the location of of a 
namespace declaration. This case is expected to be rare in practice.</P>
<H2 id=references>Appendix A: Referenced Specifications</H2>
<P>The following specifications' requirements are incorporated into the Basic 
Security Profile 1.0 by reference, except where superseded by the Profile:</P>
<UL>
  <LI><A class=offsite href="http://www.ietf.org/rfc/rfc2818.txt">HTTP over 
  TLS</A>
  <LI><A class=offsite href="http://www.ietf.org/rfc/rfc2246.txt">The TLS 
  Protocol Version 1.0</A>
  <LI><A class=offsite href="http://wp.netscape.com/eng/ssl3/ssl-toc.html">The 
  SSL Protocol Version 3.0</A>
  <LI><A class=offsite 
  href="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0.pdf">Web 
  Services Security: SOAP Message Security 1.0 (WS-Security 2004) OASIS Standard 
  200401, March 2004</A>
  <LI><A class=offsite 
  href="http://www.oasis-open.org/committees/download.php/11146/oasis-200401-wss-soap-message-security-1.0-errata-004.pdf">Web 
  Services Security: SOAP Message Security 1.0 (WS-Security 2004) Errata 1.0 
  Committee Draft 200401, October 2004</A>
  <LI><A class=offsite 
  href="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0.pdf">Web 
  Services Security UsernameToken Profile 1.0 OASIS Standard 200401, March 
  2004</A>
  <LI><A class=offsite 
  href="http://www.oasis-open.org/committees/download.php/11143/oasis-200401-wss-username-token-profile-1.0-errata-003.pdf">Web 
  Services Security: UsernameToken Profile 1.0 Errata 1.0 Committee Draft 
  200401, September 2004</A>
  <LI><A class=offsite 
  href="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0.pdf">Web 
  Services Security X.509 Certificate Token Profile OASIS Standard 200401, March 
  2004</A>
  <LI><A class=offsite 
  href="http://www.oasis-open.org/committees/download.php/11145/oasis-200401-x509-token-profile-1.0-errata-004.pdf">Web 
  Services Security: X.509 Token Profile 1.0 Errata 1.0 Committee Draft 200401, 
  October 2004</A>
  <LI><A class=offsite href="http://www.ietf.org/rfc/rfc2459.txt">RFC2459: 
  Internet X.509 Public Key Infrastructure Certificate and CRL Profile</A>
  <LI><A class=offsite 
  href="http://www.itu.int/rec/recommendation.asp?type=items&amp;lang=e&amp;parent=T-REC-X.509-200110-I!Cor1">Information 
  technology &quot;Open Systems Interconnection&quot; The Directory: Public-key and 
  attribute certificate frameworks Technical Corrigendum 1</A>
  <LI><A class=offsite href="http://www.w3.org/TR/xmldsig-core/">XML-Signature 
  Syntax and Processing</A>
  <LI><A class=offsite 
  href="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0.pdf">Web 
  Services Security: SOAP Message Security Section 9</A>
  <LI><A class=offsite href="http://www.w3.org/TR/xmlenc-core/">XML Encryption 
  Syntax and Processing</A>
  <LI><A class=offsite 
  href="http://www.ws-i.org/Profiles/BasicProfile-1.0.html">Basic Profile 
  Version 1.0 (BP1.0)</A>
  <LI><A class=offsite 
  href="http://www.ws-i.org/Profiles/BasicProfile-1.0-errata.html">Basic Profile 
  Version 1.0 Errata</A>
  <LI><A class=offsite 
  href="http://www.ws-i.org/Profiles/BasicProfile-1.1.html">Basic Profile 
  Version 1.1 (BP1.1)</A>
  <LI><A class=offsite 
  href="http://www.ws-i.org/Profiles/SimpleSoapBindingProfile-1.0.html">Simple 
  SOAP Binding Profile Version 1.0 (SSBP1.0)</A>
  <LI><A class=offsite 
  href="http://www.ws-i.org/Profiles/Basic/2003-08/AttachmentsProfile-1.0.pdf">Attachments 
  Profile Version 1.0 (AP1.0)</A>
  <LI><A class=offsite 
  href="http://www.oasis-open.org/apps/org/workgroup/wss/download.php/10902/wss-swa-profile-1.0-cd-01.pdf">Web 
  Services Security: SOAP Messages with Attachments (SwA) Profile 
1.0</A></LI></UL>
<H2 id=points>Appendix B: Extensibility Points</H2>
<P>This section identifies extensibility points, as defined in &quot;Scope of the 
Basic Security Profile 1.0,&quot; for the Basic Security Profile 1.0's component 
specifications.</P>
<P>These mechanisms are out of the scope of the Basic Security Profile 1.0; 
their use may affect interoperability, and may require private agreement between 
the parties to a Web service.</P>
<P>In <A class=offsite href="http://www.ietf.org/rfc/rfc2246.txt">The TLS 
Protocol Version 1.0:</A></P>
<UL>
  <LI><SPAN class=statement-id>E0009</SPAN> - <STRONG>TLS Ciphersuites</STRONG> 
  - TLS allows for the use of arbitrary encryption algorithms. Note that while 
  section 10.1 of the Basic Security Profile 1.0 mandates, recommends, and 
  discourages support for certain ciphersuites, the Basic Security Profile 1.0 
  does not prohibit use of any specific ciphersuite.
  <LI><SPAN class=statement-id>E0010</SPAN> - <STRONG>TLS Extensions</STRONG> - 
  TLS allows for extensions during the handshake phase.</LI></UL>
<P>In <A class=offsite href="http://wp.netscape.com/eng/ssl3/ssl-toc.html">The 
SSL Protocol Version 3.0:</A></P>
<UL>
  <LI><SPAN class=statement-id>E0011</SPAN> - <STRONG>SSL Ciphersuites</STRONG> 
  - SSL allows for the use of arbitrary encryption algorithms. Note that while 
  section 10.1 of the Basic Security Profile 1.0 mandates, recommends, and 
  discourages support for certain ciphersuites, the Basic Security Profile 1.0 
  does not prohibit use of any specific ciphersuite.</LI></UL>
<P>In <A class=offsite 
href="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0.pdf">Web 
Services Security: SOAP Message Security 1.0 (WS-Security 2004) OASIS Standard 
200401, March 2004:</A></P>
<UL>
  <LI><SPAN class=statement-id>E0002</SPAN> - <STRONG>Security Tokens</STRONG> - 
  Security tokens may be specified in additional security token 
profiles.</LI></UL>
<P>In <A class=offsite href="http://www.ietf.org/rfc/rfc2459.txt">RFC2459: 
Internet X.509 Public Key Infrastructure Certificate and CRL Profile:</A></P>
<UL>
  <LI><SPAN class=statement-id>E0012</SPAN> - <STRONG>Certificate 
  Authority</STRONG> - The choice of the Certificate Authority is a private 
  agreement between parties.
  <LI><SPAN class=statement-id>E0013</SPAN> - <STRONG>Certificate 
  Extensions</STRONG> - X.509 allows for arbitrary certificate 
extensions.</LI></UL>
<H2 id=acks>Appendix C: Acknowledgements</H2>
<P>This document is the work of the WS-I Basic Security Profiles Working Group, 
whose members have included:</P>
<P>Steve Anderson (OpenNetwork), Paula Austel (IBM), Siddharth Bajaj (Verisign), 
Frank Balluffi (Deutsche Bank), Abbie Barbir (Nortel), David Baum (Kantega AS), 
Randy Bias (Grand Central Communications), Tim Bond (webMethods, Inc.), Heidi 
Buelow (Quovadx), David Burdett (Commerce One, Inc.), Ted Burghart (Hitachi, 
Ltd.) Symon Chang (Commerce One, Inc.), Richard Chennault, (Kaiser Permanente), 
Dipak Chopra (SAP AG), Jamie Clark (OASIS), Edward Cobb (BEA Systems, Inc.), 
David Cohen (Merrill Lynch), Brett Cooper, (Accenture), Ugo Corda (SeeBeyond 
Technology), Paul Cotton (Microsoft Corporation), Suresh Damodaran, 
(Rosettanet), Mark Davis (Sarvega, Inc.), Alex Deacon (Verisign), Thomas 
DeMartini (ContentGuard, Inc.), Blake Dournaee (Sarvega, Inc.), Rob Drew 
(Charlse Schwab), Gregory Elkins (Reed Elsevier), Mark Ericson (Mindreef), Jon 
Oyvind Eriksen (Kantega AS), Chris Ferris (IBM), Bob Freund, (Hitachi), Edwin 
Goei (Sun Microsystems), Grant Goodale (Reactivity, Inc.), Marc Goodner (SAP 
AG), Phil Goodwin (Sun Microsystems), Marc Graveline (Cognos, Inc.), Eric 
Gravengaard (Reactivity, Inc.), Thomas Gross (IBM), Martin Gudgin (Microsoft 
Corporation), Marc Hadley (Sun Microsystems), Mark Hapner (Sun Microsystems), 
Nathan Harris (Kaiser Permanente), Bret Hartman (Datapower Technology, Inc.), 
Frederick Hirsch (Nokia), Jason Hogg (Microsoft Corporation), Maryann Hondo 
(IBM), Lawrence Hsiung (Quovadx), Tony Huber (Commerce Quest), Jim Hughes 
(Hewlett-Packard), Michael Hui (Computer Associates), Brian Jackson (Avanade, 
Inc.), Steve Jenisch (SAS Institute), Erik Johnson (Epicor), Chris Kaler 
(Microsoft Corporation), Anish Karmarkar (Oracle Corporation), Dana Kaufman, 
(Forum Systems), Manveen Kaur (Sun Microsystems), Slava Kavsan (RSA Security), 
Paul Knight (Nortel Networks), Chris Kurt (Microsoft Corporation), Kelvin 
Lawrence (IBM), Hal Lockhart (BEA Systems), Brad Lund (Intel Corporation), Jim 
Luth (OPC Foundation), Paul Madsen (Entrust, Inc.), Eve Maler (Sun 
Microsystems), Skip Marler (Parasoft), Axl Mattheus (Sun Microsystems), Michael 
McIntosh (IBM), Craig Milhiser, (Ascential), Chris Miller (Accenture), Dale 
Moberg (Cyclone Commerce), Ron Monzillo (Sun Microsystems), K. Scott Morrison, 
(Layer 7) Tim Moses (Entrust, Inc.), Tony Nadalin (IBM), Nataraj Nagaratnam 
(IBM), Andrew Nash (RSA Security), Hsin Ning (Bestning Technologies), Eisaku 
Nishiyama (Hitachi, Ltd.), Mark Nottingham (BEA Systems, Inc.), TJ Pannu 
(ContentGuard, Inc.), Martine Pean (Quovadx), Robert Philpott (RSA Security), 
Dave Prout (BT), Joe Pruitt (F5 Networks, Inc.), Eric Rejkovic (Oracle 
Corporation), Matt Recupito (Accenture), Jason Rouault (Hewlett-Packard), Rich 
Salz (Datapower Technology, Inc.), Matt Sanchez (Webify Solutions, Inc. ), Jerry 
Schwarz (Oracle Corporation), Senthil Sengodan (Nokia), Shawn Sharp (Cyclone 
Commerce), Aslak Siira (F5 Networks, Inc.), David Solo (Citigroup, Inc. ), 
Davanum Srinivas (Computer Associates), Raghavan Srinivas (Sun Microsystems), 
John Stanton (Defense Information Systems Agency), Andrew Stone (Accenture), 
Julie Surer (MITRE), Wes Swenson (Forum Systems), Dino Vitale (Citigroup, Inc.), 
Jonathan Wenocur (Datapower Technology, Inc.), Pete Wenzel (SeeBeyond 
Technology), Ian White (Micro Focus) </P></BODY></HTML>
