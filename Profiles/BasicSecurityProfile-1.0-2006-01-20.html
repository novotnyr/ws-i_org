<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=us-ascii">
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html                                     >
  <head>
    <title>Basic Security Profile - 
					Version 1.0 
					(WGD)
				</title>
    <style type="text/css">
                     body { color: black; background: white; font-family: sans-serif; margin: 16pt 24pt; }
                     dt { font-style: italic; padding-top: 0.5em; }
                     h4 { font-weight: normal; font-style: italic; font-size: 0.8em; margin-bottom: 0; }
                     .refinement { margin: 18pt 0em; }
                    .statement { font-style: italic; margin: 0.5em 5.5em; text-indent: -4em; }
                    .statement-id { background-color: #ffa; font-style: normal; padding: 0em 0.3em; }
					.statement-target { font-weight: bold; font-style: normal;  }
                    .statement-type { background-color: #ccf; font-style: normal; padding: 0em 0.3em; font-size: 0.7em; vertical-align: text-top; }
                    .statement-origin { background-color: #fcc; font-style: normal; padding: 0em 0.3em; font-size: 0.7em; vertical-align: text-top; }
                    .rationale { margin: 0.5em 0em;  }
                    .explanation { margin: 0.5em 0em; }
                    .definition { margin: 0.5em 5.5em;}
                    .explanation p, .rationale p { margin: 0.25em 0; }
                    .practice { background-color: green; }
                    .example { background-color: #eee; margin: 0.5em 2em; padding: 0.5em; }
                    .example-banner { margin: 0; }
                    .example pre { margin: 0; }
                    .correct, .incorrect { font-family: sans-serif; font-weight: bold; font-size: 0.9em; margin: 0; }
                    .correct { color: #090; }
                    .incorrect { color: #900; }
                    .specification { padding: 0.5em; background-color: #ffa; margin: 0.5em 2em; }
                    .ednote { margin: 1.2em; padding: 1.2em; background-color: #fcc; }
                    .note { background-color: #fcc; margin-left: 1.5em; }
                    .toc { margin-left: 2em; }
                    .subtoc { margin-left: 3em; }
                    .subsubtoc { margin-left: 4em; }
                    .chg { background-color: orange; text-decoration: underline; }
                    .add { background-color: green; text-decoration: underline; }
                    .del { background-color: red; text-decoration: line-through; }
                    media print {
                        a.offsite:after { font-size: 85%; font-weight: lighter; }
                    } 
                    [id]:hover:after { font-size: 50%; color: #ccc; text-decoration: none; }
		        </style>
  </head>
  <body>
    <div class="head">
      <p>
        <a href="http://www.ws-i.org/">
          <img src="http://www.ws-i.org/images/WS-I-logo.gif" height="88" width="107" border="0" alt="WS-I" />
        </a>
      </p>
      <h1>Basic Security Profile Version 1.0</h1>
      <h2>Working Group Draft</h2>
      <h2>2006-01-20</h2>
      <dl>
        <dt>This version:</dt>
        <dd>
          <a href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2006-01-20.html">http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2006-01-20.html
							</a>
        </dd>
        <dt>Latest version:</dt>
        <dd>
          <a href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0.html">http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0.html
							</a>
        </dd>
        <dt>Editors:</dt>
        <dd>Abbie Barbir, Nortel Networks</dd>
        <dd>Martin Gudgin, Microsoft</dd>
        <dd>Michael McIntosh, IBM</dd>
        <dd>K. Scott Morrison, Layer 7</dd>
        <dt>Administrative contact:</dt>
        <dd>
          <a href="mailto:secretary@ws-i.org">secretary@ws-i.org</a>
        </dd>
      </dl>
      <p class="copyright" id="copyright"> Copyright &#169;  2002-2006 by
			<a href="http://www.ws-i.org/">The Web Services-Interoperability
			Organization</a> (<abbr title="Web Services Interoperability&#xD;&#xA;			Organization">WS-I</abbr>) and Certain of its Members. All Rights
			Reserved.</p>
    </div>
    <hr />
    <h2 id="abstract">Abstract</h2>
    <p>This document defines the WS-I Basic Security Profile 1.0, based on a set of non-proprietary Web services specifications, along with clarifications and amendments to those specifications which promote interoperability.</p>
    <h2 id="status">Status of this Document</h2>
    <p> This document is a Working
				Group Draft; it has been accepted by the Working Group as
				reflecting the current state of discussions. It is a work in
				progress, and should not be considered authoritative or final;
				other documents may supersede this document. </p>
    <h2 id="license">Notice</h2>
    <p>The material contained herein is not a license, either expressly or
		impliedly, to any intellectual property owned or controlled by any of
		the authors or developers of this material or WS-I. The material
		contained herein is provided on an &quot;AS IS&quot; basis and to the maximum
		extent permitted by applicable law, this material is provided AS IS
		AND WITH ALL FAULTS, and the authors and developers of this material
		and WS-I hereby disclaim all other warranties and conditions, either
		express, implied or statutory, including, but not limited to, any (if
		any) implied warranties, duties or conditions of merchantability, of
		fitness for a particular purpose, of accuracy or completeness of
		responses, of results, of workmanlike effort, of lack of viruses, and
		of lack of negligence. ALSO, THERE IS NO WARRANTY OR CONDITION OF
		TITLE, QUIET ENJOYMENT, QUIET POSSESSION, CORRESPONDENCE TO
		DESCRIPTION OR NON-INFRINGEMENT WITH REGARD TO THIS MATERIAL. </p>
    <p>IN NO EVENT WILL ANY AUTHOR OR DEVELOPER OF THIS MATERIAL OR WS-I
		BE LIABLE TO ANY OTHER PARTY FOR THE COST OF PROCURING SUBSTITUTE
		GOODS OR SERVICES, LOST PROFITS, LOSS OF USE, LOSS OF DATA, OR ANY
		INCIDENTAL, CONSEQUENTIAL, DIRECT, INDIRECT, OR SPECIAL DAMAGES
		WHETHER UNDER CONTRACT, TORT, WARRANTY, OR OTHERWISE, ARISING IN ANY
		WAY OUT OF THIS OR ANY OTHER AGREEMENT RELATING TO THIS MATERIAL,
		WHETHER OR NOT SUCH PARTY HAD ADVANCE NOTICE OF THE POSSIBILITY OF
		SUCH DAMAGES.</p>
    <h2 id="feedback">Feedback</h2>
    <p>The Web Services-Interoperability Organization (WS-I)
					would like to receive input, suggestions and other
					feedback (&quot;Feedback&quot;) on this work from a wide variety of
					industry participants to improve its quality over time.
					</p>
    <p>By sending email, or otherwise communicating with WS-I, you (on
			behalf of yourself if you are an individual, and your company if
			you are providing Feedback on behalf of the company) will be
			deemed to have granted to WS-I, the members of WS-I, and other
			parties that have access to your Feedback, a non-exclusive,
			non-transferable, worldwide, perpetual, irrevocable, royalty-free
			license to use, disclose, copy, license, modify, sublicense or
			otherwise distribute and exploit in any manner whatsoever the
			Feedback you provide regarding the work. You acknowledge that you
			have no expectation of confidentiality with respect to any
			Feedback you provide. You represent and warrant that you have
			rights to provide this Feedback, and if you are providing Feedback
			on behalf of a company, you represent and warrant that you have
			the rights to provide Feedback on behalf of your company. You also
			acknowledge that WS-I is not required to review, discuss, use,
			consider or in any way incorporate your Feedback into future
			versions of its work. If WS-I does incorporate some or all of your
			Feedback in a future version of the work, it may, but is not
			obligated to include your name (or, if you are identified as
			acting on behalf of your company, the name of your company) on a
			list of contributors to the work. If the foregoing is not
			acceptable to you and any company on whose behalf you are acting,
			please do not provide any Feedback.</p>
    <p>Feedback on this document should be directed to <a href="mailto:wsi_secprofile_comment@lists.ws-i.org">wsi_secprofile_comment@lists.ws-i.org</a>.</p>
    <hr />
    <h2 id="toc">Table of Contents</h2>
    <p class="toc">1. <a href="#introduction">Introduction</a><br /><span class="subtoc">1.1. <a href="#philosophy">Guiding Principles</a></span><br />2. <a href="#documentConventions">Document Conventions</a><br /><span class="subtoc">2.1. <a href="#SecurityConsiderations">Security Considerations</a></span><br /><span class="subtoc">2.2. <a href="#conventions">Notational Conventions</a></span><br /><span class="subtoc">2.3. <a href="#versioning">Profile Identification and Versioning</a></span><br />3. <a href="#conformance">Profile Conformance</a><br /><span class="subtoc">3.1. <a href="#conformance_requirements">Conformance Requirements</a></span><br /><span class="subtoc">3.2. <a href="#conformance_targets">Conformance Targets</a></span><br /><span class="subtoc">3.3. <a href="#conformance_scope">Conformance Scope</a></span><br /><span class="subtoc">3.4. <a href="#conformance_claims">Claiming Conformance</a></span><br />4. <a href="#transportsec">Transport Layer Security</a><br /><span class="subtoc">4.1. <a href="#SSLTLS">SSL and TLS</a></span><br /><span class="subsubtoc">4.1.1. <a href="#Use_of_SSL_2.0">Use of SSL 2.0</a></span><br />5. <a href="#msgsec">SOAP Message Security</a><br /><span class="subtoc">5.1. <a href="#WSSST">Security Tokens</a></span><br /><span class="subsubtoc">5.1.1. <a href="#wsse_BinarySecurityToken/@EncodingType_Attribute">wsse:BinarySecurityToken/@EncodingType Attribute</a></span><br /><span class="subsubtoc">5.1.2. <a href="#wsse_BinarySecurityToken/@ValueType_Attribute">wsse:BinarySecurityToken/@ValueType Attribute</a></span><br /><span class="subtoc">5.2. <a href="#WSSTokenReferences">SecurityTokenReferences</a></span><br /><span class="subsubtoc">5.2.1. <a href="#Internal_References">Internal References</a></span><br /><span class="subsubtoc">5.2.2. <a href="#Shorthand_XPointer_References">Shorthand XPointer References</a></span><br /><span class="subsubtoc">5.2.3. <a href="#References_to_Preceding_Security_Tokens">References to Preceding Security Tokens</a></span><br /><span class="subsubtoc">5.2.4. <a href="#Direct_Preferred_to_Embedded_for_Internal_References">Direct Preferred to Embedded for Internal References</a></span><br /><span class="subsubtoc">5.2.5. <a href="#Direct_Required_When_Possible_for_External_References">Direct Required When Possible for External References</a></span><br /><span class="subsubtoc">5.2.6. <a href="#Format_of_Embedded_References">Format of Embedded References</a></span><br /><span class="subsubtoc">5.2.7. <a href="#Key_Name_References_Prohibited">Key Name References Prohibited</a></span><br /><span class="subsubtoc">5.2.8. <a href="#KeyIdentifier/@ValueType_Attribute">KeyIdentifier/@ValueType Attribute</a></span><br /><span class="subsubtoc">5.2.9. <a href="#KeyIdentifier/@EncodingType_Attribute">KeyIdentifier/@EncodingType Attribute</a></span><br /><span class="subsubtoc">5.2.10. <a href="#References_from_within_Embedded_Tokens">References from within Embedded Tokens</a></span><br /><span class="subsubtoc">5.2.11. <a href="#Embedded_Token_Content">Embedded Token Content</a></span><br /><span class="subsubtoc">5.2.12. <a href="#Reference_from_wsse_SecurityTokenReference_to_wsse_SecurityTokenReference">Reference from wsse:SecurityTokenReference to wsse:SecurityTokenReference</a></span><br /><span class="subsubtoc">5.2.13. <a href="#wsse_SecurityTokenReference/Reference_ValueType_Attribute">wsse:SecurityTokenReference/Reference ValueType Attribute</a></span><br /><span class="subsubtoc">5.2.14. <a href="#wsse_SecurityTokenReference_content">wsse:SecurityTokenReference content</a></span><br /><span class="subsubtoc">5.2.15. <a href="#wsse_SecurityTokenReference/Reference_requires_URI_attribute">wsse:SecurityTokenReference/Reference requires URI attribute</a></span><br /><span class="subsubtoc">5.2.16. <a href="#wsse_SecurityTokenReference_Dereferencing_Transform">wsse:SecurityTokenReference Dereferencing Transform</a></span><br /><span class="subsubtoc">5.2.17. <a href="#Security_Token_References_across_security_headers_prohibited">Security Token References across security headers prohibited</a></span><br /><span class="subtoc">5.3. <a href="#WSSTimeStamp">Timestamps</a></span><br /><span class="subsubtoc">5.3.1. <a href="#wsu_Timestamp/wsu_Created">wsu:Timestamp/wsu:Created</a></span><br /><span class="subsubtoc">5.3.2. <a href="#Occurence_constraints_on	wsu_Created_and_wsu_Expires_">Occurence constraints on	wsu:Created and wsu:Expires </a></span><br /><span class="subsubtoc">5.3.3. <a href="#Leap_Seconds_Not_Allowed">Leap Seconds Not Allowed</a></span><br /><span class="subsubtoc">5.3.4. <a href="#Timestamp_ValueType">Timestamp ValueType</a></span><br /><span class="subsubtoc">5.3.5. <a href="#Timestamp_Format">Timestamp Format</a></span><br /><span class="subsubtoc">5.3.6. <a href="#Timestamp_Resolution">Timestamp Resolution</a></span><br /><span class="subsubtoc">5.3.7. <a href="#wsu_Timestamp_inside_wsse_Security_header_">wsu:Timestamp inside wsse:Security header </a></span><br /><span class="subtoc">5.4. <a href="#WSSReferences">wsu:Id References</a></span><br /><span class="subsubtoc">5.4.1. <a href="#wsu_Id_Attribute_Uniqueness">wsu:Id Attribute Uniqueness</a></span><br /><span class="subtoc">5.5. <a href="#WSSProcessing">wsse:Security Processing Order</a></span><br /><span class="subsubtoc">5.5.1. <a href="#Order_of_Processing">Order of Processing</a></span><br /><span class="subtoc">5.6. <a href="#WSSActor">SOAP Actor</a></span><br /><span class="subsubtoc">5.6.1. <a href="#SOAP_Actor_Value">SOAP Actor Value</a></span><br />6. <a href="#usernametoken">Username Token Profile</a><br /><span class="subtoc">6.1. <a href="#tokenusage">Token Usage</a></span><br /><span class="subsubtoc">6.1.1. <a href="#wsse_UsernameToken/wsse_Password/@Type">wsse:UsernameToken/wsse:Password/@Type</a></span><br /><span class="subsubtoc">6.1.2. <a href="#UsernameToken_Contents">UsernameToken Contents</a></span><br /><span class="subsubtoc">6.1.3. <a href="#PasswordDigest">PasswordDigest</a></span><br /><span class="subsubtoc">6.1.4. <a href="#ValueType_attribute">ValueType attribute</a></span><br /><span class="subsubtoc">6.1.5. <a href="#Nonce_EncodingType_attribute">Nonce EncodingType attribute</a></span><br /><span class="subsubtoc">6.1.6. <a href="#Reference_by_KeyIdentifier">Reference by KeyIdentifier</a></span><br /><span class="subsubtoc">6.1.7. <a href="#Key_Derivation">Key Derivation</a></span><br />7. <a href="#x509token">X.509 Certificate Token Profile</a><br /><span class="subtoc">7.1. <a href="#x509tokentypes">Token Types</a></span><br /><span class="subsubtoc">7.1.1. <a href="#Certificate_Path_Format">Certificate Path Format</a></span><br /><span class="subsubtoc">7.1.2. <a href="#Key_Identifier_or_X509IssuerSerial_for_External_References">Key Identifier or X509IssuerSerial for External References</a></span><br /><span class="subsubtoc">7.1.3. <a href="#KeyIdentifier">KeyIdentifier</a></span><br /><span class="subsubtoc">7.1.4. <a href="#KeyIdentifier_EncodingType">KeyIdentifier EncodingType</a></span><br /><span class="subsubtoc">7.1.5. <a href="#X509IssuerSerial_Encoding">X509IssuerSerial Encoding</a></span><br />8. <a href="#xmlSignature">XML-Signature</a><br /><span class="subtoc">8.1. <a href="#xmlSignatureGeneral">General Constraints on XML Signature</a></span><br /><span class="subsubtoc">8.1.1. <a href="#Signature_Content">Signature Content</a></span><br /><span class="subsubtoc">8.1.2. <a href="#Signature_Types">Signature Types</a></span><br /><span class="subtoc">8.2. <a href="#WSSIDRef">Element References in XML Signature</a></span><br /><span class="subsubtoc">8.2.1. <a href="#Reference_to_Elements_by_Shorthand_XPointer_(XMLDSIG)">Reference to Elements by Shorthand XPointer (XMLDSIG)</a></span><br /><span class="subsubtoc">8.2.2. <a href="#Reference_to_Elements_by_XPath_Expression">Reference to Elements by XPath Expression</a></span><br /><span class="subtoc">8.3. <a href="#xmlSignatureAlgorithms">XML Signature Algorithms</a></span><br /><span class="subsubtoc">8.3.1. <a href="#Use_Exclusive_C14N">Use Exclusive C14N</a></span><br /><span class="subsubtoc">8.3.2. <a href="#Transforms_Element">Transforms Element</a></span><br /><span class="subsubtoc">8.3.3. <a href="#Transform_Element">Transform Element</a></span><br /><span class="subsubtoc">8.3.4. <a href="#Digest_Algorithm">Digest Algorithm</a></span><br /><span class="subsubtoc">8.3.5. <a href="#Key_Signature_Algorithms">Key Signature Algorithms</a></span><br /><span class="subsubtoc">8.3.6. <a href="#Transform_Algorithm">Transform Algorithm</a></span><br /><span class="subtoc">8.4. <a href="#xmlSignatureSyntax">XML Signature Syntax</a></span><br /><span class="subsubtoc">8.4.1. <a href="#ds_HMACOutputLength">ds:HMACOutputLength</a></span><br /><span class="subsubtoc">8.4.2. <a href="#ds_KeyInfo_with_ds_Signature">ds:KeyInfo with ds:Signature</a></span><br /><span class="subsubtoc">8.4.3. <a href="#ds_Manifest">ds:Manifest</a></span><br /><span class="subsubtoc">8.4.4. <a href="#Encrypting_signatures">Encrypting signatures</a></span><br />9. <a href="#xmlEncryption">XML Encryption</a><br /><span class="subtoc">9.1. <a href="#xmlEncryptProcessing">XML Encryption Processing Model</a></span><br /><span class="subsubtoc">9.1.1. <a href="#xenc_ReferenceList">xenc:ReferenceList</a></span><br /><span class="subsubtoc">9.1.2. <a href="#xenc_EncryptedKey">xenc:EncryptedKey</a></span><br /><span class="subtoc">9.2. <a href="#xmlEncryptionKeys">XML Encryption Syntax</a></span><br /><span class="subsubtoc">9.2.1. <a href="#Placement">Placement</a></span><br /><span class="subsubtoc">9.2.2. <a href="#Prohibited_xenc_EncryptedKey_attributes">Prohibited xenc:EncryptedKey attributes</a></span><br /><span class="subsubtoc">9.2.3. <a href="#xenc_EncryptedData_contents">xenc:EncryptedData contents</a></span><br /><span class="subsubtoc">9.2.4. <a href="#xenc_EncryptedData_attributes">xenc:EncryptedData attributes</a></span><br /><span class="subsubtoc">9.2.5. <a href="#References_from_xenc_EncryptedData">References from xenc:EncryptedData</a></span><br /><span class="subsubtoc">9.2.6. <a href="#xenc_EncryptionMethod_mandatory">xenc:EncryptionMethod mandatory</a></span><br /><span class="subsubtoc">9.2.7. <a href="#xenc_EncryptedKey/@Recipient">xenc:EncryptedKey/@Recipient</a></span><br /><span class="subsubtoc">9.2.8. <a href="#ds_KeyInfo_with_Encryption">ds:KeyInfo with Encryption</a></span><br /><span class="subsubtoc">9.2.9. <a href="#xenc_EncryptedData">xenc:EncryptedData</a></span><br /><span class="subsubtoc">9.2.10. <a href="#SOAP_Envelope">SOAP Envelope</a></span><br /><span class="subtoc">9.3. <a href="#ElementReferencesinXMLEncryption">Element References in XML Encryption</a></span><br /><span class="subsubtoc">9.3.1. <a href="#Reference_to_Elements_by_Shorthand_XPointer_(XMLENC)">Reference to Elements by Shorthand XPointer (XMLENC)</a></span><br /><span class="subtoc">9.4. <a href="#xmlEncryptionAlgorithms">XML Encryption Algorithms</a></span><br /><span class="subsubtoc">9.4.1. <a href="#Data_Encryption_Algorithms">Data Encryption Algorithms</a></span><br /><span class="subsubtoc">9.4.2. <a href="#Key_Transport_Algorithms">Key Transport Algorithms</a></span><br /><span class="subsubtoc">9.4.3. <a href="#Key_Wrap_Algorithms">Key Wrap Algorithms</a></span><br />10. <a href="#algorithms">Algorithms</a><br /><span class="subtoc">10.1. <a href="#tlssslalg">Transport Level Security Algorithms</a></span><br /><span class="subsubtoc">10.1.1. <a href="#Mandatory_ciphersuites">Mandatory ciphersuites</a></span><br /><span class="subsubtoc">10.1.2. <a href="#Recommended_ciphersuites">Recommended ciphersuites</a></span><br /><span class="subsubtoc">10.1.3. <a href="#Discouraged_ciphersuites">Discouraged ciphersuites</a></span><br /><span class="subsubtoc">10.1.4. <a href="#Prohibited_ciphersuites">Prohibited ciphersuites</a></span><br />11. <a href="#reltoBasicProfile">Relationship of Basic Security Profile as an Extension to Basic Profile</a><br /><span class="subtoc">11.1. <a href="#bpclarify">Basic Profile Clarifications</a></span><br /><span class="subsubtoc">11.1.1. <a href="#BP_Requirement_R2301">BP Requirement R2301</a></span><br /><span class="subsubtoc">11.1.2. <a href="#BP_Requirement_R2710">BP Requirement R2710</a></span><br /><span class="subsubtoc">11.1.3. <a href="#BP_Requirement_R2712">BP Requirement R2712</a></span><br /><span class="subsubtoc">11.1.4. <a href="#BP_Requirement_R2724">BP Requirement R2724</a></span><br /><span class="subsubtoc">11.1.5. <a href="#BP_Requirement_R2725">BP Requirement R2725</a></span><br /><span class="subsubtoc">11.1.6. <a href="#BP_Requirement_R2729">BP Requirement R2729</a></span><br /><span class="subsubtoc">11.1.7. <a href="#BP_Requirement_R2738">BP Requirement R2738</a></span><br /><span class="subsubtoc">11.1.8. <a href="#BP_Requirement_R1029">BP Requirement R1029</a></span><br />12. <a href="#attachsec">Attachment Security</a><br /><span class="subtoc">12.1. <a href="#swa">SOAP with Attachments</a></span><br /><span class="subsubtoc">12.1.1. <a href="#Conformance">Conformance</a></span><br /><span class="subsubtoc">12.1.2. <a href="#Relationship_between_Parts">Relationship between Parts</a></span><br /><span class="subsubtoc">12.1.3. <a href="#Encryption_and_Root_Part">Encryption and Root Part</a></span><br /><span class="subtoc">12.2. <a href="#signedAttachments">Signed Attachments</a></span><br /><span class="subsubtoc">12.2.1. <a href="#Reference_to_Signed_Attachments">Reference to Signed Attachments</a></span><br /><span class="subsubtoc">12.2.2. <a href="#Attachment_Transforms">Attachment Transforms</a></span><br /><span class="subsubtoc">12.2.3. <a href="#Canonicalization">Canonicalization</a></span><br /><span class="subsubtoc">12.2.4. <a href="#Digest_Values">Digest Values</a></span><br /><span class="subsubtoc">12.2.5. <a href="#Content-Type">Content-Type</a></span><br /><span class="subtoc">12.3. <a href="#encryptedAttachments">Encrypted Attachments</a></span><br /><span class="subsubtoc">12.3.1. <a href="#References_to_Encrypted_Attachments">References to Encrypted Attachments</a></span><br /><span class="subsubtoc">12.3.2. <a href="#Type_attribute">Type attribute</a></span><br /><span class="subsubtoc">12.3.3. <a href="#Reference_URIs">Reference URIs</a></span><br /><span class="subsubtoc">12.3.4. <a href="#Content">Content</a></span><br />13. <a href="#seccon">Security Considerations</a><br /><span class="subtoc">13.1. <a href="#transportsecConsiderations">SOAPAction Header</a></span><br /><span class="subsubtoc">13.1.1. <a href="#SOAPAction_header">SOAPAction header</a></span><br /><span class="subtoc">13.2. <a href="#clockSynch">Clock Synchronization</a></span><br /><span class="subtoc">13.3. <a href="#bindSTtoSigs">Security Token Substitution</a></span><br /><span class="subsubtoc">13.3.1. <a href="#Security_Token_Substitution">Security Token Substitution</a></span><br /><span class="subsubtoc">13.3.2. <a href="#Security_Token_Reference_in_Subsequent_Messages">Security Token Reference in Subsequent Messages</a></span><br /><span class="subtoc">13.4. <a href="#removalModXML">Protecting against removal and modification of XML Elements</a></span><br /><span class="subtoc">13.5. <a href="#trustWhatIsSigned">Only What is Signed is Protected</a></span><br /><span class="subtoc">13.6. <a href="#usesha1">Use of SHA1</a></span><br /><span class="subtoc">13.7. <a href="#uniqueIds">Uniqueness of ID attributes</a></span><br /><span class="subtoc">13.8. <a href="#signSTs">Signing Security Tokens</a></span><br /><span class="subtoc">13.9. <a href="#signUTs">Signing Username Tokens</a></span><br /><span class="subtoc">13.10. <a href="#signBTs">Signing Binary Tokens</a></span><br /><span class="subtoc">13.11. <a href="#signXTs">Signing XML Tokens</a></span><br /><span class="subtoc">13.12. <a href="#replayUTs">Replay of Username Token</a></span><br /><span class="subsubtoc">13.12.1. <a href="#Replay_of_Username_Token">Replay of Username Token</a></span><br /><span class="subtoc">13.13. <a href="#digVClearPass">Use of Digest vs. Cleartext Password</a></span><br /><span class="subtoc">13.14. <a href="#encSig">Encryption with Signatures</a></span><br /><span class="subsubtoc">13.14.1. <a href="#Encrypt_DigestValue">Encrypt DigestValue</a></span><br /><span class="subtoc">13.15. <a href="#operr">Possible Operational Errors</a></span><br />
                Appendix A: <a href="#references">Referenced Specifications</a><br />
                Appendix B: <a href="#points">Extensibility Points</a><br />
            Appendix C: <a href="#acks">Acknowledgements</a><br /></p>
    <h2 id="introduction">1. Introduction</h2>
    <p><span class="statement-target"></span>This document defines the WS-I Basic Security Profile 1.0 (hereafter, &quot;Profile&quot;), consisting of a set
             of non-proprietary Web services specifications, along with clarifications to and amplifications of
             those specifications which promote interoperability.</p>
    <p><span class="statement-target"></span>Section 1, <em><span class="statement-target"></span>&quot;Introduction,&quot;</em><span class="statement-target"></span> introduces the Basic Security Profile 1.0 and relates the philosophy that it
             takes with regard to interoperability.</p>
    <p><span class="statement-target"></span>Section 2, <em><span class="statement-target"></span>&quot;Document Conventions,&quot;</em><span class="statement-target"></span> describes notational conventions utilized by the Basic Security Profile 1.0.</p>
    <p><span class="statement-target"></span>Section 3, <em><span class="statement-target"></span>&quot;Profile Conformance,&quot;</em><span class="statement-target"></span> explains what it means to be conformant to the Basic Security Profile 1.0. </p>
    <p><span class="statement-target"></span>Each subsequent section addresses a component of the Basic Security Profile 1.0, and consists of two parts: 
             an overview detailing the component specifications and their extensibility points, followed by subsections 
             that address individual parts of the component specifications. Note that there is no relationship between the section numbers
             in this document and those in the referenced specifications.</p>
    <h3 id="philosophy">1.1 Guiding Principles</h3>
    <p><span class="statement-target"></span>The Profile was developed according to a set of principles that, together, form the philosophy of the
				Basic Security Profile 1.0, as it relates to bringing about interoperability. This section documents these guidelines.</p>
    <dl>
      <dt><span class="statement-target"></span>No guarantee of interoperability</dt>
      <dd><span class="statement-target"></span>Although it is impossible to completely guarantee the interoperability of a particular service, the Basic Security
				Profile 1.0 attempts to increase interoperability by addressing the most common problems that implementation experience
				has revealed to date.</dd>
      <dt><span class="statement-target"></span>Focus profiling effort</dt>
      <dd><span class="statement-target"></span>The focus of the Basic Security Profile 1.0 is the specifications that are explicitly defined as in-scope for the
				Basic Security Profile 1.0. Other specifications are profiled to the minimal extent necessary to allow meaningful profiling
				of the scoped specifications. This allows an in-depth profile of the scoped specifications with reduced constraining of
				other specifications.</dd>
      <dt><span class="statement-target"></span>Application semantics</dt>
      <dd><span class="statement-target"></span>Although communication of application semantics can be facilitated by the technologies that comprise the Basic
				Security Profile 1.0, assuring the common understanding of those semantics is not addressed by it.</dd>
      <dt><span class="statement-target"></span>Testability</dt>
      <dd><span class="statement-target"></span>When possible, the Basic Security Profile 1.0 makes statements that are testable. However, such testability is not
				required. Preferably, testing is achieved in a non-intrusive manner (e.g., examining artifacts &quot;on the wire&quot;).
                Note: Due to the nature of cryptographic security, non-intrusive testing may not be possible.</dd>
      <dt><span class="statement-target"></span>Strength of requirements</dt>
      <dd><span class="statement-target"></span>The Profile makes strong requirements (e.g., MUST, MUST NOT) wherever feasible; if there are legitimate cases where such
                a requirement cannot be met, conditional requirements (e.g., MAY, SHOULD, SHOULD NOT) are used. Optional and conditional
				requirements introduce ambiguity and mismatches between implementations.</dd>
      <dt><span class="statement-target"></span>Restriction vs. relaxation</dt>
      <dd><span class="statement-target"></span>When amplifying the requirements of referenced specifications (including the Basic Profile 1.0), the Basic Security
				Profile 1.0 may restrict them, but does not relax them (e.g., change a MUST to a MAY).</dd>
      <dt><span class="statement-target"></span>Multiple mechanisms</dt>
      <dd><span class="statement-target"></span>If a referenced specification allows multiple mechanisms to be used interchangeably to achieve the same goal, 
                the Basic Security Profile 1.0 selects those that are well-understood, widely implemented and useful. Extraneous or
				underspecified mechanisms and extensions introduce complexity and therefore reduce interoperability.</dd>
      <dt><span class="statement-target"></span>Future compatibility</dt>
      <dd><span class="statement-target"></span>When possible, the Basic Security Profile 1.0 aligns its requirements with in-progress revisions to the
				specifications it references (e.g., Web Services Security). This aids implementers by enabling a graceful transition,
				and assures that WS-I does not 'fork' from these efforts. When the Basic Security Profile 1.0 cannot address an
                issue in a specification it references, this information is communicated to the appropriate body to assure its
				consideration.</dd>
      <dt><span class="statement-target"></span>Compatibility with deployed services</dt>
      <dd><span class="statement-target"></span>Backwards compatibility with deployed Web services is not a goal for the Basic Security Profile 1.0, but due
				consideration is given to it; the Profile does not introduce a change to the requirements of a referenced specification
                unless doing so addresses specific interoperability issues.</dd>
      <dt><span class="statement-target"></span>Focus on interoperability</dt>
      <dd><span class="statement-target"></span>Although there are potentially a number of inconsistencies and design flaws in the referenced specifications,
                the Basic Security Profile 1.0 only addresses those that affect interoperability.</dd>
      <dt><span class="statement-target"></span>Conformance targets</dt>
      <dd><span class="statement-target"></span>Where possible, the Basic Security Profile 1.0 places requirements on artifacts (e.g., WSDL descriptions, SOAP
				messages) rather than the producing or consuming software's behaviors or roles. Artifacts are concrete, making them
                easier to verify and therefore making conformance easier to understand and less error-prone.</dd>
      <dt><span class="statement-target"></span>Lower-layer interoperability</dt>
      <dd><span class="statement-target"></span>The Profile speaks to interoperability at the web-services layer only; it assumes that interoperability of
				lower-layer protocols (e.g. TCP, HTTP) and technologies (e.g. encryption and signature algorithms) is adequate and
				well-understood. WS-I does not attempt to assure the interoperability of these protocols and technologies as a whole.
				This assures that WS-I's expertise in and focus on Web services standards is used effectively.</dd>
      <dt><span class="statement-target"></span>Do no harm</dt>
      <dd><span class="statement-target"></span>Interoperability of security technologies does not in and of itself ensure security, and the act of combining new
				technologies and protocols is especially susceptible to security threats.  The profile takes steps to avoid
				introducing new security threats.</dd>
      <dt><span class="statement-target"></span>Best Practices</dt>
      <dd><span class="statement-target"></span>It is not the intent of the Basic Security Profile 1.0 to define security best practices. However, when multiple
				options exist, we may use known security weaknesses as a means of reducing choice and thus enhancing interoperability.
				The Basic Security Profile 1.0 will offer non-normative security considerations where the authors deem appropriate;
				however, these are by no means exhaustive and should not be perceived as a sanctioning of a security best practice.</dd>
      <dt><span class="statement-target"></span>Selected Errata Inclusion</dt>
      <dd><span class="statement-target"></span>The Basic Security Profile 1.0 restates selected requirements from the WS-Security Errata rather than including
				the entire Errata by reference, prefering interoperability over strict conformance.</dd>
    </dl>
    <h2 id="documentConventions">2. Document Conventions</h2>
    <p><span class="statement-target"></span>This document follows conventions common to all WS-I profiles.
            These are described in the following sections.</p>
    <h3 id="SecurityConsiderations">2.1 Security Considerations</h3>
    <p><span class="statement-target"></span>In addition to interoperability recommendations (which are made in Rnnnn statements and intended to improve
			interoperability), the Basic Security Profile 1.0 makes a number of security recommendations intended to improve
			security. These Security Considerations are presented as follows:</p>
    <p class="statement">
      <span class="statement-id"><span class="statement-target"></span>Cnnnn</span><span class="statement-target"></span> Statement text here.
		  </p>
    <p><span class="statement-target"></span>where &quot;nnnn&quot; is replaced by a number that is unique among the security recommendations in the Basic Security
				Profile 1.0, thereby forming a unique security recommendation identifier. Each security recommendation contains
				a <em><span class="statement-target"></span>SHOULD</em><span class="statement-target"></span> or a <em><span class="statement-target"></span>MAY</em><span class="statement-target"></span> to highlight exactly what is being recommended; however, these
				recommendations are informational only and are non-normative. Though security recommendations are expected to be
				tested by the test tools to highlight possible security problems, security recommendations have no impact on
				conformance.</p>
    <p><span class="statement-target"></span>It should be understood that, while a number of recommendations are made about security, adherence to these security
				recommendations does not guarantee security.</p>
    <h3 id="conventions">2.2 
            Notational Conventions
        </h3>
    <p>The keywords &quot;MUST&quot;, &quot;MUST NOT&quot;, &quot;REQUIRED&quot;, &quot;SHALL&quot;, &quot;SHALL NOT&quot;,
        &quot;SHOULD&quot;, &quot;SHOULD NOT&quot;, &quot;RECOMMENDED&quot;, &quot;MAY&quot;, and &quot;OPTIONAL&quot; in this
        document are to be interpreted as described in <a class="offsite" href="http://www.ietf.org/rfc/rfc2119.txt">RFC2119</a>.</p>
    <p>Normative statements of requirements in 
		  the Basic Security Profile 1.0 (i.e., those
        impacting conformance, as outlined in &quot;<a href="#conformance_requirements">Conformance Requirements</a>&quot;) are
        presented in the following manner:</p>
    <p class="statement">
      <span class="statement-id">Rnnnn</span>Statement
        text here.</p>
    <p>where &quot;nnnn&quot; is replaced by a number that is unique among the
        requirements in 
		  the Basic Security Profile 1.0, thereby forming a unique requirement
        identifier.</p>
    <p>Requirement identifiers can be considered to be namespace
        qualified, in such a way as to be compatible with QNames from <a class="offsite" href="http://www.w3.org/TR/REC-xml-names/">Namespaces in XML</a>. If
        there is no explicit namespace prefix on a requirement's identifier
        (e.g., &quot;R9999&quot; as opposed to &quot;bp10:R9999&quot;), it should be interpreted
        as being in the namespace identified by the conformance URI of the
        document section it occurs in. If it is qualified, the prefix should
        be interpreted according to the namespace mappings in effect, as
        documented below.</p>
    <p>Some requirements clarify the referenced specification(s), but do not
        place additional constraints upon implementations. For convenience,
        clarifications are annotated in the following manner: <span class="statement-type">C</span></p>
    <p>Some requirements are derived from ongoing standardization work on
        the referenced specification(s). For convenience, such forward-derived
        statements are annotated in the following manner: <span class="statement-origin">xxxx</span>, where &quot;xxxx&quot; is an identifier
        for the specification (e.g., &quot;WSDL20&quot; for WSDL Version 2.0). Note that
        because such work was not complete when this document was published,
        the specification that the requirement is derived from may change;
        this information is included only as a convenience to
        implementers.</p>
    <p>Extensibility points in underlying specifications (see &quot;<a href="#conformance_scope">Conformance Scope</a>&quot;) are presented in a similar
        manner:</p>
    <p class="statement">
      <span class="statement-id">Ennnn</span>Extensibility
        Point Name - Description</p>
    <p>where &quot;nnnn&quot; is replaced by a number that is unique among the extensibility
        points in 
		  the Basic Security Profile 1.0. As with requirement statements, extensibility statements
        can be considered namespace-qualified.</p>
    <p>This specification uses a number of namespace prefixes throughout;
            their associated URIs are listed below. Note that the choice of any
            namespace prefix is arbitrary and not semantically significant.</p>
    <ul>
      <li>
        <strong>soap</strong> - &quot;http://schemas.xmlsoap.org/soap/envelope/&quot;</li>
      <li>
        <strong>xsd</strong> - &quot;http://www.w3.org/2001/XMLSchema&quot;</li>
      <li>
        <strong>wsi</strong> - &quot;http://www.ws-i.org/schemas/conformanceClaim&quot;</li>
      <li>
        <strong>ds</strong> - &quot;http://www.w3.org/2000/09/xmldsig#&quot;&quot;</li>
      <li>
        <strong>xenc</strong> - &quot;http://www.w3.org/2001/04/xmlenc#&quot;</li>
      <li>
        <strong>c14n</strong> - &quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot;</li>
      <li>
        <strong>wsse</strong> - &quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd&quot;</li>
      <li>
        <strong>wsu</strong> - &quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd&quot;</li>
      <li>
        <strong>b10</strong> - &quot;http://www.ws-i.org/Profiles/Basic/2003-08/BasicProfile-1.0a.htm&quot;</li>
      <li>
        <strong>bp11</strong> - &quot;http://www.ws-i.org/Profiles/BasicProfile-1.1.html&quot;</li>
    </ul>
    <h3 id="versioning">2.3       
        Profile Identification and Versioning
        </h3>
    <p>This document is identified by a name (in this case, Basic Security Profile) and 
        a version number (here, 1.0). Together, they identify a 
        particular <em>profile instance</em>.</p>
    <p>Version numbers are composed of a major and minor portion, in the form 
        &quot;major.minor&quot;. They can be used to determine the precedence of a 
        profile instance; a higher version number (considering both the major 
        and minor components) indicates that an instance is more recent, and 
        therefore supersedes earlier instances.</p>
    <p>Instances of profiles with the same name (e.g., &quot;Example 
        Profile 1.1&quot; and &quot;Example Profile 5.0&quot;) address interoperability 
        problems in the same general scope (although some developments may 
        require the exact scope of a profile to change between instances).</p>
    <p>One can also use this information to determine whether two instances of 
        a profile are backwards-compatible; that is, whether one can assume 
        that conformance to an earlier profile instance implies conformance to a later 
        one. Profile instances with the same name and major version number (e.g., 
        &quot;Example Profile 1.0&quot; and &quot;Example Profile 1.1&quot;) MAY be considered 
        compatible. Note that this does not imply anything about compatibility 
        in the other direction; that is, one cannot assume that conformance 
        with a later profile instance implies conformance to an earlier one.</p>
    <h2 id="conformance">3 
            Profile Conformance
        </h2>
    <p>Conformance to 
		  the Basic Security Profile 1.0 is defined by adherence to the
        set of <em>requirements</em> defined for a specific
        <em>target</em>, within the <em>scope</em> of the
        Profile. This section explains these terms and describes how
        conformance is defined and used.</p>
    <h3 id="conformance_requirements">3.1
             
            Conformance Requirements
        </h3>
    <p>Requirements state the criteria for conformance to the
        Profile. They typically refer to an existing specification and
        embody refinements, amplifications, interpretations and
        clarifications to it in order to improve interoperability. All
        requirements in 
		  the Basic Security Profile 1.0 are considered normative, and those
        in the specifications it references that are in-scope (see
        &quot;Conformance Scope&quot;) should likewise be considered normative.
        When requirements in 
		  the Basic Security Profile 1.0 and its referenced
        specifications contradict each other, 
		  the Basic Security Profile 1.0's
        requirements take precedence for purposes of Profile
        conformance.</p>
    <p>Requirement levels, using <a class="offsite" href="http://www.ietf.org/rfc/rfc2119.txt">RFC2119</a> language (e.g.,
        MUST, MAY, SHOULD) indicate the nature of the requirement and its
        impact on conformance. Each requirement is individually identified
        (e.g., R9999) for convenience.</p>
    <p>For example;</p>
    <p class="statement">
      <span class="statement-id">R9999</span> WIDGETs SHOULD be round in shape.</p>
    <p>This requirement is identified by &quot;R9999&quot;, applies to the
        target WIDGET (see below), and places a conditional
        requirement upon widgets; i.e., although this requirement must
        be met to maintain conformance in most cases, there are some
        situations where there may be valid reasons for it not being
        met (which are explained in the requirement itself, or in its
        accompanying text).</p>
    <p>Each requirement statement contains exactly one requirement level
        keyword (e.g., &quot;MUST&quot;) and one conformance target keyword (e.g.,
        &quot;MESSAGE&quot;). The conformance target keyword appears in bold text (e.g. &quot;<b>MESSAGE</b>&quot;). Other conformance targets appearing in non-bold text are being used strictly for their definition and NOT as a conformance target. Additional text may
        be included to illuminate a requirement or group of
        requirements (e.g., rationale and examples); however, prose
        surrounding requirement statements must not be considered in
        determining conformance.</p>
    <p>Definitions of terms in 
		  the Basic Security Profile 1.0 are considered
        authoritative for the purposes of determining
        conformance.</p>
    <p>None of the requirements in 
		  the Basic Security Profile 1.0, regardless of
        their conformance level, should be interpreted as limiting the
        ability of an otherwise conforming implementation to apply
        security countermeasures in response to a real or perceived
        threat (e.g., a denial of service attack).</p>
    <h3 id="conformance_targets">3.2
             
            Conformance Targets
	    </h3>
    <p>Conformance targets identify what artifacts (e.g.,
        SOAP message, WSDL description, UDDI registry data) or
        parties (e.g., SOAP processor, end user) requirements
        apply to. </p>
    <p>This allows for the definition of conformance in
        different contexts, to assure unambiguous interpretation
        of the applicability of requirements, and to allow
        conformance testing of artifacts (e.g., SOAP messages and
        WSDL descriptions) and the behavior of various parties to
        a Web service (e.g., clients and service instances).</p>
    <p>Requirements' conformance targets are physical
        artifacts wherever possible, to simplify testing and avoid
        ambiguity.</p>
    <p>The following conformance targets are used in 
		  the Basic Security Profile 1.0:</p>
    <ul>
      <li>
        <strong>SECURE_ENVELOPE</strong> 
              - a SOAP envelope that contains sub-elements that have been subject to integrity and/or confidentiality protection.
		A message is considered conformant when all of its contained Artifacts are conformant with all Statements Targeted to those
		Artifacts as appropriate in the Basic Security Profile.
		Use of artifacts for which there are no statements in the Basic Security Profile does not affect conformance.</li>
      <li>
        <strong>SECURE_MESSAGE</strong> 
              - protocol elements that have WSS Security applied to them. Protocol elements include a primary SOAP envelope and
		optionally associated SwA attachments.</li>
      <li>
        <strong>SENDER</strong> 
              - software that generates a message according to the protocol(s) associated with it. A sender is considered conformant
		when all of the messages it produces are conformant and its behavior is conformant with all statements related to SENDER in the
		Basic Security Profile 1.0.
                (from 
                Basic Profile 1.0)
              </li>
      <li>
        <strong>RECEIVER</strong> 
              - software that consumes a message according to the protocol(s) associated with it. A receiver is considered conformant
		when it is capable of consuming conformant messages containing the artifacts that it supports and its behavior is conformant with
		all statements related to RECEIVER in the Basic Security Profile 1.0. A conformant receiver need not accept all possible conformant
		messages. A conformant receiver may choose not to support artifacts that provide unneeded or undesired functionality. When a receiver
		supports a specific artifact, and the Basic Security Profile 1.0 contains statements related to that artifact, a conformant receiver
		must accept all required conformant forms of that artifact.
                (from 
                Basic Profile 1.0)
              </li>
      <li>
        <strong>INSTANCE</strong> 
              - software that implements a wsdl:port or a uddi:bindingTemplate.
                (from 
                Basic Profile 1.0)
              </li>
      <li>
        <strong>SOAP_ENVELOPE</strong> 
              - an element named soap:Envelope, which has no parent element.</li>
      <li>
        <strong>SOAP_HEADER</strong> 
              - an element named soap:Header, included as a child of the SOAP_ENVELOPE.</li>
      <li>
        <strong>HEADER_ELEMENT</strong> 
              - an element included as a child of the SOAP_HEADER.</li>
      <li>
        <strong>SECURITY_HEADER</strong> 
              - a HEADER_ELEMENT named wsse:Security.</li>
      <li>
        <strong>SIGNATURE</strong> 
              - an element named ds:Signature, included as a child of a SECURITY_HEADER.</li>
      <li>
        <strong>SIG_KEY_INFO</strong> 
              - an element named ds:KeyInfo, included as a child of a SIGNATURE.</li>
      <li>
        <strong>SIGNED_INFO</strong> 
              - an element named ds:SignedInfo, included as a child of a SIGNATURE.</li>
      <li>
        <strong>SIGNATURE_METHOD</strong> 
              - an element named ds:SignatureMethod, included as a child of a SIGNED_INFO.</li>
      <li>
        <strong>SIG_REFERENCE</strong> 
              - an element named ds:Reference, included as a child of a SIGNED_INFO.</li>
      <li>
        <strong>SIG_TRANSFORMS</strong> 
              - an element named ds:Transforms, included as a child of a SIG_REFERENCE.</li>
      <li>
        <strong>SIG_TRANSFORM</strong> 
              - an element named ds:Transform, included as a child of a SIG_TRANSFORMS.</li>
      <li>
        <strong>CANONICALIZATION_METHOD</strong> 
              - an element named ds:CanonicalizationMethod, included as a child of a SIGNED_INFO or a wsse:TransformationParameters child of a SIG_TRANSFORM.</li>
      <li>
        <strong>INCLUSIVE_NAMESPACES</strong> 
              - an element named xc14n:InclusiveNamespaces, include as a child of a SIG_TRANSFORM or a CANONICALIZATION_METHOD.</li>
      <li>
        <strong>DIGEST_METHOD</strong> 
              - an element named ds:DigestMethod, included as a child of a SIG_TRANSFORM.</li>
      <li>
        <strong>ENCRYPTED_KEY</strong> 
              - an element named xenc:EncryptedKey, included as a child of a SECURITY_HEADER.</li>
      <li>
        <strong>ENC_KEY_INFO</strong> 
              - an element named ds:KeyInfo, included as a child of an ENCRYPTED_KEY or ENCRYPTED_DATA.</li>
      <li>
        <strong>ENC_REFERENCE_LIST</strong> 
              - an element named xenc:ReferenceList, included as a child of a SECURITY_HEADER.</li>
      <li>
        <strong>EK_REFERENCE_LIST</strong> 
              - an element named xenc:ReferenceList, included as a child of an ENCRYPTED_KEY.</li>
      <li>
        <strong>ENC_KEY_REFERENCE</strong> 
              - an element named xenc:KeyReference, included as a child of an ENC_REFERENCE_LIST.</li>
      <li>
        <strong>EK_KEY_REFERENCE</strong> 
              - an element named xenc:KeyReference, included as a child of an EK_REFERENCE_LIST.</li>
      <li>
        <strong>ENC_DATA_REFERENCE</strong> 
              - an element named xenc:DataReference, included as a child of an ENC_REFERENCE_LIST.</li>
      <li>
        <strong>EK_DATA_REFERENCE</strong> 
              - an element named xenc:DataReference, included as a child of an EK_REFERENCE_LIST.</li>
      <li>
        <strong>ENCRYPTED_DATA</strong> 
              - an element named xenc:EncryptedData, referenced by an EK_REFERENCE_LIST or an ENC_REFERENCE_LIST.</li>
      <li>
        <strong>ED_ENCRYPTION_METHOD</strong> 
              - an element named xenc:EncryptionMethod, included as a child of an ENCRYPTED_DATA.</li>
      <li>
        <strong>EK_ENCRYPTION_METHOD</strong> 
              - an element named xenc:EncryptionMethod, included as a child of an ENCRYPTED_KEY.</li>
      <li>
        <strong>SECURITY_TOKEN_REFERENCE</strong> 
              - an element named wsse:SecurityTokenReference, included as a descendant of a SECURITY_HEADER or ENCRYPTED_DATA.</li>
      <li>
        <strong>STR_EMBEDDED</strong> 
              - an element named wsse:Embedded, included as a child of a SECURITY_TOKEN_REFERENCE.</li>
      <li>
        <strong>STR_REFERENCE</strong> 
              - an element named wsse:Reference, included as a child of a SECURITY_TOKEN_REFERENCE.</li>
      <li>
        <strong>STR_KEY_NAME</strong> 
              - an element named ds:KeyName, included as a child of a SECURITY_TOKEN_REFERENCE.</li>
      <li>
        <strong>STR_KEY_IDENTIFIER</strong> 
              - an element named wsse:KeyIdentifier, included as a child of a SECURITY_TOKEN_REFERENCE.</li>
      <li>
        <strong>STR_ISSUER_SERIAL</strong> 
              - an element named ds:X509IssuerSerial, included as a child of a child element named ds:X509Data of a SECURITY_TOKEN_REFERENCE.</li>
      <li>
        <strong>INTERNAL_SECURITY_TOKEN</strong> 
              - a SECURITY_TOKEN defined in a security token profile, included as a child of a SECURITY_HEADER or STR_EMBEDDED.</li>
      <li>
        <strong>EXTERNAL_SECURITY_TOKEN</strong> 
              - a SECURITY_TOKEN defined in a security token profile, not included as a descendant of a SOAP_ENVELOPE.</li>
      <li>
        <strong>EXTERNAL_TOKEN_REFERENCE</strong> 
              - a SECURITY_TOKEN_REFERENCE that refers to an EXTERNAL_SECURITY_TOKEN.</li>
      <li>
        <strong>USERNAME_TOKEN</strong> 
              - a SECURITY_TOKEN named wsse:UsernameToken.</li>
      <li>
        <strong>NONCE</strong> 
              - an element named wsse:Nonce, included as a child of a USERNAME_TOKEN.</li>
      <li>
        <strong>PASSWORD</strong> 
              - an element named wsse:Password, included as a child of a USERNAME_TOKEN.</li>
      <li>
        <strong>BINARY_SECURITY_TOKEN</strong> 
              - a SECURITY_TOKEN named wsse:BinarySecurityToken.</li>
      <li>
        <strong>X509_TOKEN</strong> 
              - a BINARY_SECURITY_TOKEN containing an X.509 certificate.</li>
      <li>
        <strong>PKCS7_TOKEN</strong> 
              - a BINARY_SECURITY_TOKEN containing a PKCS#7 certificate chain.</li>
      <li>
        <strong>PKIPATH_TOKEN</strong> 
              - a BINARY_SECURITY_TOKEN containing a PkiPath certificate chain.</li>
      <li>
        <strong>KERBEROS_TOKEN</strong> 
              - a BINARY_SECURITY_TOKEN containing a GSS wrapped Kerberos v5 AP-REQ or a non-wrapped Kerberos v5 AP-REQ.</li>
      <li>
        <strong>REL_TOKEN</strong> 
              - a SECURITY_TOKEN named rel:license.</li>
      <li>
        <strong>SAML_TOKEN</strong> 
              - a SECURITY_TOKEN named saml:Assertion.</li>
      <li>
        <strong>SECURITY_TOKEN</strong> 
              - an INTERNAL_SECURITY_TOKEN or EXTERNAL_SECURITY_TOKEN (e.g. USERNAME_TOKEN, X509_TOKEN, REL_TOKEN, SAML_TOKEN, KERBEROS_TOKEN, etc.).</li>
      <li>
        <strong>TIMESTAMP</strong> 
              - an element named wsu:Timestamp, included as a child of a SECURITY_HEADER.</li>
      <li>
        <strong>CREATED</strong> 
              - an element named wsu:Created, included as a child of a TIMESTAMP or USERNAME_TOKEN.</li>
      <li>
        <strong>EXPIRES</strong> 
              - an element named wsu:Expires, included as a child of a TIMESTAMP or USERNAME_TOKEN.</li>
      <li>
        <strong>MIME_HEADER</strong> 
              - a header field of a multipart entity, as defined by MIME.</li>
      <li>
        <strong>MIME_BODY</strong> 
              - the body of a multipart entity, as defined by MIME.</li>
      <li>
        <strong>MIME_PART</strong> 
              - the MIME_BODY and all MIME_HEADERs associated with a single multipart entity, as defined by MIME.</li>
    </ul>
    <h3 id="conformance_scope">3.3
             
            Conformance Scope
        </h3>
    <p>The scope of 
		  the Basic Security Profile 1.0 delineates the technologies
        that it addresses; in other words, 
		  the Basic Security Profile 1.0 only attempts
        to improve interoperability within its own scope.
        Generally, 
		  the Basic Security Profile 1.0's scope is bounded by the
        specifications referenced by it.</p>
    <p>The Profile's scope is further refined by extensibility
        points. Referenced specifications often provide extension
        mechanisms and unspecified or open-ended configuration
        parameters; when identified in 
		  the Basic Security Profile 1.0 as an
        extensibility point, such a mechanism or parameter is
        outside the scope of 
		  the Basic Security Profile 1.0, and its use or non-use
        is not relevant to conformance.</p>
    <p>Note that 
		  the Basic Security Profile 1.0 may still place requirements on
        the use of an extensibility point. Also, specific uses of
        extensibility points may be further restricted by other
        profiles, to improve interoperability when used in
        conjunction with 
		  the Basic Security Profile 1.0.</p>
    <p>Because the use of extensibility points may impair
        interoperability, their use should be negotiated or
        documented in some fashion by the parties to a Web
        service; for example, this could take the form of an
        out-of-band agreement.</p>
    <p>The Profile's scope is defined by the referenced
        specifications in <a href="#references">Appendix A</a>,  as refined by the
        extensibility points in <a href="#points">Appendix B</a>.</p>
    <h3 id="conformance_claims">3.4
             
            Claiming Conformance
        </h3>
    <p>Claims of conformance to 
		  the Basic Security Profile 1.0 can be made using the following 
        mechanisms, as described in <a class="offsite" href="http://www.ws-i.org/Profiles/ConformanceClaims-1.0.html">Conformance Claim Attachment Mechanisms</a>, 
        when the applicable Profile requirements associated 
        with the listed targets have been met:</p>
    <p class="ednote">The CCAM URI may change before final publication.</p>
    <ul>
    </ul>
    <p>The conformance claim URI for 
		  the Basic Security Profile 1.0 is &quot;http://ws-i.org/profiles/basic-security/core/1.0&quot;
			  , with the following exceptions, which are associated with specific sections:</p>
    <ul>
      <li>
        <a href="#transportsec">Transport Layer Security</a> - &quot;http://ws-i.org/profiles/basic-security/transport/1.0&quot;</li>
      <li>
        <a href="#usernametoken">Username Token Profile</a> - &quot;http://ws-i.org/profiles/basic-security/username-token/1.0&quot;</li>
      <li>
        <a href="#x509token">X.509 Certificate Token Profile</a> - &quot;http://ws-i.org/profiles/basic-security/x.509-certificate-token/1.0&quot;</li>
      <li>
        <a href="#attachsec">Attachment Security</a> - &quot;http://ws-i.org/profiles/basic-security/swa/1.0&quot;</li>
    </ul>
    <p>If a claim of conformance is made as described in CCAM to BSP 1.0 (&quot;http://ws-i.org/profiles/basic-security/core/1.0&quot;), then the claim MUST also specify which tokens, be they BSP profile tokens or other mutually agreed upon tokens, are supported.</p>
    <p>The conformance URI for transport level security (&quot;http://ws-i.org/profiles/basic-security/transport/1.0&quot;) can be used in isolation or in combination with other conformance URIs.</p>
    <h2 id="transportsec">4. Transport Layer Security</h2>
    <p>This section of 
		  the Basic Security Profile 1.0 incorporates the following
		specifications by reference, and defines extensibility points within
		them:
		</p>
    <ul>
      <li>
        <a class="offsite" href="http://www.ietf.org/rfc/rfc2818.txt">HTTP over TLS</a>
      </li>
      <li>
        <a class="offsite" href="http://www.ietf.org/rfc/rfc2246.txt">The TLS Protocol Version 1.0</a>
        <br />Extensibility points:
			               <ul><li><span class="statement-id" id="E0009">E0009</span> - TLS Ciphersuites - TLS allows for the use of arbitrary encryption algorithms. Note that while section 10.1 of the Basic Security Profile 1.0 mandates,
recommends, and discourages support for certain ciphersuites, the Basic Security Profile 1.0 does not prohibit use of any specific ciphersuite.</li><li><span class="statement-id" id="E0010">E0010</span> - TLS Extensions - TLS allows for extensions during the handshake phase.</li></ul></li>
      <li>
        <a class="offsite" href="http://wp.netscape.com/eng/ssl3/ssl-toc.html">The SSL Protocol Version 3.0</a>
        <br />Extensibility points:
			               <ul><li><span class="statement-id" id="E0011">E0011</span> - SSL Ciphersuites - SSL allows for the use of arbitrary encryption algorithms. Note that while section 10.1 of the Basic Security Profile 1.0 mandates,
recommends, and discourages support for certain ciphersuites, the Basic Security Profile 1.0 does not prohibit use of any specific ciphersuite.</li></ul></li>
    </ul>
    <h3 id="SSLTLS">4.1 SSL and TLS</h3>
    <p>The following specifications (or sections thereof) are referred to
		in this section of 
		  the Basic Security Profile 1.0:</p>
    <ul>
      <li>
        <a class="offsite" href="http://www.ietf.org/rfc/rfc2818.txt">HTTP over TLS: Section 2.2.1</a>
      </li>
    </ul>
    <p><span class="statement-target"></span>SSL and TLS are both used as underlying protocols for HTTP/S. The Profile places the following constraints on those protocols:</p>
    <div class="refinement">
      <h4 id="Use_of_SSL_2.0">4.1.1 Use of SSL 2.0</h4>
      <div class="rationale">
        <p><span class="statement-target"></span>SSL 2.0 has known security issues and all current implementations of HTTP/S support more recent protocols.
			Therefore the Basic Security Profile 1.0 prohibits use of SSL 2.0.</p>
      </div>
      <p class="statement">
        <span class="statement-id">
          <a name="R2001">R2001</a>
        </span> 
			A <span class="statement-target">SENDER</span> MUST NOT use SSL 2.0 as the underlying protocol for HTTP/S.
		  </p>
      <p class="statement">
        <span class="statement-id">
          <a name="R2002">R2002</a>
        </span> 
			A <span class="statement-target">RECEIVER</span> MUST NOT use SSL 2.0 as the underlying protocol for HTTP/S.
		  </p>
    </div>
    <h2 id="msgsec">5. SOAP Message Security</h2>
    <p>This section of 
		  the Basic Security Profile 1.0 incorporates the following
		specifications by reference, and defines extensibility points within
		them:
		</p>
    <ul>
      <li>
        <a class="offsite" href="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0.pdf">Web Services Security: SOAP Message Security 1.0 (WS-Security 2004) OASIS Standard 200401, March 2004</a>
        <br />Extensibility points:
			               <ul><li><span class="statement-id" id="E0002">E0002</span> - Security Tokens - Security tokens may be specified in additional security token profiles.</li></ul></li>
    </ul>
    <h3 id="WSSST">5.1 Security Tokens</h3>
    <p>The following specifications (or sections thereof) are referred to
		in this section of 
		  the Basic Security Profile 1.0:</p>
    <ul>
      <li>
        <a class="offsite" href="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0.pdf">Web Services Security: SOAP Message Security Section 6</a>
      </li>
    </ul>
    <p><span class="statement-target"></span>In some areas the Basic Security Profile allows limited flexibility and extensibility in the application of
			security to messages. Some agreement between the SENDER and RECEIVER over which mechanisms and choices should
			be used for message exchanges is necessary. Since no security policy description language or negotiation mechanism
			is in scope for the Basic Security Profile, some out of band agreement must be reached for which security tokens
			should be used.
          </p>
    <p><span class="statement-target"></span>The Basic Security Profile 1.0 places the following constraints on the use of Security Tokens:</p>
    <div class="refinement">
      <h4 id="wsse_BinarySecurityToken/@EncodingType_Attribute">5.1.1 wsse:BinarySecurityToken/@EncodingType Attribute</h4>
      <div class="rationale">
        <p><span class="statement-target"></span>
            Base64Binary is the only encoding type specified by Web Services Security: SOAP Message Security.
            Explicit specification of attribute values simplifies XML processing requirements and as a general principle
			the Basic Security Profile 1.0 requires that attributes be explicitly specified rather than relying on default
			values.
          </p>
      </div>
      <p class="statement">
        <span class="statement-id">
          <a name="R3029">R3029</a>
        </span> 
            Any <span class="statement-target">BINARY_SECURITY_TOKEN</span> MUST specify an EncodingType attribute.
          </p>
      <p class="statement">
        <span class="statement-id">
          <a name="R3030">R3030</a>
        </span> 
            Any <span class="statement-target">BINARY_SECURITY_TOKEN</span> EncodingType attribute MUST have a value of
			&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;.
          </p>
      <div class="explanation">
        <p><span class="statement-target"></span>
             A BinarySecurityToken may specify its encoding type. The Profile restricts the encoding type to Base64Binary
			and requires its explicit specification.
          </p>
      </div>
      <p class="example-banner">For example,</p>
      <div class="example">
        <p class="incorrect">INCORRECT: </p>
        <pre>
&lt;!-- This example is incorrect because the wsse:BinarySecurityToken element is missing an EncodingType attribute --&gt;

&lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                          ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0##X509v3&quot;&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
&lt;/wsse:BinarySecurityToken&gt;
</pre>
      </div>
      <div class="example">
        <p class="correct">CORRECT: </p>
        <pre>
&lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                          ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;
                          EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
&lt;/wsse:BinarySecurityToken&gt;
</pre>
      </div>
    </div>
    <div class="refinement">
      <h4 id="wsse_BinarySecurityToken/@ValueType_Attribute">5.1.2 wsse:BinarySecurityToken/@ValueType Attribute</h4>
      <div class="rationale">
        <p><span class="statement-target"></span>
             There is no appropriate default for ValueType so the Basic Security Profile 1.0 mandates that an explicit value be
             provided.
          </p>
      </div>
      <p class="statement">
        <span class="statement-id">
          <a name="R3031">R3031</a>
        </span> 
            Any <span class="statement-target">BINARY_SECURITY_TOKEN</span> MUST specify an ValueType attribute.
          </p>
      <p class="statement">
        <span class="statement-id">
          <a name="R3032">R3032</a>
        </span> 
            Any <span class="statement-target">BINARY_SECURITY_TOKEN</span> ValueType attribute MUST have a value specified by the related security token profile.
          </p>
      <p class="statement">
        <span class="statement-id">
          <a name="R3033">R3033</a>
        </span> 
            Any <span class="statement-target">X509_TOKEN</span> ValueType attribute MUST have a value of
            &quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;.
          </p>
      <div class="explanation">
        <p><span class="statement-target"></span>
             Web Services Security: SOAP Message Security allows for a BinarySecurityToken to optionally specify its
             ValueType. The Profile restricts the ValueType to one of those specified by a security token profile
             and requires its specification.
          </p>
      </div>
      <p class="example-banner">For example,</p>
      <div class="example">
        <p class="incorrect">INCORRECT: </p>
        <pre>
&lt;!-- This example is incorrect because the wsse:BinarySecurityToken element is missing a ValueType attribute --&gt;

&lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                          EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
&lt;/wsse:BinarySecurityToken&gt;
</pre>
      </div>
      <div class="example">
        <p class="incorrect">INCORRECT: </p>
        <pre>
&lt;!-- This example is incorrect because the ValueType attribute on the wsse:BinarySecurityToken element has an incorrect value. --&gt;

&lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                          ValueType=&quot;http://www.mta.org/NYC#SubwayToken&quot;
                          EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
&lt;/wsse:BinarySecurityToken&gt;
</pre>
      </div>
      <div class="example">
        <p class="correct">CORRECT: </p>
        <pre>
&lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                          ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;
                          EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
&lt;/wsse:BinarySecurityToken&gt;
</pre>
      </div>
    </div>
    <h3 id="WSSTokenReferences">5.2 SecurityTokenReferences</h3>
    <p>The following specifications (or sections thereof) are referred to
		in this section of 
		  the Basic Security Profile 1.0:</p>
    <ul>
      <li>
        <a class="offsite" href="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0.pdf">Web Services Security: SOAP Message Security Section 7</a>
      </li>
    </ul><span class="statement-target"></span>
			Web Services Security: SOAP Message Security defines a wsse:SecurityTokenReference element for use in
			SOAP messages. The Profile places the following constraints on its use:
        <div class="refinement"><h4 id="Internal_References">5.2.1 Internal References</h4><div class="rationale"><p><span class="statement-target"></span>
            Web Services Security: SOAP Message Security provides a list of reference mechanisms in preferred order 
            (i.e., most specific to least specific). This adds ambiguity and complexity, which discourages interoperability.
          </p></div><p class="statement"><span class="statement-id"><a name="R3022">R3022</a></span> 
            Any <span class="statement-target">SECURITY_TOKEN_REFERENCE</span> that references an INTERNAL_SECURITY_TOKEN which has a wsu:Id attribute MUST 
			contain an STR_REFERENCE or STR_EMBEDDED.
          </p><div class="explanation"><p><span class="statement-target"></span>
            The recommendation does not allow the use of Key Identifier and Key Name references due to possible ambiguities.
            Direct References and Embedded References are to be used instead of these. This reduces complexity and improves
            interoperability.          
          </p></div><p class="example-banner">For example,</p><div class="example"><p class="incorrect">INCORRECT: </p><pre>
&lt;!-- This example is incorrect because it refers to a wsse:BinarySecurityToken element which specifies a wsu:id
     attribute using a wsse:KeyIdentifier element rather than a wsse:Reference or wsse:Embedded element --&gt;

&lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd' 
               xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd' 
               xmlns:xenc='http://www.w3.org/2001/04/xmlenc#' 
               xmlns:ds='http://www.w3.org/2000/09/xmldsig#' &gt;
   &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                             ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;
                             EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
   &lt;/wsse:BinarySecurityToken&gt;
   &lt;wsse:SecurityTokenReference&gt;
      &lt;wsse:KeyIdentifier EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;
                          ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509SubjectKeyIdentifier&quot;&gt;
         MIGfMa0GCSq
      &lt;/wsse:KeyIdentifier&gt;
   &lt;/wsse:SecurityTokenReference&gt;
&lt;/wsse:Security&gt;
</pre></div><div class="example"><p class="correct">CORRECT: </p><pre>
&lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd' 
               xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd' 
               xmlns:xenc='http://www.w3.org/2001/04/xmlenc#' 
               xmlns:ds='http://www.w3.org/2000/09/xmldsig#' &gt;
   &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                             ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;
                             EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
   &lt;/wsse:BinarySecurityToken&gt;
   &lt;wsse:SecurityTokenReference&gt;
      &lt;wsse:Reference URI='#SomeCert'
                      ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot; /&gt;
   &lt;/wsse:SecurityTokenReference&gt;
&lt;/wsse:Security&gt;
</pre></div><div class="example"><p class="correct">CORRECT: </p><pre>
&lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd' 
               xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd' 
               xmlns:xenc='http://www.w3.org/2001/04/xmlenc#' 
               xmlns:ds='http://www.w3.org/2000/09/xmldsig#' &gt;
   &lt;wsse:SecurityTokenReference&gt;
      &lt;wsse:Embedded wsu:Id=&quot;TheEmbeddedElementAroundSomeCert&quot;&gt;
         &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                                   ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;
                                   EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
         &lt;/wsse:BinarySecurityToken&gt;
      &lt;/wsse:Embedded&gt;
   &lt;/wsse:SecurityTokenReference&gt;
&lt;/wsse:Security&gt;
</pre></div></div><div class="refinement"><h4 id="Shorthand_XPointer_References">5.2.2 Shorthand XPointer References</h4><div class="rationale"><p><span class="statement-target"></span>
             Constraining the number of referencing mechanisms reduces complexity and thus improves interoperability.
             The wsse:BinarySecurityToken has a wsu:Id attribute allowing references to this token to use the
             relatively efficient and unambiguous Shorthand XPointer Reference mechanism.
          </p></div><p class="statement"><span class="statement-id"><a name="R5204">R5204</a></span> 
             Any <span class="statement-target">STR_REFERENCE</span> to an INTERNAL_SECURITY_TOKEN MUST contain a URI attribute with a Shorthand XPointer value.
          </p><div class="explanation"><p><span class="statement-target"></span>
             The Profile requires the use of Shorthand XPointer Reference to ensure that the URI efficiently
             references the correct token. 
          </p></div><p class="example-banner">For example,</p><div class="example"><p class="correct">CORRECT: </p><pre>
&lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd' 
               xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd' 
               xmlns:xenc='http://www.w3.org/2001/04/xmlenc#' 
               xmlns:ds='http://www.w3.org/2000/09/xmldsig#' &gt;
 &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                           ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;
                           EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
 &lt;/wsse:BinarySecurityToken&gt;
 &lt;xenc:EncryptedKey&gt;
   &lt;xenc:EncryptionMethod Algorithm='http://www.w3.org/2001/04/xmlenc#rsa-1_5' /&gt;
   &lt;ds:KeyInfo&gt;
    &lt;wsse:SecurityTokenReference&gt;
     &lt;wsse:Reference
       URI='#SomeCert'
       ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;/&gt;
    &lt;/wsse:SecurityTokenReference&gt;
   &lt;/ds:KeyInfo&gt;
   &lt;xenc:CipherData&gt;
     &lt;xenc:CipherValue&gt;
       XZEEVABD3L9G+VNTCDiDTE7WB1a4kILtz5f9FT747eE=       
     &lt;/xenc:CipherValue&gt;
   &lt;/xenc:CipherData&gt;
 &lt;/xenc:EncryptedKey&gt;
&lt;/wsse:Security&gt;
</pre></div><div class="example"><p class="correct">CORRECT: </p><pre>
&lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd' 
               xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd' 
               xmlns:xenc='http://www.w3.org/2001/04/xmlenc#' 
               xmlns:ds='http://www.w3.org/2000/09/xmldsig#' &gt;
 &lt;rel:license xmlns:rel='urn:mpeg:mpeg21:2003:01-REL-R-NS'
              wsu:Id='SomeLic' 
              licenseId='uuid:3D680C71-177B-40cc-84C1-123B02503524' &gt;
 . . .
 &lt;/rel:license&gt;
 &lt;ds:Signature&gt;
   . . .
   &lt;ds:KeyInfo&gt;
    &lt;wsse:SecurityTokenReference&gt;
     &lt;wsse:Reference
       URI='#SomeLic'
       ValueType=&quot;http://docs.oasis-open.org/wss/2004/##/oasis-####-wss-REL-token-profile-1.0#license&quot; /&gt;
    &lt;/wsse:SecurityTokenReference&gt;
   &lt;/ds:KeyInfo&gt;
 &lt;/ds:Signature&gt;
&lt;/wsse:Security&gt;
</pre></div></div><div class="refinement"><h4 id="References_to_Preceding_Security_Tokens">5.2.3 References to Preceding Security Tokens</h4><div class="rationale"><p><span class="statement-target"></span>
             Security token references are intended to provide access to security tokens residing anywhere in a document. 
             However, token placement can have a significant affect on processing efficiency when the document is processed 
             in a stream-oriented fashion. For example, resolving a forward reference to a token may require significant 
             subsequent document parsing that could otherwise be eliminated. This need to satisfy random access to security 
             tokens adds complexity to implementations that works against interoperability. 
          </p></div><p class="statement"><span class="statement-id"><a name="R5205">R5205</a></span> 
             Any <span class="statement-target">INTERNAL_SECURITY_TOKEN</span> that does not contain an STR_EMBEDDED MUST precede all
			 SECURITY_TOKEN_REFERENCE elements that reference it in the SOAP_ENVELOPE.
          </p><div class="explanation"><p><span class="statement-target"></span>
             Ensuring that a security token element appears before it is referenced, when processing in document order, 
             means that implementations have access to the token content referenced from a wsse:SecurityTokenReference 
             element when it is needed to verify a signature or perform decryption. 
          </p></div><p class="example-banner">For example,</p><div class="example"><p class="incorrect">INCORRECT: </p><pre>
&lt;!-- This example is incorrect because the wsse:BinarySecurityToken with the wsu:Id of SomeCert appears after it is 
     referenced from within the xenc:EncryptedKey element --&gt; 

&lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd' 
               xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd' 
               xmlns:xenc='http://www.w3.org/2001/04/xmlenc#' 
               xmlns:ds='http://www.w3.org/2000/09/xmldsig#' &gt;
 &lt;xenc:EncryptedKey&gt;
   &lt;xenc:EncryptionMethod Algorithm='http://www.w3.org/2001/04/xmlenc#rsa-1_5' /&gt;
   &lt;ds:KeyInfo&gt;
     &lt;wsse:SecurityTokenReference&gt;
       &lt;wsse:Reference
         URI='#SomeCert'
         ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;/&gt;
     &lt;/wsse:SecurityTokenReference&gt;
   &lt;/ds:KeyInfo&gt;
   &lt;xenc:CipherData&gt;
     &lt;xenc:CipherValue&gt;
       XZEEVABD3L9G+VNTCDiDTE7WB1a4kILtz5f9FT747eE=       
     &lt;/xenc:CipherValue&gt;
   &lt;/xenc:CipherData&gt;
 &lt;/xenc:EncryptedKey&gt;
 &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                           ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;
                           EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
 &lt;/wsse:BinarySecurityToken&gt;
&lt;/wsse:Security&gt;
</pre></div><div class="example"><p class="correct">CORRECT: </p><pre>
&lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd' 
               xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd' 
               xmlns:xenc='http://www.w3.org/2001/04/xmlenc#' 
               xmlns:ds='http://www.w3.org/2000/09/xmldsig#' &gt;
 &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                           ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;
                           EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
 &lt;/wsse:BinarySecurityToken&gt;
 &lt;xenc:EncryptedKey&gt;
   &lt;xenc:EncryptionMethod Algorithm='http://www.w3.org/2001/04/xmlenc#rsa-1_5' /&gt;
   &lt;ds:KeyInfo&gt;
     &lt;wsse:SecurityTokenReference&gt;
       &lt;wsse:Reference
         URI='#SomeCert'
         ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;/&gt;
     &lt;/wsse:SecurityTokenReference&gt;
   &lt;/ds:KeyInfo&gt;
   &lt;xenc:CipherData&gt;
     &lt;xenc:CipherValue&gt;
       XZEEVABD3L9G+VNTCDiDTE7WB1a4kILtz5f9FT747eE=       
     &lt;/xenc:CipherValue&gt;
   &lt;/xenc:CipherData&gt;
 &lt;/xenc:EncryptedKey&gt;
&lt;/wsse:Security&gt;
</pre></div></div><div class="refinement"><h4 id="Direct_Preferred_to_Embedded_for_Internal_References">5.2.4 Direct Preferred to Embedded for Internal References</h4><div class="rationale"><p><span class="statement-target"></span>
	          Since multiple security elements may reference a single security token and processing
	          of those elements may result in the removal of the element, consistent use of direct rather
	          than embedded references simplifies processing.
	          Direct references are encouraged, embedded references are discouraged.
	        </p></div><p class="statement"><span class="statement-id"><a name="R3023">R3023</a></span> 
			  Any <span class="statement-target">SECURITY_TOKEN_REFERENCE</span> that references an INTERNAL_SECURITY_TOKEN that is referenced several
			  times SHOULD contain an STR_REFERENCE rather than an STR_EMBEDDED.
	        </p><div class="explanation"><p><span class="statement-target"></span>
	          The Profile encourages the consistent use of Direct Reference to security tokens.
	        </p></div><p class="example-banner">For example,</p><div class="example"><p class="incorrect">INCORRECT: </p><pre>
&lt;!-- This example is incorrect because it uses a wsse:Embedded element for the wsse:BinarySecurityToken 
     with the wsu:Id of SomeCert. It is assumed that this token is referred to from several places elsewhere
     in the SOAP envelope ( not shown )  --&gt;

&lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd' 
               xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd' 
               xmlns:xenc='http://www.w3.org/2001/04/xmlenc#' 
               xmlns:ds='http://www.w3.org/2000/09/xmldsig#' &gt;
   &lt;wsse:SecurityTokenReference&gt;
      &lt;wsse:Embedded wsu:Id=&quot;TheEmbeddedElementAroundSomeCert&quot;&gt;
         &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                                   ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;
                                   EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
         &lt;/wsse:BinarySecurityToken&gt;
      &lt;/wsse:Embedded&gt;
   &lt;/wsse:SecurityTokenReference&gt;
&lt;/wsse:Security&gt;
</pre></div><div class="example"><p class="correct">CORRECT: </p><pre>
&lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd' 
               xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd' 
               xmlns:xenc='http://www.w3.org/2001/04/xmlenc#' 
               xmlns:ds='http://www.w3.org/2000/09/xmldsig#' &gt;
   &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                             ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;
                             EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
   &lt;/wsse:BinarySecurityToken&gt;
   &lt;wsse:SecurityTokenReference&gt;
      &lt;wsse:Reference URI='#SomeCert'
                      ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot; /&gt;
   &lt;/wsse:SecurityTokenReference&gt;
&lt;/wsse:Security&gt;
</pre></div></div><div class="refinement"><h4 id="Direct_Required_When_Possible_for_External_References">5.2.5 Direct Required When Possible for External References</h4><div class="rationale"><p><span class="statement-target"></span>
		     Since multiple security elements may reference a single external security token, consistent use of
             direct references simplifies processing. Direct references are encouraged. 
		  </p></div><p class="statement"><span class="statement-id"><a name="R3024">R3024</a></span> 
             Any <span class="statement-target">EXTERNAL_TOKEN_REFERENCE</span> that can use an STR_REFERENCE MUST contain an STR_REFERENCE.
          </p><div class="explanation"><p><span class="statement-target"></span>
             The Profile encourages the use of Direct Reference in order to minimize ambiguity. 
		  </p></div><p class="example-banner">For example,</p><div class="example"><p class="correct">CORRECT: </p><pre>
&lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd' 
               xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd' 
               xmlns:xenc='http://www.w3.org/2001/04/xmlenc#' 
               xmlns:ds='http://www.w3.org/2000/09/xmldsig#' &gt;

   &lt;wsse:SecurityTokenReference&gt;
      &lt;wsse:Reference URI='http://www.ws-i.org/CertStore/Examples/BSP.PEM'
                      ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot; /&gt;
   &lt;/wsse:SecurityTokenReference&gt;
&lt;/wsse:Security&gt;
</pre></div></div><div class="refinement"><h4 id="Format_of_Embedded_References">5.2.6 Format of Embedded References</h4><div class="rationale"><p><span class="statement-target"></span>
            Using a single consistent format for security tokens, regardless of reference mechanism,
            ensures consistent processing.                
          </p></div><p class="statement"><span class="statement-id"><a name="R3025">R3025</a></span> 
            Any <span class="statement-target">INTERNAL_SECURITY_TOKEN</span> contained in an STR_EMBEDDED MUST be in the same format
			as if it were a child of a SECURITY_HEADER.
          </p><p class="example-banner">For example,</p><div class="example"><p class="incorrect">INCORRECT: </p><pre>
&lt;!-- This example is incorrect because the wsse:Embedded element carries the data for the X.509 certificate
     directly rather than as a wsse:BinarySecurityToken element  --&gt;

&lt;wsse:SecurityTokenReference&gt;
   &lt;wsse:Embedded wsu:Id=&quot;SomeCert&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
   &lt;/wsse:Embedded&gt;
&lt;/wsse:SecurityTokenReference&gt;
</pre></div><div class="example"><p class="correct">CORRECT: </p><pre>
&lt;wsse:SecurityTokenReference&gt;
   &lt;wsse:Embedded wsu:Id=&quot;TheEmbeddedElementAroundSomeCert&quot;&gt;
      &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                                ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;
                                EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
      &lt;/wsse:BinarySecurityToken&gt;
   &lt;/wsse:Embedded&gt;
&lt;/wsse:SecurityTokenReference&gt;
</pre></div></div><div class="refinement"><h4 id="Key_Name_References_Prohibited">5.2.7 Key Name References Prohibited</h4><div class="rationale"><p><span class="statement-target"></span>
             Key Name References may be ambiguous.                      
		  </p></div><p class="statement"><span class="statement-id"><a name="R3027">R3027</a></span> 
             Any <span class="statement-target">SECURITY_TOKEN_REFERENCE</span> MUST NOT contain an STR_KEY_NAME.
          </p><div class="explanation"><p><span class="statement-target"></span>
             In any case where a security token would be referred to by Key Name,
             it would also be possible to refer to it by a more efficient and/or less ambiguous mechanism
             (e.g. Direct, Key Identifier and/or Issuer and Serial Number). Thus, the Basic Security Profile 1.0 disallows the
             use of Key Name References
          </p></div><p class="example-banner">For example,</p><div class="example"><p class="incorrect">INCORRECT: </p><pre>
&lt;!-- This example is incorrect because it uses a ds:KeyName element to refer to an X.509 certificate  --&gt;

&lt;wsse:SecurityTokenReference&gt;
   &lt;ds:KeyName&gt;CN=Security WG, OU=BSP, O=WS-I, C=US&lt;/ds:KeyName&gt;
&lt;/wsse:SecurityTokenReference&gt;
</pre></div></div><div class="refinement"><h4 id="KeyIdentifier/@ValueType_Attribute">5.2.8 KeyIdentifier/@ValueType Attribute</h4><div class="rationale"><p><span class="statement-target"></span>
             Having an explicit ValueType removes ambiguity about the format of the KeyIdentifier.
             The Profile restricts the value to that specified in the security token profile that is associated with
             the security token. 

             The ValueType attribute in a KeyIdentifier is optional. This can cause ambiguity when it is not explicitly
             stated. Furthermore, interoperability is discouraged if a ValueType is specified but does not correspond to
             the value associated with that token as stated in its security token profile. 
	      </p></div><p class="statement"><span class="statement-id"><a name="R3054">R3054</a></span> 
             Any <span class="statement-target">STR_KEY_IDENTIFIER</span> MUST specify a ValueType attribute.
          </p><p class="statement"><span class="statement-id"><a name="R3063">R3063</a></span> 
             Any <span class="statement-target">STR_KEY_IDENTIFIER</span> ValueType attribute MUST contain a value specified within the security token profile
			 associated with the referenced SECURITY_TOKEN.
          </p><div class="explanation"><p><span class="statement-target"></span>
             Having an explicit ValueType removes ambiguity about the format of the KeyIdentifier and enhances 
             processing efficiency.
             The Profile restricts the value to that specified in the security token profile that is associated with
             the security token.
	      </p></div><p class="example-banner">For example,</p><div class="example"><p class="incorrect">INCORRECT: </p><pre>

&lt;!-- This example is incorrect because the wsse:KeyIdentifier element is missing a ValueType attribute --&gt;

&lt;wsse:SecurityTokenReference&gt;
   &lt;wsse:KeyIdentifier EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;&gt;
      MIGfMa0GCSq
   &lt;/wsse:KeyIdentifier&gt;
&lt;/wsse:SecurityTokenReference&gt;
</pre></div><div class="example"><p class="correct">CORRECT: </p><pre>
&lt;wsse:SecurityTokenReference&gt;
   &lt;wsse:KeyIdentifier EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;
                       ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509SubjectKeyIdentifier&quot; &gt;
      MIGfMa0GCSq
   &lt;/wsse:KeyIdentifier&gt;
&lt;/wsse:SecurityTokenReference&gt;
</pre></div></div><div class="refinement"><h4 id="KeyIdentifier/@EncodingType_Attribute">5.2.9 KeyIdentifier/@EncodingType Attribute</h4><div class="rationale"><p><span class="statement-target"></span>
            Base64Binary is the only encoding type specified by Web Services Security: SOAP Message Security.
            Explicit specification of attribute values simplifies XML processing requirements and as a general
			principle the Basic Security Profile 1.0 requires that attributes be explicitly specified rather than
			relying on default values.
          </p></div><p class="statement"><span class="statement-id"><a name="R3070">R3070</a></span> 
            Any <span class="statement-target">STR_KEY_IDENTIFIER</span> MUST specify an EncodingType attribute.
          </p><p class="statement"><span class="statement-id"><a name="R3071">R3071</a></span> 
            Any <span class="statement-target">STR_KEY_IDENTIFIER</span> EncodingType attribute MUST have a value of
			&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;.
          </p><div class="explanation"><p><span class="statement-target"></span>
             A wsse:KeyIdentifier may specify its encoding type. The Profile restricts the encoding type to
             Base64Binary and requires its explicit specification.
          </p></div><p class="example-banner">For example,</p><div class="example"><p class="incorrect">INCORRECT: </p><pre>
&lt;!-- This example is incorrect because the wsse:KeyIdentifier element is missing an EncodingType attribute --&gt;
&lt;wsse:SecurityTokenReference&gt;
   &lt;wsse:KeyIdentifier ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509SubjectKeyIdentifier&quot; &gt;
      MIGfMa0GCSq
   &lt;/wsse:KeyIdentifier&gt;
&lt;/wsse:SecurityTokenReference&gt;
</pre></div><div class="example"><p class="correct">CORRECT: </p><pre>
&lt;wsse:SecurityTokenReference&gt;
   &lt;wsse:KeyIdentifier EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;
                       ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509SubjectKeyIdentifier&quot; &gt;
      MIGfMa0GCSq
   &lt;/wsse:KeyIdentifier&gt;
&lt;/wsse:SecurityTokenReference&gt;
</pre></div></div><div class="refinement"><h4 id="References_from_within_Embedded_Tokens">5.2.10 References from within Embedded Tokens</h4><div class="rationale"><p><span class="statement-target"></span>
             Embedded security tokens can potentially chain to other security tokens, which adds complexity to 
             processing and discourages interoperability.
          </p></div><p class="statement"><span class="statement-id"><a name="R3056">R3056</a></span> 
             Any <span class="statement-target">STR_EMBEDDED</span> MUST NOT contain a wsse:SecurityTokenReference element.
          </p><div class="explanation"><p><span class="statement-target"></span>
             Eliminating redirection from within embedded elements reduces required complexity in handling embedded
             security tokens.
          </p></div><p class="example-banner">For example,</p><div class="example"><p class="incorrect">INCORRECT: </p><pre>
&lt;!-- This example is incorrect because the wsse:Embedded element contains a wsse:SecurityTokenReference element --&gt;

&lt;wsse:SecurityTokenReference&gt;
   &lt;wsse:Embedded wsu:Id=&quot;TheEmbeddedElementAroundSomeSTR&quot;&gt;
      &lt;wsse:SecurityTokenReference&gt;
         &lt;wsse:Reference URI='#SomeCert'
                         ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot; /&gt;
      &lt;/wsse:SecurityTokenReference&gt;
   &lt;/wsse:Embedded&gt;
&lt;/wsse:SecurityTokenReference&gt;
</pre></div></div><div class="refinement"><h4 id="Embedded_Token_Content">5.2.11 Embedded Token Content</h4><div class="rationale"><p><span class="statement-target"></span>
             Embedded elements can contain multiple binary security token elements, which creates ambiguity about which 
             token should be processed. Furthermore, the security token may be a type that is not defined within a 
             security token profile. This can cause problems with interoperability                    
          </p></div><p class="statement"><span class="statement-id"><a name="R3060">R3060</a></span> 
             Any <span class="statement-target">STR_EMBEDDED</span> MUST contain a single INTERNAL_SECURITY_TOKEN child element.
          </p><div class="explanation"><p><span class="statement-target"></span>
             In order to reduce ambiguity surrounding which token to process, the Basic Security Profile 1.0 restricts embedded security 
             tokens to contain exactly one security token element. It also restricts tokens to those defined in a 
             token profile; this establishes a defined scope of profiles and thus allows for interoperability between 
             implementations.
          </p></div><p class="example-banner">For example,</p><div class="example"><p class="incorrect">INCORRECT: </p><pre>
&lt;!-- This example is incorrect because the wsse:Embedded element has multiple element children --&gt;

&lt;wsse:SecurityTokenReference&gt;
   &lt;wsse:Embedded wsu:Id=&quot;TheEmbeddedElementAroundSomeCerts&quot;&gt;
      &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                                ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;
                                EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
      &lt;/wsse:BinarySecurityToken&gt;
      &lt;wsse:BinarySecurityToken wsu:Id='SomeOtherCert'
                                ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;
                                EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
      &lt;/wsse:BinarySecurityToken&gt;
   &lt;/wsse:Embedded&gt;
&lt;/wsse:SecurityTokenReference&gt;
</pre></div><div class="example"><p class="correct">CORRECT: </p><pre>
&lt;wsse:SecurityTokenReference&gt;
   &lt;wsse:Embedded wsu:Id=&quot;TheEmbeddedElementAroundSomeCert&quot;&gt;
      &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                                ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;
                                EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
      &lt;/wsse:BinarySecurityToken&gt;
   &lt;/wsse:Embedded&gt;
&lt;/wsse:SecurityTokenReference&gt;
</pre></div></div><div class="refinement"><h4 id="Reference_from_wsse_SecurityTokenReference_to_wsse_SecurityTokenReference">5.2.12 Reference from wsse:SecurityTokenReference to wsse:SecurityTokenReference</h4><div class="rationale"><p><span class="statement-target"></span>
			The only proper way to refer to an INTERNAL_SECURITY_TOKEN by Direct Reference
			(even one inside a STR_EMBEDDED) is to refer directly to the INTERNAL_SECURITY_TOKEN.
          </p></div><p class="statement"><span class="statement-id"><a name="R3057">R3057</a></span> 
             Any <span class="statement-target">STR_REFERENCE</span> MUST NOT reference a SECURITY_TOKEN_REFERENCE.
          </p><p class="statement"><span class="statement-id"><a name="R3064">R3064</a></span> 
             Any <span class="statement-target">STR_REFERENCE</span> MUST NOT reference an STR_EMBEDDED.
          </p><p class="example-banner">For example,</p><div class="example"><p class="incorrect">INCORRECT: </p><pre>
&lt;!-- This example is incorrect because the second wsse:SecurityTokenReference element refers to the 
     wsse:SecurityTokenReference with an wsu:Id of TheFirstSTR  --&gt;
     
&lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                          ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;
                          EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
&lt;/wsse:BinarySecurityToken&gt;
&lt;wsse:SecurityTokenReference wsu:Id=&quot;TheFirstSTR&quot;&gt;
   &lt;wsse:Reference URI='#SomeCert'
                   ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot; /&gt;
&lt;/wsse:SecurityTokenReference&gt;
&lt;wsse:SecurityTokenReference&gt;
   &lt;wsse:Reference URI='#TheFirstSTR'
                   ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot; /&gt;
&lt;/wsse:SecurityTokenReference&gt;
</pre></div><div class="example"><p class="correct">CORRECT: </p><pre>
&lt;wsse:SecurityTokenReference&gt;
   &lt;wsse:Embedded wsu:Id=&quot;TheEmbeddedElementAroundSomeCert&quot;&gt;
      &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                                ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;
                                EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
      &lt;/wsse:BinarySecurityToken&gt;
   &lt;/wsse:Embedded&gt;
&lt;/wsse:SecurityTokenReference&gt;
&lt;wsse:SecurityTokenReference&gt;
   &lt;wsse:Reference URI='#SomeCert'
                   ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot; /&gt;
&lt;/wsse:SecurityTokenReference&gt;
</pre></div></div><div class="refinement"><h4 id="wsse_SecurityTokenReference/Reference_ValueType_Attribute">5.2.13 wsse:SecurityTokenReference/Reference ValueType Attribute</h4><div class="rationale"><p><span class="statement-target"></span>
             The ValueType attribute in a security token reference is optional and has no accepted default value. 
             This creates ambiguity between implementations when it is missing. Furthermore, security tokens similarly 
             have ValueType attributes, which creates the possibility of contradiction between the reference and the 
             token. There is no accepted processing model to resolve this.
          </p></div><p class="statement"><span class="statement-id"><a name="R3059">R3059</a></span> 
             Any <span class="statement-target">STR_REFERENCE</span> MUST specify a ValueType attribute.
          </p><p class="statement"><span class="statement-id"><a name="R3058">R3058</a></span> 
             Any <span class="statement-target">STR_REFERENCE</span> ValueType attribute MUST match a value specified by a security token profile
             for the the referenced SECURITY_TOKEN.
          </p><div class="explanation"><p><span class="statement-target"></span>
             Requiring that Security Token References carry a ValueType attribute makes it clear what type of security 
             token is being referenced enabling security token specific reference mechanisms and aiding in error detection. 
          </p></div></div><div class="refinement"><h4 id="wsse_SecurityTokenReference_content">5.2.14 wsse:SecurityTokenReference content</h4><div class="rationale"><p><span class="statement-target"></span>
             Web Services Security: SOAP Message Security allows for a single
             SecurityTokenReference to include multiple reference mechanisms to the same security
             token. The Profile requires that only one be used.
          </p></div><p class="statement"><span class="statement-id"><a name="R3061">R3061</a></span> 
             A <span class="statement-target">SECURITY_TOKEN_REFERENCE</span> MUST have exactly one child element.
          </p><div class="explanation"><p><span class="statement-target"></span>
             Restricting the number of reference mechanisms reduces complexity.
          </p></div></div><div class="refinement"><h4 id="wsse_SecurityTokenReference/Reference_requires_URI_attribute">5.2.15 wsse:SecurityTokenReference/Reference requires URI attribute</h4><div class="rationale"><p><span class="statement-target"></span>
             Web Services Security: SOAP Message Security treats the URI attribute as optional allowing for
			 extensibility in the reference mechanism. However, the only fully specified mechanism which
             uses the Reference element requires a URI value.
          </p></div><p class="statement"><span class="statement-id"><a name="R3062">R3062</a></span> 
             Any <span class="statement-target">STR_REFERENCE</span> MUST specify a URI attribute.                      
          </p><div class="explanation"><p><span class="statement-target"></span>
             Eliminating underspecified functionality removes complexity.
          </p></div></div><div class="refinement"><h4 id="wsse_SecurityTokenReference_Dereferencing_Transform">5.2.16 wsse:SecurityTokenReference Dereferencing Transform</h4><div class="rationale"><p><span class="statement-target"></span>
             The Security Token Dereferencing Transform allows for the optional specification of a canonicalization
             algorithm.
          </p></div><p class="statement"><span class="statement-id"><a name="R3065">R3065</a></span> 
             Any <span class="statement-target">SIG_TRANSFORM</span> containing an Algorithm attribute with a value of
			 &quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#STR-Transform&quot;
			 MUST contain a wsse:TransformationParameters element containing a ds:CanonicalizationMethod element.
          </p><div class="explanation"><p><span class="statement-target"></span>
             Consistent processing of data to be signed, including security token content, reduces complexity.
          </p></div></div><div class="refinement"><h4 id="Security_Token_References_across_security_headers_prohibited">5.2.17 Security Token References across security headers prohibited</h4><div class="rationale"><p><span class="statement-target"></span>
             The potential exists for the same security token to be referenced from multiple security headers.
          </p></div><p class="statement"><span class="statement-id"><a name="R3066">R3066</a></span> 
			 Any <span class="statement-target">STR_REFERENCE</span> MUST NOT use a Shorthand XPointer to refer to an
             INTERNAL_SECURITY_TOKEN located in another SECURITY_HEADER.
		  </p><div class="explanation"><p><span class="statement-target"></span>
             Since processing of security header elements can result in the removal of those elements, references
             to elements in another header may not correctly resolve. If an internal security token is referenced
             from multiple security headers it should be copied into each referencing header. 
          </p></div></div><h3 id="WSSTimeStamp">5.3 Timestamps</h3><p>The following specifications (or sections thereof) are referred to
		in this section of 
		  the Basic Security Profile 1.0:</p><ul><li><a class="offsite" href="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0.pdf">Web Services Security: SOAP Message Security Section 10</a></li></ul><p><span class="statement-target"></span>Web Services Security: SOAP Message Security defines a Timestamp element for
               use in SOAP messages. The Profile places the following constraints on its use:
          </p><div class="refinement"><h4 id="wsu_Timestamp/wsu_Created">5.3.1 wsu:Timestamp/wsu:Created</h4><div class="rationale"><p><span class="statement-target"></span>
             The wsu:Created element represents the creation time of the security semantics.
          </p></div><p class="statement"><span class="statement-id"><a name="R3203">R3203</a></span> 
             A <span class="statement-target">TIMESTAMP</span> MUST contain exactly one CREATED.
          </p><div class="explanation"><p><span class="statement-target"></span>
             This element is REQUIRED and can only be specified once in a Timestamp element.
             Within the SOAP processing model, creation is the instant that the Infoset is serialized for transmission.
          </p></div><p class="example-banner">For example,</p><div class="example"><p class="incorrect">INCORRECT: </p><pre>
&lt;!-- This example is incorrect because the wsu:Timestamp element is missing a wsu:Created child element --&gt;

&lt;wsu:Timestamp wsu:Id=&quot;timestamp&quot;&gt;
   &lt;wsu:Expires&gt;2001-10-13T09:00:00Z&lt;/wsu:Expires&gt;
&lt;/wsu:Timestamp&gt;
</pre></div><div class="example"><p class="correct">CORRECT: </p><pre>
&lt;wsu:Timestamp wsu:Id=&quot;timestamp&quot;&gt;
   &lt;wsu:Created&gt;2001-09-13T08:42:00Z&lt;/wsu:Created&gt;
   &lt;wsu:Expires&gt;2001-10-13T09:00:00Z&lt;/wsu:Expires&gt;
 &lt;/wsu:Timestamp&gt;
</pre></div></div><div class="refinement"><h4 id="Occurence_constraints_on	wsu_Created_and_wsu_Expires_">5.3.2 Occurence constraints on	wsu:Created and wsu:Expires </h4><div class="rationale"><p><span class="statement-target"></span>
             A timestamp may optionally contain an expires element.
          </p></div><p class="statement"><span class="statement-id"><a name="R3224">R3224</a></span> 
             Any <span class="statement-target">TIMESTAMP</span> MUST NOT contain more than one EXPIRES. 
          </p><p class="statement"><span class="statement-id"><a name="R3221">R3221</a></span> 
             Any <span class="statement-target">TIMESTAMP</span> containing an EXPIRES MUST contain a CREATED that preceeds its sibling EXPIRES.
          </p><div class="explanation"><p><span class="statement-target"></span>
             Preventing multiple expires elements and enforcing the order of elements reduces complexity.
          </p></div></div><div class="refinement"><h4 id="Leap_Seconds_Not_Allowed">5.3.3 Leap Seconds Not Allowed</h4><div class="rationale"><p><span class="statement-target"></span>
             Leap seconds are allowed by the underlying specifications.
          </p></div><p class="statement"><span class="statement-id"><a name="R3213">R3213</a></span> 
             Any <span class="statement-target">CREATED</span> containing second values MUST specify seconds values less than 60.
          </p><p class="statement"><span class="statement-id"><a name="R3215">R3215</a></span> 
             Any <span class="statement-target">EXPIRES</span> containing second values MUST specify seconds values less than 60.
          </p><div class="explanation"><p><span class="statement-target"></span>
             Leap second processing is complex and error prone. The Profile disallows specification of leap seconds.
          </p></div></div><div class="refinement"><h4 id="Timestamp_ValueType">5.3.4 Timestamp ValueType</h4><div class="rationale"><p><span class="statement-target"></span>
             The underlying specifications allow for the specification of a timestamp ValueType.
          </p></div><p class="statement"><span class="statement-id"><a name="R3225">R3225</a></span> 
             Any <span class="statement-target">CREATED</span> MUST NOT include a ValueType attribute.
          </p><p class="statement"><span class="statement-id"><a name="R3226">R3226</a></span> 
             Any <span class="statement-target">EXPIRES</span> MUST NOT include a ValueType attribute.
          </p><div class="explanation"><p><span class="statement-target"></span>
             There is no specified set of values for the ValueType attribute so the Basic Security Profile 1.0 disallows its use.
          </p></div></div><div class="refinement"><h4 id="Timestamp_Format">5.3.5 Timestamp Format</h4><div class="rationale"><p><span class="statement-target"></span>
             The underlying specifications allow for a variety of timestamp formats.
          </p></div><p class="statement"><span class="statement-id"><a name="R3217">R3217</a></span> 
             Any <span class="statement-target">CREATED</span> MUST contain time values in UTC format as specified
			 by the XML Schema type (dateTime). 
          </p><p class="statement"><span class="statement-id"><a name="R3223">R3223</a></span> 
             Any <span class="statement-target">EXPIRES</span> MUST contain time values in UTC format as specified
			 by the XML Schema type (dateTime). 
          </p><div class="explanation"><p><span class="statement-target"></span>
             Limiting timestamp values to UTC time eliminates complexity.
          </p></div></div><div class="refinement"><h4 id="Timestamp_Resolution">5.3.6 Timestamp Resolution</h4><div class="rationale"><p><span class="statement-target"></span>
             The underlying specifications do not limit the resolution of timestamp values.
          </p></div><p class="statement"><span class="statement-id"><a name="R3220">R3220</a></span> 
             Any <span class="statement-target">RECEIVER</span> MUST be capable of processing CREATED or EXPIRES values up to and
             including milliseconds. 
          </p><div class="explanation"><p><span class="statement-target"></span>
             Since implementations have practical limits on resolution of time values the
             Profile requires a reasonable processing capability.
          </p></div></div><div class="refinement"><h4 id="wsu_Timestamp_inside_wsse_Security_header_">5.3.7 wsu:Timestamp inside wsse:Security header </h4><div class="rationale"><p><span class="statement-target"></span>
             The underlying specifications do not specify semantics for timestamps other than those that
             are children of the security header.
          </p></div><p class="statement"><span class="statement-id"><a name="R3218">R3218</a></span> 
             A <span class="statement-target">SECURITY_HEADER</span> MUST NOT contain a wsse:Timestamp element that is not its immediate child.
          </p><p class="statement"><span class="statement-id"><a name="R3227">R3227</a></span> 
             A <span class="statement-target">SECURITY_HEADER</span> MUST NOT contain more than one TIMESTAMP.
          </p><div class="explanation"><p><span class="statement-target"></span>
             The Profile does not allow inclusion of timestamp elements with unspecified semantics.
          </p></div></div><h3 id="WSSReferences">5.4 wsu:Id References</h3><p>The following specifications (or sections thereof) are referred to
		in this section of 
		  the Basic Security Profile 1.0:</p><ul><li><a class="offsite" href="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0.pdf">Web Services Security: SOAP Message Security</a></li></ul><p><span class="statement-target"></span>
              Web Services Security: SOAP Message Security defines a wsu:Id element for
              use in SOAP messages. The Profile places the following constraints on its use:
          </p><div class="refinement"><h4 id="wsu_Id_Attribute_Uniqueness">5.4.1 wsu:Id Attribute Uniqueness</h4><div class="rationale"><p><span class="statement-target"></span>
             One of the principles of the underlying specifications is that processing of messages should not require
             schema validation. However, without schema processing it is not possible to determine whether individual
             attributes are of type ID and must therefore be unique.
          </p></div><p class="statement"><span class="statement-id"><a name="R3204">R3204</a></span> 
             Any <span class="statement-target">SECURE_ENVELOPE</span> MUST NOT contain more than one element specifying the same wsu:Id attributes value.
          </p><div class="explanation"><p><span class="statement-target"></span>
             Since verification of signatures typically requires dereferencing of elements based on ID
             attribute values, these values are required to be unique within a message.
          </p></div></div><h3 id="WSSProcessing">5.5 wsse:Security Processing Order</h3><p>The following specifications (or sections thereof) are referred to
		in this section of 
		  the Basic Security Profile 1.0:</p><ul><li><a class="offsite" href="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0.pdf">Web Services Security: SOAP Message Security</a></li></ul><p><span class="statement-target"></span>
             Web Services Security: SOAP Message Security defines the order for processing
             signature and encryption blocks within wsse:Security headers.
             The Profile provides the following guidance:
          </p><div class="refinement"><h4 id="Order_of_Processing">5.5.1 Order of Processing</h4><div class="rationale"><p><span class="statement-target"></span>
               Messages may be signed and encrypted, potentially by multiple entities signing and encrypting overlapping elements.
               A signature applied before encryption has different security properties than encryption applied before a signature.
               Determining which security properties should be used requires an out-of-band agreement.
            </p><p><span class="statement-target"></span>
               With signature before encryption, the signer is known to have created or vouched for the
               plaintext data. It is not known to the receiver whether the signer performed the encryption.
               The potential exists for the identity of the signer to remain confidential except to the receiver
               by encryption of the signature and signer's security token.
            </p><p><span class="statement-target"></span>
               With encryption before signature, the signer is known to have created or vouched for the
               ciphertext data, but it is not known whether the signer was aware of the plaintext. It is known
               that the signer was aware that the data was encrypted and intended to be delivered to the
               receiver.
            </p></div><p class="statement"><span class="statement-id"><a name="R3212">R3212</a></span> 
             Any SIGNATURE, ENCRYPTED_KEY, and ENC_REFERENCE_LIST elements MUST be ordered within a
             <span class="statement-target">SECURITY_HEADER</span> so a receiver will get the correct result by processing the elements in the order they appear.
          </p><div class="explanation"><p><span class="statement-target"></span>
             As signature and encryption elements are added to a security header they must be ordering in a way
             that ensures that if a receiver of the message processing the elements in the order they appear they
             will achieve the correct result.
          </p></div></div><h3 id="WSSActor">5.6 SOAP Actor</h3><p>The following specifications (or sections thereof) are referred to
		in this section of 
		  the Basic Security Profile 1.0:</p><ul><li><a class="offsite" href="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0.pdf">Web Services Security: SOAP Message Security</a></li></ul><p><span class="statement-target"></span>
             SOAP defines an actor attribute for use in SOAP headers.
             The Profile places the following constraints on its use:</p><div class="refinement"><h4 id="SOAP_Actor_Value">5.6.1 SOAP Actor Value</h4><div class="rationale"><p><span class="statement-target"></span>
             The actor attribute allows a security header to be targeted to a specific processing component or node.
          </p></div><p class="statement"><span class="statement-id"><a name="R3206">R3206</a></span> 
             Any <span class="statement-target">SOAP_HEADER</span> MUST NOT contain more than one SECURITY_HEADER with the actor attribute omitted.
          </p><p class="statement"><span class="statement-id"><a name="R3210">R3210</a></span> 
             Any <span class="statement-target">SOAP_HEADER</span> MUST NOT contain more than one SECURITY_HEADER with the same actor attribute value.
          </p><div class="explanation"><p><span class="statement-target"></span>
             Correct security header processing is order dependent.
			 Eliminating potential ambiguity caused by ordering dependencies between headers targeted to the
			 same actor eliminates complexity. 
          </p></div></div><h2 id="usernametoken">6. Username Token Profile</h2><p>This section of 
		  the Basic Security Profile 1.0 incorporates the following
		specifications by reference:
		</p><ul><li><a class="offsite" href="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0.pdf">Web Services Security UsernameToken Profile 1.0 OASIS Standard 200401, March 2004</a></li></ul><h3 id="tokenusage">6.1 Token Usage</h3><div class="refinement"><h4 id="wsse_UsernameToken/wsse_Password/@Type">6.1.1 wsse:UsernameToken/wsse:Password/@Type</h4><div class="rationale"><p><span class="statement-target"></span>
             Passwords may be present in a variety of formats. The Type attribute specifies the format
             of the Password value.
          </p></div><p class="statement"><span class="statement-id"><a name="R4201">R4201</a></span> 
             Any <span class="statement-target">PASSWORD</span> MUST specify a Type attribute.
          </p><div class="explanation"><p><span class="statement-target"></span>
             To avoid ambiguity, the Type attribute must be specified on the wsse:Password element of a
             wsse:UsernameToken.
          </p></div><p class="example-banner">For example,</p><div class="example"><p class="incorrect">INCORRECT: </p><pre>
&lt;!-- This example is incorrect because the wsse:Password element is missing a Type attribute with a value of 
     http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText --&gt;

&lt;wsse:UsernameToken
   xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd' &gt;
   &lt;wsse:Username&gt;Bert&lt;/wsse:Username&gt;
   &lt;wsse:Password&gt;Ernie&lt;/wsse:Password&gt;
&lt;/wsse:UsernameToken&gt;
</pre></div><div class="example"><p class="incorrect">INCORRECT: </p><pre>&lt;
&lt;!-- This example is incorrect because the wsse:Password element is missing a Type attribute with a value of 
     http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordDigest --&gt;

&lt;wsse:UsernameToken
   xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd' &gt;
   &lt;wsse:Username&gt;Bert&lt;/wsse:Username&gt;
   &lt;wsse:Password&gt;B5twk47KwSrjeg==&lt;/wsse:Password&gt;
&lt;/wsse:UsernameToken&gt;
</pre></div><div class="example"><p class="correct">CORRECT: </p><pre>
&lt;wsse:UsernameToken
   xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd' &gt;
   &lt;wsse:Username&gt;Bert&lt;/wsse:Username&gt;
   &lt;wsse:Password
      Type='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText'&gt;
      Ernie
   &lt;/wsse:Password&gt;
&lt;/wsse:UsernameToken&gt;
</pre></div><div class="example"><p class="correct">CORRECT: </p><pre>
&lt;wsse:UsernameToken xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd' &gt;
   &lt;wsse:Username&gt;Bert&lt;/wsse:Username&gt;
   &lt;wsse:Password
      Type='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordDigest'&gt;
      B5twk47KwSrjeg==
   &lt;/wsse:Password&gt;
&lt;/wsse:UsernameToken&gt;
</pre></div></div><div class="refinement"><h4 id="UsernameToken_Contents">6.1.2 UsernameToken Contents</h4><p class="statement"><span class="statement-id"><a name="R4222">R4222</a></span> 
				Any <span class="statement-target">USERNAME_TOKEN</span> MUST NOT have more than one PASSWORD.
			</p><p class="statement"><span class="statement-id"><a name="R4223">R4223</a></span> 
				Any <span class="statement-target">USERNAME_TOKEN</span> MUST NOT have more than one CREATED.
			</p><p class="statement"><span class="statement-id"><a name="R4225">R4225</a></span> 
				Any <span class="statement-target">USERNAME_TOKEN</span> MUST NOT have more than one NONCE.
			</p></div><div class="refinement"><h4 id="PasswordDigest">6.1.3 PasswordDigest</h4><div class="rationale"><p><span class="statement-target"></span>
             The underlying specifications specify a Type value for password digests but there
             is ambiguity in the algorithm to be used to calculate the digest.
          </p></div><p class="statement"><span class="statement-id"><a name="R4212">R4212</a></span> 
	         Any <span class="statement-target">PASSWORD</span> with a Type attribute value of
             &quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordDigest&quot;
             MUST have its value computed using the following formula,
             where &quot;+&quot; indicates concatenation: Password_Digest = Base64 ( SHA-1 ( nonce + created + password ) ).
             That is, concatenate the text forms of the nonce, creation time, and the password
             (or shared secret or password equivalent), digest the combination using
             the SHA-1 hash algorithm, then include the Base64 encoding of that result
             as the password (digest).
             Any elements that are not present are simply omitted from the concatenation.
          </p><div class="explanation"><p><span class="statement-target"></span>
             The Profile describes the digest calculation details to eliminate ambiguity.
          </p></div></div><div class="refinement"><h4 id="ValueType_attribute">6.1.4 ValueType attribute</h4><div class="rationale"><p><span class="statement-target"></span>
             The underlying specifications do not fully describe the proper ValueType for UsernameToken.
          </p></div><p class="statement"><span class="statement-id"><a name="R4214">R4214</a></span> 
             Any <span class="statement-target">STR_REFERENCE</span> to a USERNAME_TOKEN MUST have a ValueType attribute with a value of
             &quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#UsernameToken&quot;.
		  </p><div class="explanation"><p><span class="statement-target"></span>
             The Profile requires a specific value for the ValueType.
          </p></div></div><div class="refinement"><h4 id="Nonce_EncodingType_attribute">6.1.5 Nonce EncodingType attribute</h4><div class="rationale"><p><span class="statement-target"></span>
             Base64Binary is the only encoding type specified by Web Services Security: SOAP Message Security.
             Explicit specification of attribute values simplifies XML processing requirements and
             as a general principle the Basic Security Profile 1.0 requires that attributes be explicitly specified
             rather than relying on default values.
          </p></div><p class="statement"><span class="statement-id"><a name="R4220">R4220</a></span> 
			 Any <span class="statement-target">NONCE</span> MUST specify an EncodingType attribute.
          </p><p class="statement"><span class="statement-id"><a name="R4221">R4221</a></span> 
			 Any <span class="statement-target">NONCE</span> EncodingType attribute MUST have a value of
			 &quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;.
          </p><div class="explanation"><p><span class="statement-target"></span>
             A UsernameToken may specify its encoding type. The Profile restricts the encoding type to
             Base64Binary and requires its explicit specification.
          </p></div></div><div class="refinement"><h4 id="Reference_by_KeyIdentifier">6.1.6 Reference by KeyIdentifier</h4><div class="rationale"><p><span class="statement-target"></span>
             The underlying specifications do not describe a mechanism for generating a KeyIdentifier
             for a UsernameToken.
          </p></div><p class="statement"><span class="statement-id"><a name="R4215">R4215</a></span> 
		     Any <span class="statement-target">SECURITY_TOKEN_REFERENCE</span> to a USERNAME_TOKEN MUST NOT contain an STR_KEY_IDENTIFIER.
		  </p><div class="explanation"><p><span class="statement-target"></span>
             The Profile disallows the use of unspecified mechanisms for generation of KeyIdentifier values.
          </p></div></div><div class="refinement"><h4 id="Key_Derivation">6.1.7 Key Derivation</h4><div class="explanation"><p><span class="statement-target"></span>
             The Username Token profile does not currently define a key derivation algorithm.
		     The OASIS WSS TC is expected to address this issue in a subsequent specification.
		  </p></div></div><h2 id="x509token">7. X.509 Certificate Token Profile</h2><p>This section of 
		  the Basic Security Profile 1.0 incorporates the following
		specifications by reference, and defines extensibility points within
		them:
		</p><ul><li><a class="offsite" href="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0.pdf">Web Services Security X.509 Certificate Token Profile OASIS Standard 200401, March 2004</a></li><li><a class="offsite" href="http://www.ietf.org/rfc/rfc2459.txt">RFC2459: Internet X.509 Public Key Infrastructure Certificate and CRL Profile</a><br />Extensibility points:
			               <ul><li><span class="statement-id" id="E0012">E0012</span> - Certificate Authority - The choice of the Certificate Authority is a private agreement between parties.</li><li><span class="statement-id" id="E0013">E0013</span> - Certificate Extensions - X.509 allows for arbitrary certificate extensions.</li></ul></li><li><a class="offsite" href="http://www.itu.int/rec/recommendation.asp?type=items&amp;lang=e&amp;parent=T-REC-X.509-200110-I!Cor1">Information technology &quot;Open Systems
Interconnection&quot; The Directory: Public-key and attribute certificate frameworks Technical Corrigendum 1</a></li></ul><h3 id="x509tokentypes">7.1 Token Types</h3><p>The following specifications (or sections thereof) are referred to
		in this section of 
		  the Basic Security Profile 1.0:</p><ul><li><a class="offsite" href="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0.pdf">Web Services Security: X.509 Token Profile Section 3.1</a></li></ul><p><span class="statement-target"></span>
           In some areas the Basic Security Profile allows limited flexibility and
           extensibility in the application of security to messages. Some agreement
           between the SENDER and RECEIVER over which mechanisms and choices should
           be used for message exchanges is necessary. Since no security policy description
           language or negotiation mechanism is in scope for the Basic Security Profile,
           some out of band agreement must be reached for which certificate extensions and
           issuers should be used.
          </p><p><span class="statement-target"></span>
           Web Services Security: X.509 Token Profile defines 3 token types: X509v3; x509PKIPathv1; and PKCS7.
           The Profile places the following constraints on their use:
          </p><div class="refinement"><h4 id="Certificate_Path_Format">7.1.1 Certificate Path Format</h4><div class="rationale"><p><span class="statement-target"></span>
            The underlying specifications allow certificate path information to be provided via either
            X509PKIPathv1 or PKCS7 formats.
          </p></div><p class="statement"><span class="statement-id"><a name="R5201">R5201</a></span> 
            Any BINARY_SECURITY_TOKEN containing an X.509 Certificate Path MUST have a ValuteType attribute with a value of either
			&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#PKCS7&quot; or
			&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509PKIPathv1&quot;.
          </p><p class="statement"><span class="statement-id"><a name="R5202">R5202</a></span> 
			Any BINARY_SECURITY_TOKEN containing an X.509 Certificate Path SHOULD have a ValuteType attribute with a value of
			&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509PKIPathv1&quot;.
		  </p><div class="explanation"><p><span class="statement-target"></span>
            Interoperability issues may arise if different forms of certificate path
            information are used when not expected. X509PKIPathv1 is preferred because
            it allows more efficient certificate path processing.
            PKCS7 is a more mature and widely implemented standard so it is also allowed.
            Section 3.1 of X.509 Token Profile incorrectly defines #X509PKIPathv1 as a PKIPath.
            Section 3.1 should define #X509PKIPathv1 as a PkiPath (note case),
            which X.509 defect report 279 defines as an ordered collection of certificates beginning
            with the most significant.
          </p></div></div><div class="refinement"><h4 id="Key_Identifier_or_X509IssuerSerial_for_External_References">7.1.2 Key Identifier or X509IssuerSerial for External References</h4><div class="rationale"><p><span class="statement-target"></span>
             Web Services Security: SOAP Message Security provides a list of reference mechanisms in preferred order 
             (i.e., most specific to least specific). Direct References are prefered, but when they cannot be used
             Key Identifier or Issuer and Serial Number is required.
          </p></div><p class="statement"><span class="statement-id"><a name="R5209">R5209</a></span> 
             When a <span class="statement-target">SECURITY_TOKEN_REFERENCE</span> references an EXTERNAL_SECURITY_TOKEN that cannot be referred to using an
             STR_REFERENCE but can be referred to using an STR_KEY_IDENTIFIER or STR_ISSUER_SERIAL, an STR_KEY_IDENTIFIER
             or STR_ISSUER_SERIAL MUST be used.
          </p><div class="explanation"><p><span class="statement-target"></span>
             In the event that Direct References are not possible, the Basic Security Profile 1.0 encourages the usage of mechanisms
             that are most likely to be unique. 
		  </p></div><p class="example-banner">For example,</p><div class="example"><p class="correct">CORRECT: </p><pre>
&lt;wsse:SecurityTokenReference&gt;
   &lt;wsse:KeyIdentifier EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;
                       ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509SubjectKeyIdentifier&quot; &gt;
      MIGfMa0GCSq
   &lt;/wsse:KeyIdentifier&gt;
&lt;/wsse:SecurityTokenReference&gt;
</pre></div><div class="example"><p class="correct">CORRECT: </p><pre>
&lt;wsse:SecurityTokenReference&gt;
   &lt;ds:X509Data&gt;
      &lt;ds:X509IssuerSerial&gt;
         &lt;ds:X509IssuerName&gt;CN=Security WG, OU=BSP, O=WS-I, C=US&lt;/ds:X509IssuerName&gt;
         &lt;ds:X509SerialNumber&gt;54A4E9&lt;/ds:X509SerialNumber&gt;
      &lt;/ds:X509IssuerSerial&gt;
   &lt;/ds:X509Data&gt;
&lt;/wsse:SecurityTokenReference&gt;
</pre></div></div><div class="refinement"><h4 id="KeyIdentifier">7.1.3 KeyIdentifier</h4><div class="rationale"><p><span class="statement-target"></span>
             The underlying specifications do not fully describe the proper ValueType for X.509 SubjectKeyIdentifier.
          </p></div><p class="statement"><span class="statement-id"><a name="R5206">R5206</a></span> 
            Any <span class="statement-target">STR_KEY_IDENTIFIER</span> that references an X509_TOKEN MUST have a ValueType attribute with the value of
            &quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509SubjectKeyIdentifier&quot;.
          </p><p class="statement"><span class="statement-id"><a name="R5208">R5208</a></span> 
            Any <span class="statement-target">STR_KEY_IDENTIFIER</span> that references an X509_TOKEN MUST contain the value of the token's 
			SubjectKeyIdentifier extension.
          </p><p class="statement"><span class="statement-id"><a name="R5210">R5210</a></span> 
            Any <span class="statement-target">SECURITY_TOKEN_REFERENCE</span> to an X509_TOKEN that does not contain a SubjectKeyIdentifier extension
            MUST NOT contain an STR_KEY_IDENTIFIER.
          </p><div class="explanation"><p><span class="statement-target"></span>
             The Profile requires a specific value for the ValueType.
          </p></div></div><div class="refinement"><h4 id="KeyIdentifier_EncodingType">7.1.4 KeyIdentifier EncodingType</h4><div class="rationale"><p><span class="statement-target"></span>
            This requirement addresses the provisions of SOAP Message Security 1.0 Errata
			which recommend that the optional EncodingType attribute be encoded in base64.
          </p></div><p class="statement"><span class="statement-id"><a name="R5207">R5207</a></span> 
            Any STR_KEY_IDENTIFIER that references an X509_TOKEN MUST have an @EncodingType attribute with the value 
			&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;.
		  </p><div class="explanation"><p><span class="statement-target"></span>
             The Profile requires specifying the encoding type and restricts it to base64.
          </p></div></div><div class="refinement"><h4 id="X509IssuerSerial_Encoding">7.1.5 X509IssuerSerial Encoding</h4><p class="statement"><span class="statement-id"><a name="R5409">R5409</a></span> 
				Any <span class="statement-target">STR_ISSUER_SERIAL</span> MUST contain a value follow the encoding rules specified in the XML Signature
				specification for DNames.
			</p><div class="explanation"><p><span class="statement-target"></span>Per XML Signature, DNames are encoded as follows:</p><ul><li><span class="statement-target"></span>
						Consider the string as consisting of Unicode characters.
					</li><li><span class="statement-target"></span>
						Escape occurrences of the following special characters by prefixing it with the
						&quot;\&quot; character:
						<ul><li><span class="statement-target"></span>
								a &quot;#&quot; character occurring at the beginning of the string
							</li><li><span class="statement-target"></span>
								one of the characters &quot;,&quot;, &quot;+&quot;, &quot;&quot;&quot;, &quot;\&quot;, &quot;&lt;&quot;, &quot;&gt;&quot; or &quot;;&quot;
							</li></ul></li><li><span class="statement-target"></span>
						Escape all occurrences of ASCII control characters (Unicode range \x00 - \x1f)
						by replacing them with &quot;\&quot; followed by a two digit hex number showing its Unicode
						number.
					</li><li><span class="statement-target"></span>
						Escape any trailing white space by replacing &quot;\ &quot; with &quot;\20&quot;.
					</li><li><span class="statement-target"></span>
						Since a XML document logically consists of characters, not octets, the resulting
						Unicode string is finally encoded according to the character encoding used for
						producing the physical representation of the XML document. 
					</li></ul></div></div><h2 id="xmlSignature">8. XML-Signature</h2><p><span class="statement-target"></span>
           Web Services Security: SOAP Message Security builds on XML Signature,
           defining usage of various elements from XML Signature and a processing model.
           The Profile places the constraints defined in this section on the use of
           XML Signature with Web Services Security: SOAP Message Security.
           The Profile places no constraints on other use of XML Signature.
        </p><p><span class="statement-target"></span>
           In some areas the Basic Security Profile allows limited flexibility and
           extensibility in the application of security to messages. Some agreement
           between the SENDER and RECEIVER over which mechanisms and choices should
           be used for message exchanges is necessary. Since no security policy description
           language or negotiation mechanism is in scope for the Basic Security Profile,
           some out of band agreement must be reached for which elements should be signed
           and which signature algorithms should be used.
        </p><p>This section of 
		  the Basic Security Profile 1.0 incorporates the following
		specifications by reference:
		</p><ul><li><a class="offsite" href="http://www.w3.org/TR/xmldsig-core/">XML-Signature Syntax and Processing</a></li></ul><h3 id="xmlSignatureGeneral">8.1 General Constraints on XML Signature</h3><div class="refinement"><h4 id="Signature_Content">8.1.1 Signature Content</h4><div class="rationale"><p><span class="statement-target"></span>
           Partners in a message exchange must agree which elements must be signed and which elements may be signed.
         </p></div><p class="statement"><span class="statement-id"><a name="R3105">R3105</a></span> 
           A <span class="statement-target">SENDER</span> MAY agree in an out of band fashion with a RECEIVER on required and allowed signed message content.
         </p><p class="statement"><span class="statement-id"><a name="R3106">R3106</a></span> 
           A <span class="statement-target">RECEIVER</span> MAY agree in an out of band fashion with a SENDER on required and allowed signed message content.
         </p><div class="explanation"><p><span class="statement-target"></span>
            Some vendors have strict implementation of what message content must be signed.
            Some other vendors are more tolerent to receiving additional signed content in a message.
            The Profile allows for an out of band agreement between vendors on how to address this issue.              
          </p></div></div><div class="refinement"><h4 id="Signature_Types">8.1.2 Signature Types</h4><div class="rationale"><p><span class="statement-target"></span>
            Due to the nature of the SOAP processing model,
            which is based on recognising the elements that are children of soap:Header and/or soap:Body,
            use of enveloping signatures, where the signed XML is encapsulated in a ds:Signature element,
            is inappropriate. 
            Enveloped signatures, where the ds:Signature element is a descendant of the signed element,
            limit the ability of intermediaries to process messages and should be avoided unless said
            limitation is the desired effect.
          </p></div><p class="statement"><span class="statement-id"><a name="R3102">R3102</a></span> 
            A <span class="statement-target">SIGNATURE</span> MUST NOT be an Enveloping Signature as defined by the XML Signature
            specification.
          </p><p class="statement"><span class="statement-id"><a name="R3103">R3103</a></span> 
            A <span class="statement-target">SIGNATURE</span> SHOULD be a Detached Signature as defined by the XML Signature
            specification.
          </p><p class="statement"><span class="statement-id"><a name="R3104">R3104</a></span> 
            A <span class="statement-target">SIGNATURE</span> SHOULD NOT be an Enveloped Signature as defined by the XML Signature
            Specification.
          </p><div class="explanation"><p><span class="statement-target"></span>
            Detached signatures are encouraged.
            Enveloped signatures are discouraged.
            Enveloping signatures are not allowed.
          </p></div><p class="example-banner">For example,</p><div class="example"><p class="incorrect">INCORRECT: </p><pre>
&lt;!-- This example is incorrect because it contains an enveloping signature around the SomeSecurityToken element --&gt;

&lt;ds:Signature Id='TheSig' xmlns:ds='http://www.w3.org/2000/09/xmldsig#'&gt;
   &lt;ds:SignedInfo&gt;
      &lt;ds:CanonicalizationMethod Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#' /&gt;
      &lt;ds:Reference URI='#SigPropBody'&gt;
         &lt;ds:Transforms&gt;
            &lt;ds:Transform Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#' /&gt;
         &lt;/ds:Transforms&gt;
         &lt;ds:DigestMethod Algorithm='http://www.w3.org/2000/09/xmldsig#sha1' /&gt;
         &lt;ds:DigestValue&gt;i3qi5GjhHnfoBn/jOjQp2mq0Na4=&lt;/ds:DigestValue&gt;
      &lt;/ds:Reference&gt;
   &lt;/ds:SignedInfo&gt;
   &lt;ds:SignatureValue&gt;oxNwoqGbzqg1YBliz+PProgcjw8=&lt;/ds:SignatureValue&gt;
   &lt;ds:KeyInfo&gt;
      &lt;wsse:SecurityTokenReference&gt;
         &lt;wsse:Reference
            URI='#SomeCert'
            ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;/&gt;
      &lt;/wsse:SecurityTokenReference&gt;
   &lt;/ds:KeyInfo&gt;
   &lt;ds:Object&gt;
      &lt;ds:SignatureProperties&gt;
         &lt;ds:SignatureProperty Id='SigPropBody' Target='#TheSig'&gt;
            &lt;SomeSecurityToken/&gt;
         &lt;/ds:SignatureProperty&gt;
      &lt;/ds:SignatureProperties&gt;
   &lt;/ds:Object&gt;
&lt;/ds:Signature&gt;
</pre></div><div class="example"><p class="correct">CORRECT: </p><pre>
&lt;ds:Signature xmlns:ds='http://www.w3.org/2000/09/xmldsig#'&gt;
   &lt;ds:SignedInfo&gt;
      &lt;ds:CanonicalizationMethod Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#' /&gt;
      &lt;ds:SignatureMethod Algorithm='http://www.w3.org/2000/09/xmldsig#rsa-sha1' /&gt;
      &lt;ds:Reference URI='#TheBody'&gt;
         &lt;ds:Transforms&gt;
            &lt;ds:Transform Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#' /&gt;
         &lt;/ds:Transforms&gt;
         &lt;ds:DigestMethod Algorithm='http://www.w3.org/2000/09/xmldsig#sha1' /&gt;
         &lt;ds:DigestValue&gt;i3qi5GjhHnfoBn/jOjQp2mq0Na4=&lt;/ds:DigestValue&gt;
      &lt;/ds:Reference&gt;
   &lt;/ds:SignedInfo&gt;
   &lt;ds:SignatureValue&gt;PipXJ2Sfc+LTDnq4pM5JcIYt9gg=&lt;/ds:SignatureValue&gt;
   &lt;ds:KeyInfo&gt;
      &lt;wsse:SecurityTokenReference&gt;
         &lt;wsse:Reference URI='#SomeCert'
                         ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot; /&gt;
      &lt;/wsse:SecurityTokenReference&gt;
   &lt;/ds:KeyInfo&gt;
&lt;/ds:Signature&gt;
</pre></div></div><h3 id="WSSIDRef">8.2 Element References in XML Signature</h3><p>The following specifications (or sections thereof) are referred to
		in this section of 
		  the Basic Security Profile 1.0:</p><ul><li><a class="offsite" href="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0.pdf">Web Services Security: SOAP Message Security Section 4</a></li></ul><p><span class="statement-target"></span>Element references are used to specify which portions of a SECURE_ENVELOPE are integrity protected. The Basic Security Profile 1.0 places the following constraints on the use of element references:</p><div class="refinement"><h4 id="Reference_to_Elements_by_Shorthand_XPointer_(XMLDSIG)">8.2.1 Reference to Elements by Shorthand XPointer (XMLDSIG)</h4><div class="rationale"><p><span class="statement-target"></span>
             Processing of Shorthand XPointer References requires knowledge of which attributes are IDs.
             Since the underlying specifications strive to allow message processing without schema processing,
             some non-schema aware method for identifying ID attributes must be used.
          </p></div><p class="statement"><span class="statement-id"><a name="R3001">R3001</a></span> 
             Any <span class="statement-target">SIG_REFERENCE</span> to an element with a wsu:Id attribute or a Local ID attribute defined
             by XML Signature or XML Encryption MUST contain a URI attribute containing a Shorthand XPointer.
          </p><p class="statement"><span class="statement-id"><a name="R3003">R3003</a></span> 
             Any <span class="statement-target">SIG_REFERENCE</span> to a SIGNATURE or descendant of a SIGNATURE MUST contain a URI attribute with
             a reference value that is a Shorthand XPointer to Local ID attribute defined by XML Signature.
          </p><p class="statement"><span class="statement-id"><a name="R3004">R3004</a></span> 
             Any <span class="statement-target">SIG_REFERENCE</span> to an element defined in XML Encryption MUST contain a URI attribute with
             a reference value that is a Shorthand XPointer to Local ID attribute defined by XML Encryption.
          </p><p class="statement"><span class="statement-id"><a name="R3005">R3005</a></span> 
             Any <span class="statement-target">SIG_REFERENCE</span> to an element that is not defined in XML Encryption, a SIGNATURE,
             or a descendant of a SIGNATURE SHOULD contain a URI attribute with a reference value that is a
			 Shorthand XPointer to a wsu:Id attribute.
          </p><div class="explanation"><p><span class="statement-target"></span>
             The underlying specifications define well known ID attributes. Limiting references to those
             well known attributes reduces complexity and the reliance on schema processing.
          </p></div></div><div class="refinement"><h4 id="Reference_to_Elements_by_XPath_Expression">8.2.2 Reference to Elements by XPath Expression</h4><div class="rationale"><p><span class="statement-target"></span>
              Elements that do not have an attribute of type ID cannot be referred to by Shorthand XPointer
              References so a different referencing mechanism is needed.
          </p></div><p class="statement"><span class="statement-id"><a name="R3002">R3002</a></span> 
			Any <span class="statement-target">SIG_REFERENCE</span> to an element that does not have an ID attribute MUST contain a
			TRANSFORM with an Algorithm attribute value of &quot;http://www.w3.org/2002/06/xmldsig-filter2&quot;.
          </p><div class="explanation"><p><span class="statement-target"></span>
              The XPath Filter 2.0 transform is more efficient than the original XPath transform from XML
              Digital Signature Syntax and Processing.
          </p></div><p class="example-banner">For example,</p><div class="example"><p class="incorrect">INCORRECT: </p><pre>
&lt;!-- This example is incorrect because it uses the http://www.w3.org/TR/1999/REC-xpath-19991116 transform instead of the http://www.w3.org/2002/06/xmldsig-filter2 transform --&gt;

&lt;soap:Envelope xmlns:soap='http://schemas.xmlsoap.org/soap/envelope' &gt;
 &lt;soap:Header&gt;
   &lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd'
                  xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd'&gt;
     &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                               ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
     &lt;/wsse:BinarySecurityToken&gt;
     &lt;ds:Signature xmlns:ds='http://www.w3.org/2000/09/xmldsig#'&gt;
       &lt;ds:SignedInfo&gt;
         &lt;ds:CanonicalizationMethod Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#' /&gt;
         &lt;ds:SignatureMethod Algorithm='http://www.w3.org/2000/09/xmldsig#rsa-sha1' /&gt;
         &lt;ds:Reference URI=''&gt;
           &lt;ds:Transforms&gt;
             &lt;ds:Transform Algorithm='http://www.w3.org/TR/1999/REC-xpath-19991116'&gt;
               &lt;ds:XPath&gt;/soap:Envelope/soap:Body/*&lt;/ds:XPath&gt;
             &lt;/ds:Transform&gt;
             &lt;ds:Transform Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#' /&gt;
           &lt;/ds:Transforms&gt;
           &lt;ds:DigestMethod Algorithm='http://www.w3.org/2000/09/xmldsig#sha1' /&gt;
           &lt;ds:DigestValue&gt;VEPKwzfPGOxh2OUpoK0bcl58jtU=&lt;/ds:DigestValue&gt;
         &lt;/ds:Reference&gt;
       &lt;/ds:SignedInfo&gt;
       &lt;ds:SignatureValue&gt;+diIuEyDpV7qxVoUOkb5rj61+Zs=&lt;/ds:SignatureValue&gt;
       &lt;ds:KeyInfo&gt;
         &lt;wsse:SecurityTokenReference&gt;
            &lt;wsse:Reference
              URI='#SomeCert'
              ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot; /&gt;
         &lt;/wsse:SecurityTokenReference&gt;
       &lt;/ds:KeyInfo&gt;
     &lt;/ds:Signature&gt;
   &lt;/wsse:Security&gt;
 &lt;/soap:Header&gt;
 &lt;soap:Body xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd'
            wsu:Id='TheBody'&gt;
   &lt;m:SomeElement xmlns:m='http://example.org/ws' /&gt;
 &lt;/soap:Body&gt;
&lt;/soap:Envelope&gt;
</pre></div><div class="example"><p class="correct">CORRECT: </p><pre>
&lt;soap:Envelope xmlns:soap='http://schemas.xmlsoap.org/soap/envelope' &gt;
  &lt;soap:Header&gt;
    &lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd'
                   xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd'&gt;
      &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                                ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
      &lt;/wsse:BinarySecurityToken&gt;
      &lt;ds:Signature xmlns:ds='http://www.w3.org/2000/09/xmldsig#'&gt;
        &lt;ds:SignedInfo&gt;
          &lt;ds:CanonicalizationMethod Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#' /&gt;
          &lt;ds:SignatureMethod Algorithm='http://www.w3.org/2000/09/xmldsig#rsa-sha1' /&gt;
          &lt;ds:Reference URI=''&gt;
            &lt;ds:Transforms&gt;
              &lt;ds:Transform Algorithm='http://www.w3.org/2002/06/xmldsig-filter2'
                            xmlns:dsxp='http://www.w3.org/2002/06/xmldsig-filter2'&gt;
                &lt;dsxp:XPath Filter='intersect'&gt;/soap:Envelope/soap:Body/*&lt;/dsxp:XPath&gt;
              &lt;/ds:Transform&gt;
              &lt;ds:Transform Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#'&gt;
                &lt;xc14n:InclusiveNamespaces xmlns:xc14n='http://www.w3.org/2001/10/xml-exc-c14n#' /&gt;
              &lt;/ds:Transform&gt;
            &lt;/ds:Transforms&gt;
            &lt;ds:DigestMethod Algorithm='http://www.w3.org/2000/09/xmldsig#sha1' /&gt;
            &lt;ds:DigestValue&gt;VEPKwzfPGOxh2OUpoK0bcl58jtU=&lt;/ds:DigestValue&gt;
          &lt;/ds:Reference&gt;
        &lt;/ds:SignedInfo&gt;
        &lt;ds:SignatureValue&gt;+diIuEyDpV7qxVoUOkb5rj61+Zs=&lt;/ds:SignatureValue&gt;
        &lt;ds:KeyInfo&gt;
          &lt;wsse:SecurityTokenReference&gt;
            &lt;wsse:Reference
              URI='#SomeCert'
              ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot; /&gt;
          &lt;/wsse:SecurityTokenReference&gt;
        &lt;/ds:KeyInfo&gt;
      &lt;/ds:Signature&gt;
    &lt;/wsse:Security&gt;
  &lt;/soap:Header&gt;
  &lt;soap:Body xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd'
             wsu:Id='TheBody'&gt;
    &lt;m:SomeElement xmlns:m='http://example.org/ws' /&gt;
  &lt;/soap:Body&gt;
&lt;/soap:Envelope&gt;
</pre></div></div><h3 id="xmlSignatureAlgorithms">8.3 XML Signature Algorithms</h3><div class="refinement"><h4 id="Use_Exclusive_C14N">8.3.1 Use Exclusive C14N</h4><div class="rationale"><p><span class="statement-target"></span>
             Unless proper canonicalization is performed, verification of signatures may not work due to
             changes to the elements in the containing scope.
          </p></div><p class="statement"><span class="statement-id"><a name="R5404">R5404</a></span> 
             Any <span class="statement-target">CANONICALIZATION_METHOD</span> Algorithm attribute MUST have a value of
             &quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot; indicating that it uses Exclusive C14N without
             comments for canonicalization.
          </p><p class="statement"><span class="statement-id"><a name="R5406">R5406</a></span> 
             Any <span class="statement-target">CANONICALIZATION_METHOD</span> MUST contain an INCLUSIVE_NAMESPACES with a
			 PrefixList attribute unless the PrefixList is empty.
          </p><p class="statement"><span class="statement-id"><a name="R5407">R5407</a></span> 
             Any <span class="statement-target">TRANSFORM</span> with an Algorithm attribute with a value of &quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot;
			 MUST contain an INCLUSIVE_NAMESPACES with an PrefixList attribute unless the PrefixList is empty.
          </p><p class="statement"><span class="statement-id"><a name="R5413">R5413</a></span> 
			Any <span class="statement-target">TRANSFORM</span> with an Algorithm attribute with a value of
			&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#STR-Transform&quot;
			MUST have an INCLUSIVE_NAMESPACES with an PrefixList attribute unless the PrefixList is empty.
          </p><p class="statement"><span class="statement-id"><a name="R5405">R5405</a></span> 
			 Any <span class="statement-target">INCLUSIVE_NAMESPACES</span> MUST contain the prefix of all namespaces that are in-scope and desired
             to be protected, but not visibly utilized, for the element being signed and its descendants, per
             Exclusive XML Canonicalization Version 1.0.
          <span class="statement-type">C</span></p><p class="statement"><span class="statement-id"><a name="R5408">R5408</a></span> 
             Any <span class="statement-target">INCLUSIVE_NAMESPACES</span> MUST contain the string &quot;#default&quot; if a default namespace is in-scope and
             desired to be protected, but not visibly utilized, for the element being signed and its descendants,
             per Exclusive XML Canonicalization Version 1.0.
          </p><p class="statement"><span class="statement-id"><a name="R5414">R5414</a></span> 
             A <span class="statement-target">RECEIVER</span> MUST be capable of accepting and processing an INCLUSIVE_NAMESPACES PrefixList attribute
             containing prefixes in any order within the string.
          </p><p class="statement"><span class="statement-id"><a name="R5415">R5415</a></span> 
             A <span class="statement-target">RECEIVER</span> MUST be capable of accepting and processing an INCLUSIVE_NAMESPACES PrefixList attribute
             containing arbitrary whitespace before, after and between the prefixes within the string.
          </p><div class="explanation"><p><span class="statement-target"></span>
             The use of Exclusive Canonicalization with xc14n:InclusiveNamespaces/@Prefix addresses problems
             with both Inclusive Canonicalization and Exclusive Canonicalization without
             xc14n:InclusiveNamespaces/@Prefix.
          </p></div><p class="example-banner">For example,</p><div class="example"><p class="incorrect">INCORRECT: </p><pre>
&lt;!-- This example is incorrect because it uses the http://www.w3.org/TR/2001/REC-xml-c14n-20010315
canonicalization algorithm --&gt;

&lt;ds:CanonicalizationMethod Algorithm='http://www.w3.org/TR/2001/REC-xml-c14n-20010315' /&gt;
</pre></div><div class="example"><p class="incorrect">INCORRECT: </p><pre>
&lt;!-- This example is incorrect because the PrefixList of the xc14n:InclusiveNamespaces element does not contain the 
     correct list of prefixes. It should contain the bar prefix. --&gt;

&lt;soap:Envelope xmlns:soap='http://schemas.xmlsoap.org/soap/envelope'&gt;
  &lt;soap:Header&gt;
    &lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd'
                   xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd'&gt;
      &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                                ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
      &lt;/wsse:BinarySecurityToken&gt;
      &lt;ds:Signature xmlns:ds='http://www.w3.org/2000/09/xmldsig#'&gt;
        &lt;ds:SignedInfo&gt;
          &lt;ds:CanonicalizationMethod Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#' /&gt;
          &lt;ds:SignatureMethod Algorithm='http://www.w3.org/2000/09/xmldsig#rsa-sha1' /&gt;
          &lt;ds:Reference URI='#TheBody'&gt;
            &lt;ds:Transforms&gt;
              &lt;ds:Transform Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#'&gt;
                &lt;xc14n:InclusiveNamespaces xmlns:xc14n='http://www.w3.org/2001/10/xml-exc-c14n#' /&gt;
              &lt;/ds:Transform&gt;
            &lt;/ds:Transforms&gt;
            &lt;ds:DigestMethod Algorithm='http://www.w3.org/2000/09/xmldsig#sha1' /&gt;
            &lt;ds:DigestValue&gt;VEPKwzfPGOxh2OUpoK0bcl58jtU=&lt;/ds:DigestValue&gt;
          &lt;/ds:Reference&gt;
        &lt;/ds:SignedInfo&gt;
        &lt;ds:SignatureValue&gt;+diIuEyDpV7qxVoUOkb5rj61+Zs=&lt;/ds:SignatureValue&gt;
        &lt;ds:KeyInfo&gt;
          &lt;wsse:SecurityTokenReference&gt;
            &lt;wsse:Reference
              URI='#SomeCert'
              ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot; /&gt;
          &lt;/wsse:SecurityTokenReference&gt;
        &lt;/ds:KeyInfo&gt;
      &lt;/ds:Signature&gt;
    &lt;/wsse:Security&gt;
  &lt;/soap:Header&gt;
  &lt;soap:Body xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd'
             wsu:Id='TheBody'
			 xmlns:bar=&quot;http://bar.com&quot;&gt;
    &lt;m:SomeElement xmlns:m='http://example.org/ws' foo='bar:none'/&gt;
  &lt;/soap:Body&gt;
&lt;/soap:Envelope&gt;
</pre></div><div class="example"><p class="correct">CORRECT: </p><pre>
&lt;soap:Envelope xmlns:soap='http://schemas.xmlsoap.org/soap/envelope'&gt;
  &lt;soap:Header&gt;
    &lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd'
                   xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd'&gt;
      &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                                ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
      &lt;/wsse:BinarySecurityToken&gt;
      &lt;ds:Signature xmlns:ds='http://www.w3.org/2000/09/xmldsig#'&gt;
        &lt;ds:SignedInfo&gt;
          &lt;ds:CanonicalizationMethod Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#' /&gt;
          &lt;ds:SignatureMethod Algorithm='http://www.w3.org/2000/09/xmldsig#rsa-sha1' /&gt;
          &lt;ds:Reference URI='#TheBody'&gt;
            &lt;ds:Transforms&gt;
              &lt;ds:Transform Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#'&gt;
                &lt;xc14n:InclusiveNamespaces xmlns:xc14n='http://www.w3.org/2001/10/xml-exc-c14n#' PrefixList='bar' /&gt;
              &lt;/ds:Transform&gt;
            &lt;/ds:Transforms&gt;
            &lt;ds:DigestMethod Algorithm='http://www.w3.org/2000/09/xmldsig#sha1' /&gt;
            &lt;ds:DigestValue&gt;VEPKwzfPGOxh2OUpoK0bcl58jtU=&lt;/ds:DigestValue&gt;
          &lt;/ds:Reference&gt;
        &lt;/ds:SignedInfo&gt;
        &lt;ds:SignatureValue&gt;+diIuEyDpV7qxVoUOkb5rj61+Zs=&lt;/ds:SignatureValue&gt;
        &lt;ds:KeyInfo&gt;
          &lt;wsse:SecurityTokenReference&gt;
            &lt;wsse:Reference
              URI='#SomeCert'
              ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot; /&gt;
          &lt;/wsse:SecurityTokenReference&gt;
        &lt;/ds:KeyInfo&gt;
      &lt;/ds:Signature&gt;
    &lt;/wsse:Security&gt;
  &lt;/soap:Header&gt;
  &lt;soap:Body xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd'
             wsu:Id='TheBody'
			 xmlns:bar=&quot;http://bar.com&quot;&gt;
    &lt;m:SomeElement xmlns:m='http://example.org/ws' foo='bar:none'/&gt;
  &lt;/soap:Body&gt;
&lt;/soap:Envelope&gt;
</pre></div></div><div class="refinement"><h4 id="Transforms_Element">8.3.2 Transforms Element</h4><div class="rationale"><p><span class="statement-target"></span>
			At a minimum an XML Canonicalization Algorithm needs to be specified for each Reference, necessitating a ds:Transforms element.
		  </p></div><p class="statement"><span class="statement-id"><a name="R5416">R5416</a></span> 
			Any <span class="statement-target">SIG_REFERENCE</span> MUST contain a SIG_TRANSFORMS.
		  </p></div><div class="refinement"><h4 id="Transform_Element">8.3.3 Transform Element</h4><div class="rationale"><p><span class="statement-target"></span>
                    Canonicalization is critical to ensuring signatures are processed correctly,
                    thus each ds:Reference will need at least one ds:Transform to specify the
                    Exclusive C14N Canonicalization transform or a transform which itself incorporates
                    Exclusive C14N Canonicalization.
                  </p></div><p class="statement"><span class="statement-id"><a name="R5411">R5411</a></span> 
                    Any <span class="statement-target">SIG_TRANSFORMS</span> MUST contain at least one SIG_TRANSFORM.
                  </p><p class="statement"><span class="statement-id"><a name="R5412">R5412</a></span> 
                    Any SIG_TRANSFORMS MUST contain as its last child a SIG_TRANSFORM with an Algorithm attribute with a value of
                    &quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot; or
					&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#STR-Transform&quot; or
					&quot;http://docs.oasis-open.org/wss/oasis-wss-SwAProfile-1.1#Attachment-Content-Signature-Transform&quot; or
					&quot;http://docs.oasis-open.org/wss/oasis-wss-SwAProfile-1.1#Attachment-Complete-Signature-Transform&quot;.
                  </p><p class="example-banner">For example,</p><div class="example"><p class="incorrect">INCORRECT: </p><pre>
&lt;!-- This example is incorrect because the ds:Reference element does not have a ds:Transforms child element --&gt;

&lt;ds:Reference URI='#TheBody'&gt;
   &lt;ds:DigestMethod Algorithm='http://www.w3.org/2000/09/xmldsig#sha1' /&gt;
   &lt;ds:DigestValue&gt;VEPKwzfPGOxh2OUpoK0bcl58jtU=&lt;/ds:DigestValue&gt;
&lt;/ds:Reference&gt;
</pre></div><div class="example"><p class="correct">CORRECT: </p><pre>
&lt;ds:Reference URI='#TheBody'&gt;
   &lt;ds:Transforms&gt;
      &lt;ds:Transform Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#'/&gt;
      &lt;/ds:Transform&gt;
   &lt;/ds:Transforms&gt;
   &lt;ds:DigestMethod Algorithm='http://www.w3.org/2000/09/xmldsig#sha1' /&gt;
   &lt;ds:DigestValue&gt;+VTJraRYFT3pl7Z4uAWhmr5+bf4=&lt;/ds:DigestValue&gt;
&lt;/ds:Reference&gt;
</pre></div></div><div class="refinement"><h4 id="Digest_Algorithm">8.3.4 Digest Algorithm</h4><div class="rationale"><p><span class="statement-target"></span>
			The SHA1 Digest algorithm is widely-implemented and interoperable hence the recommendation that it be used for signature digests.
		  </p></div><p class="statement"><span class="statement-id"><a name="R5420">R5420</a></span> 
			Any <span class="statement-target">DIGEST_METHOD</span> Algorithm attribute SHOULD have the value &quot;http://www.w3.org/2000/09/xmldsig#sha1&quot;.
		  </p></div><div class="refinement"><h4 id="Key_Signature_Algorithms">8.3.5 Key Signature Algorithms</h4><div class="rationale"><p><span class="statement-target"></span>
			The two algorithms listed are widely-implemented and interoperable. Two algorithms are needed, one symmetric, one asymmetric.
		  </p></div><p class="statement"><span class="statement-id"><a name="R5421">R5421</a></span> 
			Any <span class="statement-target">SIGNATURE_METHOD</span> Algorithm attribute SHOULD have a value of
			&quot;http://www.w3.org/2000/09/xmldsig#hmac-sha1&quot; or &quot;http://www.w3.org/2000/09/xmldsig#rsa-sha1&quot;.
		  </p></div><div class="refinement"><h4 id="Transform_Algorithm">8.3.6 Transform Algorithm</h4><div class="rationale"><p><span class="statement-target"></span>
                    These algorithms are chosen for their cryptographic strength,
                    utility or because they address some security concern.
          </p></div><p class="statement"><span class="statement-id"><a name="R5423">R5423</a></span> 
                    Any <span class="statement-target">SIG_TRANSFORM</span> Algorithm attribute MUST have a value
                    of &quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot;
                    or &quot;http://www.w3.org/2002/06/xmldsig-filter2&quot;
                    or &quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#STR-Transform&quot;
                    or &quot;http://www.w3.org/2000/09/xmldsig#enveloped-signature&quot;
                    or &quot;http://docs.oasis-open.org/wss/oasis-wss-SwAProfile-1.1#Attachment-Content-Signature-Transform&quot;
                    or &quot;http://docs.oasis-open.org/wss/oasis-wss-SwAProfile-1.1#Attachment-Complete-Signature-Transform&quot;
          </p><p class="example-banner">For example,</p><div class="example"><p class="correct">CORRECT: </p><pre>
&lt;soap:Envelope xmlns:soap='http://schemas.xmlsoap.org/soap/envelope' &gt;
  &lt;soap:Header&gt;
    &lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd'
                   xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd'&gt;
      &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                                ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
      &lt;/wsse:BinarySecurityToken&gt;
      &lt;xenc:EncryptedKey xmlns:xenc='http://www.w3.org/2001/04/xmlenc#' &gt;
        &lt;xenc:EncryptionMethod Algorithm='http://www.w3.org/2001/04/xmlenc#rsa-1_5' /&gt;
        &lt;ds:KeyInfo xmlns:ds='http://www.w3.org/2000/09/xmldsig#'&gt;
          &lt;wsse:SecurityTokenReference&gt;
            &lt;wsse:Reference
              URI='#SomeCert'
              ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot; /&gt;
          &lt;/wsse:SecurityTokenReference&gt;
        &lt;/ds:KeyInfo&gt;
        &lt;xenc:CipherData&gt;
          &lt;xenc:CipherValue&gt;
            XZEEVABD3L9G+VNTCDiDTE7WB1a4kILtz5f9FT747eE=       
          &lt;/xenc:CipherValue&gt;
        &lt;/xenc:CipherData&gt;
      &lt;/xenc:EncryptedKey&gt;
      &lt;ds:Signature xmlns:ds='http://www.w3.org/2000/09/xmldsig#'&gt;
        &lt;ds:SignedInfo&gt;
          &lt;ds:CanonicalizationMethod Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#' /&gt;
          &lt;ds:SignatureMethod Algorithm='http://www.w3.org/2000/09/xmldsig#hmac-sha1' /&gt;
          &lt;ds:Reference URI='#TheBody'&gt;
            &lt;ds:Transforms&gt;
              &lt;ds:Transform Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#' /&gt;
            &lt;/ds:Transforms&gt;
            &lt;ds:DigestMethod Algorithm='http://www.w3.org/2000/09/xmldsig#sha1' /&gt;
            &lt;ds:DigestValue&gt;+VTJraRYFT3pl7Z4uAWhmr5+bf4=&lt;/ds:DigestValue&gt;
          &lt;/ds:Reference&gt;
        &lt;/ds:SignedInfo&gt;
        &lt;ds:SignatureValue&gt;+diIuEyDpV7qxVoUOkb5rj61+Zs=&lt;/ds:SignatureValue&gt;
      &lt;/ds:Signature&gt;
    &lt;/wsse:Security&gt;
  &lt;/soap:Header&gt;
  &lt;soap:Body xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd'
             wsu:Id='TheBody'&gt;
    &lt;m:SomeElement xmlns:m='http://example.org/ws' /&gt;
  &lt;/soap:Body&gt;
&lt;/soap:Envelope&gt;
</pre></div><div class="example"><p class="correct">CORRECT: </p><pre>
&lt;soap:Envelope xmlns:soap='http://schemas.xmlsoap.org/soap/envelope' &gt;
  &lt;soap:Header&gt;
    &lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd'
                   xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd'&gt;
      &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                                ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
      &lt;/wsse:BinarySecurityToken&gt;
      &lt;ds:Signature xmlns:ds='http://www.w3.org/2000/09/xmldsig#'&gt;
        &lt;ds:SignedInfo&gt;
          &lt;ds:CanonicalizationMethod Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#' /&gt;
          &lt;ds:SignatureMethod Algorithm='http://www.w3.org/2000/09/xmldsig#rsa-sha1' /&gt;
          &lt;ds:Reference URI='#TheBody'&gt;
            &lt;ds:Transforms&gt;
              &lt;ds:Transform Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#' /&gt;
            &lt;/ds:Transforms&gt;
            &lt;ds:DigestMethod Algorithm='http://www.w3.org/2000/09/xmldsig#sha1' /&gt;
            &lt;ds:DigestValue&gt;+VTJraRYFT3pl7Z4uAWhmr5+bf4=&lt;/ds:DigestValue&gt;
          &lt;/ds:Reference&gt;
        &lt;/ds:SignedInfo&gt;
        &lt;ds:SignatureValue&gt;+diIuEyDpV7qxVoUOkb5rj61+Zs=&lt;/ds:SignatureValue&gt;
        &lt;ds:KeyInfo&gt;
          &lt;wsse:SecurityTokenReference&gt;
            &lt;wsse:Reference
              URI='#SomeCert'
              ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot; /&gt;
          &lt;/wsse:SecurityTokenReference&gt;
        &lt;/ds:KeyInfo&gt;
      &lt;/ds:Signature&gt;
    &lt;/wsse:Security&gt;
  &lt;/soap:Header&gt;
  &lt;soap:Body xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd'
             wsu:Id='TheBody'&gt;
    &lt;m:SomeElement xmlns:m='http://example.org/ws' /&gt;
  &lt;/soap:Body&gt;
&lt;/soap:Envelope&gt;
</pre></div><p class="ednote"><strong>Editors' note:</strong>Update the SwA Profile URIs when final.</p></div><h3 id="xmlSignatureSyntax">8.4 XML Signature Syntax</h3><p><span class="statement-target"></span>XML-Signature Syntax and Processing defines many elements and attributes.
                    The Basic Security Profile 1.0 places the following constraints on the syntax of signatures:</p><div class="refinement"><h4 id="ds_HMACOutputLength">8.4.1 ds:HMACOutputLength</h4><div class="rationale"><p><span class="statement-target"></span>
                      The ds:HMACOutputLength provides an input parameter to the HMAC-SHA1 algorithm specifying how many bits of the output to use.    Disallowing use of this element results in ALL the bits of the output being used.
                    </p></div><p class="statement"><span class="statement-id"><a name="R5401">R5401</a></span> 
                      Any <span class="statement-target">SIGNATURE_METHOD</span> MUST NOT contain a ds:HMACOutputLength element.
                    </p><p class="example-banner">For example,</p><div class="example"><p class="incorrect">INCORRECT: </p><pre>
&lt;!-- This example is incorrect because the ds:SignatureMethod element has a ds:HMACOutputLength child element --&gt;
&lt;ds:SignatureMethod Algorithm='http://www.w3.org/2000/09/xmldsig#hmac-sha1'&gt;
   &lt;ds:HMACOutputLength&gt;128&lt;/ds:HMACOutputLength&gt;
&lt;/ds:SignatureMethod&gt;
</pre></div><div class="example"><p class="correct">CORRECT: </p><pre>
&lt;ds:SignatureMethod Algorithm='http://www.w3.org/2000/09/xmldsig#hmac-sha1' /&gt;
</pre></div></div><div class="refinement"><h4 id="ds_KeyInfo_with_ds_Signature">8.4.2 ds:KeyInfo with ds:Signature</h4><div class="rationale"><p><span class="statement-target"></span>
                    The ds:KeyInfo element allows for many different child elements.
                    The Profile mandates a single element, wsse:SecurityTokenReference, 
                    which is needed to reference security tokens.
                    </p></div><p class="statement"><span class="statement-id"><a name="R5402">R5402</a></span> 
                    Any <span class="statement-target">SIG_KEY_INFO</span> MUST contain exactly one child element.
                  </p><p class="statement"><span class="statement-id"><a name="R5417">R5417</a></span> 
                    Any <span class="statement-target">SIG_KEY_INFO</span> MUST contain a SECURITY_TOKEN_REFERENCE child element.
                  </p><p class="example-banner">For example,</p><div class="example"><p class="correct">CORRECT: </p><pre>
&lt;ds:KeyInfo xmlns:ds='http://www.w3.org/2000/09/xmldsig#' &gt;
   &lt;wsse:SecurityTokenReference&gt;
      &lt;wsse:Reference URI='#SomeCert'
                      ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot; /&gt;
   &lt;/wsse:SecurityTokenReference&gt;
&lt;/ds:KeyInfo&gt;
</pre></div></div><div class="refinement"><h4 id="ds_Manifest">8.4.3 ds:Manifest</h4><div class="rationale"><p><span class="statement-target"></span>The ds:Manifest element is designed for specific application level use cases that do not apply to the use of XML Signature in SOAP Message Security.</p></div><p class="statement"><span class="statement-id"><a name="R5403">R5403</a></span> 
                        A <span class="statement-target">SIGNATURE</span> MUST NOT contain a ds:Manifest descendant element.
                    </p><p class="example-banner">For example,</p><div class="example"><p class="incorrect">INCORRECT: </p><pre>
&lt;!-- This example is incorrect because the ds:Signature element has a ds:Manifest grandchild element --&gt;

&lt;ds:Signature xmlns:ds='http://www.w3.org/2000/09/xmldsig#'&gt;
   &lt;ds:SignedInfo&gt;
      &lt;ds:CanonicalizationMethod Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#' /&gt;
      &lt;ds:SignatureMethod Algorithm='http://www.w3.org/2000/09/xmldsig#rsa-sha1' /&gt;
      &lt;ds:Reference URI='#TheManifest'&gt;
         &lt;ds:Transforms&gt;
            &lt;ds:Transform Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#' /&gt;
         &lt;/ds:Transforms&gt;
         &lt;ds:DigestMethod Algorithm='http://www.w3.org/2000/09/xmldsig#sha1' /&gt;
         &lt;ds:DigestValue&gt;OVuYKGY6KCGB0l0XHS3krj8vjek=&lt;/ds:DigestValue&gt;
      &lt;/ds:Reference&gt;
   &lt;/ds:SignedInfo&gt;
   &lt;ds:SignatureValue&gt;L7X0Zw23/zYQnX4+Z+p0gCygKQ0=&lt;/ds:SignatureValue&gt;
   &lt;ds:KeyInfo&gt;
      &lt;wsse:SecurityTokenReference&gt;
         &lt;wsse:Reference URI='#SomeCert'
                         ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot; /&gt;
      &lt;/wsse:SecurityTokenReference&gt;
   &lt;/ds:KeyInfo&gt;
   &lt;ds:Object&gt;
      &lt;ds:Manifest Id='TheManifest'&gt;
         &lt;ds:Reference URI='#TheBody'&gt;
            &lt;ds:Transforms&gt;
               &lt;ds:Transform Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#' /&gt;
            &lt;/ds:Transforms&gt;
            &lt;ds:DigestMethod Algorithm='http://www.w3.org/2000/09/xmldsig#sha1' /&gt;
            &lt;ds:DigestValue&gt;+VTJraRYFT3pl7Z4uAWhmr5+bf4=&lt;/ds:DigestValue&gt;
         &lt;/ds:Reference&gt;
      &lt;/ds:Manifest&gt;
   &lt;/ds:Object&gt;
&lt;/ds:Signature&gt;
</pre></div></div><div class="refinement"><h4 id="Encrypting_signatures">8.4.4 Encrypting signatures</h4><div class="rationale"><p><span class="statement-target"></span>If the value of a ds:DigestValue element in a SIGNATURE needs to be encrypted the entire parent ds:Signature element MUST be encrypted.</p></div><p class="statement"><span class="statement-id"><a name="R5440">R5440</a></span> A <span class="statement-target">SIGNATURE</span> MUST NOT have any xenc:EncryptedData elements amongst its descendants.</p></div><h2 id="xmlEncryption">9. XML Encryption</h2><p><span class="statement-target"></span>
                   Web Services Security: SOAP Message Security builds on XML Encryption,
                   defining usage of various elements from XML Encryption and a processing model.
                   The Basic Security Profile 1.0 places the constraints defined in this section on the use of
                   XML Encryption with Web Services Security: SOAP Message Security.
                   The Basic Security Profile 1.0 places no constraints on other use of XML Encryption.
                </p><p><span class="statement-target"></span>
                   In some areas the Basic Security Profile allows limited flexibility and
                   extensibility in the application of security to messages. Some agreement
                   between the SENDER and RECEIVER over which mechanisms and choices should
                   be used for message exchanges is necessary. Since no security policy description
                   language or negotiation mechanism is in scope for the Basic Security Profile,
                   some out of band agreement must be reached for which elements should be encrypted
                   and which data encryption, key transport and/or key wrap algorithms should be used.
                </p><p>This section of 
		  the Basic Security Profile 1.0 incorporates the following
		specifications by reference:
		</p><ul><li><a class="offsite" href="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0.pdf">Web Services Security: SOAP Message Security Section 9</a></li><li><a class="offsite" href="http://www.w3.org/TR/xmlenc-core/">XML Encryption Syntax and Processing</a></li></ul><h3 id="xmlEncryptProcessing">9.1 XML Encryption Processing Model</h3><div class="refinement"><h4 id="xenc_ReferenceList">9.1.1 xenc:ReferenceList</h4><div class="rationale"><p><span class="statement-target"></span>Some encryption steps might not produce an xenc:ReferenceList.
                    For those that do produce an xenc:ReferenceList, there must be a separate
                    xenc:ReferenceList for each such encryption step. When there is a xenc:ReferenceList
                    either as a child of wsse:Security or as a child of xenc:EncryptedKey it must list
                    all the corresponding xenc:EncryptedData elements by using xenc:DataReference
                    elements.</p></div><p class="statement"><span class="statement-id"><a name="R3205">R3205</a></span> 
                    Any <span class="statement-target">ENC_REFERENCE_LIST</span> produced as part of an encryption step MUST use a single key.
                  </p><p class="statement"><span class="statement-id"><a name="R3228">R3228</a></span> 
                    Any <span class="statement-target">ENC_REFERENCE_LIST</span> MUST contain an xenc:DataReference element for each
                    ENCRYPTED_DATA produced in the associated encryption step.
                  </p><p class="statement"><span class="statement-id"><a name="R3214">R3214</a></span> 
                    Any <span class="statement-target">EK_REFERENCE_LIST</span> MUST contain a xenc:DataReference for each
                    ENCRYPTED_DATA produced in the associated encryption step.
                    </p></div><div class="refinement"><h4 id="xenc_EncryptedKey">9.1.2 xenc:EncryptedKey</h4><div class="rationale"><p><span class="statement-target"></span>To facilitate ease of processing,
                               keys are required to appear inside wsse:Security headers
                               and to appear before they are required for decryption of elements
                               inside a wsse:Security header.</p></div><p class="statement"><span class="statement-id"><a name="R3208">R3208</a></span> 
                    Any <span class="statement-target">ENCRYPTED_KEY</span> MUST precede any ENCRYPTED_DATA in the same SECURITY_HEADER
                    referenced by the associated EK_REFERENCE_LIST.
                    </p><p class="example-banner">For example,</p><div class="example"><p class="incorrect">INCORRECT: </p><pre>
&lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd'
               xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd' 
               xmlns:xenc='http://www.w3.org/2001/04/xmlenc#' 
               xmlns:ds='http://www.w3.org/2000/09/xmldsig#' &gt;
  &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                            ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
  &lt;/wsse:BinarySecurityToken&gt;
  &lt;xenc:EncryptedData Id='Enc1'&gt;
    &lt;xenc:EncryptionMethod Algorithm='http://www.w3.org/2001/04/xmlenc#tripledes-cbc' /&gt;
    &lt;xenc:CipherData&gt;
      &lt;xenc:CipherValue&gt;
9jFtYcLSlDZQBMjKfT7ctg6Jy+6sC8YORhiPeTvOjug7ozY2SRHGuLt8G/vf2f/f4IdF0ewiDOpq...
   &lt;/xenc:CipherValue&gt;
 &lt;/xenc:CipherData&gt;
&lt;/xenc:EncryptedData&gt;
&lt;xenc:EncryptedKey&gt;
  &lt;xenc:EncryptionMethod Algorithm='http://www.w3.org/2001/04/xmlenc#rsa-1_5' /&gt;
  &lt;ds:KeyInfo&gt;
    &lt;wsse:SecurityTokenReference&gt;
      &lt;wsse:Reference
        URI='#SomeCert'
        ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot; /&gt;
    &lt;/wsse:SecurityTokenReference&gt;
  &lt;/ds:KeyInfo&gt;
  &lt;xenc:CipherData&gt;
    &lt;xenc:CipherValue&gt;
      XZEEVABD3L9G+VNTCDiDTE7WB1a4kILtz5f9FT747eE=
    &lt;/xenc:CipherValue&gt;
    &lt;xenc:ReferenceList&gt;
      &lt;xenc:DataReference URI='#Enc1' /&gt;
    &lt;/xenc:ReferenceList&gt;
  &lt;/xenc:CipherData&gt;
&lt;/xenc:EncryptedKey&gt;
&lt;/wsse:Security&gt;
</pre></div><div class="example"><p class="correct">CORRECT: </p><pre>
&lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd'
               xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd' 
               xmlns:xenc='http://www.w3.org/2001/04/xmlenc#' 
               xmlns:ds='http://www.w3.org/2000/09/xmldsig#' &gt;
  &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                            ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
  &lt;/wsse:BinarySecurityToken&gt;
  &lt;xenc:EncryptedKey&gt;
   &lt;xenc:EncryptionMethod Algorithm='http://www.w3.org/2001/04/xmlenc#rsa-1_5' /&gt;
   &lt;ds:KeyInfo&gt;
     &lt;wsse:SecurityTokenReference&gt;
       &lt;wsse:Reference
         URI='#SomeCert'
         ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot; /&gt;
     &lt;/wsse:SecurityTokenReference&gt;
   &lt;/ds:KeyInfo&gt;
   &lt;xenc:CipherData&gt;
     &lt;xenc:CipherValue&gt;
       XZEEVABD3L9G+VNTCDiDTE7WB1a4kILtz5f9FT747eE=       
     &lt;/xenc:CipherValue&gt;
   &lt;/xenc:CipherData&gt;
   &lt;xenc:ReferenceList&gt;
     &lt;xenc:DataReference URI='#Enc1' /&gt;
   &lt;/xenc:ReferenceList&gt;
  &lt;/xenc:EncryptedKey&gt;
  &lt;xenc:EncryptedData Id='Enc1'&gt;
   &lt;xenc:EncryptionMethod Algorithm='http://www.w3.org/2001/04/xmlenc#tripledes-cbc' /&gt;
   &lt;xenc:CipherData&gt;
     &lt;xenc:CipherValue&gt;
9jFtYcLSlDZQBMjKfT7ctg6Jy+6sC8YORhiPeTvOjug7ozY2SRHGuLt8G/vf2f/f4IdF0ewiDOpq...
     &lt;/xenc:CipherValue&gt;
   &lt;/xenc:CipherData&gt;
  &lt;/xenc:EncryptedData&gt;
&lt;/wsse:Security&gt;
</pre></div></div><h3 id="xmlEncryptionKeys">9.2 XML Encryption Syntax</h3><p>The following specifications (or sections thereof) are referred to
		in this section of 
		  the Basic Security Profile 1.0:</p><ul><li><a class="offsite" href="http://www.w3.org/TR/xmlenc-core/">XML Encryption Syntax and Processing</a></li></ul><p><span class="statement-target"></span>XML Encryption Syntax and Processing defines many elements and attributes.
               The Basic Security Profile 1.0 places the following constraints on their use:</p><div class="refinement"><h4 id="Placement">9.2.1 Placement</h4><div class="rationale"><p><span class="statement-target"></span>
			Mandating that an xenc:EncryptedKey element contain a refernce list detailing which message parts
            were encrypted under that key aids message processing, unless it contains a symetric key that is
            also used for signing.
		  </p></div><p class="statement"><span class="statement-id"><a name="R3216">R3216</a></span> 
			Any <span class="statement-target">ENCRYPTED_KEY</span> that is used in an encryption step SHOULD contain a EK_REFERENCE_LIST.
		  </p><p class="example-banner">For example,</p><div class="example"><p class="incorrect">INCORRECT: </p><pre>
&lt;!-- This example is incorrect because the xenc:EncryptedKey element is missing an xenc:ReferenceList child element --&gt;

&lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd'
               xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd' 
               xmlns:xenc='http://www.w3.org/2001/04/xmlenc#' 
               xmlns:ds='http://www.w3.org/2000/09/xmldsig#' &gt;
  &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                            ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
  &lt;/wsse:BinarySecurityToken&gt;
  &lt;xenc:EncryptedKey&gt;
    &lt;xenc:EncryptionMethod Algorithm='http://www.w3.org/2001/04/xmlenc#rsa-1_5' /&gt;
    &lt;ds:KeyInfo&gt;
      &lt;wsse:SecurityTokenReference&gt;
        &lt;wsse:Reference
          URI='#SomeCert'
          ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot; /&gt;
      &lt;/wsse:SecurityTokenReference&gt;
    &lt;/ds:KeyInfo&gt;
    &lt;xenc:CipherData&gt;
      &lt;xenc:CipherValue&gt;
        XZEEVABD3L9G+VNTCDiDTE7WB1a4kILtz5f9FT747eE=       
      &lt;/xenc:CipherValue&gt;
    &lt;/xenc:CipherData&gt;
  &lt;/xenc:EncryptedKey&gt;
  &lt;xenc:ReferenceList&gt;
    &lt;xenc:DataReference URI='#Enc1' /&gt;
  &lt;/xenc:ReferenceList&gt;
  &lt;xenc:EncryptedData Id='Enc1'&gt;
    &lt;xenc:EncryptionMethod Algorithm='http://www.w3.org/2001/04/xmlenc#tripledes-cbc' /&gt;
    &lt;xenc:CipherData&gt;
      &lt;xenc:CipherValue&gt;
9jFtYcLSlDZQBMjKfT7ctg6Jy+6sC8YORhiPeTvOjug7ozY2SRHGuLt8G/vf2f/f4IdF0ewiDOpq...
      &lt;/xenc:CipherValue&gt;
    &lt;/xenc:CipherData&gt;
  &lt;/xenc:EncryptedData&gt;
&lt;/wsse:Security&gt;
</pre></div><div class="example"><p class="correct">CORRECT: </p><pre>
&lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd'
               xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd' 
               xmlns:xenc='http://www.w3.org/2001/04/xmlenc#' 
               xmlns:ds='http://www.w3.org/2000/09/xmldsig#' &gt;
  &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                            ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
  &lt;/wsse:BinarySecurityToken&gt;
  &lt;xenc:EncryptedKey&gt;
    &lt;xenc:EncryptionMethod Algorithm='http://www.w3.org/2001/04/xmlenc#rsa-1_5' /&gt;
    &lt;ds:KeyInfo&gt;
      &lt;wsse:SecurityTokenReference&gt;
        &lt;wsse:Reference
          URI='#SomeCert'
          ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot; /&gt;
      &lt;/wsse:SecurityTokenReference&gt;
    &lt;/ds:KeyInfo&gt;
    &lt;xenc:CipherData&gt;
      &lt;xenc:CipherValue&gt;
        XZEEVABD3L9G+VNTCDiDTE7WB1a4kILtz5f9FT747eE=       
      &lt;/xenc:CipherValue&gt;
    &lt;/xenc:CipherData&gt;
    &lt;xenc:ReferenceList&gt;
      &lt;xenc:DataReference URI='#Enc1' /&gt;
    &lt;/xenc:ReferenceList&gt;
  &lt;/xenc:EncryptedKey&gt;
  &lt;xenc:EncryptedData Id='Enc1'&gt;
    &lt;xenc:EncryptionMethod Algorithm='http://www.w3.org/2001/04/xmlenc#tripledes-cbc' /&gt;
    &lt;xenc:CipherData&gt;
      &lt;xenc:CipherValue&gt;
9jFtYcLSlDZQBMjKfT7ctg6Jy+6sC8YORhiPeTvOjug7ozY2SRHGuLt8G/vf2f/f4IdF0ewiDOpq...
      &lt;/xenc:CipherValue&gt;
    &lt;/xenc:CipherData&gt;
  &lt;/xenc:EncryptedData&gt;
&lt;/wsse:Security&gt;
</pre></div></div><div class="refinement"><h4 id="Prohibited_xenc_EncryptedKey_attributes">9.2.2 Prohibited xenc:EncryptedKey attributes</h4><div class="rationale"><p><span class="statement-target"></span>
			These prohibited attributes are not needed for xenc:EncryptedKey elements used to secure SOAP messages.
		  </p></div><p class="statement"><span class="statement-id"><a name="R3209">R3209</a></span> 
			Any <span class="statement-target">ENCRYPTED_KEY</span> MUST NOT specify a Type attribute.
		  </p><p class="statement"><span class="statement-id"><a name="R5622">R5622</a></span> 
			Any <span class="statement-target">ENCRYPTED_KEY</span> MUST NOT specify a MimeType attribute.
		  </p><p class="statement"><span class="statement-id"><a name="R5623">R5623</a></span> 
			Any <span class="statement-target">ENCRYPTED_KEY</span> MUST NOT specify a Encoding attribute.
		  </p></div><div class="refinement"><h4 id="xenc_EncryptedData_contents">9.2.3 xenc:EncryptedData contents</h4><div class="rationale"><p><span class="statement-target"></span>
			The ds:KeyInfo element is useful for determining the security token with which the relevant key material is associated.
		  </p></div><p class="statement"><span class="statement-id"><a name="R5629">R5629</a></span> 
			An <span class="statement-target">ENCRYPTED_DATA</span> which is not referenced from an ENCRYPTED_KEY MUST contain a ds:KeyInfo
          </p></div><div class="refinement"><h4 id="xenc_EncryptedData_attributes">9.2.4 xenc:EncryptedData attributes</h4><div class="rationale"><p><span class="statement-target"></span>
			All xenc:EncryptedData elements will be referred to from an xenc:Reference list. Such references use shorthand XPointers, hence this requirement.
		  </p></div><p class="statement"><span class="statement-id"><a name="R5624">R5624</a></span> 
			Any <span class="statement-target">ENCRYPTED_DATA</span> MUST have an Id attribute.
		  </p></div><div class="refinement"><h4 id="References_from_xenc_EncryptedData">9.2.5 References from xenc:EncryptedData</h4><div class="rationale"><p><span class="statement-target"></span>
			Security token references are intended to refer directly to security tokens. This requirement prohibits cases where a reference is made to a ds:KeyInfo which in turn contains another reference.
		  </p></div><p class="statement"><span class="statement-id"><a name="R3211">R3211</a></span> 
			Any <span class="statement-target">SECURITY_TOKEN_REFERENCE</span> inside an ENCRYPTED_DATA MUST NOT reference a ds:KeyInfo element.
		  </p></div><div class="refinement"><h4 id="xenc_EncryptionMethod_mandatory">9.2.6 xenc:EncryptionMethod mandatory</h4><div class="rationale"><p><span class="statement-target"></span>
			Specifying the encryption algorithm used to perform the encryption makes messages more self-describing and aids interoperability.		  </p></div><p class="statement"><span class="statement-id"><a name="R5601">R5601</a></span> 
			Any <span class="statement-target">ENCRYPTED_DATA</span> MUST contain an xenc:EncryptionMethod child element.
		  </p><p class="statement"><span class="statement-id"><a name="R5603">R5603</a></span> 
			Any <span class="statement-target">ENCRYPTED_KEY</span> MUST contain an xenc:EncryptionMethod child element.
		  </p><p class="example-banner">For example,</p><div class="example"><p class="incorrect">INCORRECT: </p><pre>
&lt;!-- This example is incorrect because the xenc:EncryptedKey element is missing an xenc:EncryptionMethod child element --&gt;

&lt;xenc:EncryptedKey&gt;
   &lt;ds:KeyInfo&gt;
      &lt;wsse:SecurityTokenReference&gt;
         &lt;wsse:Reference URI='#SomeCert'
                         ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot; /&gt;
      &lt;/wsse:SecurityTokenReference&gt;
   &lt;/ds:KeyInfo&gt;
   &lt;xenc:CipherData&gt;
      &lt;xenc:CipherValue&gt;
         XZEEVABD3L9G+VNTCDiDTE7WB1a4kILtz5f9FT747eE=       
      &lt;/xenc:CipherValue&gt;
   &lt;/xenc:CipherData&gt;
   &lt;xenc:ReferenceList&gt;
      &lt;xenc:DataReference URI='#Enc1' /&gt;
   &lt;/xenc:ReferenceList&gt;
&lt;/xenc:EncryptedKey&gt;
</pre></div><div class="example"><p class="incorrect">INCORRECT: </p><pre>
&lt;!-- This example is incorrect because the xenc:EncryptedData element is missing an xenc:EncryptionMethod child element --&gt;

&lt;xenc:EncryptedData Id='Enc1'&gt;
   &lt;xenc:CipherData&gt;
      &lt;xenc:CipherValue&gt;
9jFtYcLSlDZQBMjKfT7ctg6Jy+6sC8YORhiPeTvOjug7ozY2SRHGuLt8G/vf2f/f4IdF0ewiDOpq...
      &lt;/xenc:CipherValue&gt;
   &lt;/xenc:CipherData&gt;
&lt;/xenc:EncryptedData&gt;
</pre></div><div class="example"><p class="correct">CORRECT: </p><pre>
&lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd'
               xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd' 
               xmlns:xenc='http://www.w3.org/2001/04/xmlenc#' 
               xmlns:ds='http://www.w3.org/2000/09/xmldsig#' &gt;
  &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                            ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
  &lt;/wsse:BinarySecurityToken&gt;
  &lt;xenc:EncryptedKey&gt;
    &lt;xenc:EncryptionMethod Algorithm='http://www.w3.org/2001/04/xmlenc#rsa-1_5' /&gt;
    &lt;ds:KeyInfo&gt;
      &lt;wsse:SecurityTokenReference&gt;
        &lt;wsse:Reference
          URI='#SomeCert'
          ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot; /&gt;
      &lt;/wsse:SecurityTokenReference&gt;
    &lt;/ds:KeyInfo&gt;
    &lt;xenc:CipherData&gt;
      &lt;xenc:CipherValue&gt;
        XZEEVABD3L9G+VNTCDiDTE7WB1a4kILtz5f9FT747eE=       
      &lt;/xenc:CipherValue&gt;
    &lt;/xenc:CipherData&gt;
    &lt;xenc:ReferenceList&gt;
      &lt;xenc:DataReference URI='#Enc1' /&gt;
    &lt;/xenc:ReferenceList&gt;
  &lt;/xenc:EncryptedKey&gt;
  &lt;xenc:EncryptedData Id='Enc1'&gt;
    &lt;xenc:EncryptionMethod Algorithm='http://www.w3.org/2001/04/xmlenc#tripledes-cbc' /&gt;
    &lt;xenc:CipherData&gt;
      &lt;xenc:CipherValue&gt;
9jFtYcLSlDZQBMjKfT7ctg6Jy+6sC8YORhiPeTvOjug7ozY2SRHGuLt8G/vf2f/f4IdF0ewiDOpq...
      &lt;/xenc:CipherValue&gt;
    &lt;/xenc:CipherData&gt;
  &lt;/xenc:EncryptedData&gt;
&lt;/wsse:Security&gt;
</pre></div></div><div class="refinement"><h4 id="xenc_EncryptedKey/@Recipient">9.2.7 xenc:EncryptedKey/@Recipient</h4><div class="rationale"><p><span class="statement-target"></span>
			This attribute is prohibited because the soap:actor attribute conveys the same information.
		  </p></div><p class="statement"><span class="statement-id"><a name="R5602">R5602</a></span> 
			Any <span class="statement-target">ENCRYPTED_KEY</span> MUST NOT contain a Recipient attribute.
		  </p><p class="example-banner">For example,</p><div class="example"><p class="incorrect">INCORRECT: </p><pre>
&lt;!-- This example is incorrect because the xenc:EncryptedKey element has a Recipient attribute  --&gt;

&lt;xenc:EncryptedKey Recipient='Bert'&gt;
   &lt;xenc:EncryptionMethod Algorithm='http://www.w3.org/2001/04/xmlenc#rsa-1_5' /&gt;
   &lt;ds:KeyInfo&gt;
      &lt;wsse:SecurityTokenReference&gt;
         &lt;wsse:Reference URI='#SomeCert'
                         ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot; /&gt;
      &lt;/wsse:SecurityTokenReference&gt;
   &lt;/ds:KeyInfo&gt;
   &lt;xenc:CipherData&gt;
      &lt;xenc:CipherValue&gt;
         XZEEVABD3L9G+VNTCDiDTE7WB1a4kILtz5f9FT747eE=       
      &lt;/xenc:CipherValue&gt;
   &lt;/xenc:CipherData&gt;
   &lt;xenc:ReferenceList&gt;
      &lt;xenc:DataReference URI='#Enc1' /&gt;
   &lt;/xenc:ReferenceList&gt;
&lt;/xenc:EncryptedKey&gt;
</pre></div></div><div class="refinement"><h4 id="ds_KeyInfo_with_Encryption">9.2.8 ds:KeyInfo with Encryption</h4><div class="rationale"><p><span class="statement-target"></span>
             The ds:KeyInfo element allows for many different child elements.
             The Profile mandates a single element, wsse:SecurityTokenReference,
             which is needed to reference security tokens.
          </p></div><p class="statement"><span class="statement-id"><a name="R5424">R5424</a></span> 
			 Any <span class="statement-target">ENC_KEY_INFO</span> MUST have exactly one child element.
	      </p><p class="statement"><span class="statement-id"><a name="R5426">R5426</a></span> 
             Any <span class="statement-target">ENC_KEY_INFO</span> MUST contain a child SECURITY_TOKEN_REFERENCE.
          </p></div><div class="refinement"><h4 id="xenc_EncryptedData">9.2.9 xenc:EncryptedData</h4><div class="rationale"><p><span class="statement-target"></span>
			In order for the data to be protected from inspection, it must be replaced with the corresponding encrypted content.
		  </p></div><p class="statement"><span class="statement-id"><a name="R5606">R5606</a></span> 
		    Any encrypted element or element content within a <span class="statement-target">SECURE_ENVELOPE</span>,
            encrypted as a result of an encryption step, MUST be replaced by a
            corresponding ENCRYPTED_DATA, unless the element is a HEADER_ELEMENT.
		  <span class="statement-type">C</span></p><p class="statement"><span class="statement-id"><a name="R5614">R5614</a></span> 
			A <span class="statement-target">HEADER_ELEMENT</span> encrypted as a result of an encryption step MAY be
            replaced by a corresponding ENCRYPTED_DATA.
		  <span class="statement-type">C</span></p></div><div class="refinement"><h4 id="SOAP_Envelope">9.2.10 SOAP Envelope</h4><div class="rationale"><p><span class="statement-target"></span>
			Specifically, the Envelope, Header, or Body elements must not be encrypted.
			Encrypting any of the listed elements would break the SOAP processing model and so is prohibited.
		  </p></div><p class="statement"><span class="statement-id"><a name="R5607">R5607</a></span> 
			Any <span class="statement-target">SECURE_ENVELOPE</span> MUST still be a valid SOAP Envelope after encryption is applied.
		  </p></div><h3 id="ElementReferencesinXMLEncryption">9.3 Element References in XML Encryption</h3><div class="refinement"><h4 id="Reference_to_Elements_by_Shorthand_XPointer_(XMLENC)">9.3.1 Reference to Elements by Shorthand XPointer (XMLENC)</h4><div class="rationale"><p><span class="statement-target"></span>
			The above requirements ensure that Shorthand XPointer References are used where approriate
            and that they refer to the correct attribute values.
		  </p></div><p class="statement"><span class="statement-id"><a name="R5608">R5608</a></span> 
			Any <span class="statement-target">ENC_DATA_REFERENCE</span> MUST contain a URI attribute containing a 
			Shorthand XPointer reference value based on the ID attribute of the 
			referred to ENCRYPTED_DATA.
		  </p><p class="statement"><span class="statement-id"><a name="R5613">R5613</a></span> 
			Any <span class="statement-target">ENC_KEY_REFERENCE</span> MUST contain a  URI attribute containing a 
			Shorthand XPointer reference value based on the ID attribute of the 
			referred to ENCRYPTED_KEY.
		  </p><p class="statement"><span class="statement-id"><a name="R3006">R3006</a></span> 
			Any <span class="statement-target">EK_DATA_REFERENCE</span> MUST contain a URI attribute containing a 
			Shorthand XPointer reference value based on the ID attribute of the 
			referred to ENCRYPTED_DATA.
          </p><p class="statement"><span class="statement-id"><a name="R3007">R3007</a></span> 
			Any <span class="statement-target">EK_KEY_REFERENCE</span> MUST contain a URI attribute containing a 
			Shorthand XPointer reference value based on the ID attribute of the 
			referred to ENCRYPTED_KEY.
		  </p></div><h3 id="xmlEncryptionAlgorithms">9.4 XML Encryption Algorithms</h3><div class="refinement"><h4 id="Data_Encryption_Algorithms">9.4.1 Data Encryption Algorithms</h4><div class="rationale"><p><span class="statement-target"></span>
                       Data encryption algorithms are used for encrypting elements and element content.
                       Industries, organizations, and application domains are currently choosing from a variety of
                       data encryption algorithms based on reasons including performance, security characteristics,
                       and regulatory compliance.
                       A set of the most commonly chosen and widely deployed data encryption algorithms are supported
                       by the Basic Security Profile in order to avoid disenfranchising existing applications.
                       At some point in the future, if and when consensus is reached for a single data encryption
                       algorithm the Basic Security Profile 1.0 may be revised to constrain instances to use only that algorithm.
                    </p></div><p class="statement"><span class="statement-id"><a name="R5620">R5620</a></span> 
                       Any <span class="statement-target">ED_ENCRYPTION_METHOD</span> Algorithm attribute MUST have a value of
                       &quot;http://www.w3.org/2001/04/xmlenc#tripledes-cbc&quot;,
                       &quot;http://www.w3.org/2001/04/xmlenc#aes128-cbc&quot;
                       or &quot;http://www.w3.org/2001/04/xmlenc#aes256-cbc&quot;
                    </p><div class="explanation"><p><span class="statement-target"></span>
                       The 3DES algorithm (&quot;http://www.w3.org/2001/04/xmlenc#tripledes-cbc&quot;) is widely implemented
                       and deployed in existing practice.
                       The AES algorithm is relatively new and becoming widely implemented and deployed.
                       The 128-bit variation of AES (&quot;http://www.w3.org/2001/04/xmlenc#aes128-cbc&quot;) is relatively
                       faster but weaker than the 256-bit variation (&quot;http://www.w3.org/2001/04/xmlenc#aes256-cbc&quot;).
                    </p></div></div><div class="refinement"><h4 id="Key_Transport_Algorithms">9.4.2 Key Transport Algorithms</h4><div class="rationale"><p><span class="statement-target"></span>
                       Key transport algorithms are used for encrypting symmetric encryption keys,
                       such as data encryption keys, with asymmetric encryption keys.
                       This technique allows for encryption of relatively large amount of data with efficient
                       symmetric encryption and securely transmitting the associated relatively small symmetric
                       encryption key.
                       Industries, organizations, and application domains are currently choosing from a variety of
                       key transport algorithms based on reasons including performance, security characteristics,
                       and regulatory compliance.
                       A set of the most commonly chosen and widely deployed key transport algorithms are supported
                       by the Basic Security Profile in order to avoid disenfranchising existing applications.
                       At some point in the future, if and when consensus is reached for a single key transport
                       algorithm the Basic Security Profile 1.0 may be revised to constrain instances to use only that algorithm.
                    </p></div><p class="statement"><span class="statement-id"><a name="R5621">R5621</a></span> 
                       When used for Key Transport, any <span class="statement-target">EK_ENCRYPTION_METHOD</span> Algorithm attribute MUST have a value of
                       &quot;http://www.w3.org/2001/04/xmlenc#rsa-1_5&quot;
                       or &quot;http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p&quot;
                    </p><div class="explanation"><p><span class="statement-target"></span>
                       The RSA (PKCS#1.5) algorithm (&quot;http://www.w3.org/2001/04/xmlenc#rsa-1_5&quot;) is widely
                       implemented and deployed in existing practice.
                       The RSA-OAEP algorithm (&quot;http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p&quot;) is relatively
                       new and becoming widely implemented and deployed.
                    </p></div></div><div class="refinement"><h4 id="Key_Wrap_Algorithms">9.4.3 Key Wrap Algorithms</h4><div class="rationale"><p><span class="statement-target"></span>
                       Key wrap algorithms are used for encrypting symmetric encryption keys,
                       such as data encryption keys, with symmetric encryption keys.
                       Industries, organizations, and application domains are currently choosing from a variety of
                       key wrap algorithms based on reasons including performance, security characteristics,
                       and regulatory compliance.
                       A set of the most commonly chosen and widely deployed key wrap algorithms are supported
                       by the Basic Security Profile in order to avoid disenfranchising existing applications.
                       At some point in the future, if and when consensus is reached for a single key wrap
                       algorithm the Basic Security Profile 1.0 may be revised to constrain instances to use only that algorithm.
                    </p></div><p class="statement"><span class="statement-id"><a name="R5625">R5625</a></span> 
                       When used for Key Wrap, any <span class="statement-target">EK_ENCRYPTION_METHOD</span> Algorithm attribute MUST have a value of
                       &quot;http://www.w3.org/2001/04/xmlenc#kw-tripledes&quot;,
                       &quot;http://www.w3.org/2001/04/xmlenc#kw-aes128&quot;,
                       or &quot;http://www.w3.org/2001/04/xmlenc#kw-aes256&quot;.
                    </p><div class="explanation"><p><span class="statement-target"></span>
                       The 3DES algorithm (&quot;http://www.w3.org/2001/04/xmlenc#kw-tripledes&quot;) is widely implemented
                       and deployed in existing practice.
                       The AES algorithm is relatively new and becoming widely implemented and deployed.
                       The 128-bit variation of AES (&quot;http://www.w3.org/2001/04/xmlenc#kw-aes128&quot;) is relatively
                       faster but weaker than the 256-bit variation (&quot;http://www.w3.org/2001/04/xmlenc#kw-aes256&quot;).
                    </p></div></div><h2 id="algorithms">10. Algorithms</h2><p><span class="statement-target"></span>This section provides guidance, and in some cases requirements, concerning the use of various categories of algorithms.</p><h3 id="tlssslalg">10.1 Transport Level Security Algorithms</h3><p><span class="statement-target"></span>In SSL and TLS, choices of algorithms are expressed as ciphersuites.
			  The following subsections specify ciphersuites that are required, recommended,
			  discouraged and prohibited, respectively. The use of any other ciphersuite not
			  discussed below is optional.</p><div class="refinement"><h4 id="Mandatory_ciphersuites">10.1.1 Mandatory ciphersuites</h4><div class="rationale"><p><span class="statement-target"></span>
			The specified algorithm suites are considered to be widely-implemented, secure and interoperable.
		  </p></div><p class="statement"><span class="statement-id"><a name="R5701">R5701</a></span> 
			Any TLS-capable <span class="statement-target">INSTANCE</span> that is not FIPS compliant MUST support TLS_RSA_WITH_3DES_EDE_CBC_SHA
		  </p><p class="statement"><span class="statement-id"><a name="R5702">R5702</a></span> 
			Any SSL-capable <span class="statement-target">INSTANCE</span> that is not FIPS compliant MUST support SSL_RSA_WITH_3DES_EDE_CBC_SHA
		  </p><p class="statement"><span class="statement-id"><a name="R5703">R5703</a></span> 
			Any TLS-capable <span class="statement-target">INSTANCE</span> that is FIPS compliant MUST support TLS_RSA_FIPS_WITH_3DES_EDE_CBC_SHA
		  </p><p class="statement"><span class="statement-id"><a name="R5704">R5704</a></span> 
			Any SSL-capable <span class="statement-target">INSTANCE</span> that is FIPS compliant MUST support SSL_RSA_FIPS_WITH_3DES_EDE_CBC_SHA
		  </p></div><div class="refinement"><h4 id="Recommended_ciphersuites">10.1.2 Recommended ciphersuites</h4><div class="rationale"><p><span class="statement-target"></span>As the AES encryption algorithm is intended to supersede the 3DES algorithm,
				it is recommended that TLS-capable implementations implement TLS_RSA_WITH_AES_128_CBC_SHA
				or the FIPS equivalent, and SSL-capable implementations implement SSL_RSA_WITH_AES_128_CBC_SHA
				or the FIPS equivalent.</p></div></div><div class="refinement"><h4 id="Discouraged_ciphersuites">10.1.3 Discouraged ciphersuites</h4><div class="rationale"><p><span class="statement-target"></span>The ciphersuites defined in the SSL and TLS specifications that use anonymous Diffie-Helman
                 (i.e. those that have DH_anon in their symbolic name ) are vulnerable to man-in-the-middle attacks.
                 It is recommended that such ciphersuites be avoided.</p><p><span class="statement-target"></span>The Profile recommends against the use of the following ciphersuites due to their lack of confidentiality services:</p><ul><li><span class="statement-target"></span>SSL_RSA_WITH_NULL_SHA</li><li><span class="statement-target"></span>TLS_RSA_WITH_NULL_SHA</li><li><span class="statement-target"></span>SSL_RSA_WITH_NULL_MD5</li><li><span class="statement-target"></span>TLS_RSA_WITH_NULL_MD5</li></ul><p><span class="statement-target"></span>It is also recommended that ciphersuites that use 40 or 56 bit keys be avoided, due to their relative
              ease of compromise through brute-force attack.</p></div></div><div class="refinement"><h4 id="Prohibited_ciphersuites">10.1.4 Prohibited ciphersuites</h4><div class="rationale"><p><span class="statement-target"></span>The Profile does not prohibit the use of any transport layer security ciphersuites, but careful
             thought should be given prior to the use of any ciphersuites discussed under &quot;Discouraged ciphersuites&quot;. </p></div></div><h2 id="reltoBasicProfile">11. Relationship of Basic Security Profile as an Extension to Basic Profile</h2><p><span class="statement-target"></span>The Basic Security Profile is an extension profile to the Basic Profile.
                This means it is consistent with the Basic Profile but profiles additional functionality - how
                to add conformant security features to the Basic Profile when needed.</p><p><span class="statement-target"></span>As an extension of the Basic Profile, the Basic Security Profile is designed to support the
                addition of security functionality to SOAP messaging, in an interoperable manner. One example of
                such functionality is the confidentiality of selected SOAP header blocks and SOAP body elements
                through the use of OASIS Web Services Security encryption. The intent of such techniques is to
                change the nature of the SOAP message so that unintended parties cannot read such content. This
                means that the secured SOAP message is no longer obviously related to the original WSDL
                description, and is not intelligible without decryption. Other security mechanisms such as
                signatures may also modify the content of SOAP envelopes.</p><p><span class="statement-target"></span>The Basic Profile includes requirements on the content of SOAP envelopes
                (or in Basic Profile 1.0 the format of SOAP messages).
                Testing conformance to these statements by using a &quot;man-in-the-middle&quot;
                interceptor as outlined in the WS-I Monitor Tool Functional Specification will not be possible if
                encryption has been applied to portions of the SOAP envelope and have not yet been decrypted. Even
                if interception is possible, some messages may have a different structure due to security.</p><p><span class="statement-target"></span>Such SOAP messages still conform to the Basic Profile, since conformance to the Basic Profile
                means conformance once a receiver has reversed security changes introduced by a message sender.
                This is not obvious in some Basic Profile requirements, so this document further clarifies these
                requirements in the normative &quot;Basic Profile Clarifications&quot; section below.</p><p><span class="statement-target"></span>It is helpful to visualize a SOAP message in light of a protocol layering model, such as the
                ISO seven layer protocol model [ Tanenbaum ]. This model shows how a protocol is in fact composed
                of different layers, and how to a given layer underlying layers are transparent. The
                implementation of a given protocol layer at an endpoint may be modeled as that implementation
                consuming a service of the underlying protocol layer, and providing a service to the layer above
                it. In this model no protocol layer need be aware of layers above or below it, making the layer
                implementations independent. This is illustrated in Figure 1.</p><p><img src="http://members.ws-i.org/dman/Document.phx/Private+Folders/Community+Folder/Working+Groups/WSBasic+Security+Profile/Working+Documents/Profile/v1.0/images/Network+Layer+Diagram" /></p><p><span class="statement-target"></span>Figure 1: Protocol Stack with SOAP Message Security</p><p><span class="statement-target"></span>Traditionally, protocol layers have been distinguished by the use of protocol enveloping,
                where the message at one layer is conveyed as the body in the next lower layer. The sender passes
                a message to the lower level protocol implementation that packages it in a protocol envelope and
                sends it to the corresponding layer in the receiver. The sender and receiver at this lower layer
                perform whatever processing is necessary for delivery according to the specification of that layer,
                and finally the receiver passes the message up to the peer of the sender.</p><p><span class="statement-target"></span>SOAP Security may be viewed as a lower layer with respect to the more general SOAP web
                services application layer. Thus a SOAP sender may pass a SOAP message to a lower layer SOAP
                security implementation that applies encryption (for example), and sends the message to the
                destination SOAP Security layer, which removes the encryption before passing the message up to the
                peer SOAP web services application layer.</p><p><span class="statement-target"></span>Thus a Basic Profile interceptor and compliance monitoring activity should logically occur at
                a receiver at the interface between the SOAP security implementation and SOAP web services
                application layer.</p><p>This section of 
		  the Basic Security Profile 1.0 incorporates the following
		specifications by reference:
		</p><ul><li><a class="offsite" href="http://www.ws-i.org/Profiles/BasicProfile-1.0.html">Basic Profile Version 1.0 (BP1.0)</a></li><li><a class="offsite" href="http://www.ws-i.org/Profiles/BasicProfile-1.0-errata.html">Basic Profile Version 1.0 Errata</a></li><li><a class="offsite" href="http://www.ws-i.org/Profiles/BasicProfile-1.1.html">Basic Profile Version 1.1 (BP1.1)</a></li><li><a class="offsite" href="http://www.ws-i.org/Profiles/SimpleSoapBindingProfile-1.0.html">Simple SOAP Binding Profile Version 1.0 (SSBP1.0)</a></li></ul><h3 id="bpclarify">11.1 Basic Profile Clarifications</h3><p><span class="statement-target"></span>This section clarifies the BP1.0 (including Errata), BP1.1, SSBP1.0, and AP1.0 statements that might be
                    unclear when SOAP Message Security is applied in compliance with the Basic Security Profile.</p><p><span class="statement-target"></span>This section lists each possibly confusing BP1.0, BP1.1, SSBP1.0, and AP1.0 requirement
                    and an associated statement to clarify that requirement in the context of the basic security
                    profile.</p><p><span class="statement-target"></span>When these clarifying statements include the phrase &quot;reverse SOAP Message Security&quot; it
                    means to remove various impacts of applying SOAP Message Security that may have been applied
                    since the MESSAGE (BP1.0) or ENVELOPE (BP 1.1) was originally created for that recipient
                    according to the BP. This may mean decrypting relevant portions of the XML or removing XML
                    Signature elements or making other reverse transformations as appropriate to the aspects of
                    SOAP Message Security that were applied in the specific circumstance. </p><p><span class="statement-target"></span>Not all security must be reversed, only that for the intended recipient, as applied to
                    the BP compliant envelope before sent to that recipient.</p><div class="refinement"><h4 id="BP_Requirement_R2301">11.1.1 BP Requirement R2301</h4><div class="rationale"><p><span class="statement-target"></span>bp10:R2301 states &quot;The order of the elements in the soap:body of a MESSAGE MUST be
                        the same as that of the wsdl:parts in the  wsdl:message that describes it.&quot;</p><p><span class="statement-target"></span>bp11:R2301 states &quot;The order of the elements in the soap:body of an ENVELOPE MUST be
                        the same as that of the wsdl:parts in the wsdl:message that describes it.&quot;</p></div><p class="statement"><span class="statement-id"><a name="R5800">R5800</a></span> 
                bp10:R2301 MUST be true after any SOAP Message Security has been reversed for the <span class="statement-target">MESSAGE</span>
              </p><p class="statement"><span class="statement-id"><a name="R5801">R5801</a></span> 
                bp11:R2301 MUST be true after any SOAP Message Security has been reversed for the <span class="statement-target">ENVELOPE</span>
              </p></div><div class="refinement"><h4 id="BP_Requirement_R2710">11.1.2 BP Requirement R2710</h4><div class="rationale"><p><span class="statement-target"></span>bp10:R2710 states &quot;The operations in a wsdl:binding in a DESCRIPTION MUST result in
                        operation signatures that are different from one another.&quot;</p><p><span class="statement-target"></span>bp11:R2710 states &quot;The operations in a wsdl:binding in a DESCRIPTION MUST result in
                        operation signatures that are different from one another.&quot;</p></div><p class="statement"><span class="statement-id"><a name="R5802">R5802</a></span> 
                bp10:R2710 MUST be true after SOAP Message Security processing has been reversed for the <span class="statement-target">MESSAGE</span>
              </p><p class="statement"><span class="statement-id"><a name="R5803">R5803</a></span> 
                bp11:R2710 MUST be true after SOAP Message Security processing has been reversed for the <span class="statement-target">ENVELOPE</span>
              </p></div><div class="refinement"><h4 id="BP_Requirement_R2712">11.1.3 BP Requirement R2712</h4><div class="rationale"><p><span class="statement-target"></span>bp10:R2712 states &quot;A document-literal binding MUST be serialized as a
                        MESSAGE with a  soap:Body whose child element is an instance of the global element
                        declaration referenced by the corresponding wsdl:message part.&quot;
                </p><p><span class="statement-target"></span>bp11:R2712 states &quot;A document-literal binding MUST be serialized as an ENVELOPE
                        with a soap:Body whose child element is an instance of the global element declaration
                        referenced by the corresponding wsdl:message part.&quot;
                </p></div><p class="statement"><span class="statement-id"><a name="R5804">R5804</a></span> 
                bp10:R2712 MUST be true after any SOAP Message Security has been reversed for the <span class="statement-target">MESSAGE</span>
              </p><p class="statement"><span class="statement-id"><a name="R5805">R5805</a></span> 
                bp11:R2712 MUST be true after any SOAP Message Security has been reversed for the <span class="statement-target">ENVELOPE</span>
              </p></div><div class="refinement"><h4 id="BP_Requirement_R2724">11.1.4 BP Requirement R2724</h4><div class="rationale"><p><span class="statement-target"></span>
                  bp10:R2724 states &quot;If an INSTANCE receives a message that is inconsistent with its WSDL
                  description, it SHOULD generate a soap:Fault with a faultcode of 'Client', unless a
                  'MustUnderstand' or 'VersionMismatch' fault is generated.&quot;
                </p><p><span class="statement-target"></span>
                  bp11:R2724 states &quot;If an INSTANCE receives an envelope that is inconsistent with its WSDL
                  description, it SHOULD generate a soap:Fault with a faultcode of 'Client', unless a
                  'MustUnderstand' or 'VersionMismatch' fault is generated.&quot;
                </p></div><p class="statement"><span class="statement-id"><a name="R5806">R5806</a></span> 
                For bp10:R2724 &quot;Inconsistent&quot; MUST be taken to mean &quot;Inconsistent after SOAP Message security
                has been reversed&quot;, for the <span class="statement-target">MESSAGE</span>
              </p><p class="statement"><span class="statement-id"><a name="R5807">R5807</a></span> 
                For bp11:R2724 &quot;Inconsistent&quot; MUST be taken to mean &quot;Inconsistent after SOAP Message security has
                been reversed&quot;, for the <span class="statement-target">ENVELOPE</span>
              </p></div><div class="refinement"><h4 id="BP_Requirement_R2725">11.1.5 BP Requirement R2725</h4><div class="rationale"><p><span class="statement-target"></span>
                  bp10:R2725 states &quot;If an INSTANCE receives a message that is inconsistent with its WSDL
                  description, it MUST check for  &quot;VersionMismatch&quot;, &quot;MustUnderstand&quot; and &quot;Client&quot; fault
                  conditions in that order.&quot;
                </p><p><span class="statement-target"></span>
                  bp11:R2725 states &quot;If an INSTANCE receives an envelope that is inconsistent with its WSDL
                  description, it MUST check for &quot;VersionMismatch&quot;, &quot;MustUnderstand&quot; and &quot;Client&quot; fault conditions
                  in that order.&quot;
                </p></div><p class="statement"><span class="statement-id"><a name="R5808">R5808</a></span> 
                With respect to bp10:R2725 the <span class="statement-target">INSTANCE</span> must check for consistency of the MESSAGE per BP 1.0
                after reversing SOAP Message Security.
              </p><p class="statement"><span class="statement-id"><a name="R5809">R5809</a></span> 
                With respect to bp11:R2725 the <span class="statement-target">INSTANCE</span> must check for consistency of the ENVELOPE per BP 1.1
                after reversing SOAP Message Security.
              </p></div><div class="refinement"><h4 id="BP_Requirement_R2729">11.1.6 BP Requirement R2729</h4><div class="rationale"><p><span class="statement-target"></span>bp10:R2729 states &quot;A MESSAGE described with an rpc-literal binding that is a response message
                 MUST have a wrapper element whose name is the corresponding wsdl:operation name suffixed with the string 'Response'.&quot;
                </p><p><span class="statement-target"></span>bp11:R2729 states &quot;An ENVELOPE described with an rpc-literal binding that is a response MUST
                 have a wrapper element whose name is the corresponding wsdl:operation name suffixed with the string 'Response'.&quot;
                </p></div><p class="statement"><span class="statement-id"><a name="R5810">R5810</a></span> 
                With respect to bp10:R2729 the verification of the wrapper element name of the <span class="statement-target">MESSAGE</span> must be
                performed after reversing SOAP Message Security.
              </p><p class="statement"><span class="statement-id"><a name="R5811">R5811</a></span> 
                With respect to bp11:R2729 the verification of the wrapper element name of the <span class="statement-target">ENVELOPE</span> must be
                performed after reversing SOAP Message Security.
              </p></div><div class="refinement"><h4 id="BP_Requirement_R2738">11.1.7 BP Requirement R2738</h4><div class="rationale"><p><span class="statement-target"></span>bp10:R2738 states &quot;A MESSAGE MUST include all soapbind:headers specified on a
                        wsdl:input or wsdl:output of a wsdl:operation of a  wsdl:binding that describes it.</p><p><span class="statement-target"></span>bp11:R2738 states &quot;An ENVELOPE MUST include all soapbind:headers specified on a
                        wsdl:input or wsdl:output of a wsdl:operation of a wsdl:binding that describes it.&quot;</p></div><p class="statement"><span class="statement-id"><a name="R5812">R5812</a></span> 
                With respect to bp10:R2738 verification of a <span class="statement-target">MESSAGE</span> must occur after SOAP Message Security has
                been reversed.
              </p><p class="statement"><span class="statement-id"><a name="R5813">R5813</a></span> 
                With respect to bp11:R2738 verification of an <span class="statement-target">ENVELOPE</span> must occur after SOAP Message Security has
                been reversed.
              </p></div><div class="refinement"><h4 id="BP_Requirement_R1029">11.1.8 BP Requirement R1029</h4><div class="rationale"><p><span class="statement-target"></span>
                       This clarifies the Basic Profile's R1029 to reflect the fact that transmission
                       of security related faults may increase the vulnerablility to certain attacks
                       and in some cases faults should not be transmitted.
                   </p></div><p class="statement"><span class="statement-id"><a name="R5814">R5814</a></span> 
                       Where the normal outcome of processing a SECURE_ENVELOPE would have resulted
                       in the transmission of a SOAP Response, but rather a fault is generated
                       instead, a <span class="statement-target">RECEIVER</span> MAY transmit a fault or silently discard the message.
                   </p></div><h2 id="attachsec">12. Attachment Security</h2><p>This section of 
		  the Basic Security Profile 1.0 incorporates the following
		specifications by reference:
		</p><ul><li><a class="offsite" href="http://www.ws-i.org/Profiles/Basic/2003-08/AttachmentsProfile-1.0.pdf">Attachments Profile Version 1.0 (AP1.0)</a></li><li><a class="offsite" href="http://www.oasis-open.org/apps/org/workgroup/wss/download.php/10902/wss-swa-profile-1.0-cd-01.pdf">Web Services Security: SOAP Messages with Attachments (SwA) Profile 1.0</a></li></ul><p><span class="statement-target"></span>
		       The section provides guidance for protecting attachments when they are used with SOAP Messages.
		       As is explained in Section 3 Conformance all features described in the Basic Security Profile 1.0, including support
		       for attachments and security for attachments in any form by any instance is not required.
          </p><p><span class="statement-target"></span>
             SSL/TLS may be used to provide authentication, integrity and confidentiality protection, on a
             hop-by-hop basis, for an entire HTTP Message. This includes HTTP Headers, the SOAP Envelope, and
             all MIME_PARTs.
          </p><p><span class="statement-target"></span>
             SSL/TLS does not provide protection, except between adjacent HTTP Nodes, for HTTP Messages when
             the SOAP Message Path contains SOAP Intermediaries. An instance should not use SSL/TLS without
             WSS with Message Exchange Patterns (MEPs) that may contain SOAP intermediaries or when these
             security functions are required to be performed independently of the connection.
          </p><p><span class="statement-target"></span>
             WSS may be used to provide authentication, integrity and confidentiality protection for a subset
             of the SOAP Message and associated attachments. WSS provides protection for SOAP Messages and
             attachments when the SOAP Message Path contains SOAP Intermediaries. An instance should use WSS
             with MEPs that may contain SOAP Intermediaries or when these security functions are required to
             be performed independently of the transport layer connection.
          </p><p><span class="statement-target"></span>
             An instance may use SSL/TLS in conjunction with WSS if warranted by application security
             requirements. This combination provides integrity and confidentiality protection for the entire
             HTTP Message (on a hop-by-hop basis) including HTTP Headers, SOAP Envelope, and all MIME_PARTs.
          </p><p><span class="statement-target"></span>
             Application level security mechanisms, including XML Signature, XML Encryption, PKCS#7, S/MIME, etc.
             for attachment data may also be used by a instance where appropriate, but statements regarding the
             interoperability of such mechanisms are out of scope for the Basic Security Profile 1.0.
          </p><p><span class="statement-target"></span>
             The Basic Security Profile 1.0 describes one attachment security mechanism and URI.
          </p><h3 id="swa">12.1 SOAP with Attachments</h3><p>The following specifications (or sections thereof) are referred to
		in this section of 
		  the Basic Security Profile 1.0:</p><ul><li><a class="offsite" href="http://www.ws-i.org/Profiles/Basic/2003-08/AttachmentsProfile-1.0.pdf">Attachments Profile Version 1.0 (AP1.0)</a></li><li><a class="offsite" href="http://www.oasis-open.org/apps/org/workgroup/wss/download.php/10902/wss-swa-profile-1.0-cd-01.pdf">Web Services Security: SOAP Messages with Attachments (SwA) Profile 1.0</a></li></ul><div class="refinement"><h4 id="Conformance">12.1.1 Conformance</h4><div class="rationale"><p><span class="statement-target"></span>
			The Basic Security Profile is an extension profile to the Basic Profile,
            and thus this requirement makes it explicit that when using the WSS SwA profile
            in conformance to the BSP SwA profile section that the messages containing attachments
            must conform to the WS-I Attachments Profile 1.0. This is consistent with the WSS SwA profile and good practice.
		  </p></div><p class="statement"><span class="statement-id"><a name="R6001">R6001</a></span> 
			The <span class="statement-target">SECURE_MESSAGE</span> MUST conform to Attachments Profile 1.1.
		  </p></div><div class="refinement"><h4 id="Relationship_between_Parts">12.1.2 Relationship between Parts</h4><div class="rationale"><p><span class="statement-target"></span>
			The WSS SwA profile outlines how attachments may be secured when conveyed in conjunction
            with a primary SOAP envelope. The SOAP envelope is contained in a distinct MIME part.
            Attachment parts can contain arbitrary content as indicated by the MIME-Type, and an attachment
            could contain content with nested MIME parts. In order to enable interoperable processing at the
            SOAP messaging layer it is important to only secure the top-level MIME attachments that are in the
            same Multipart structure as the MIME part conveying the primary SOAP envelope.
		  </p></div><p class="statement"><span class="statement-id"><a name="R6002">R6002</a></span> 
			A signed and/or encrypted MIME_PART MUST be at the same MIME
			level as the root MIME_PART containing the SECURE_ENVELOPE.
		  </p></div><div class="refinement"><h4 id="Encryption_and_Root_Part">12.1.3 Encryption and Root Part</h4><div class="rationale"><p><span class="statement-target"></span>
			It is essential that SOAP processors (intermediaries and ultimate SOAP receiver) be able to process
            the primary SOAP envelope. For this reason, the MIME part containing the primary SOAP envelope must
            not be secured using the WSS SwA profile mechanisms. This includes encryption, since an encrypted SOAP
            structure cannot be processed, and signing, since this would preclude intermediary processing of the
            SOAP message, since this often involves adding, or removing headers. Note that WSS security may be
            applied to portions of the primary SOAP envelope in conformance with the BSP, but not by using attachment
            security mechanisms.
		  </p></div><p class="statement"><span class="statement-id"><a name="R6003">R6003</a></span> 
			A root MIME_PART MUST NOT be referenced by a SIG_REFERENCE,
			ENC_REFERENCE_LIST, or EK_REFERENCE_LIST.
		  </p></div><h3 id="signedAttachments">12.2 Signed Attachments</h3><div class="refinement"><h4 id="Reference_to_Signed_Attachments">12.2.1 Reference to Signed Attachments</h4><p class="statement"><span class="statement-id"><a name="R6100">R6100</a></span> 
			A <span class="statement-target">SIG_REFERENCE</span> to a MIME_PART MUST use a URI attribute of the form
			&quot;cid:partToBeSigned&quot;.
		  </p></div><div class="refinement"><h4 id="Attachment_Transforms">12.2.2 Attachment Transforms</h4><div class="rationale"><p><span class="statement-target"></span>
			The WSS SwA profile requires that a ds:Reference to an attachment part that is signed must use a
            transform specifying either the Attachment-Complete-Signature-Transform or the
            Attachment-Content-Signature-Transform URIs. This statement reiterates that requirement for testability.
		  </p></div><p class="statement"><span class="statement-id"><a name="R6101">R6101</a></span> 
			A <span class="statement-target">SIG_REFERENCE</span> to a MIME_PART MUST use a TRANSFORM specified by the Algorithm
            &quot;http://docs.oasis-open.org/wss/oasis-wss-SwAProfile-1.1#Attachment-Content-Signature-Transform&quot; 
			or &quot;http://docs.oasis-open.org/wss/oasis-wss-SwAProfile-1.1#Attachment-Complete-Signature-Transform&quot;.
		  </p></div><div class="refinement"><h4 id="Canonicalization">12.2.3 Canonicalization</h4><div class="rationale"><p><span class="statement-target"></span>
			Signature digest calculations require that the exact same input be provided to the digest
            algorithm both when the signature is created and when it is verified. Canonicalization is
            required to ensure the same literal representation despite changes due to message
            transformation during transport. XML exclusive canonicalization is required as part of the
            Attachment-Complete-Signature-Transform or Attachment-Content-Signature-Transform processing.
            A separate transform for canonicalization should not be provided since it is already included
            as part of the processing associated with these transforms.
		  </p></div><p class="statement"><span class="statement-id"><a name="R6103">R6103</a></span> 
			The output of the Attachment-Content-Signature-Transform or the XML octet stream portion of
            the output of the Attachment-Complete-Signature-Transform must be consistent with Exclusive
            XML Canonicalization without comments having been performed when creating that output.
		  </p></div><div class="refinement"><h4 id="Digest_Values">12.2.4 Digest Values</h4><div class="rationale"><p><span class="statement-target"></span>
			 Signature digest calculations require that the exact same input be provided to the
             digest algorithm both when the signature is created and when it is verified.
             Canonicalization is required to ensure the same literal representation despite changes due
             to message transformation during transport, for example line ending changes. MIME
             canonicalization algorithms are required for interoperability by WSS SwA profile.
             This statement reiterates that requirement for testability.
		   </p></div><p class="statement"><span class="statement-id"><a name="R6104">R6104</a></span> 
			Any <span class="statement-target">SIG_REFERENCE</span> to a MIME_PART not containing XML MUST include a ds:DigestValue
			calculated using MIME canonicalization according to the requirements of the
			MIME Type.
           </p><p class="statement"><span class="statement-id"><a name="R6108">R6108</a></span> 
			Any <span class="statement-target">SIG_REFERENCE</span> to a MIME_PART containing the &quot;application/text&quot; content type MUST include a
            ds:DigestValue which is calculated after the text is canonicalized according to MIME
            canonicalization algorithm for text.
		  </p><p class="statement"><span class="statement-id"><a name="R6109">R6109</a></span> 
			Any <span class="statement-target">SIG_REFERENCE</span> to a MIME_PART containing the an XML content type MUST include a
            ds:DigestValue which is calculated after the XML is canonicalized according to 
			Exclusive XML Canonicalization without comments, as specified by the URI
			&quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot;.
		  </p></div><div class="refinement"><h4 id="Content-Type">12.2.5 Content-Type</h4><div class="rationale"><p><span class="statement-target"></span>
			 Signature digest calculations require that the exact same input be provided to the digest algorithm
             both when the signature is created and when it is verified. Canonicalization is required to ensure
             the same literal representation despite changes due to message transformation during transport.
             It is essential to determine the correct type of canonicalization to perform, based on the MIME_PART
             content type. For this reason it is required that the Content-Type be explicitly stated with a
             Content-Type MIME header.
		   </p></div><p class="statement"><span class="statement-id"><a name="R6106">R6106</a></span> 
			 A <span class="statement-target">MIME_PART</span> referenced by a SIG_REFERENCE which specifies a Tranform algorithm of
             &quot;http://docs.oasis-open.org/wss/oasis-wss-SwAProfile-1.1#Attachment-Complete-Signature-Transform&quot;
			 MUST have a Content-Type MIME-header.
           </p><p class="statement"><span class="statement-id"><a name="R6107">R6107</a></span> 
			 A <span class="statement-target">MIME_PART</span> referenced by a SIG_REFERENCE which specifies a Tranform algorithm of
             &quot;http://docs.oasis-open.org/wss/oasis-wss-SwAProfile-1.1#Attachment-Content-Signature-Transform&quot;
             MUST have a Content-Type MIME-header.   </p></div><h3 id="encryptedAttachments">12.3 Encrypted Attachments</h3><div class="refinement"><h4 id="References_to_Encrypted_Attachments">12.3.1 References to Encrypted Attachments</h4><div class="rationale"><p><span class="statement-target"></span>
			 The WSS SwA profile requires that an EncryptedData element in the primary SOAP envelope be used to
             reference the encrypted MIME part. This statement reiterates that requirement for testability.
		   </p></div><p class="statement"><span class="statement-id"><a name="R6200">R6200</a></span> 
			 An encrypted <span class="statement-target">MIME_PART</span> MUST be referenced using an ENCRYPTED_DATA.
		   </p></div><div class="refinement"><h4 id="Type_attribute">12.3.2 Type attribute</h4><div class="rationale"><p><span class="statement-target"></span>
			 The WSS SwA profile requires that an EncryptedData element in the primary SOAP envelope that references
             an encrypted MIME part specify the Type as either Attachment-Content-Only or Attachment-Complete so that
             it can be processed correctly upon decryption. This statement reiterates that requirement for testability.
		   </p></div><p class="statement"><span class="statement-id"><a name="R6201">R6201</a></span> 
			An <span class="statement-target">ENCRYPTED_DATA</span> that references a MIME_PART MUST include a Type attribute
			with the value &quot;http://docs.oasis-open.org/wss/oasis-wss-SwAProfile-1.1#Attachment-Content-Only&quot; or 
			&quot;http://docs.oasis-open.org/wss/oasis-wss-SwAProfile-1.1#Attachment-Complete&quot;.
		   </p></div><div class="refinement"><h4 id="Reference_URIs">12.3.3 Reference URIs</h4><div class="rationale"><p><span class="statement-target"></span>
			 The WSS SwA profile requires that the EncryptedData element in the primary SOAP envelope that references
             an encrypted MIME part must reference the Cipherdata using the same cid: as the original attachment cid:,
             simplifying processing. This statement reiterates that requirement for testability.
		   </p></div><p class="statement"><span class="statement-id"><a name="R6202">R6202</a></span> 
			 An <span class="statement-target">ENCRYPTED_DATA</span> that references a MIME_PART MUST contain a
			 xenc:CipherData/xenc:CipherReference element with a URI attribute having the same URI
			 as the original MIME_PART.
		   </p></div><div class="refinement"><h4 id="Content">12.3.4 Content</h4><div class="rationale"><p><span class="statement-target"></span>
			 The WSS SwA profile specifies that when an attachment is encrypted, the resulting EncryptedData element be placed in the
			 wsse:Security header in the primary SOAP envelope and that the cipherdata be placed in the attachment part. This statement
             reiterates the requirement of replacing the content of the attachment with the cipherdata, for testability.
		   </p></div><p class="statement"><span class="statement-id"><a name="R6203">R6203</a></span> 
			 The content of a <span class="statement-target">MIME_PART</span> encrypted according to the WSS SwA profile MUST be replaced by the cipher value that results
             from encrypting the MIME_PART and is referenced from the CipherReference in the EncryptedData element.
           </p></div><h2 id="seccon">13. Security Considerations</h2><span class="statement-target"></span>
                This section lists a number of security considerations that should be taken into account
                when using one or more of the technologies discussed in the Basic Security Profile 1.0.
              <h3 id="transportsecConsiderations">13.1 SOAPAction Header</h3><span class="statement-target"></span>
		The use of the SOAPAction header in situations where the message content is being integrity or confidentiality 
		protected can result in security risks when the transport layer does not provide the same protection to the 
		SOAPAction header. The most obvious risk is that the SOAPAction header can potentially expose sensitive information 
		about a SOAP message such as the URI of the service, or the context of the transaction that is taking place. Another, 
		more subtle risk occurs in a situation where message routing is done based on the value of the SOAPAction header. 
		By modifying the value, an attacker could cause the message to be directed to a different receiver. This could 
		potentially defeat a replay detection mechanism that was based on the assumption that the message would always be 
		routed to the same place. Yet another risk occurs when intermediates are present. An intermediate might decide on a 
		set of processing steps based on the value of SOAPAction or application/soap+xml, which is subject to tampering. A 
		subsequent receiver might base its processing on the actual message content, which could be secured through XML signatures. 
		Suppose that the intermediate was a security gateway. It could be tricked into allowing a payment operation through that
		had only query security. 
                <div class="refinement"><h4 id="SOAPAction_header">13.1.1 SOAPAction header</h4><p class="statement"><span class="statement-id"><a name="C2010">C2010</a></span> 
                  In a <span class="statement-target">DESCRIPTION</span>, the soapAction attibute of a soapbind:operation 
                  element SHOULD be either omitted, or have as its value an empty string.
          </p></div><h3 id="clockSynch">13.2 Clock Synchronization</h3><span class="statement-target"></span>
                  The specifications covered by the Basic Security Profile 1.0 use time-based mechanisms to prevent replay
                  attacks. These mechanisms will be ineffective unless the system clocks of the various network
                  nodes are synchronized. Since the technology to perform distributed clock synchronization are
                  well known and widely available and are not among the technologies being profiled here, this
                  document does not specify how clock synchronization should be done. However, the recommendation
                  of the use of time-based security mechanisms implies that synchronization is being done.
                <h3 id="bindSTtoSigs">13.3 Security Token Substitution</h3><span class="statement-target"></span>
                  If a message is signed using a Security Token that binds a public verification key with
                  other claims, and specific processing is performed based on those claims, then in order to
                  protect against post-signature substitution of the Security Token with one that binds the same
                  key to different claims, Security Token itself should be part of the signature computation.
                  This can be acheived by putting a child ds:Reference element whose URI attribute contains a
                  shorthand XPointer reference to the wsse:SecurityTokenReference that specifies the Security
                  Token into the ds:SignedInfo element of a signature.
                <span class="statement-target"></span>
                  If a ds:SignedInfo contains one or more ds:Reference children whose URI attribute
                  contains a shorthand XPointer reference to a wsse:SecurityTokenReference that uses a
                  potentially ambiguous mechanism to refer to the Security Token (e.g. KeyIdentifier), then in
                  order to protect against post-signature substitution of the Security Token with one that binds
                  the same key to different claims, it is recommended that the content of the Security Token be
                  signed either directly or using the Security Token Dereferencing Transform.
                <div class="refinement"><h4 id="Security_Token_Substitution">13.3.1 Security Token Substitution</h4><p class="statement"><span class="statement-id"><a name="C5443">C5443</a></span> 
                  When the signer's SECURITY_TOKEN is an INTERNAL_SECURITY_TOKEN, the <span class="statement-target">SIGNED_INFO</span>
                  MAY include a SIG_REFERENCE that refers to the signer's SECURITY_TOKEN in order to
                  prevent substitution with another SECURITY_TOKEN that uses the same key.
                <span class="statement-type">C</span></p><p class="statement"><span class="statement-id"><a name="C5441">C5441</a></span> 
                  When the signer's SECURITY_TOKEN is an EXTERNAL_SECURITY_TOKEN, the <span class="statement-target">SIGNED_INFO</span>
                  MAY include a SIG_REFERENCE that refers to the SECURITY_TOKEN_REFERENCE that refers to
                  the signer's SECURITY_TOKEN using the Security Token Dereferencing Transform 
                  in order to prevent substitution of another SECURITY_TOKEN that uses the same key.
                <span class="statement-type">C</span></p></div><span class="statement-target"></span>
                  When a key is provided in band within a Security Token or otherwise for the purpose of specifying
                  a key to be used by another node for encrypting information to be sent in a future message, it
                  is recommended that the sender of the key cryptographicaly bind the key to the message in
                  which it is transmitted. This can be done either by using the key to perform a Signature or
                  HMAC over critical elements of the message body or by including the key under a signature
                  covering critical elements of the message body which uses some other key. If a key is sent in
                  a message which the receiver is expected to use to encrypt data in some future message, there
                  is a risk that an attacker could substitute some other key and thereby be able to read
                  unauthorized data. This is true even if the key is contained in a signed certificate, but is
                  not bound to the current message in some way. If the future encryption key is used to sign the
                  initial request, by verifying the signature, the receiver can determine that the key is the
                  one that was intended.
                <div class="refinement"><h4 id="Security_Token_Reference_in_Subsequent_Messages">13.3.2 Security Token Reference in Subsequent Messages</h4><p class="statement"><span class="statement-id"><a name="C5442">C5442</a></span> 
                  When an encryption key to be used in subsequent messages is provided in an INTERNAL_SECURITY_TOKEN,
                  a <span class="statement-target">SIGNED_INFO</span> MAY include a SIG_REFERENCE that refers to the signer's SECURITY_TOKEN in order to
                  prevent substitution with another SECURITY_TOKEN that uses the same key.
                <span class="statement-type">C</span></p></div><h3 id="removalModXML">13.4 Protecting against removal and modification of XML Elements</h3><p><span class="statement-target"></span>XML Signatures using Shorthand XPointer References (AKA IDREF) protect against the removal and modification of 
          XML elements; but do not protect the location of the element within the XML Document.</p><p><span class="statement-target"></span>Whether or not this is security vulnerability depends on whether the location of the signed data within its 
		  surrounding context has any semantic import. This consideration applies to data carried in the SOAP Body or 
		  the Header.</p><p><span class="statement-target"></span>Of particular concern is the ability to relocate signed data into a SOAP Header block which is unknown to the 
		  receiver and marked mustUnderstand=&quot;false&quot;. This could have the effect of causing the receiver to ignore signed 
		  data which the sender expected would either be processed or result in the generation of a mustUnderstand fault.</p><p><span class="statement-target"></span>A similar exploit would involve relocating signed data into a SOAP Header block targeted to a S11:actor or S12:role 
		  other than that which the sender intended, and which the receiver will not process.</p><p><span class="statement-target"></span>While these attacks could apply to any portion of the message, their effects are most pernicious with SOAP header 
		  elements which may not always be present, but must be processed whenever they appear.</p><p><span class="statement-target"></span>In the general case of XML Documents and Signatures, this issue may be resolved by signing the entire XML Document 
		  and/or strict XML Schema specification and enforcement. However, because elements of the SOAP message, particularly 
		  header elements, may be legitimately modified by SOAP intermediaries, this approach is usually not appropriate. It is 
		  RECOMMENDED that applications signing any part of the SOAP body sign the entire body.</p><p><span class="statement-target"></span>Alternatives countermeasures include (but are not limited to):</p><ul><li><span class="statement-target"></span>References using XPath transforms with Absolute Path expressions, </li><li><span class="statement-target"></span>A Reference using an XPath transform to include any significant location-dependent elements and exclude any elements 
		           that might legitimately be removed, added, or altered by intermediaries,</li><li><span class="statement-target"></span>Using only References to elements with location-independent semantics,</li><li><span class="statement-target"></span>
				Strict policy specification and enforcement regarding which message parts are to be signed. For example:
				<ul><li><span class="statement-target"></span>Requiring that the entire SOAP Body and all children of SOAP Header be signed,</li><li><span class="statement-target"></span>Requiring that SOAP header elements which are marked mustUnderstand=&quot;false&quot; and have signed descendents MUST include 
		              the mustUnderstand attribute under the signature.</li></ul></li></ul><h3 id="trustWhatIsSigned">13.5 Only What is Signed is Protected</h3><p><span class="statement-target"></span>A receiver should treat the origin of any unsigned content as suspect.
			Only the subset of message content that is signed by an entity can be
			trusted as having been produced or otherwise acknowledged by that entity.
			All other content should be treated as if it were placed in the message
			by an untrusted third party (potentially an adversary).</p><p><span class="statement-target"></span>XML Signatures allow fine grained selection of elements to be signed
			through a variety of means including Shorthand XPointer references to
			selected elements and references using transforms (such as XPath) that
			cause a value other than what would be obvious by examining the serialized
			content of the element (by adding, modifying, or removing a value) to
			be used for digest computation. This could allow values to be added,
			modified, or removed without detection. Therefore, a receiver should not
			consider it sufficient to verify that an element is referenced, but should
			also verify that the result of the application of the indicated transform
			algorithms produce the expected, trusted value.</p><h3 id="usesha1">13.6 Use of SHA1</h3><p><span class="statement-target"></span>BSP recommends using SHA1 based algorithms for interoperability purposes.
               If SHA1 based algorithms are deemed unsuitable, other algorithms (like SHA256)
               can be used.</p><h3 id="uniqueIds">13.7 Uniqueness of ID attributes</h3><span class="statement-target"></span>
                  XML 1.0 requires that all attributes of type ID in a given XML document have unique
                  values, but only validating XML processors have such type information. As various aspects of
                  SOAP Message Security use ID based references it is recommended that applications ensure that
                  ID attributes are unique by some mechanism.
                <h3 id="signSTs">13.8 Signing Security Tokens</h3><span class="statement-target"></span>
                  In general, tokens contain claims made by an authority, usually about some system entity.
                  Obviously a party relying on these claims must trust that authority to make them. The relying
                  party must generally verify these claims. The method of doing this depends on the token type
                  and is specified by the corresponding token profile.
                <h3 id="signUTs">13.9 Signing Username Tokens</h3><span class="statement-target"></span>
                  When a wsse:UsernameToken contains only a wsse:Username and wsse:PasswordText and is
                  simply presented for Authentication where replay is not a concern, it does not need to be
                  signed because the act of checking it against a stored value has the effect of verifying it.
                  When a wsse:Nonce and/or wsu:Created are used with the wsse:Username and wsse:PasswordText to
                  prevent replay, the wsse:UsernameToken must be signed to prevent undetected alteration of
                  these fields. If a wsse:PasswordText is being used to derive a key for a subsequent encryption
                  of a response, it should be signed to ensure that an attacker does not substitute an
                  alternative, but valid wsse:Username and wsse:PasswordText. This is equivalent to the key
                  substitution attack available when an X.509 Token is used for a similar purpose.
                <h3 id="signBTs">13.10 Signing Binary Tokens</h3><span class="statement-target"></span>
                  The content of a binary token will be a binary object which is integrity protected by a
                  mechanism specific to the object type. For example, an X.509 certificate will be signed by the
                  issuing authority. The outer wrapper of the binary token merely contains type indication
                  information which does not have to be integrity protected in order to be able to rely in the
                  claims.
                <h3 id="signXTs">13.11 Signing XML Tokens</h3><span class="statement-target"></span>
                  XML tokens should be digitally signed in a manner described by their profile (or
                  documents referenced by it), or delivered directly from their issuer over an integrity
                  protected channel.
                <h3 id="replayUTs">13.12 Replay of Username Token</h3><p><span class="statement-target"></span>A sender that includes a Nonce child in a UsernameToken element should anticipate that
                  the receiver may refuse to process the message due to either an accidental collision or
                  transport layer delays. Therefore, if it decides to retry transmission, it should do so with a
                  new Nonce.</p><p><span class="statement-target"></span>Unless other mechanisms are used to protect against replay of the username token,
                  service providers should retain nonces in a store that is shared between all SOAP nodes (and
                  within a distributed SOAP node all &quot;components&quot;) that can be authorized using the same
                  passwords.</p><p><span class="statement-target"></span>The policy that allows service providers to forget nonces may be based on any
                  considerations that the service considers relevant. When a nonce is forgotten the server
                  should ensure that in the future it rejects UsernameTokens with a Created time that is
                  earlier than the forgotten nonce.</p><div class="refinement"><h4 id="Replay_of_Username_Token">13.12.1 Replay of Username Token</h4><p class="statement"><span class="statement-id"><a name="C4210">C4210</a></span> 
                       Any <span class="statement-target">USERNAME_TOKEN</span> that contains a NONCE and PASSWORD with a Type attribute value of
                       &quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText&quot;
                       SHOULD be referenced by a SIG_REFERENCE in order to prevent replay. 
                    </p><p class="statement"><span class="statement-id"><a name="C4211">C4211</a></span> 
                       Any <span class="statement-target">USERNAME_TOKEN</span> that contains a CREATED and a PASSWORD with a Type attribute value of
                       &quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText&quot;
                       SHOULD be referenced by a SIG_REFERENCE in order to prevent replay. 
                    </p></div><h3 id="digVClearPass">13.13 Use of Digest vs. Cleartext Password</h3><p><span class="statement-target"></span>A sending application utilizing password authentication must decide whether to use a
				  cleartext password or a password digest (The sender needs to know via some out-of-band mechanism
				  and/or prior arrangement which mechanisms the receiver supports). The digest should always be
				  preferred if it can be used, as the digest algorithm does not reveal the password and can protect
				  against replay of the password. (It does not however, protect against offline guessing or brute
				  force attacks.)</p><p><span class="statement-target"></span>Password digests can only be used in situations where both sender and receiver can start
				  with the same secret value (e.g., the cleartext password or a hash of the password). The following
				  are criteria for considering when to use digests vs. cleartext:</p><p><span class="statement-target"></span>1. If the receiver can access the cleartext password, a digest may be used. </p><p><span class="statement-target"></span>2. If the receiver can access a value that can be derived by the sender directly from the
				  cleartext password (e.g., the receiver has access to a SHA1 hash of the password), the derived
				  value (e.g. the hash) may be used in the digest. </p><p><span class="statement-target"></span>3. If the sender needs extra information to derive the value available to the receiver, it
				  will not be feasible to use password digest, even though the information is not intentionally
				  secret. For example, UNIX systems add a salt value to each password before hashing it. It is
				  infeasible for the sender to discover the salt value required for a specific username.</p><p><span class="statement-target"></span>4. If the receiver does not have access to any password value, derived or otherwise, but
				  merely the ability to test a username/password combination for validity, a digest may not be used.
				  An example of this is when the username/password combination is presented to a database, directory
				  or mainframe system for verification.</p><p><span class="statement-target"></span>When sending any form of a password, cleartext or digest, confidentiality services are
				  strongly recommended to prevent its value from being revealed or from offline guessing.</p><h3 id="encSig">13.14 Encryption with Signatures</h3><p><span class="statement-target"></span>When a message contains a data value which does not have a significant number of probable
			      variations and that data is signed and then encrypted, it is recommended that the sender either
			      include some suitably random value such as a wsse:Nonce in the data, or encrypt the related
				  ds:DigestValue element in order to protect the confidentiality of the data.</p><p><span class="statement-target"></span>An adversary can compute the digest for each of the data values and compare them against the digests
				  in the signature thereby deducing the encrypted data value. This type of attack is most likely to
				  be successful when there are a relatively small set of probable data values. Therefore the threat
				  can be mitigated by introduction of some random value into the original data or encryption of the
				  digest.</p><div class="refinement"><h4 id="Encrypt_DigestValue">13.14.1 Encrypt DigestValue</h4><p class="statement"><span class="statement-id"><a name="C5630">C5630</a></span> 
                        Any <span class="statement-target">SIGNATURE</span> computed over data that is subsequently encrypted SHOULD also be encrypted
                        in order to prevent plaintext guessing attacks when the probable set of data values is small.  
                    </p></div><h3 id="operr">13.15 Possible Operational Errors</h3><p><span class="statement-target"></span>Under SOAP processing rules, there is no way a sender can be sure that a message containing a security
			header addressed to a given Role/Actor will ever reach a node that is taking on that Role/Actor. If not,
			the specified security processing will not occur.</p><p><span class="statement-target"></span>Under SOAP processing rules, there is no way a sender can determine in what order nodes taking on specific
			Role/Actor's will be reached. If signatures and encryptions specified in different security headers overlap,
			verification and decryption operations may fail as a result of being processed in the wrong order. (Generally
			overlapping signatures will verify regardless of the order of verification.) This problem can be avoided by
			never specifying overlapping operations in distinct headers, however application requirements may not prevent
			this. For example, many senders may wish to include the entire Body under a signature, possibly before or after
			encrypting portions of it.</p><p><span class="statement-target"></span>Under SOAP processing rules, there is no way a sender can determine which particular secrets are possessed
			by a node taking on a given Role/Actor. If a node is required to perform decryption or verify an HMAC and it
			does not posses the necessary secret, it will be unable to perform these operations. This will not only impact
			its operation, but in the case it is an intermedairy may make it possible for nodes receiving the message
			subsequently from performing security processing correctly due to overlapping operations, even when that node
			does posses the necessary secrets.</p><p><span class="statement-target"></span>If a namespace that is in fact visibly used within some text to be Canonicalized via the Exclusive C14N
			Algorithm is included in the bar PrefixList, then under some valid transformations of the transmitted document
			signature verification may spuriously fail, because the Canonicalized form shifts the location of of a namespace
			declaration. This case is expected to be rare in practice.</p><h2 id="references">Appendix A: Referenced Specifications</h2><p>The following specifications' requirements are incorporated
				into 
		  the Basic Security Profile 1.0 by reference, except where superseded by the
				Profile:</p><ul><li><a class="offsite" href="http://www.ietf.org/rfc/rfc2818.txt">HTTP over TLS</a></li><li><a class="offsite" href="http://www.ietf.org/rfc/rfc2246.txt">The TLS Protocol Version 1.0</a></li><li><a class="offsite" href="http://wp.netscape.com/eng/ssl3/ssl-toc.html">The SSL Protocol Version 3.0</a></li><li><a class="offsite" href="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0.pdf">Web Services Security: SOAP Message Security 1.0 (WS-Security 2004) OASIS Standard 200401, March 2004</a></li><li><a class="offsite" href="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0.pdf">Web Services Security UsernameToken Profile 1.0 OASIS Standard 200401, March 2004</a></li><li><a class="offsite" href="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0.pdf">Web Services Security X.509 Certificate Token Profile OASIS Standard 200401, March 2004</a></li><li><a class="offsite" href="http://www.ietf.org/rfc/rfc2459.txt">RFC2459: Internet X.509 Public Key Infrastructure Certificate and CRL Profile</a></li><li><a class="offsite" href="http://www.itu.int/rec/recommendation.asp?type=items&amp;lang=e&amp;parent=T-REC-X.509-200110-I!Cor1">Information technology &quot;Open Systems
Interconnection&quot; The Directory: Public-key and attribute certificate frameworks Technical Corrigendum 1</a></li><li><a class="offsite" href="http://www.w3.org/TR/xmldsig-core/">XML-Signature Syntax and Processing</a></li><li><a class="offsite" href="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0.pdf">Web Services Security: SOAP Message Security Section 9</a></li><li><a class="offsite" href="http://www.w3.org/TR/xmlenc-core/">XML Encryption Syntax and Processing</a></li><li><a class="offsite" href="http://www.ws-i.org/Profiles/BasicProfile-1.0.html">Basic Profile Version 1.0 (BP1.0)</a></li><li><a class="offsite" href="http://www.ws-i.org/Profiles/BasicProfile-1.0-errata.html">Basic Profile Version 1.0 Errata</a></li><li><a class="offsite" href="http://www.ws-i.org/Profiles/BasicProfile-1.1.html">Basic Profile Version 1.1 (BP1.1)</a></li><li><a class="offsite" href="http://www.ws-i.org/Profiles/SimpleSoapBindingProfile-1.0.html">Simple SOAP Binding Profile Version 1.0 (SSBP1.0)</a></li><li><a class="offsite" href="http://www.ws-i.org/Profiles/Basic/2003-08/AttachmentsProfile-1.0.pdf">Attachments Profile Version 1.0 (AP1.0)</a></li><li><a class="offsite" href="http://www.oasis-open.org/apps/org/workgroup/wss/download.php/10902/wss-swa-profile-1.0-cd-01.pdf">Web Services Security: SOAP Messages with Attachments (SwA) Profile 1.0</a></li></ul><h2 id="points">Appendix B: Extensibility Points</h2><p>This section identifies extensibility points, as defined in
				&quot;Scope of 
		  the Basic Security Profile 1.0,&quot; for 
		  the Basic Security Profile 1.0's component
				specifications.</p><p>These mechanisms are out of the scope
				of 
		  the Basic Security Profile 1.0; their use may affect interoperability, and may
				require private agreement between the parties to a Web
				service.</p><p>In <a class="offsite" href="http://www.ietf.org/rfc/rfc2246.txt">The TLS Protocol Version 1.0:</a></p><ul><li><span class="statement-id">E0009</span> - <strong>TLS Ciphersuites</strong> - TLS allows for the use of arbitrary encryption algorithms. Note that while section 10.1 of the Basic Security Profile 1.0 mandates,
recommends, and discourages support for certain ciphersuites, the Basic Security Profile 1.0 does not prohibit use of any specific ciphersuite.</li><li><span class="statement-id">E0010</span> - <strong>TLS Extensions</strong> - TLS allows for extensions during the handshake phase.</li></ul><p>In <a class="offsite" href="http://wp.netscape.com/eng/ssl3/ssl-toc.html">The SSL Protocol Version 3.0:</a></p><ul><li><span class="statement-id">E0011</span> - <strong>SSL Ciphersuites</strong> - SSL allows for the use of arbitrary encryption algorithms. Note that while section 10.1 of the Basic Security Profile 1.0 mandates,
recommends, and discourages support for certain ciphersuites, the Basic Security Profile 1.0 does not prohibit use of any specific ciphersuite.</li></ul><p>In <a class="offsite" href="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0.pdf">Web Services Security: SOAP Message Security 1.0 (WS-Security 2004) OASIS Standard 200401, March 2004:</a></p><ul><li><span class="statement-id">E0002</span> - <strong>Security Tokens</strong> - Security tokens may be specified in additional security token profiles.</li></ul><p>In <a class="offsite" href="http://www.ietf.org/rfc/rfc2459.txt">RFC2459: Internet X.509 Public Key Infrastructure Certificate and CRL Profile:</a></p><ul><li><span class="statement-id">E0012</span> - <strong>Certificate Authority</strong> - The choice of the Certificate Authority is a private agreement between parties.</li><li><span class="statement-id">E0013</span> - <strong>Certificate Extensions</strong> - X.509 allows for arbitrary certificate extensions.</li></ul><h2 id="acks">Appendix C: Acknowledgements</h2><p>This document is the work of the WS-I Basic Security Profiles Working Group, whose members have included:</p><p>
	  Jan Alexander (Microsoft Corporation),
      Steve Anderson (BMC),
	  Paula Austel (IBM),
	  Siddharth Bajaj (Verisign),
	  Frank Balluffi (Deutsche Bank),
	  Abbie Barbir (Nortel),
	  David Baum (Kantega AS),
	  Randy Bias (Grand Central Communications),
	  Tim Bond (webMethods, Inc.),
	  Heidi Buelow (Quovadx),
	  David Burdett (Commerce One, Inc.),
	  Ted Burghart (Hitachi, Ltd.)
	  Symon Chang (TIBCO, Inc.),
	  Richard Chennault, (Kaiser Permanente),
	  Dipak Chopra (SAP AG),
	  Jamie Clark (OASIS),
	  Edward Cobb (BEA Systems, Inc.),
	  David Cohen (Merrill Lynch),
	  Brett Cooper, (Accenture),
	  Ugo Corda (SeeBeyond Technology),
	  Paul Cotton (Microsoft Corporation),
	  Suresh Damodaran, (Rosettanet),
	  Mark Davis (Intel),
	  Alex Deacon (Verisign),
	  Thomas DeMartini (ContentGuard, Inc.),
	  Blake Dournaee (Intel),
	  Rob Drew (Charlse Schwab),
	  Gregory Elkins (Reed Elsevier),
	  Mark Ericson (Mindreef),
	  Jon Oyvind Eriksen (Kantega AS),
	  Chris Ferris (IBM),
	  Bob Freund, (Hitachi),
	  Edwin Goei (Sun Microsystems),
	  Grant Goodale (Reactivity, Inc.),
	  Marc Goodner (SAP AG),
	  Phil Goodwin (Sun Microsystems),
	  Marc Graveline (Cognos, Inc.),
	  Eric Gravengaard (Reactivity, Inc.),
	  Thomas Gross (IBM),
	  Martin Gudgin (Microsoft Corporation),
	  Marc Hadley (Sun Microsystems),
	  Mark Hapner (Sun Microsystems),
	  Nathan Harris (Kaiser Permanente),
	  Bret Hartman (IBM),
	  Frederick Hirsch (Nokia),
	  Jason Hogg (Microsoft Corporation),
	  Maryann Hondo (IBM),
	  Lawrence Hsiung (Quovadx),
	  Tony Huber (Commerce Quest),
	  Jim Hughes (Hewlett-Packard),
	  Michael Hui (Computer Associates),
	  Brian Jackson (Avanade, Inc.),
	  Steve Jenisch (SAS Institute),
	  Erik Johnson (Epicor),
	  Chris Kaler (Microsoft Corporation),
	  Anish Karmarkar (Oracle Corporation),
	  Dana Kaufman, (Forum Systems),
	  Manveen Kaur (Sun Microsystems),
	  Slava Kavsan (RSA Security),
	  Paul Knight (Nortel Networks),
	  Chris Kurt (Microsoft Corporation),
	  Kelvin Lawrence (IBM),
	  Hal Lockhart (BEA Systems),
	  Brad Lund (Intel Corporation),
	  Jim Luth (OPC Foundation),
	  Paul Madsen (Entrust, Inc.),
	  Eve Maler (Sun Microsystems),
	  Skip Marler (Parasoft),
	  Axl Mattheus (Sun Microsystems),
	  Michael McIntosh (IBM),
	  Craig Milhiser, (Ascential),
	  Chris Miller (Accenture),
      Prateek Mishra (Oracle Corporation)
	  Dale Moberg (Cyclone Commerce),
	  Ron Monzillo (Sun Microsystems),
	  K. Scott Morrison, (Layer 7)
	  Tim Moses (Entrust, Inc.),
	  Tony Nadalin (IBM),
	  Nataraj Nagaratnam (IBM),
	  Andrew Nash (RSA Security),
	  Hsin Ning (Bestning Technologies),
	  Eisaku Nishiyama (Hitachi, Ltd.),
	  Mark Nottingham (BEA Systems, Inc.),
	  TJ Pannu (ContentGuard, Inc.),
	  Martine Pean (Quovadx),
	  Robert Philpott (RSA Security),
	  Dave Prout (BT),
	  Joe Pruitt (F5 Networks, Inc.),
	  Eric Rejkovic (Oracle Corporation),
	  Matt Recupito (Accenture),
	  Jason Rouault (Hewlett-Packard),
	  Rich Salz (IBM),
	  Matt Sanchez (Webify Solutions, Inc. ),
	  Jerry Schwarz (Oracle Corporation),
	  Senthil Sengodan (Nokia),
	  Shawn Sharp (Cyclone Commerce),
	  Aslak Siira (F5 Networks, Inc.),
	  David Solo (Citigroup, Inc.),
	  Davanum Srinivas (Computer Associates),
	  Raghavan Srinivas (Sun Microsystems),
	  John Stanton (Defense Information Systems Agency),
	  Andrew Stone (Accenture),
	  Julie Surer (MITRE),
	  Wes Swenson (Forum Systems),
	  Dino Vitale (Citigroup, Inc.),
	  Jonathan Wenocur (IBM),
	  Pete Wenzel (Sun Microsystems),
	  Ian White (Micro Focus)
    </p></body>
</html>