<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3c.org/TR/1999/REC-html401-19991224/loose.dtd">

<HTML                                     ><HEAD><TITLE>Basic Security Profile - Version 1.0 (WGD)</TITLE>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<STYLE type=text/css>BODY {
	BACKGROUND: white; MARGIN: 16pt 24pt; COLOR: black; FONT-FAMILY: sans-serif
}
DT {
	PADDING-TOP: 0.5em; FONT-STYLE: italic
}
H4 {
	FONT-WEIGHT: normal; FONT-SIZE: 0.8em; MARGIN-BOTTOM: 0px; FONT-STYLE: italic
}
.refinement {
	MARGIN: 18pt 0em
}
.statement {
	MARGIN: 0.5em 5.5em; TEXT-INDENT: -4em; FONT-STYLE: italic
}
.statement-id {
	PADDING-RIGHT: 0.3em; PADDING-LEFT: 0.3em; PADDING-BOTTOM: 0em; PADDING-TOP: 0em; FONT-STYLE: normal; BACKGROUND-COLOR: #ffa
}
.statement-target {
	FONT-WEIGHT: bold; FONT-STYLE: normal
}
.statement-type {
	PADDING-RIGHT: 0.3em; PADDING-LEFT: 0.3em; FONT-SIZE: 0.7em; PADDING-BOTTOM: 0em; VERTICAL-ALIGN: text-top; PADDING-TOP: 0em; FONT-STYLE: normal; BACKGROUND-COLOR: #ccf
}
.statement-origin {
	PADDING-RIGHT: 0.3em; PADDING-LEFT: 0.3em; FONT-SIZE: 0.7em; PADDING-BOTTOM: 0em; VERTICAL-ALIGN: text-top; PADDING-TOP: 0em; FONT-STYLE: normal; BACKGROUND-COLOR: #fcc
}
.rationale {
	MARGIN: 0.5em 0em
}
.explanation {
	MARGIN: 0.5em 0em
}
.definition {
	MARGIN: 0.5em 5.5em
}
.explanation P {
	MARGIN: 0.25em 0px
}
.rationale P {
	MARGIN: 0.25em 0px
}
.practice {
	BACKGROUND-COLOR: green
}
.example {
	PADDING-RIGHT: 0.5em; PADDING-LEFT: 0.5em; PADDING-BOTTOM: 0.5em; MARGIN: 0.5em 2em; PADDING-TOP: 0.5em; BACKGROUND-COLOR: #eee
}
.example-banner {
	MARGIN: 0px
}
.example PRE {
	MARGIN: 0px
}
.correct {
	FONT-WEIGHT: bold; FONT-SIZE: 0.9em; MARGIN: 0px; FONT-FAMILY: sans-serif
}
.incorrect {
	FONT-WEIGHT: bold; FONT-SIZE: 0.9em; MARGIN: 0px; FONT-FAMILY: sans-serif
}
.correct {
	COLOR: #090
}
.incorrect {
	COLOR: #900
}
.specification {
	PADDING-RIGHT: 0.5em; PADDING-LEFT: 0.5em; PADDING-BOTTOM: 0.5em; MARGIN: 0.5em 2em; PADDING-TOP: 0.5em; BACKGROUND-COLOR: #ffa
}
.ednote {
	PADDING-RIGHT: 1.2em; PADDING-LEFT: 1.2em; PADDING-BOTTOM: 1.2em; MARGIN: 1.2em; PADDING-TOP: 1.2em; BACKGROUND-COLOR: #fcc
}
.note {
	MARGIN-LEFT: 1.5em; BACKGROUND-COLOR: #fcc
}
.toc {
	MARGIN-LEFT: 2em
}
.subtoc {
	MARGIN-LEFT: 3em
}
.subsubtoc {
	MARGIN-LEFT: 4em
}
.chg {
	BACKGROUND-COLOR: orange; TEXT-DECORATION: underline
}
.add {
	BACKGROUND-COLOR: green; TEXT-DECORATION: underline
}
.del {
	BACKGROUND-COLOR: red; TEXT-DECORATION: line-through
}

media Print    
{
A.offsite:unknown {
	FONT-WEIGHT: lighter; FONT-SIZE: 85%;}
    }
UNKNOWN {
	FONT-SIZE: 50%; COLOR: #ccc; TEXT-DECORATION: none;}
</STYLE>

<META content="MSHTML 6.00.2800.1479" name=GENERATOR></HEAD>
<BODY>
<DIV class=head>
<P><A href="http://www.ws-i.org/"><IMG height=88 alt=WS-I 
src="http://www.ws-i.org/images/WS-I-logo.gif" width=107 
border=0> </A></P>
<H1>Basic Security Profile Version 1.0</H1>
<H2>Working Group Draft</H2>
<H2>Date: 2005/01/20</H2>
<DL>
  <DT>This revision: 
  <DD><A 
  href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html">http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html</A> 
  <DT>Latest revision: 
  <DD><A 
  href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0.html">http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0.html</A>
  <DT>Editors: 
  <DD>Abbie Barbir, Nortel Networks 
  <DD>Martin Gudgin, Microsoft 
  <DD>Michael McIntosh, IBM 
  <DD>K. Scott Morrison, Layer 7 
  <DT>Administrative contact: 
  <DD><A href="mailto:secretary@ws-i.org">secretary@ws-i.org</A> </DD></DL>
<P class=copyright id=copyright>Copyright © 2002-2005 by <A 
href="http://www.ws-i.org/">The Web Services-Interoperability Organization</A> 
(<ABBR 
title="Web Services Interoperability&#13;&#10;&#9;&#9;&#9;Organization">WS-I</ABBR>) 
and Certain of its Members. All Rights Reserved.</P></DIV>
<HR>

<H2 id=abstract>Abstract</H2>
<P>This document defines the WS-I Basic Security Profile 1.0, based on a set of 
non-proprietary Web services specifications, along with clarifications and 
amendments to those specifications which promote interoperability.</P>
<H2 id=status>Status of this Document</H2>
<P>This document is a Working Group Draft; it has been accepted by the Working 
Group as reflecting the current state of discussions. It is a work in progress, 
and should not be considered authoritative or final; other documents may 
supersede this document. </P>
<H2 id=license>Notice</H2>
<P>The material contained herein is not a license, either expressly or 
impliedly, to any intellectual property owned or controlled by any of the 
authors or developers of this material or WS-I. The material contained herein is 
provided on an &quot;AS IS&quot; basis and to the maximum extent permitted by applicable 
law, this material is provided AS IS AND WITH ALL FAULTS, and the authors and 
developers of this material and WS-I hereby disclaim all other warranties and 
conditions, either express, implied or statutory, including, but not limited to, 
any (if any) implied warranties, duties or conditions of merchantability, of 
fitness for a particular purpose, of accuracy or completeness of responses, of 
results, of workmanlike effort, of lack of viruses, and of lack of negligence. 
ALSO, THERE IS NO WARRANTY OR CONDITION OF TITLE, QUIET ENJOYMENT, QUIET 
POSSESSION, CORRESPONDENCE TO DESCRIPTION OR NON-INFRINGEMENT WITH REGARD TO 
THIS MATERIAL. </P>
<P>IN NO EVENT WILL ANY AUTHOR OR DEVELOPER OF THIS MATERIAL OR WS-I BE LIABLE 
TO ANY OTHER PARTY FOR THE COST OF PROCURING SUBSTITUTE GOODS OR SERVICES, LOST 
PROFITS, LOSS OF USE, LOSS OF DATA, OR ANY INCIDENTAL, CONSEQUENTIAL, DIRECT, 
INDIRECT, OR SPECIAL DAMAGES WHETHER UNDER CONTRACT, TORT, WARRANTY, OR 
OTHERWISE, ARISING IN ANY WAY OUT OF THIS OR ANY OTHER AGREEMENT RELATING TO 
THIS MATERIAL, WHETHER OR NOT SUCH PARTY HAD ADVANCE NOTICE OF THE POSSIBILITY 
OF SUCH DAMAGES.</P>
<H2 id=feedback>Feedback</H2>
<P>The Web Services-Interoperability Organization (WS-I) would like to receive 
input, suggestions and other feedback (&quot;Feedback&quot;) on this work from a wide 
variety of industry participants to improve its quality over time. </P>
<P>By sending email, or otherwise communicating with WS-I, you (on behalf of 
yourself if you are an individual, and your company if you are providing 
Feedback on behalf of the company) will be deemed to have granted to WS-I, the 
members of WS-I, and other parties that have access to your Feedback, a 
non-exclusive, non-transferable, worldwide, perpetual, irrevocable, royalty-free 
license to use, disclose, copy, license, modify, sublicense or otherwise 
distribute and exploit in any manner whatsoever the Feedback you provide 
regarding the work. You acknowledge that you have no expectation of 
confidentiality with respect to any Feedback you provide. You represent and 
warrant that you have rights to provide this Feedback, and if you are providing 
Feedback on behalf of a company, you represent and warrant that you have the 
rights to provide Feedback on behalf of your company. You also acknowledge that 
WS-I is not required to review, discuss, use, consider or in any way incorporate 
your Feedback into future versions of its work. If WS-I does incorporate some or 
all of your Feedback in a future version of the work, it may, but is not 
obligated to include your name (or, if you are identified as acting on behalf of 
your company, the name of your company) on a list of contributors to the work. 
If the foregoing is not acceptable to you and any company on whose behalf you 
are acting, please do not provide any Feedback.</P>
<P>Feedback on this document should be directed to <A 
href="mailto:wsi_secprofile_comment@lists.ws-i.org">wsi_secprofile_comment@lists.ws-i.org</A>.</P>
<HR>

<H2 id=toc>Table of Contents</H2>
<P class=toc>1. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#introduction">Introduction</A><BR><SPAN 
class=subtoc>1.1. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#philosophy">Guiding 
Principles</A></SPAN><BR>2. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#documentConventions">Document 
Conventions</A><BR><SPAN class=subtoc>2.1. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#SecurityConsiderations">Security 
Considerations</A></SPAN><BR><SPAN class=subtoc>2.2. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#conventions">Notational 
Conventions</A></SPAN><BR><SPAN class=subtoc>2.3. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#versioning">Profile 
Identification and Versioning</A></SPAN><BR>3. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#conformance">Profile 
Conformance</A><BR><SPAN class=subtoc>3.1. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#conformance_requirements">Conformance 
Requirements</A></SPAN><BR><SPAN class=subtoc>3.2. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#conformance_targets">Conformance 
Targets</A></SPAN><BR><SPAN class=subtoc>3.3. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#conformance_scope">Conformance 
Scope</A></SPAN><BR><SPAN class=subtoc>3.4. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#conformance_claims">Claiming 
Conformance</A></SPAN><BR>4. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#transportsec">Transport 
Layer Security</A><BR><SPAN class=subtoc>4.1. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#SSLTLS">SSL 
and TLS</A></SPAN><BR><SPAN class=subsubtoc>4.1.1. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#Use_of_SSL_2.0">Use 
of SSL 2.0</A></SPAN><BR><SPAN class=subtoc>4.2. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#transportsecConsiderations">Security 
Considerations</A></SPAN><BR><SPAN class=subsubtoc>4.2.1. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#SOAPAction_Header">SOAPAction 
Header</A></SPAN><BR>5. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#msgsec">SOAP 
Message Security</A><BR><SPAN class=subtoc>5.1. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#WSSST">Security 
Tokens</A></SPAN><BR><SPAN class=subsubtoc>5.1.1. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#Binary_Security_Token_EncodingType_Attribute">Binary 
Security Token EncodingType Attribute</A></SPAN><BR><SPAN class=subsubtoc>5.1.2. 
<A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#Binary_Security_Token_ValueType_Attribute">Binary 
Security Token ValueType Attribute</A></SPAN><BR><SPAN class=subtoc>5.2. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#WSSTokenReferences">SecurityTokenReferences</A></SPAN><BR><SPAN 
class=subsubtoc>5.2.1. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#Internal_References">Internal 
References</A></SPAN><BR><SPAN class=subsubtoc>5.2.2. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#Shorthand_XPointer_References">Shorthand 
XPointer References</A></SPAN><BR><SPAN class=subsubtoc>5.2.3. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#References_to_Preceding_Security_Tokens">References 
to Preceding Security Tokens</A></SPAN><BR><SPAN class=subsubtoc>5.2.4. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#Direct_Preferred_to_Embedded_for_Internal_References">Direct 
Preferred to Embedded for Internal References</A></SPAN><BR><SPAN 
class=subsubtoc>5.2.5. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#Direct_Required_When_Possible_for_External_References">Direct 
Required When Possible for External References</A></SPAN><BR><SPAN 
class=subsubtoc>5.2.6. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#Format_of_Embedded_References">Format 
of Embedded References</A></SPAN><BR><SPAN class=subsubtoc>5.2.7. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#Key_Identifier_for_External_References">Key 
Identifier for External References</A></SPAN><BR><SPAN class=subsubtoc>5.2.8. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#Key_Name_References_Prohibited">Key 
Name References Prohibited</A></SPAN><BR><SPAN class=subsubtoc>5.2.9. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#KeyIdentifier/@ValueType_Attribute">http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#KeyIdentifier/@ValueType_Attribute</A></SPAN><BR><SPAN 
class=subsubtoc>5.2.10. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#Children_of_wsse_Embedded">Children 
of wsse:Embedded</A></SPAN><BR><SPAN class=subsubtoc>5.2.11. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#Reference_from_wsse_SecurityTokenReference_to_wsse_SecurityTokenReference">Reference 
from wsse:SecurityTokenReference to 
wsse:SecurityTokenReference</A></SPAN><BR><SPAN class=subsubtoc>5.2.12. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#wsse_SecurityTokenReference/Reference_ValueType_Attribute">wsse:SecurityTokenReference/Reference 
ValueType Attribute</A></SPAN><BR><SPAN class=subsubtoc>5.2.13. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#wsse_SecurityTokenReference_constraints">wsse:SecurityTokenReference 
constraints</A></SPAN><BR><SPAN class=subsubtoc>5.2.14. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#wsse_SecurityTokenReference_Dereferencing_Transform">wsse:SecurityTokenReference 
Dereferencing Transform</A></SPAN><BR><SPAN class=subtoc>5.3. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#WSSTimeStamp">Timestamps</A></SPAN><BR><SPAN 
class=subsubtoc>5.3.1. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#wsu_Timestamp/wsu_Created">wsu:Timestamp/wsu:Created</A></SPAN><BR><SPAN 
class=subsubtoc>5.3.2. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#Occurence_constraints_onwsu_Created_and_wsu_Expires_">Occurence 
constraints on wsu:Created and wsu:Expires </A></SPAN><BR><SPAN 
class=subsubtoc>5.3.3. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#Value_constraints_on_wsu_Created_and_wsu_Expires_">Value 
constraints on wsu:Created and wsu:Expires </A></SPAN><BR><SPAN 
class=subsubtoc>5.3.4. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#wsu_Timestamp_inside_wsse_Security_header_">wsu:Timestamp 
inside wsse:Security header </A></SPAN><BR><SPAN class=subtoc>5.4. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#WSSReferences">wsu:Id 
References</A></SPAN><BR><SPAN class=subsubtoc>5.4.1. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#wsu_Id_Attribute_Uniqueness">wsu:Id 
Attribute Uniqueness</A></SPAN><BR><SPAN class=subtoc>5.5. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#WSSProcessing">wsse:Security 
Processing Order</A></SPAN><BR><SPAN class=subsubtoc>5.5.1. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#Order_of_Processing">Order 
of Processing</A></SPAN><BR><SPAN class=subtoc>5.6. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#WSSActor">SOAP 
Actor</A></SPAN><BR><SPAN class=subsubtoc>5.6.1. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#SOAP_Actor_Value">SOAP 
Actor Value</A></SPAN><BR>6. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#usernametoken">Username 
Token Profile</A><BR><SPAN class=subtoc>6.1. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#tokenusage">Token 
Usage</A></SPAN><BR><SPAN class=subsubtoc>6.1.1. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#wsse_UsernameToken/wsse_Password/@Type">http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#wsse_UsernameToken/wsse_Password/@Type</A></SPAN><BR><SPAN 
class=subsubtoc>6.1.2. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#PasswordDigest">PasswordDigest</A></SPAN><BR><SPAN 
class=subsubtoc>6.1.3. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#ValueType_attribute">ValueType 
attribute</A></SPAN><BR><SPAN class=subsubtoc>6.1.4. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#Reference_by_KeyIdentifier">Reference 
by KeyIdentifier</A></SPAN><BR><SPAN class=subsubtoc>6.1.5. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#Key_Derivation">Key 
Derivation</A></SPAN><BR><SPAN class=subsubtoc>6.1.6. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#Sign_UsernameToken">Sign 
UsernameToken</A></SPAN><BR>7. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#x509token">X.509 
Certificate Token Profile</A><BR><SPAN class=subtoc>7.1. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#x509tokentypes">Token 
Types</A></SPAN><BR><SPAN class=subsubtoc>7.1.1. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#Certificate_Path">Certificate 
Path</A></SPAN><BR><SPAN class=subsubtoc>7.1.2. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#KeyIdentifier">KeyIdentifier</A></SPAN><BR>8. 
<A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#xmlSignature">XML-Signature</A><BR><SPAN 
class=subtoc>8.1. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#xmlSignatureGeneral">General 
Constraints on XML Signature</A></SPAN><BR><SPAN class=subsubtoc>8.1.1. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#Types_of_Signatures">Types 
of Signatures</A></SPAN><BR><SPAN class=subtoc>8.2. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#WSSIDRef">Element 
References in XML Signature</A></SPAN><BR><SPAN class=subsubtoc>8.2.1. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#Reference_to_Elements_by_Shorthand_XPointer">Reference 
to Elements by Shorthand XPointer</A></SPAN><BR><SPAN class=subsubtoc>8.2.2. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#Reference_to_Elements_by_XPath_Expression">Reference 
to Elements by XPath Expression</A></SPAN><BR><SPAN class=subtoc>8.3. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#xmlSignatureAlgorithms">XML 
Signature Algorithms</A></SPAN><BR><SPAN class=subsubtoc>8.3.1. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#Use_Exclusive_C14N">Use 
Exclusive C14N</A></SPAN><BR><SPAN class=subsubtoc>8.3.2. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#Transform_required">Transform 
required</A></SPAN><BR><SPAN class=subsubtoc>8.3.3. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#Permitted_algorithms">Permitted 
algorithms</A></SPAN><BR><SPAN class=subtoc>8.4. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#xmlSignatureSyntax">XML 
Signature Syntax</A></SPAN><BR><SPAN class=subsubtoc>8.4.1. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#ds_HMACOutputLength">ds:HMACOutputLength</A></SPAN><BR><SPAN 
class=subsubtoc>8.4.2. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#ds_KeyInfo">ds:KeyInfo</A></SPAN><BR><SPAN 
class=subsubtoc>8.4.3. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#ds_Manifest">ds:Manifest</A></SPAN><BR><SPAN 
class=subtoc>8.5. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#xmlSignatureConsiderations">Security 
Considerations</A></SPAN><BR><SPAN class=subsubtoc>8.5.1. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#Sign_Security_Token">Sign 
Security Token</A></SPAN><BR>9. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#xmlEncryption">XML 
Encryption</A><BR><SPAN class=subtoc>9.1. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#xmlEncryptProcessing">XML 
Encryption Processing Model</A></SPAN><BR><SPAN class=subsubtoc>9.1.1. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#xenc_ReferenceList">xenc:ReferenceList</A></SPAN><BR><SPAN 
class=subsubtoc>9.1.2. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#xenc_EncryptedKey">xenc:EncryptedKey</A></SPAN><BR><SPAN 
class=subtoc>9.2. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#xmlEncryptionKeys">XML 
Encryption Syntax</A></SPAN><BR><SPAN class=subsubtoc>9.2.1. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#Placement">Placement</A></SPAN><BR><SPAN 
class=subsubtoc>9.2.2. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#xenc_EncryptedKey_attributes">xenc:EncryptedKey 
attributes</A></SPAN><BR><SPAN class=subsubtoc>9.2.3. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#xenc_EncryptedData_attributes">xenc:EncryptedData 
attributes</A></SPAN><BR><SPAN class=subsubtoc>9.2.4. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#References_from_xenc_EncryptedData">References 
from xenc:EncryptedData</A></SPAN><BR><SPAN class=subsubtoc>9.2.5. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#xenc_EncryptionMethod_mandatory">xenc:EncryptionMethod 
mandatory</A></SPAN><BR><SPAN class=subsubtoc>9.2.6. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#xenc_EncryptedKey/@Recipient">http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#xenc_EncryptedKey/@Recipient</A></SPAN><BR><SPAN 
class=subsubtoc>9.2.7. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#ds_KeyInfo/xenc_AgreementMethod_prohibited">ds:KeyInfo/xenc:AgreementMethod 
prohibited</A></SPAN><BR><SPAN class=subsubtoc>9.2.8. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#xenc_EncryptedData">xenc:EncryptedData</A></SPAN><BR><SPAN 
class=subsubtoc>9.2.9. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#SOAP_Envelope">SOAP 
Envelope</A></SPAN><BR><SPAN class=subtoc>9.3. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#ElementReferencesinXMLEncryption">Element 
References in XML Encryption</A></SPAN><BR><SPAN class=subsubtoc>9.3.1. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#Reference_to_Elements_by_Shorthand_XPointer">Reference 
to Elements by Shorthand XPointer</A></SPAN><BR><SPAN class=subtoc>9.4. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#xmlEncryptionAlgorithms">XML 
Encryption Algorithms</A></SPAN><BR><SPAN class=subsubtoc>9.4.1. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#Permitted_Algorithms">Permitted 
Algorithms</A></SPAN><BR><SPAN class=subtoc>9.5. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#xmlEncryptionConsiderations">Security 
Considerations</A></SPAN><BR><SPAN class=subsubtoc>9.5.1. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#Encrypt_DigestValue">Encrypt 
DigestValue</A></SPAN><BR>10. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#algorithms">Algorithms</A><BR><SPAN 
class=subtoc>10.1. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#tlssslalg">Transport 
Level Security Algorithms</A></SPAN><BR><SPAN class=subsubtoc>10.1.1. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#Mandatory_ciphersuites">Mandatory 
ciphersuites</A></SPAN><BR><SPAN class=subsubtoc>10.1.2. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#Recommended_ciphersuites">Recommended 
ciphersuites</A></SPAN><BR><SPAN class=subsubtoc>10.1.3. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#Discouraged_ciphersuites">Discouraged 
ciphersuites</A></SPAN><BR><SPAN class=subsubtoc>10.1.4. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#Prohibited_ciphersuites">Prohibited 
ciphersuites</A></SPAN><BR>11. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#reltoBasicProfile">Relationship 
of Basic Security Profile as an Extension to Basic Profile</A><BR><SPAN 
class=subtoc>11.1. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#bpclarify">Basic 
Profile Clarifications</A></SPAN><BR><SPAN class=subsubtoc>11.1.1. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#BP_Requirement_R2301">BP 
Requirement R2301</A></SPAN><BR><SPAN class=subsubtoc>11.1.2. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#BP_Requirement_R2710">BP 
Requirement R2710</A></SPAN><BR><SPAN class=subsubtoc>11.1.3. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#BP_Requirement_R2712">BP 
Requirement R2712</A></SPAN><BR><SPAN class=subsubtoc>11.1.4. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#BP_Requirement_R2724">BP 
Requirement R2724</A></SPAN><BR><SPAN class=subsubtoc>11.1.5. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#BP_Requirement_R2725">BP 
Requirement R2725</A></SPAN><BR><SPAN class=subsubtoc>11.1.6. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#BP_Requirement_R2729">BP 
Requirement R2729</A></SPAN><BR><SPAN class=subsubtoc>11.1.7. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#BP_Requirement_R2738">BP 
Requirement R2738</A></SPAN><BR><SPAN class=subsubtoc>11.1.8. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#BP_Requirement_R1029">BP 
Requirement R1029</A></SPAN><BR>12. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#attachsec">Attachment 
Security</A><BR><SPAN class=subtoc>12.1. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#swa">SOAP 
with Attachments</A></SPAN><BR><SPAN class=subsubtoc>12.1.1. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#Conformance">Conformance</A></SPAN><BR><SPAN 
class=subsubtoc>12.1.2. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#Scope">Scope</A></SPAN><BR><SPAN 
class=subtoc>12.2. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#signedAttachments">Signed 
Attachments</A></SPAN><BR><SPAN class=subsubtoc>12.2.1. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#Reference">Reference</A></SPAN><BR><SPAN 
class=subsubtoc>12.2.2. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#Transform">Transform</A></SPAN><BR><SPAN 
class=subtoc>12.3. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#encryptedAttachments">Encrypted 
Attachments</A></SPAN><BR><SPAN class=subsubtoc>12.3.1. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#Reference">Reference</A></SPAN><BR><SPAN 
class=subsubtoc>12.3.2. <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#Content">Content</A></SPAN><BR>13. 
<A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#seccon">Security 
Considerations</A><BR>Appendix A: <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#references">Referenced 
Specifications</A><BR>Appendix B: <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#points">Extensibility 
Points</A><BR>Appendix C: <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#acks">Acknowledgements</A><BR></P>
<H2 id=introduction>1. Introduction</H2>
<P><SPAN class=statement-target></SPAN>This document defines the WS-I Basic 
Security Profile 1.0 (hereafter, &quot;Profile&quot;), consisting of a set of 
non-proprietary Web services specifications, along with clarifications to and 
amplifications of those specifications which promote interoperability.</P>
<P><SPAN class=statement-target></SPAN>Section 1, <EM><SPAN 
class=statement-target></SPAN>&quot;Introduction,&quot;</EM><SPAN 
class=statement-target></SPAN> introduces the Profile and relates the philosophy 
that it takes with regard to interoperability.</P>
<P><SPAN class=statement-target></SPAN>Section 2, <EM><SPAN 
class=statement-target></SPAN>&quot;Document Conventions,&quot;</EM><SPAN 
class=statement-target></SPAN> describes notational conventions utilized by this 
Profile.</P>
<P><SPAN class=statement-target></SPAN>Section 3, <EM><SPAN 
class=statement-target></SPAN>&quot;Profile Conformance,&quot;</EM><SPAN 
class=statement-target></SPAN> explains what it means to be conformant to the 
Profile. </P>
<P><SPAN class=statement-target></SPAN>Each subsequent section addresses a 
component of the Profile, and consists of two parts: an overview detailing the 
component specifications and their extensibility points, followed by subsections 
that address individual parts of the component specifications. Note that there 
is no relationship between the section numbers in this document and those in the 
referenced specifications.</P>
<H3 id=philosophy>1.1 Guiding Principles</H3>
<P><SPAN class=statement-target></SPAN>The Profile was developed according to a 
set of principles that, together, form the philosophy of the Profile, as it 
relates to bringing about interoperability. This section documents these 
guidelines.</P>
<DL>
  <DT><SPAN class=statement-target></SPAN>No guarantee of interoperability 
  <DD><SPAN class=statement-target></SPAN>Although it is impossible to 
  completely guarantee the interoperability of a particular service, the Profile 
  attempts to increase interoperability by addressing the most common problems 
  that implementation experience has revealed to date. 
  <DT><SPAN class=statement-target></SPAN>Focus profiling effort 
  <DD><SPAN class=statement-target></SPAN>The focus of the Profile is the 
  specifications that are explicitly defined as in-scope for the profile. Other 
  specifications are profiled to the minimal extent necessary to allow 
  meaningful profiling of the scoped specifications. This allows an in-depth 
  profile of the scoped specifications with reduced constraining of other 
  specifications. 
  <DT><SPAN class=statement-target></SPAN>Application semantics 
  <DD><SPAN class=statement-target></SPAN>Although communication of application 
  semantics can be facilitated by the technologies that comprise the Profile, 
  assuring the common understanding of those semantics is not addressed by it. 
  <DT><SPAN class=statement-target></SPAN>Testability 
  <DD><SPAN class=statement-target></SPAN>When possible, the Profile makes 
  statements that are testable. However, such testability is not required. 
  Preferably, testing is achieved in a non-intrusive manner (e.g., examining 
  artifacts &quot;on the wire&quot;). Note: Due to the nature of cryptographic security, 
  non-intrusive testing may not be possible. 
  <DT><SPAN class=statement-target></SPAN>Strength of requirements 
  <DD><SPAN class=statement-target></SPAN>The Profile makes strong requirements 
  (e.g., MUST, MUST NOT) wherever feasible; if there are legitimate cases where 
  such a requirement cannot be met, conditional requirements (e.g., SHOULD, 
  SHOULD NOT) are used. Optional and conditional requirements introduce 
  ambiguity and mismatches between implementations. 
  <DT><SPAN class=statement-target></SPAN>Restriction vs. relaxation 
  <DD><SPAN class=statement-target></SPAN>When amplifying the requirements of 
  referenced specifications (including the Basic Profile 1.0 ), the Profile may 
  restrict them, but does not relax them (e.g., change a MUST to a MAY). 
  <DT><SPAN class=statement-target></SPAN>Multiple mechanisms 
  <DD><SPAN class=statement-target></SPAN>If a referenced specification allows 
  multiple mechanisms to be used interchangeably to achieve the same goal, the 
  Profile selects those that are well-understood, widely implemented and useful. 
  Extraneous or underspecified mechanisms and extensions introduce complexity 
  and therefore reduce interoperability. 
  <DT><SPAN class=statement-target></SPAN>Future compatibility 
  <DD><SPAN class=statement-target></SPAN>When possible, the Profile aligns its 
  requirements with in-progress revisions to the specifications it references 
  (e.g., Web Services Security). This aids implementers by enabling a graceful 
  transition, and assures that WS-I does not 'fork' from these efforts. When the 
  Profile cannot address an issue in a specification it references, this 
  information is communicated to the appropriate body to assure its 
  consideration. 
  <DT><SPAN class=statement-target></SPAN>Compatibility with deployed services 
  <DD><SPAN class=statement-target></SPAN>Backwards compatibility with deployed 
  Web services is not a goal for the Profile, but due consideration is given to 
  it; the Profile does not introduce a change to the requirements of a 
  referenced specification unless doing so addresses specific interoperability 
  issues. 
  <DT><SPAN class=statement-target></SPAN>Focus on interoperability 
  <DD><SPAN class=statement-target></SPAN>Although there are potentially a 
  number of inconsistencies and design flaws in the referenced specifications, 
  the Profile only addresses those that affect interoperability. 
  <DT><SPAN class=statement-target></SPAN>Conformance targets 
  <DD><SPAN class=statement-target></SPAN>Where possible, the Profile places 
  requirements on artifacts (e.g., WSDL descriptions, SOAP messages) rather than 
  the producing or consuming software's behaviors or roles. Artifacts are 
  concrete, making them easier to verify and therefore making conformance easier 
  to understand and less error-prone. 
  <DT><SPAN class=statement-target></SPAN>Lower-layer interoperability 
  <DD><SPAN class=statement-target></SPAN>The BSP Profile speaks to 
  interoperability at the web-services layer only; it assumes that 
  interoperability of lower-layer protocols ( e.g. TCP, HTTP ) and technologies 
  (e.g. encryption and signature algorithms ) is adequate and well-understood. 
  WS-I does not attempt to assure the interoperability of these protocols and 
  technologies as a whole. This assures that WS-I's expertise in and focus on 
  Web services standards is used effectively. 
  <DT><SPAN class=statement-target></SPAN>Do no harm 
  <DD><SPAN class=statement-target></SPAN>Interoperability of security 
  technologies does not in and of itself ensure security, and the act of 
  combining new technologies and protocols is especially susceptible to security 
  threats. The profile takes steps to avoid introducing new security threats. 
  <DT><SPAN class=statement-target></SPAN>Best Practices 
  <DD><SPAN class=statement-target></SPAN>It is not the intent of the BSP 
  Profile to define security best practices. However, when multiple options 
  exist, we may use known security weaknesses as a means of reducing choice and 
  thus enhancing interoperability. BSP Profile will offer non-normative security 
  considerations where the authors deem appropriate; however, these are by no 
  means exhaustive and should not be perceived as a sanctioning of a security 
  best practice. </DD></DL>
<H2 id=documentConventions>2. Document Conventions</H2>
<P><SPAN class=statement-target></SPAN>This document follows conventions common 
to all WS-I profiles. These are described in the following sections. </P>
<H3 id=SecurityConsiderations>2.1 Security Considerations</H3>
<P><SPAN class=statement-target></SPAN>The Profile will draw attention to 
security considerations; however, these are informational only and should be 
treated as non-normative. Adherence to these considerations does not guarantee 
security.</P>
<P><SPAN class=statement-target></SPAN>Security considerations are presented as 
follows:</P>
<P class=statement><SPAN class=statement-id><SPAN 
class=statement-target></SPAN>Cnnnn</SPAN><SPAN class=statement-target></SPAN> 
Statement text here. </P>
<P><SPAN class=statement-target></SPAN>where &quot;nnnn&quot; is replaced by a number that 
is unique among the considerations in the Profile, thereby forming a unique 
consideration identifier.</P>
<H3 id=conventions>2.2 Notational Conventions </H3>
<P>The keywords &quot;MUST&quot;, &quot;MUST NOT&quot;, &quot;REQUIRED&quot;, &quot;SHALL&quot;, &quot;SHALL NOT&quot;, &quot;SHOULD&quot;, 
&quot;SHOULD NOT&quot;, &quot;RECOMMENDED&quot;, &quot;MAY&quot;, and &quot;OPTIONAL&quot; in this document are to be 
interpreted as described in <A class=offsite 
href="http://www.ietf.org/rfc/rfc2119.txt">RFC2119</A>.</P>
<P>Normative statements of requirements in the Profile (i.e., those impacting 
conformance, as outlined in &quot;<A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#conformance_requirements">Conformance 
Requirements</A>&quot;) are presented in the following manner:</P>
<P class=statement><SPAN class=statement-id>Rnnnn</SPAN>Statement text here.</P>
<P>where &quot;nnnn&quot; is replaced by a number that is unique among the requirements in 
the Profile, thereby forming a unique requirement identifier.</P>
<P>Requirement identifiers can be considered to be namespace qualified, in such 
a way as to be compatible with QNames from <A class=offsite 
href="http://www.w3.org/TR/REC-xml-names/">Namespaces in XML</A>. If there is no 
explicit namespace prefix on a requirement's identifier (e.g., &quot;R9999&quot; as 
opposed to &quot;bp10:R9999&quot;), it should be interpreted as being in the namespace 
identified by the conformance URI of the document section it occurs in. If it is 
qualified, the prefix should be interpreted according to the namespace mappings 
in effect, as documented below.</P>
<P>Some requirements clarify the referenced specification(s), but do not place 
additional constraints upon implementations. For convenience, clarifications are 
annotated in the following manner: <SPAN class=statement-type>C</SPAN></P>
<P>Some requirements are derived from ongoing standardization work on the 
referenced specification(s). For convenience, such forward-derived statements 
are annotated in the following manner: <SPAN class=statement-origin>xxxx</SPAN>, 
where &quot;xxxx&quot; is an identifier for the specification (e.g., &quot;WSDL20&quot; for WSDL 
Version 2.0). Note that because such work was not complete when this document 
was publiished, the specification that the requirement is derived from may 
change; this information is included only as a convenience to implementers.</P>
<P>Extensibility points in underlying specifications (see &quot;<A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#conformance_scope">Conformance 
Scope</A>&quot;) are presented in a similar manner:</P>
<P class=statement><SPAN class=statement-id>Ennnn</SPAN>Extensibility Point Name 
- Description</P>
<P>where &quot;nnnn&quot; is replaced by a number that is unique among the extensibility 
points in the Profile. As with requirement statements, extensibility statements 
can be considered namespace-qualified.</P>
<P>This specification uses a number of namespace prefixes throughout; their 
associated URIs are listed below. Note that the choice of any namespace prefix 
is arbitrary and not semantically significant.</P>
<UL>
  <LI><STRONG>soap</STRONG> - &quot;http://schemas.xmlsoap.org/soap/envelope/&quot; 
  <LI><STRONG>xsd</STRONG> - &quot;http://www.w3.org/2001/XMLSchema&quot; 
  <LI><STRONG>wsi</STRONG> - &quot;http://www.ws-i.org/schemas/conformanceClaim&quot; 
  <LI><STRONG>ds</STRONG> - &quot;http://www.w3.org/2000/09/xmldsig#&quot;&quot; 
  <LI><STRONG>xenc</STRONG> - &quot;http://www.w3.org/2001/04/xmlenc#&quot; 
  <LI><STRONG>c14n</STRONG> - &quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot; 
  <LI><STRONG>wsse</STRONG> - 
  &quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd&quot; 

  <LI><STRONG>wsu</STRONG> - 
  &quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd&quot; 

  <LI><STRONG>b10</STRONG> - 
  &quot;http://www.ws-i.org/Profiles/Basic/2003-08/BasicProfile-1.0a.htm&quot; 
  <LI><STRONG>bp11</STRONG> - 
  &quot;http://www.ws-i.org/Profiles/BasicProfile-1.1.html&quot; 
  </LI></UL>
<H3 id=versioning>2.3 Profile Identification and Versioning </H3>
<P>This document is identified by a name (in this case, Basic Security Profile) 
and a version number (here, 1.0). Together, they identify a particular 
<EM>profile instance</EM>.</P>
<P>Version numbers are composed of a major and minor portion, in the form 
&quot;major.minor&quot;. They can be used to determine the precedence of a profile 
instance; a higher version number (considering both the major and minor 
components) indicates that an instance is more recent, and therefore supersedes 
earlier instances.</P>
<P>Instances of profiles with the same name (e.g., &quot;Example Profile 1.1&quot; and 
&quot;Example Profile 5.0&quot;) address interoperability problems in the same general 
scope (although some developments may require the exact scope of a profile to 
change between instances).</P>
<P>One can also use this information to determine whether two instances of a 
profile are backwards-compatible; that is, whether one can assume that 
conformance to an earlier profile instance implies conformance to a later one. 
Profile instances with the same name and major version number (e.g., &quot;Example 
Profile 1.0&quot; and &quot;Example Profile 1.1&quot;) MAY be considered compatible. Note that 
this does not imply anything about compatibility in the other direction; that 
is, one cannot assume that conformance with a later profile instance implies 
conformance to an earlier one.</P>
<H2 id=conformance>3 Profile Conformance </H2>
<P>Conformance to the Profile is defined by adherence to the set of 
<EM>requirements</EM> defined for a specific <EM>target</EM>, within the 
<EM>scope</EM> of the Profile. This section explains these terms and describes 
how conformance is defined and used.</P>
<H3 id=conformance_requirements>3.1 Conformance Requirements </H3>
<P>Requirements state the criteria for conformance to the Profile. They 
typically refer to an existing specification and embody refinements, 
amplifications, interpretations and clarifications to it in order to improve 
interoperability. All requirements in the Profile are considered normative, and 
those in the specifications it references that are in-scope (see &quot;Conformance 
Scope&quot;) should likewise be considered normative. When requirements in the 
Profile and its referenced specifications contradict each other, the Profile's 
requirements take precedence for purposes of Profile conformance.</P>
<P>Requirement levels, using <A class=offsite 
href="http://www.ietf.org/rfc/rfc2119.txt">RFC2119</A> language (e.g., MUST, 
MAY, SHOULD) indicate the nature of the requirement and its impact on 
conformance. Each requirement is individually identified (e.g., R9999) for 
convenience.</P>
<P>For example;</P>
<P class=statement><SPAN class=statement-id>R9999</SPAN> WIDGETs SHOULD be round 
in shape.</P>
<P>This requirement is identified by &quot;R9999&quot;, applies to the target WIDGET (see 
below), and places a conditional requirement upon widgets; i.e., although this 
requirement must be met to maintain conformance in most cases, there are some 
situations where there may be valid reasons for it not being met (which are 
explained in the requirement itself, or in its accompanying text).</P>
<P>Each requirement statement contains exactly one requirement level keyword 
(e.g., &quot;MUST&quot;) and one conformance target keyword (e.g., &quot;MESSAGE&quot;). The 
conformance target keyword appears in bold text (e.g. &quot;<B>MESSAGE</B>&quot;). Other 
conformance targets appearing in non-bold text are being used strictly for their 
definition and NOT as a conformance target. Additional text may be included to 
illuminate a requirement or group of requirements (e.g., rationale and 
examples); however, prose surrounding requirement statements must not be 
considered in determining conformance.</P>
<P>Definitions of terms in the Profile are considered authoritative for the 
purposes of determining conformance.</P>
<P>None of the requirements in the Profile, regardless of their conformance 
level, should be interpreted as limiting the ability of an otherwise conforming 
implementation to apply security countermeasures in response to a real or 
perceived threat (e.g., a denial of service attack).</P>
<H3 id=conformance_targets>3.2 Conformance Targets </H3>
<P>Conformance targets identify what artifacts (e.g., SOAP message, WSDL 
description, UDDI registry data) or parties (e.g., SOAP processor, end user) 
requirements apply to. </P>
<P>This allows for the definition of conformance in different contexts, to 
assure unambiguous interpretation of the applicability of requirements, and to 
allow conformance testing of artifacts (e.g., SOAP messages and WSDL 
descriptions) and the behavior of various parties to a Web service (e.g., 
clients and service instances).</P>
<P>Requirements' conformance targets are physical artifacts wherever possible, 
to simplify testing and avoid ambiguity.</P>
<P>The following conformance targets are used in the Profile:</P>
<UL>
  <LI><STRONG>SECURE_ENVELOPE</STRONG> - a SOAP envelope that contains 
  sub-elements that have been subject to integrity and/or confidentiality 
  protection. A message is considered conformant when all of its contained 
  Artifacts are conformant with all Statements related to SECURE_ENVELOPE, 
  SECURE_MESSAGE, SECURITY_HEADER, REFERENCE, SIGNATURE, ENCRYPTED_KEY, 
  ENCRYPTION_REFERENCE_LIST, ENCRYPTED_KEY_REFERENCE_LIST, ENCRYPTED_DATA, 
  SECURITY_TOKEN_REFERENCE, INTERNAL_SECURITY_TOKEN and TIMESTAMP as appropriate 
  in the Profile. Use of artifacts for which there are no statements in the 
  Profile does not effect conformance. 
  <LI><STRONG>SECURE_MESSAGE</STRONG> - protocol elements that have WSS Security 
  applied to them. Protocol elements include a primary SOAP envelope and 
  optionally associated SwA attachments. 
  <LI><STRONG>SENDER</STRONG> - software that generates a message according to 
  the protocol(s) associated with it. A sender is considered conformant when all 
  of the messages it produces are conformant and its behavior is conformant with 
  all statements related to SENDER in the Profile. (from Basic Profile 1.0) 
  <LI><STRONG>RECEIVER</STRONG> - software that consumes a message according to 
  the protocol(s) associated with it. A receiver is considered conformant when 
  it is capable of consuming conformant messages containing the artifacts that 
  it supports and its behavior is conformant with all statements related to 
  RECEIVER in the Profile. A conformant receiver need not accept all possible 
  conformant messages. A conformant receiver may choose not to support artifacts 
  that provide unneeded or undesired functionality. When a receiver supports a 
  specific artifact, a nd the Profile contains statements related to that 
  artifact, a conformant receiver must accept all required conformant forms of 
  that artifact. (from Basic Profile 1.0) 
  <LI><STRONG>INSTANCE</STRONG> - software that implements a wsdl:port or a 
  uddi:bindingTemplate. (from Basic Profile 1.0) 
  <LI><STRONG>DESCRIPTION</STRONG> - descriptions of types, messages, interfaces 
  and their concrete protocol and data format bindings, and the network access 
  points associated with Web services (e.g., WSDL descriptions) (from <A 
  class=offsite href="http://www.ws-i.org/Profiles/BasicProfile-1.0.html">Basic 
  Profile 1.0</A>) 
  <LI><STRONG>SECURITY_HEADER</STRONG> - an element included as a child of 
  soap:Envelope/soap:Header and named wsse:Security 
  <LI><STRONG>REFERENCE</STRONG> - a SIGNATURE ds:Reference element. 
  <LI><STRONG>SIGNATURE</STRONG> - an element included as a child of a 
  SECURITY_HEADER and named ds:Signature. 
  <LI><STRONG>ENCRYPTED_KEY</STRONG> - an element included as a child of a 
  SECURITY_HEADER and named xenc:EncryptedKey. 
  <LI><STRONG>ENCRYPTION_REFERENCE_LIST</STRONG> - an element which is included 
  as a child of a SECURITY_HEADER and named xenc:ReferenceList. 
  <LI><STRONG>ENCRYPTED_KEY_REFERENCE_LIST</STRONG> - an element which is 
  included as a child of an ENCRYPTED_KEY and named xenc:ReferenceList. 
  <LI><STRONG>ENCRYPTED_DATA</STRONG> - an element named xenc:EncryptedData 
  which is referenced by either an ENCRYPTED_KEY_REFERENCE_LIST or an 
  ENCRYPTION_REFERENCE_LIST. 
  <LI><STRONG>SECURITY_TOKEN_REFERENCE</STRONG> - an element included as a 
  descendant of a SECURITY_HEADER or an ENCRYPTED_DATA and is named 
  wsse:SecurityTokenReference. 
  <LI><STRONG>INTERNAL_SECURITY_TOKEN</STRONG> - a security token defined in a 
  security token profile and that is either a child of a SECURITY_HEADER or a 
  child of a wsse:Embedded element in a SECURITY_TOKEN_REFERENCE. 
  <LI><STRONG>EXTERNAL_SECURITY_TOKEN</STRONG> - a security token defined in a 
  security token profile that is external to a SECURE_ENVELOPE. 
  <LI><STRONG>SECURITY_TOKEN</STRONG> - either an INTERNAL_SECURITY_TOKEN or an 
  EXTERNAL_SECURITY_TOKEN. (e.g. UsernameToken, X.509 Certificate Token, REL 
  Token, SAML Token et.al.) 
  <LI><STRONG>TIMESTAMP</STRONG> - an element included as a child of a 
  SECURITY_HEADER and named wsu:Timestamp </LI></UL>
<H3 id=conformance_scope>3.3 Conformance Scope </H3>
<P>The scope of the Profile delineates the technologies that it addresses; in 
other words, the Profile only attempts to improve interoperability within its 
own scope. Generally, the Profile's scope is bounded by the specifications 
referenced by it.</P>
<P>The Profile's scope is further refined by extensibility points. Referenced 
specifications often provide extension mechanisms and unspecified or open-ended 
configuration parameters; when identified in the Profile as an extensibility 
point, such a mechanism or parameter is outside the scope of the Profile, and 
its use or non-use is not relevant to conformance.</P>
<P>Note that the Profile may still place requirements on the use of an 
extensibility point. Also, specific uses of extensibility points may be further 
restricted by other profiles, to improve interoperability when used in 
conjunction with the Profile.</P>
<P>Because the use of extensibility points may impair interoperability, their 
use should be negotiated or documented in some fashion by the parties to a Web 
service; for example, this could take the form of an out-of-band agreement.</P>
<P>The Profile's scope is defined by the referenced specifications in <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#references">Appendix 
A</A>, as refined by the extensibility points in <A 
href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#points">Appendix 
B</A>.</P>
<H3 id=conformance_claims>3.4 Claiming Conformance </H3>
<P>Claims of conformance to the Profile can be made using the following 
mechanisms, as described in <A class=offsite 
href="http://www.ws-i.org/Profiles/ConformanceClaims-1.0.html">Conformance Claim 
Attachment Mechanisms</A>, when the applicable Profile requirements associated 
with the listed targets have been met:</P>
<P class=ednote>The CCAM URI may change before final publication.</P>
<UL></UL>
<P>The conformance claim URI for this Profile is 
&quot;http://ws-i.org/profiles/basic-security/core/1.0&quot;, with the following 
exceptions, which are associatedwith specific sections:</P>
<UL>
  <LI><A 
  href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#usernametoken">Username 
  Token Profile</A> - 
  &quot;http://ws-i.org/profiles/basic-security/username-token/1.0&quot; 
  <LI><A 
  href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#x509token">X.509 
  Certificate Token Profile</A> - 
  &quot;http://ws-i.org/profiles/basic-security/x.509-certificate-token/1.0&quot; 
  <LI><A 
  href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0-2005-01-20.html#attachsec">Attachment 
  Security</A> - &quot;http://ws-i.org/profiles/basic-security/swa/1.0&quot; </LI></UL>
<H2 id=transportsec>4. Transport Layer Security</H2>
<P>This section of the Profile incorporates the following specifications by 
reference, and defines extensibility points within them: </P>
<UL>
  <LI><A class=offsite href="http://www.ietf.org/rfc/rfc2818.txt">HTTP over 
  TLS</A> 
  <LI><A class=offsite href="http://www.ietf.org/rfc/rfc2246.txt">The TLS 
  Protocol Version 1.0</A> <BR>Extensibility points: 
  <UL>
    <LI><SPAN class=statement-id id=E0009>E0009</SPAN> - TLS Ciphersuites - TLS 
    allows for the use of arbitrary encryption algorithms. Note that while 
    section 10.1 of this Profile mandates, recommends, and discourages support 
    for certain ciphersuites, this Profile does not prohibit use of any specific 
    ciphersuite.
    <LI><SPAN class=statement-id id=E0010>E0010</SPAN> - TLS Extensions - TLS 
    allows for extensions during the handshake phase.</LI></UL>
  <LI><A class=offsite href="http://wp.netscape.com/eng/ssl3/ssl-toc.html">The 
  SSL Protocol Version 3.0</A> <BR>Extensibility points: 
  <UL>
    <LI><SPAN class=statement-id id=E0011>E0011</SPAN> - SSL Ciphersuites - SSL 
    allows for the use of arbitrary encryption algorithms. Note that while 
    section 10.1 of this Profile mandates, recommends, and discourages support 
    for certain ciphersuites, this Profile does not prohibit use of any specific 
    ciphersuite.</LI></UL></LI></UL>
<H3 id=SSLTLS>4.1 SSL and TLS</H3>
<P>The following specifications (or sections thereof) are referred to in this 
section of the Profile:</P>
<UL>
  <LI><A class=offsite href="http://www.ietf.org/rfc/rfc2818.txt">HTTP over TLS: 
  Section 2.2.1</A> </LI></UL>
<P><SPAN class=statement-target></SPAN>SSL and TLS are both used as underlying 
protocols for HTTP/S. This profile places the following constraints on those 
protocols:</P>
<DIV class=refinement>
<H4 id=Use_of_SSL_2.0>4.1.1 Use of SSL 2.0</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>SSL 2.0 has known security issues and all 
current implementations of HTTP/S support more recent protocols. Therefore this 
profile prohibits use of SSL 2.0.</P></DIV>
<P class=statement><SPAN class=statement-id><A name=R2001>R2001</A> </SPAN>A 
<SPAN class=statement-target>SENDER</SPAN> MUST NOT use SSL 2.0 as the 
underlying protocol for HTTP/S</P>
<P class=statement><SPAN class=statement-id><A name=R2002>R2002</A> </SPAN>A 
<SPAN class=statement-target>RECEIVER</SPAN> MUST NOT use SSL 2.0 as the 
underlying protocol for HTTP/S</P></DIV>
<H3 id=transportsecConsiderations>4.2 Security Considerations</H3>
<P>The following specifications (or sections thereof) are referred to in this 
section of the Profile:</P>
<UL>
  <LI><A class=offsite href="http://www.ietf.org/rfc/rfc2818.txt">HTTP over 
  TLS</A> </LI></UL>
<P><SPAN class=statement-target></SPAN>HTTP headers are only protected when SSL 
or TLS is used, and even then only between adjacent SOAP nodes. This profile 
places the following constraints on the use of HTTP headers:</P>
<DIV class=refinement>
<H4 id=SOAPAction_Header>4.2.1 SOAPAction Header</H4>
<DIV class=rationale>
<P></P></DIV>
<P class=statement><SPAN class=statement-id><A name=C2010>C2010</A> </SPAN>A 
<SPAN class=statement-target>SECURE_ENVELOPE</SPAN> SHOULD NOT be transmitted in 
an HTTP message containing a SOAPAction header in order to prevent processing 
based on this potentially unsecured value. </P></DIV>
<H2 id=msgsec>5. SOAP Message Security</H2>
<P>This section of the Profile incorporates the following specifications by 
reference, and defines extensibility points within them: </P>
<UL>
  <LI><A class=offsite 
  href="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0.pdf">Web 
  Services Security: SOAP Message Security</A> <BR>Extensibility points: 
  <UL>
    <LI><SPAN class=statement-id id=E0002>E0002</SPAN> - Security Tokens - 
    Security tokens may be specified in additional security token 
  profiles.</LI></UL></LI></UL>
<H3 id=WSSST>5.1 Security Tokens</H3>
<P>The following specifications (or sections thereof) are referred to in this 
section of the Profile:</P>
<UL>
  <LI><A class=offsite 
  href="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0.pdf">Web 
  Services Security: SOAP Message Security Section 6</A> </LI></UL><SPAN 
class=statement-target></SPAN>This Profile places the following constraints on 
the use of Security Tokens:
<DIV class=refinement>
<H4 id=Binary_Security_Token_EncodingType_Attribute>5.1.1 Binary Security Token 
EncodingType Attribute</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>Base64Binary is the only encoding type 
specified by Web Services Security: SOAP Message Security. Explicit 
specification of default values simplifies XML processing requirements. 
</P></DIV>
<P class=statement><SPAN class=statement-id><A name=R3029>R3029</A></SPAN> A 
<SPAN class=statement-target>SECURITY_TOKEN</SPAN> named 
wsse:BinarySecurityToken MUST specify an EncodingType attribute. </P>
<P class=statement><SPAN class=statement-id><A name=R3030>R3030</A></SPAN> An 
EncodingType attribute of a <SPAN class=statement-target>SECURITY_TOKEN</SPAN> 
named wsse:BinarySecurityToken MUST have a value of 
&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;. 
</P>
<DIV class=explanation>
<P><SPAN class=statement-target></SPAN>A BinarySecurityToken may specify its 
encoding type. The Profile restricts the encoding type to Base64Binary and 
requires its explicit specification. </P></DIV>
<P class=example-banner>For example,</P>
<DIV class=example>
<P class=incorrect>INCORRECT: </P><PRE>&lt;!-- This example is incorrect because the wsse:BinarySecurityToken element is missing an EncodingType attribute --&gt;

&lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                          ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
&lt;/wsse:BinarySecurityToken&gt;
</PRE></DIV>
<DIV class=example>
<P class=correct>CORRECT: </P><PRE>&lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                          ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509&quot;
                          EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
&lt;/wsse:BinarySecurityToken&gt;
</PRE></DIV></DIV>
<DIV class=refinement>
<H4 id=Binary_Security_Token_ValueType_Attribute>5.1.2 Binary Security Token 
ValueType Attribute</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>There is no appropriate default for 
ValueType. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R3031>R3031</A></SPAN> A 
<SPAN class=statement-target>SECURITY_TOKEN</SPAN> named 
wsse:BinarySecurityToken MUST specify a ValueType attribute. </P>
<P class=statement><SPAN class=statement-id><A name=R3032>R3032</A></SPAN> An 
ValueType attribute of a <SPAN class=statement-target>SECURITY_TOKEN</SPAN> 
named wsse:BinarySecurityToken MUST have a value specified by the related 
security token profile. </P>
<P class=statement><SPAN class=statement-id><A name=R3033>R3033</A></SPAN> A 
<SPAN class=statement-target>SECURITY_TOKEN</SPAN> named 
wsse:BinarySecurityToken containing a single X.509 Certificate MUST specify a 
ValueType attribute with the value 
&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509&quot;. 
</P>
<DIV class=explanation>
<P><SPAN class=statement-target></SPAN>Web Services Security: SOAP Message 
Security allows for a BinarySecurityToken to optionally specify its ValueType. 
The Profile restricts the ValueType to one of those specified by a security 
token profile and requires its specification. </P></DIV>
<P class=example-banner>For example,</P>
<DIV class=example>
<P class=incorrect>INCORRECT: </P><PRE>&lt;!-- This example is incorrect because the wsse:BinarySecurityToken element is missing a ValueType attribute --&gt;

&lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                          EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
&lt;/wsse:BinarySecurityToken&gt;
</PRE></DIV>
<DIV class=example>
<P class=incorrect>INCORRECT: </P><PRE>&lt;!-- This example is incorrect because the ValueType attribute on the wsse:BinarySecurityToken element has an incorrect value. --&gt;

&lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                          ValueType=&quot;http://www.mta.org/NYC#SubwayToken&quot;
                          EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
&lt;/wsse:BinarySecurityToken&gt;
</PRE></DIV>
<DIV class=example>
<P class=correct>CORRECT: </P><PRE>&lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                          ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509&quot;
                          EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
&lt;/wsse:BinarySecurityToken&gt;
</PRE></DIV></DIV>
<H3 id=WSSTokenReferences>5.2 SecurityTokenReferences</H3>
<P>The following specifications (or sections thereof) are referred to in this 
section of the Profile:</P>
<UL>
  <LI><A class=offsite 
  href="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0.pdf">Web 
  Services Security: SOAP Message Security Section 7</A></LI></UL><SPAN 
class=statement-target></SPAN>Web Services Security: SOAP Message Security 
defines a wsse:SecurityTokenReference element for use in SOAP messages. This 
Profile places the following constraints on its use: 
<DIV class=refinement>
<H4 id=Internal_References>5.2.1 Internal References</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>Reference by Key Identifier may be 
ambiguous. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R3022>R3022</A></SPAN> When 
a <SPAN class=statement-target>SECURITY_TOKEN_REFERENCE</SPAN> references an 
INTERNAL_SECURITY_TOKEN which has a wsu:Id attribute, the reference MUST use 
either a Direct Reference or an Embedded Reference. </P>
<DIV class=explanation>
<P><SPAN class=statement-target></SPAN>Direct and Embedded are preferred over 
Key Identifier References. </P></DIV>
<P class=example-banner>For example,</P>
<DIV class=example>
<P class=incorrect>INCORRECT: </P><PRE>&lt;!-- This example is incorrect because it refers to a wsse:BinarySecurityToken element which specifies a wsu:id
     attribute using a wsse:KeyIdentifier element rather than a wsse:Reference or wsse:Embedded element --&gt;

&lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd' 
               xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd' 
               xmlns:xenc='http://www.w3.org/2001/04/xmlenc#' 
               xmlns:ds='http://www.w3.org/2000/09/xmldsig#' &gt;
   &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                             ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509&quot;
                             EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
   &lt;/wsse:BinarySecurityToken&gt;
   &lt;wsse:SecurityTokenReference&gt;
      &lt;wsse:KeyIdentifier EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;
                          ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#X509SubjectKeyIdentifier&quot;&gt;
         MIGfMa0GCSq
      &lt;/wsse:KeyIdentifier&gt;
   &lt;/wsse:SecurityTokenReference&gt;
&lt;/wsse:Security&gt;
</PRE></DIV>
<DIV class=example>
<P class=correct>CORRECT: </P><PRE>&lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd' 
               xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd' 
               xmlns:xenc='http://www.w3.org/2001/04/xmlenc#' 
               xmlns:ds='http://www.w3.org/2000/09/xmldsig#' &gt;
   &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                             ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509&quot;
                             EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
   &lt;/wsse:BinarySecurityToken&gt;
   &lt;wsse:SecurityTokenReference&gt;
      &lt;wsse:Reference URI='#SomeCert'
                      ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509&quot; /&gt;
   &lt;/wsse:SecurityTokenReference&gt;
&lt;/wsse:Security&gt;
</PRE></DIV>
<DIV class=example>
<P class=correct>CORRECT: </P><PRE>&lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd' 
               xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd' 
               xmlns:xenc='http://www.w3.org/2001/04/xmlenc#' 
               xmlns:ds='http://www.w3.org/2000/09/xmldsig#' &gt;
   &lt;wsse:SecurityTokenReference&gt;
      &lt;wsse:Embedded wsu:Id=&quot;TheEmbeddedElementAroundSomeCert&quot;&gt;
         &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                                   ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509&quot;
                                   EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
         &lt;/wsse:BinarySecurityToken&gt;
      &lt;/wsse:Embedded&gt;
   &lt;/wsse:SecurityTokenReference&gt;
&lt;/wsse:Security&gt;
</PRE></DIV></DIV>
<DIV class=refinement>
<H4 id=Shorthand_XPointer_References>5.2.2 Shorthand XPointer References</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>Constraining the number of different 
referencing mechanisms reduces complexity and thus improves interoperability. 
The wsse:BinarySecurityToken, the element which contains the security token, has 
a wsu:Id attribute allowing references to this token to use Shorthand XPointers. 
</P></DIV>
<P class=statement><SPAN class=statement-id><A name=R5204>R5204</A></SPAN> When 
a <SPAN class=statement-target>SECURITY_TOKEN_REFERENCE</SPAN> uses a Direct 
Reference to an INTERNAL_SECURITY_TOKEN, it MUST use a Shorthand XPointer 
Reference. </P>
<P class=example-banner>For example,</P>
<DIV class=example>
<P class=correct>CORRECT: </P><PRE>&lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd' 
               xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd' 
               xmlns:xenc='http://www.w3.org/2001/04/xmlenc#' 
               xmlns:ds='http://www.w3.org/2000/09/xmldsig#' &gt;
 &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                           ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509&quot;
                           EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
 &lt;/wsse:BinarySecurityToken&gt;
 &lt;xenc:EncryptedKey&gt;
   &lt;xenc:EncryptionMethod Algorithm='http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p' /&gt;
   &lt;ds:KeyInfo&gt;
    &lt;wsse:SecurityTokenReference&gt;
     &lt;wsse:Reference
       URI='#SomeCert'
       ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509&quot;/&gt;
    &lt;/wsse:SecurityTokenReference&gt;
   &lt;/ds:KeyInfo&gt;
   &lt;xenc:CipherData&gt;
     &lt;xenc:CipherValue&gt;
       XZEEVABD3L9G+VNTCDiDTE7WB1a4kILtz5f9FT747eE=       
     &lt;/xenc:CipherValue&gt;
   &lt;/xenc:CipherData&gt;
 &lt;/xenc:EncryptedKey&gt;
&lt;/wsse:Security&gt;
</PRE></DIV>
<DIV class=example>
<P class=correct>CORRECT: </P><PRE>&lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd' 
               xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd' 
               xmlns:xenc='http://www.w3.org/2001/04/xmlenc#' 
               xmlns:ds='http://www.w3.org/2000/09/xmldsig#' &gt;
 &lt;rel:license xmlns:rel='urn:mpeg:mpeg21:2003:01-REL-R-NS'
              wsu:Id='SomeLic' 
              licenseId='uuid:3D680C71-177B-40cc-84C1-123B02503524' &gt;
 . . .
 &lt;/rel:license&gt;
 &lt;ds:Signature&gt;
   . . .
   &lt;ds:KeyInfo&gt;
    &lt;wsse:SecurityTokenReference&gt;
     &lt;wsse:Reference
       URI='#SomeLic'
       ValueType=&quot;http://docs.oasis-open.org/wss/2004/##/oasis-####-wss-REL-token-profile-1.0#license&quot; /&gt;
    &lt;/wsse:SecurityTokenReference&gt;
   &lt;/ds:KeyInfo&gt;
 &lt;/ds:Signature&gt;
&lt;/wsse:Security&gt;
</PRE></DIV></DIV>
<DIV class=refinement>
<H4 id=References_to_Preceding_Security_Tokens>5.2.3 References to Preceding 
Security Tokens</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>Ensuring that a security token appears 
before it is referenced means that the implementations already have the token in 
hand when it is needed to verify a signature or perform decryption. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R5205>R5205</A></SPAN> An 
<SPAN class=statement-target>INTERNAL_SECURITY_TOKEN</SPAN> MUST precede the 
first SECURITY_TOKEN_REFERENCE that references it. </P>
<DIV class=explanation>
<P><SPAN class=statement-target></SPAN>Any wsse:BinarySecurityToken element must 
appear before a referencing wsse:SecurityTokenReference element in document 
order. </P></DIV>
<P class=example-banner>For example,</P>
<DIV class=example>
<P class=incorrect>INCORRECT: </P><PRE>&lt;!-- This example is incorrect because the wsse:BinarySecurityToken with the wsu:Id of SomeCert appears after it is 
     referenced from within the xenc:EncryptedKey element --&gt; 

&lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd' 
               xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd' 
               xmlns:xenc='http://www.w3.org/2001/04/xmlenc#' 
               xmlns:ds='http://www.w3.org/2000/09/xmldsig#' &gt;
 &lt;xenc:EncryptedKey&gt;
   &lt;xenc:EncryptionMethod Algorithm='http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p' /&gt;
   &lt;ds:KeyInfo&gt;
     &lt;wsse:SecurityTokenReference&gt;
       &lt;wsse:Reference
         URI='#SomeCert'
         ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509&quot;/&gt;
     &lt;/wsse:SecurityTokenReference&gt;
   &lt;/ds:KeyInfo&gt;
   &lt;xenc:CipherData&gt;
     &lt;xenc:CipherValue&gt;
       XZEEVABD3L9G+VNTCDiDTE7WB1a4kILtz5f9FT747eE=       
     &lt;/xenc:CipherValue&gt;
   &lt;/xenc:CipherData&gt;
 &lt;/xenc:EncryptedKey&gt;
 &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                           ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509&quot;
                           EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
 &lt;/wsse:BinarySecurityToken&gt;
&lt;/wsse:Security&gt;
</PRE></DIV>
<DIV class=example>
<P class=correct>CORRECT: </P><PRE>&lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd' 
               xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd' 
               xmlns:xenc='http://www.w3.org/2001/04/xmlenc#' 
               xmlns:ds='http://www.w3.org/2000/09/xmldsig#' &gt;
 &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                           ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509&quot;
                           EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
 &lt;/wsse:BinarySecurityToken&gt;
 &lt;xenc:EncryptedKey&gt;
   &lt;xenc:EncryptionMethod Algorithm='http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p' /&gt;
   &lt;ds:KeyInfo&gt;
     &lt;wsse:SecurityTokenReference&gt;
       &lt;wsse:Reference
         URI='#SomeCert'
         ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509&quot;/&gt;
     &lt;/wsse:SecurityTokenReference&gt;
   &lt;/ds:KeyInfo&gt;
   &lt;xenc:CipherData&gt;
     &lt;xenc:CipherValue&gt;
       XZEEVABD3L9G+VNTCDiDTE7WB1a4kILtz5f9FT747eE=       
     &lt;/xenc:CipherValue&gt;
   &lt;/xenc:CipherData&gt;
 &lt;/xenc:EncryptedKey&gt;
&lt;/wsse:Security&gt;
</PRE></DIV></DIV>
<DIV class=refinement>
<H4 id=Direct_Preferred_to_Embedded_for_Internal_References>5.2.4 Direct 
Preferred to Embedded for Internal References</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>Since multiple security elements may 
reference a single token and processing of those elements may result in the 
removal of the element, consistent use of direct rather than embedded references 
simplifies processing.</P></DIV>
<P class=statement><SPAN class=statement-id><A name=R3023>R3023</A></SPAN> Each 
<SPAN class=statement-target>SECURITY_TOKEN_REFERENCE</SPAN> that refers to an 
INTERNAL_SECURITY_TOKEN that is referenced several times SHOULD be a direct 
reference rather than an embedded reference. </P>
<DIV class=explanation>
<P><SPAN class=statement-target></SPAN>Direct references are encouraged. 
Embedded references are discouraged. </P></DIV>
<P class=example-banner>For example,</P>
<DIV class=example>
<P class=incorrect>INCORRECT: </P><PRE>&lt;!-- This example is incorrect because it uses a wsse:Embedded element for the wsse:BinarySecurityToken 
     with the wsu:Id of SomeCert. It is assumed that this token is referred to from several places elsewhere
     in the SOAP envelope ( not shown )  --&gt;

&lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd' 
               xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd' 
               xmlns:xenc='http://www.w3.org/2001/04/xmlenc#' 
               xmlns:ds='http://www.w3.org/2000/09/xmldsig#' &gt;
   &lt;wsse:SecurityTokenReference&gt;
      &lt;wsse:Embedded wsu:Id=&quot;TheEmbeddedElementAroundSomeCert&quot;&gt;
         &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                                   ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509&quot;
                                   EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
         &lt;/wsse:BinarySecurityToken&gt;
      &lt;/wsse:Embedded&gt;
   &lt;/wsse:SecurityTokenReference&gt;
&lt;/wsse:Security&gt;
</PRE></DIV>
<DIV class=example>
<P class=correct>CORRECT: </P><PRE>&lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd' 
               xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd' 
               xmlns:xenc='http://www.w3.org/2001/04/xmlenc#' 
               xmlns:ds='http://www.w3.org/2000/09/xmldsig#' &gt;
   &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                             ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509&quot;
                             EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
   &lt;/wsse:BinarySecurityToken&gt;
   &lt;wsse:SecurityTokenReference&gt;
      &lt;wsse:Reference URI='#SomeCert'
                      ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509&quot; /&gt;
   &lt;/wsse:SecurityTokenReference&gt;
&lt;/wsse:Security&gt;
</PRE></DIV></DIV>
<DIV class=refinement>
<H4 id=Direct_Required_When_Possible_for_External_References>5.2.5 Direct 
Required When Possible for External References</H4>
<P class=statement><SPAN class=statement-id><A name=R3024>R3024</A></SPAN> When 
a <SPAN class=statement-target>SECURITY_TOKEN_REFERENCE</SPAN> references an 
EXTERNAL_SECURITY_TOKEN that can be referred to using a Direct Reference, a 
Direct Reference MUST be used. </P>
<P class=example-banner>For example,</P>
<DIV class=example>
<P class=correct>CORRECT: </P><PRE>&lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd' 
               xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd' 
               xmlns:xenc='http://www.w3.org/2001/04/xmlenc#' 
               xmlns:ds='http://www.w3.org/2000/09/xmldsig#' &gt;

   &lt;wsse:SecurityTokenReference&gt;
      &lt;wsse:Reference URI='http://www.ws-i.org/CertStore/Examples/BSP.PEM'
                      ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509&quot; /&gt;
   &lt;/wsse:SecurityTokenReference&gt;
&lt;/wsse:Security&gt;
</PRE></DIV></DIV>
<DIV class=refinement>
<H4 id=Format_of_Embedded_References>5.2.6 Format of Embedded References</H4>
<P class=statement><SPAN class=statement-id><A name=R3025>R3025</A></SPAN> When 
a wsse:Embedded element in a <SPAN 
class=statement-target>SECURITY_TOKEN_REFERENCE</SPAN> is used to specify an 
inline INTERNAL_SECURITY_TOKEN, its format MUST be the same as if the token were 
a child of a SECURITY_HEADER. </P>
<P class=example-banner>For example,</P>
<DIV class=example>
<P class=incorrect>INCORRECT: </P><PRE>&lt;!-- This example is incorrect because the wsse:Embedded element carries the data for the X.509 certificate
     directly rather than as a wsse:BinarySecurityToken element  --&gt;

&lt;wsse:SecurityTokenReference&gt;
   &lt;wsse:Embedded wsu:Id=&quot;SomeCert&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
   &lt;/wsse:Embedded&gt;
&lt;/wsse:SecurityTokenReference&gt;
</PRE></DIV>
<DIV class=example>
<P class=correct>CORRECT: </P><PRE>&lt;wsse:SecurityTokenReference&gt;
   &lt;wsse:Embedded wsu:Id=&quot;TheEmbeddedElementAroundSomeCert&quot;&gt;
      &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                                ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509&quot;
                                EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
      &lt;/wsse:BinarySecurityToken&gt;
   &lt;/wsse:Embedded&gt;
&lt;/wsse:SecurityTokenReference&gt;
</PRE></DIV></DIV>
<DIV class=refinement>
<H4 id=Key_Identifier_for_External_References>5.2.7 Key Identifier for External 
References</H4>
<P class=statement><SPAN class=statement-id><A name=R3026>R3026</A></SPAN> When 
a <SPAN class=statement-target>SECURITY_TOKEN_REFERENCE</SPAN> references an 
EXTERNAL_SECURITY_TOKEN that cannot be referred to using a Direct Reference but 
can be referred to using a Key Identifier or ds:X509Data/ds:X509IssuerSerial, a 
Key Identifier or ds:X509Data/ds:X509IssuerSerial MUST be used. </P>
<P class=example-banner>For example,</P>
<DIV class=example>
<P class=correct>CORRECT: </P><PRE>&lt;wsse:SecurityTokenReference&gt;
   &lt;wsse:KeyIdentifier EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;
                       ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#X509SubjectKeyIdentifier&quot; &gt;
      MIGfMa0GCSq
   &lt;/wsse:KeyIdentifier&gt;
&lt;/wsse:SecurityTokenReference&gt;
</PRE></DIV>
<DIV class=example>
<P class=correct>CORRECT: </P><PRE>&lt;wsse:SecurityTokenReference&gt;
   &lt;ds:X509Data&gt;
      &lt;ds:X509IssuerSerial&gt;
         &lt;ds:X509IssuerName&gt;CN=Security WG, OU=BSP, O=WS-I, C=US&lt;/ds:X509IssuerName&gt;
         &lt;ds:X509IssuerSerial&gt;54A4E9&lt;/ds:X509IssuerSerial&gt;
      &lt;/ds:X509IssuerSerial&gt;
   &lt;/ds:X509Data&gt;
&lt;/wsse:SecurityTokenReference&gt;
</PRE></DIV></DIV>
<DIV class=refinement>
<H4 id=Key_Name_References_Prohibited>5.2.8 Key Name References Prohibited</H4>
<P class=statement><SPAN class=statement-id><A name=R3027>R3027</A></SPAN> A 
<SPAN class=statement-target>SECURITY_TOKEN_REFERENCE</SPAN> MUST NOT use a Key 
Name to reference a SECURITY_TOKEN. </P>
<P class=example-banner>For example,</P>
<DIV class=example>
<P class=incorrect>INCORRECT: </P><PRE>&lt;!-- This example is incorrect because it uses a ds:KeyName element to refer to an X.509 certificate  --&gt;

&lt;wsse:SecurityTokenReference&gt;
   &lt;ds:KeyName&gt;CN=Security WG, OU=BSP, O=WS-I, C=US&lt;/ds:KeyName&gt;
&lt;/wsse:SecurityTokenReference&gt;
</PRE></DIV></DIV>
<DIV class=refinement>
<H4 id=KeyIdentifier/@ValueType_Attribute>5.2.9 KeyIdentifier/@ValueType 
Attribute</H4>
<P class=statement><SPAN class=statement-id><A name=R3054>R3054</A></SPAN> A 
wsse:KeyIdentifier element in a <SPAN 
class=statement-target>SECURITY_TOKEN_REFERENCE</SPAN> MUST specify a ValueType 
attribute. </P>
<P class=statement><SPAN class=statement-id><A name=R3063>R3063</A></SPAN> A 
ValueType attribute on a wsse:KeyIdentifier element in a <SPAN 
class=statement-target>SECURITY_TOKEN_REFERENCE</SPAN> MUST have a value 
specified within the security token profile associated with the referenced 
SECURITY_TOKEN. </P>
<P class=example-banner>For example,</P>
<DIV class=example>
<P class=incorrect>INCORRECT: </P><PRE>&lt;!-- This example is incorrect because the wsse:KeyIdentifier element is missing a ValueType attribute --&gt;

&lt;wsse:SecurityTokenReference&gt;
   &lt;wsse:KeyIdentifier EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;&gt;
      MIGfMa0GCSq
   &lt;/wsse:KeyIdentifier&gt;
&lt;/wsse:SecurityTokenReference&gt;
</PRE></DIV>
<DIV class=example>
<P class=correct>CORRECT: </P><PRE>&lt;wsse:SecurityTokenReference&gt;
   &lt;wsse:KeyIdentifier EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;
                       ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#X509SubjectKeyIdentifier&quot; &gt;
      MIGfMa0GCSq
   &lt;/wsse:KeyIdentifier&gt;
&lt;/wsse:SecurityTokenReference&gt;
</PRE></DIV></DIV>
<DIV class=refinement>
<H4 id=Children_of_wsse_Embedded>5.2.10 Children of wsse:Embedded</H4>
<P class=statement><SPAN class=statement-id><A name=R3055>R3055</A></SPAN> A 
wsse:Embedded element in a <SPAN class=statement-target>SECURE_ENVELOPE</SPAN> 
MUST NOT contain a wsse:SecurityTokenReference child element. </P>
<P class=statement><SPAN class=statement-id><A name=R3060>R3060</A></SPAN> A 
wsse:Embedded element in a <SPAN class=statement-target>SECURE_ENVELOPE</SPAN> 
MUST contain a single child element for a security token from a token profile. 
</P>
<P class=example-banner>For example,</P>
<DIV class=example>
<P class=incorrect>INCORRECT: </P><PRE>&lt;!-- This example is incorrect because the wsse:Embedded element contains a wsse:SecurityTokenReference element --&gt;

&lt;wsse:SecurityTokenReference&gt;
   &lt;wsse:Embedded wsu:Id=&quot;TheEmbeddedElementAroundSomeSTR&quot;&gt;
      &lt;wsse:SecurityTokenReference&gt;
         &lt;wsse:Reference URI='#SomeCert'
                         ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509&quot; /&gt;
      &lt;/wsse:SecurityTokenReference&gt;
   &lt;/wsse:Embedded&gt;
&lt;/wsse:SecurityTokenReference&gt;
</PRE></DIV>
<DIV class=example>
<P class=incorrect>INCORRECT: </P><PRE>&lt;!-- This example is incorrect because the wsse:Embedded element has multiple element children --&gt;

&lt;wsse:SecurityTokenReference&gt;
   &lt;wsse:Embedded wsu:Id=&quot;TheEmbeddedElementAroundSomeCerts&quot;&gt;
      &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                                ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509&quot;
                                EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
      &lt;/wsse:BinarySecurityToken&gt;
      &lt;wsse:BinarySecurityToken wsu:Id='SomeOtherCert'
                                ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509&quot;
                                EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
      &lt;/wsse:BinarySecurityToken&gt;
   &lt;/wsse:Embedded&gt;
&lt;/wsse:SecurityTokenReference&gt;
</PRE></DIV>
<DIV class=example>
<P class=correct>CORRECT: </P><PRE>&lt;wsse:SecurityTokenReference&gt;
   &lt;wsse:Embedded wsu:Id=&quot;TheEmbeddedElementAroundSomeCert&quot;&gt;
      &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                                ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509&quot;
                                EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
      &lt;/wsse:BinarySecurityToken&gt;
   &lt;/wsse:Embedded&gt;
&lt;/wsse:SecurityTokenReference&gt;
</PRE></DIV></DIV>
<DIV class=refinement>
<H4 
id=Reference_from_wsse_SecurityTokenReference_to_wsse_SecurityTokenReference>5.2.11 
Reference from wsse:SecurityTokenReference to wsse:SecurityTokenReference</H4>
<P class=statement><SPAN class=statement-id><A name=R3056>R3056</A></SPAN> A 
<SPAN class=statement-target>SECURITY_TOKEN_REFERENCE</SPAN> MUST NOT use a 
Direct Reference to another SECURITY_TOKEN_REFERENCE that does not have a 
wsse:Embedded child element. </P>
<P class=statement><SPAN class=statement-id><A name=R3064>R3064</A></SPAN> When 
a <SPAN class=statement-target>SECURITY_TOKEN_REFERENCE</SPAN> uses a Direct 
Reference to an INTERNAL_SECURITY_TOKEN contained within an wsse:Embedded 
element of another SECURITY_TOKEN_REFERENCE, the reference MUST be to the 
contained INTERNAL_SECURITY_TOKEN not to the wsse:Embedded element.</P>
<P class=example-banner>For example,</P>
<DIV class=example>
<P class=incorrect>INCORRECT: </P><PRE>&lt;!-- This example is incorrect because the second wsse:SecurityTokenReference element refers to the 
     wsse:SecurityTokenReference with an wsu:Id of TheFirstSTR  --&gt;
     
&lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                          ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509&quot;
                          EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
&lt;/wsse:BinarySecurityToken&gt;
&lt;wsse:SecurityTokenReference wsu:Id=&quot;TheFirstSTR&quot;&gt;
   &lt;wsse:Reference URI='#SomeCert'
                   ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509&quot; /&gt;
&lt;/wsse:SecurityTokenReference&gt;
&lt;wsse:SecurityTokenReference&gt;
   &lt;wsse:Reference URI='#TheFirstSTR'
                   ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509&quot; /&gt;
&lt;/wsse:SecurityTokenReference&gt;
</PRE></DIV>
<DIV class=example>
<P class=correct>CORRECT: </P><PRE>&lt;wsse:SecurityTokenReference&gt;
   &lt;wsse:Embedded wsu:Id=&quot;TheEmbeddedElementAroundSomeCert&quot;&gt;
      &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                                ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509&quot;
                                EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
      &lt;/wsse:BinarySecurityToken&gt;
   &lt;/wsse:Embedded&gt;
&lt;/wsse:SecurityTokenReference&gt;
&lt;wsse:SecurityTokenReference&gt;
   &lt;wsse:Reference URI='#SomeCert'
                   ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509&quot; /&gt;
&lt;/wsse:SecurityTokenReference&gt;
</PRE></DIV></DIV>
<DIV class=refinement>
<H4 id=wsse_SecurityTokenReference/Reference_ValueType_Attribute>5.2.12 
wsse:SecurityTokenReference/Reference ValueType Attribute</H4>
<P class=statement><SPAN class=statement-id><A name=R3059>R3059</A></SPAN> A 
wsse:Reference element in a <SPAN 
class=statement-target>SECURITY_TOKEN_REFERENCE</SPAN> MUST specify a ValueType 
attribute. </P>
<P class=statement><SPAN class=statement-id><A name=R3058>R3058</A></SPAN> A 
wsse:Reference element in a <SPAN 
class=statement-target>SECURITY_TOKEN_REFERENCE</SPAN> MUST specify a ValueType 
attribute that matches any ValueType specified by a token profile for the the 
referenced SECURITY_TOKEN. </P></DIV>
<DIV class=refinement>
<H4 id=wsse_SecurityTokenReference_constraints>5.2.13 
wsse:SecurityTokenReference constraints</H4>
<P class=statement><SPAN class=statement-id><A name=R3061>R3061</A></SPAN> A 
<SPAN class=statement-target>SECURITY_TOKEN_REFERENCE</SPAN> MUST have exactly 
one child element. </P>
<P class=statement><SPAN class=statement-id><A name=R3062>R3062</A></SPAN> A 
wsse:Reference element in a <SPAN 
class=statement-target>SECURITY_TOKEN_REFERENCE</SPAN> MUST specify a URI 
attribute. </P></DIV>
<DIV class=refinement>
<H4 id=wsse_SecurityTokenReference_Dereferencing_Transform>5.2.14 
wsse:SecurityTokenReference Dereferencing Transform</H4>
<P class=statement><SPAN class=statement-id><A name=R3065>R3065</A></SPAN> When 
a <SPAN class=statement-target>SIGNATURE</SPAN> uses the SecurityTokenReference 
Dereferencing Transform, the ds:CanonicalizationMethod element MUST be present 
and wrapped in a wsse:TransformationParameters element. </P></DIV>
<H3 id=WSSTimeStamp>5.3 Timestamps</H3>
<P>The following specifications (or sections thereof) are referred to in this 
section of the Profile:</P>
<UL>
  <LI><A class=offsite 
  href="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0.pdf">Web 
  Services Security: SOAP Message Security Section 10</A></LI></UL>
<P><SPAN class=statement-target></SPAN>Web Services Security: SOAP Message 
Security defines a Timestamp element for use in SOAP messages. This Profile 
places the following constraints on its use:</P>
<DIV class=refinement>
<H4 id=wsu_Timestamp/wsu_Created>5.3.1 wsu:Timestamp/wsu:Created</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>The wsu:Created element represents the 
creation time of the security semantics. This element is REQUIRED and can only 
be specified once in a Timestamp element. Within the SOAP processing model, 
creation is the instant that the Infoset is serialized for transmission. 
</P></DIV>
<P class=statement><SPAN class=statement-id><A name=R3203>R3203</A></SPAN> A 
<SPAN class=statement-target>TIMESTAMP</SPAN> MUST have exactly one wsu:Created 
element child. </P>
<P class=example-banner>For example,</P>
<DIV class=example>
<P class=incorrect>INCORRECT: </P><PRE>&lt;!-- This example is incorrect because the wsu:Timestamp element is missing a wsu:Created child element --&gt;

&lt;wsu:Timestamp wsu:Id=&quot;timestamp&quot;&gt;
   &lt;wsu:Expires&gt;2001-10-13T09:00:00Z&lt;/wsu:Expires&gt;
&lt;/wsu:Timestamp&gt;
</PRE></DIV>
<DIV class=example>
<P class=correct>CORRECT: </P><PRE>&lt;wsu:Timestamp wsu:Id=&quot;timestamp&quot;&gt;
   &lt;wsu:Created&gt;2001-09-13T08:42:00Z&lt;/wsu:Created&gt;
   &lt;wsu:Expires&gt;2001-10-13T09:00:00Z&lt;/wsu:Expires&gt;
 &lt;/wsu:Timestamp&gt;
</PRE></DIV></DIV>
<DIV class=refinement>
<H4 id="Occurence_constraints_on&#9;wsu_Created_and_wsu_Expires_">5.3.2 
Occurence constraints on wsu:Created and wsu:Expires </H4>
<P class=statement><SPAN class=statement-id><A name=R3223>R3223</A></SPAN> A 
<SPAN class=statement-target>TIMESTAMP</SPAN> MUST NOT contain more than one 
wsu:Created element. </P>
<P class=statement><SPAN class=statement-id><A name=R3224>R3224</A></SPAN> A 
<SPAN class=statement-target>TIMESTAMP</SPAN> MUST NOT contain more than one 
wsu:Expires element. </P>
<P class=statement><SPAN class=statement-id><A name=R3221>R3221</A></SPAN> If a 
<SPAN class=statement-target>TIMESTAMP</SPAN> contains both a wsu:Created 
element and a wsu:Expires element they MUST appear in the order: wsu:Created 
then wsu:Expires. </P></DIV>
<DIV class=refinement>
<H4 id=Value_constraints_on_wsu_Created_and_wsu_Expires_>5.3.3 Value constraints 
on wsu:Created and wsu:Expires </H4>
<P class=statement><SPAN class=statement-id><A name=R3213>R3213</A></SPAN> A 
<SPAN class=statement-target>TIMESTAMP</SPAN> MUST NOT include wsu:Created or 
wsu:Expires values that specify leap seconds. </P>
<P class=statement><SPAN class=statement-id><A name=R3225>R3225</A></SPAN> A 
wsu:Created element within a <SPAN class=statement-target>TIMESTAMP</SPAN> MUST 
NOT include a ValueType attribute. </P>
<P class=statement><SPAN class=statement-id><A name=R3226>R3226</A></SPAN> A 
wsu:Expires element within a <SPAN class=statement-target>TIMESTAMP</SPAN> MUST 
NOT include a ValueType attribute. </P>
<P class=statement><SPAN class=statement-id><A name=R3217>R3217</A></SPAN> A 
<SPAN class=statement-target>TIMESTAMP</SPAN> MUST only contain time instants in 
UTC format as specified by the XML Schema type (dateTime). </P></DIV>
<DIV class=refinement>
<H4 id=wsu_Timestamp_inside_wsse_Security_header_>5.3.4 wsu:Timestamp inside 
wsse:Security header </H4>
<P class=statement><SPAN class=statement-id><A name=R3218>R3218</A></SPAN> A 
<SPAN class=statement-target>SECURITY_HEADER</SPAN> MUST NOT contain a 
wsu:timestamp that is not its immediate child. </P>
<P class=statement><SPAN class=statement-id><A name=R3219>R3219</A></SPAN> A 
<SPAN class=statement-target>SECURITY_HEADER</SPAN> MUST NOT contain more than 
one TIMESTAMP. </P></DIV>
<H3 id=WSSReferences>5.4 wsu:Id References</H3>
<P>The following specifications (or sections thereof) are referred to in this 
section of the Profile:</P>
<UL>
  <LI><A class=offsite 
  href="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0.pdf">Web 
  Services Security: SOAP Message Security</A></LI></UL>
<P><SPAN class=statement-target></SPAN>Web Services Security: SOAP Message 
Security defines a wsu:Id element for use in SOAP messages. This Profile places 
the following constraints on its use:</P>
<DIV class=refinement>
<H4 id=wsu_Id_Attribute_Uniqueness>5.4.1 wsu:Id Attribute Uniqueness</H4>
<P class=statement><SPAN class=statement-id><A name=R3204>R3204</A></SPAN> Two 
wsu:Id attributes within any <SPAN class=statement-target>SECURE_ENVELOPE</SPAN> 
MUST NOT have the same value. </P></DIV>
<H3 id=WSSProcessing>5.5 wsse:Security Processing Order</H3>
<P>The following specifications (or sections thereof) are referred to in this 
section of the Profile:</P>
<UL>
  <LI><A class=offsite 
  href="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0.pdf">Web 
  Services Security: SOAP Message Security</A></LI></UL>
<P><SPAN class=statement-target></SPAN>Web Services Security: SOAP Message 
Security defines the order for processing signature and encryption blocks within 
wsse:Security headers. This Profile provides the following guidance:</P>
<DIV class=refinement>
<H4 id=Order_of_Processing>5.5.1 Order of Processing</H4>
<P class=statement><SPAN class=statement-id><A name=R3212>R3212</A></SPAN> 
Within a <SPAN class=statement-target>SECURITY_HEADER</SPAN>, all SIGNATURE, 
ENCRYPTED_KEY, and ENCRYPTION_REFERENCE_LIST elements MUST be ordered so a 
receiver will get the correct result by processing the elements in the order 
they appear. </P></DIV>
<H3 id=WSSActor>5.6 SOAP Actor</H3>
<P>The following specifications (or sections thereof) are referred to in this 
section of the Profile:</P>
<UL>
  <LI><A class=offsite 
  href="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0.pdf">Web 
  Services Security: SOAP Message Security</A></LI></UL>
<P><SPAN class=statement-target></SPAN>SOAP defines an actor attribute for use 
in SOAP headers. This Profile places the following constraints on its use:</P>
<DIV class=refinement>
<H4 id=SOAP_Actor_Value>5.6.1 SOAP Actor Value</H4>
<P class=statement><SPAN class=statement-id><A name=R3206>R3206</A></SPAN> 
Within a <SPAN class=statement-target>SECURE_ENVELOPE</SPAN> there MUST be at 
most one SECURITY_HEADER with the actor attribute omitted. </P>
<P class=statement><SPAN class=statement-id><A name=R3210>R3210</A></SPAN> 
Within a <SPAN class=statement-target>SECURE_ENVELOPE</SPAN> there MUST be at 
most one SECURITY_HEADER with the same actor attribute value. </P></DIV>
<H2 id=usernametoken>6. Username Token Profile</H2>
<P>This section of the Profile incorporates the following specifications by 
reference: </P>
<UL>
  <LI><A class=offsite 
  href="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0.pdf">Web 
  Services Security: Username Token Profile</A></LI></UL>
<H3 id=tokenusage>6.1 Token Usage</H3>
<DIV class=refinement>
<H4 id=wsse_UsernameToken/wsse_Password/@Type>6.1.1 
wsse:UsernameToken/wsse:Password/@Type</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>To avoid ambiguity, the Type attribute 
must always be specified on the wsse:Password element of a 
wsse:UsernameToken</P></DIV>
<P class=statement><SPAN class=statement-id><A name=R4201>R4201</A></SPAN> A 
wsse:UsernameToken/wsse:Password element in a <SPAN 
class=statement-target>SECURITY_HEADER</SPAN> MUST specify a Type attribute. 
</P>
<P class=example-banner>For example,</P>
<DIV class=example>
<P class=incorrect>INCORRECT: </P><PRE>&lt;!-- This example is incorrect because the wsse:Password element is missing a Type attribute with a value of 
     http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText --&gt;

&lt;wsse:UsernameToken
   xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd' &gt;
   &lt;wsse:Username&gt;Bert&lt;/wsse:Username&gt;
   &lt;wsse:Password&gt;Ernie&lt;/wsse:Password&gt;
&lt;/wsse:UsernameToken&gt;
</PRE></DIV>
<DIV class=example>
<P class=incorrect>INCORRECT: </P><PRE>&lt;
&lt;!-- This example is incorrect because the wsse:Password element is missing a Type attribute with a value of 
     http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordDigest --&gt;

&lt;wsse:UsernameToken
   xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd' &gt;
   &lt;wsse:Username&gt;Bert&lt;/wsse:Username&gt;
   &lt;wsse:Password&gt;B5twk47KwSrjeg==&lt;/wsse:Password&gt;
&lt;/wsse:UsernameToken&gt;
</PRE></DIV>
<DIV class=example>
<P class=correct>CORRECT: </P><PRE>&lt;wsse:UsernameToken
   xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd' &gt;
   &lt;wsse:Username&gt;Bert&lt;/wsse:Username&gt;
   &lt;wsse:Password
      Type='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText'&gt;
      Ernie
   &lt;/wsse:Password&gt;
&lt;/wsse:UsernameToken&gt;
</PRE></DIV>
<DIV class=example>
<P class=correct>CORRECT: </P><PRE>&lt;wsse:UsernameToken xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd' &gt;
   &lt;wsse:Username&gt;Bert&lt;/wsse:Username&gt;
   &lt;wsse:Password
      Type='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordDigest'&gt;
      B5twk47KwSrjeg==
   &lt;/wsse:Password&gt;
&lt;/wsse:UsernameToken&gt;
</PRE></DIV></DIV>
<DIV class=refinement>
<H4 id=PasswordDigest>6.1.2 PasswordDigest</H4>
<P class=statement><SPAN class=statement-id><A name=R4212>R4212</A></SPAN> When 
a wsse:Password element with a Type attribute with a value of 
&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordDigest&quot; 
is used within a <SPAN class=statement-target>SECURITY_TOKEN</SPAN>, its value 
MUST be computed using the following formula, where &quot;+&quot; indicates concatenation: 
Password_Digest = Base64 ( SHA-1 ( nonce + created + password ) ). That is, 
concatenate the nonce, creation timestamp, and the password (or shared secret or 
password equivalent), digest the combination using the SHA-1 hash algorithm, 
then include the Base64 encoding of that result as the password (digest). Any 
elements that are not present are simply omitted from the concatenation. 
</P></DIV>
<DIV class=refinement>
<H4 id=ValueType_attribute>6.1.3 ValueType attribute</H4>
<P class=statement><SPAN class=statement-id><A name=R4214>R4214</A></SPAN> When 
a SECURITY_TOKEN named wsse:UsernameToken is referenced by a <SPAN 
class=statement-target>SECURITY_TOKEN_REFERENCE</SPAN> then the 
wsse:SecurityTokenReference/wsse:Reference/@ValueType attribute MUST have a 
value of 
&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#UsernameToken&quot;. 
</P></DIV>
<DIV class=refinement>
<H4 id=Reference_by_KeyIdentifier>6.1.4 Reference by KeyIdentifier</H4>
<P class=statement><SPAN class=statement-id><A name=R4215>R4215</A></SPAN> When 
a <SPAN class=statement-target>SECURITY_TOKEN_REFERENCE</SPAN> refers to a 
wsse:UsernameToken, a KeyIdentifier reference MUST NOT be used. </P></DIV>
<DIV class=refinement>
<H4 id=Key_Derivation>6.1.5 Key Derivation</H4>
<DIV class=explanation>
<P><SPAN class=statement-target></SPAN>The Username Token profile does not 
currently define a key derivation algorithm. The OASIS WSS TC is expected to 
address this issue sometime in the future. </P></DIV></DIV>
<DIV class=refinement>
<H4 id=Sign_UsernameToken>6.1.6 Sign UsernameToken</H4>
<P class=statement><SPAN class=statement-id><A name=C4210>C4210</A></SPAN> Any 
<SPAN class=statement-target>SECURITY_TOKEN</SPAN> named wsse:UsernameToken that 
contains a wsse:Nonce element and a wsse:Password element with a Type attribute 
value of 
&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText&quot; 
SHOULD be referenced by a ds:Reference in a SIGNATURE in order to prevent 
replay. </P>
<P class=statement><SPAN class=statement-id><A name=C4211>C4211</A></SPAN> Any 
<SPAN class=statement-target>SECURITY_TOKEN</SPAN> named wsse:UsernameToken that 
contains a wsu:Created element and a wsse:Password element with a Type attribute 
value of 
&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText&quot; 
SHOULD be referenced by a ds:Reference in a SIGNATURE in order to prevent 
replay. </P></DIV>
<H2 id=x509token>7. X.509 Certificate Token Profile</H2>
<P>This section of the Profile incorporates the following specifications by 
reference, and defines extensibility points within them: </P>
<UL>
  <LI><A class=offsite 
  href="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0.pdf">Web 
  Services Security: X.509 Token Profile</A>
  <LI><A class=offsite href="http://www.ietf.org/rfc/rfc2818.txt">RFC2459: 
  Internet X.509 Public Key Infrastructure Certificate and CRL 
  Profile</A><BR>Extensibility points: 
  <UL>
    <LI><SPAN class=statement-id id=E0012>E0012</SPAN> - Certificate Authority - 
    The choice of the Certificate Authority is a private agreement between 
    parties.
    <LI><SPAN class=statement-id id=E0013>E0013</SPAN> - Certificate Extensions 
    - X.509 allows for arbitrary certificate extensions.</LI></UL></LI></UL>
<H3 id=x509tokentypes>7.1 Token Types</H3>
<P>The following specifications (or sections thereof) are referred to in this 
section of the Profile:</P>
<UL>
  <LI><A class=offsite 
  href="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0.pdf">Web 
  Services Security: X.509 Token Profile Section 3.1</A></LI></UL>
<P><SPAN class=statement-target></SPAN>Web Services Security: X.509 Token 
Profile defines 3 token types: X509v3; x509PKIPathv1; and PKCS7. This Profile 
places the following constraints on their use:</P>
<DIV class=refinement>
<H4 id=Certificate_Path>7.1.1 Certificate Path</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>Interoperability issues may arise if 
different forms of certificate path information are used when not expected. 
X509PKIPathv1 is preferred because it allows more efficient certificate path 
processing. PKCS7 is a more mature and widely implemented standard so it is also 
allowed. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R5201>R5201</A></SPAN> When 
certificate path information is provided, a <SPAN 
class=statement-target>SENDER</SPAN> MUST provide one of the X509PKIPathv1 or 
PKCS7 token types. </P>
<P class=statement><SPAN class=statement-id><A name=R5202>R5202</A></SPAN> When 
certificate path information is provided, a <SPAN 
class=statement-target>SENDER</SPAN> SHOULD provide the X509PKIPathv1 token 
type. </P>
<P class=statement><SPAN class=statement-id><A name=R5203>R5203</A></SPAN> When 
certificate path information is provided, a <SPAN 
class=statement-target>RECEIVER</SPAN> MUST accept X509PKIPathv1 and PKCS7 token 
types. </P></DIV>
<DIV class=refinement>
<H4 id=KeyIdentifier>7.1.2 KeyIdentifier</H4>
<P class=statement><SPAN class=statement-id><A name=R5206>R5206</A></SPAN> When 
the wsse:KeyIdentifier element is used within a <SPAN 
class=statement-target>SECURITY_TOKEN_REFERENCE</SPAN> to specify a reference to 
an X.509 Certificate Token, the wsse:KeyIdentifier element MUST have ValueType 
attribute with the value 
http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#X509SubjectKeyIdentifier 
and its contents MUST be the value of the certificate's X.509 
SubjectKeyIdentifier extension. </P></DIV>
<H2 id=xmlSignature>8. XML-Signature</H2>
<P><SPAN class=statement-target></SPAN>Web Services Security: SOAP Message 
Security builds on XML Signature, defining usage of various elements from XML 
Signature and a processing model. This Profile places the constraints defined in 
this section on the use of XML Signature with Web Services Security: SOAP 
Message Security. This Profile places no constraints on other use of XML 
Signature.</P>
<P>This section of the Profile incorporates the following specifications by 
reference: </P>
<UL>
  <LI><A class=offsite href="http://www.w3.org/TR/xmldsig-core/">XML-Signature 
  Syntax and Processing</A></LI></UL>
<H3 id=xmlSignatureGeneral>8.1 General Constraints on XML Signature</H3>
<DIV class=refinement>
<H4 id=Types_of_Signatures>8.1.1 Types of Signatures</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>Due to the nature of the SOAP processing 
model, which is based on recognising the elements that are children of 
soap:Header and/or soap:Body, use of enveloping signatures, where the signed XML 
is encapsulated in a ds:Signature element, is inappropriate. Enveloped 
signatures, where the ds:Signature element is a descendant of the signed 
element, limit the ability of intermediaries to process messages and should be 
avoided unless said limitation is the desired effect. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R3102>R3102</A></SPAN> A 
<SPAN class=statement-target>SIGNATURE</SPAN> MUST NOT be an Enveloping 
Signature as defined by the XML Signature specification. </P>
<P class=statement><SPAN class=statement-id><A name=R3103>R3103</A></SPAN> A 
<SPAN class=statement-target>SIGNATURE</SPAN> SHOULD be a Detached Signature as 
defined by the XML Signature specification. </P>
<P class=statement><SPAN class=statement-id><A name=R3104>R3104</A></SPAN> A 
<SPAN class=statement-target>SIGNATURE</SPAN> SHOULD NOT be an Enveloped 
Signature as defined by the XML Signature Specification. </P>
<DIV class=explanation>
<P><SPAN class=statement-target></SPAN>Detached signatures are encouraged. 
Enveloped signatures are discouraged. Enveloping signatures are not allowed. 
</P></DIV>
<P class=example-banner>For example,</P>
<DIV class=example>
<P class=incorrect>INCORRECT: </P><PRE>&lt;!-- This example is incorrect because it contains an enveloping signature around the SomeSecurityToken element --&gt;

&lt;ds:Signature Id='TheSig' xmlns:ds='http://www.w3.org/2000/09/xmldsig#'&gt;
   &lt;ds:SignedInfo&gt;
      &lt;ds:CanonicalizationMethod Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#&quot; '&gt;
         &lt;c14n:InclusiveNamespaces xmlns:c14n='http://www.w3.org/2001/10/xml-exc-c14n#' PrefixList='wsse soap' /&gt;
      &lt;/ds:CanonicalizationMethod&gt;
      &lt;ds:SignatureMethod Algorithm='http://www.w3.org/2000/09/xmldsig#rsa-sha1' /&gt;
      &lt;ds:Reference URI='#SigPropBody'&gt;
         &lt;ds:Transforms&gt;
            &lt;ds:Transform Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#'&gt;
               &lt;c14n:InclusiveNamespaces xmlns:c14n='http://www.w3.org/2001/10/xml-exc-c14n#' PrefixList='' /&gt;
            &lt;/ds:Transform&gt;
         &lt;/ds:Transforms&gt;
         &lt;ds:DigestMethod Algorithm='http://www.w3.org/2000/09/xmldsig#sha1' /&gt;
         &lt;ds:DigestValue&gt;i3qi5GjhHnfoBn/jOjQp2mq0Na4=&lt;/ds:DigestValue&gt;
      &lt;/ds:Reference&gt;
   &lt;/ds:SignedInfo&gt;
   &lt;ds:SignatureValue&gt;oxNwoqGbzqg1YBliz+PProgcjw8=&lt;/ds:SignatureValue&gt;
   &lt;ds:KeyInfo&gt;
      &lt;wsse:SecurityTokenReference&gt;
         &lt;wsse:Reference
            URI='#SomeCert'
            ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509&quot;/&gt;
      &lt;/wsse:SecurityTokenReference&gt;
   &lt;/ds:KeyInfo&gt;
   &lt;ds:Object&gt;
      &lt;ds:SignatureProperties&gt;
         &lt;ds:SignatureProperty Id='SigPropBody' Target='#TheSig'&gt;
            &lt;SomeSecurityToken/&gt;
         &lt;/ds:SignatureProperty&gt;
      &lt;/ds:SignatureProperties&gt;
   &lt;/ds:Object&gt;
&lt;/ds:Signature&gt;
</PRE></DIV>
<DIV class=example>
<P class=correct>CORRECT: </P><PRE>&lt;ds:Signature xmlns:ds='http://www.w3.org/2000/09/xmldsig#'&gt;
   &lt;ds:SignedInfo&gt;
      &lt;ds:CanonicalizationMethod Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#&quot; '&gt;
         &lt;c14n:InclusiveNamespaces xmlns:c14n='http://www.w3.org/2001/10/xml-exc-c14n#'
                                   PrefixList='wsse soap' /&gt;
      &lt;/ds:CanonicalizationMethod&gt;
      &lt;ds:SignatureMethod Algorithm='http://www.w3.org/2000/09/xmldsig#rsa-sha1' /&gt;
      &lt;ds:Reference URI='#TheBody'&gt;
         &lt;ds:Transforms&gt;
            &lt;ds:Transform Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#'&gt;
               &lt;c14n:InclusiveNamespaces xmlns:c14n='http://www.w3.org/2001/10/xml-exc-c14n#'
                                         PrefixList='soap wsu m' /&gt;
            &lt;/ds:Transform&gt;
         &lt;/ds:Transforms&gt;
         &lt;ds:DigestMethod Algorithm='http://www.w3.org/2000/09/xmldsig#sha1' /&gt;
         &lt;ds:DigestValue&gt;i3qi5GjhHnfoBn/jOjQp2mq0Na4=&lt;/ds:DigestValue&gt;
      &lt;/ds:Reference&gt;
   &lt;/ds:SignedInfo&gt;
   &lt;ds:SignatureValue&gt;PipXJ2Sfc+LTDnq4pM5JcIYt9gg=&lt;/ds:SignatureValue&gt;
   &lt;ds:KeyInfo&gt;
      &lt;wsse:SecurityTokenReference&gt;
         &lt;wsse:Reference URI='#SomeCert'
                         ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509&quot; /&gt;
      &lt;/wsse:SecurityTokenReference&gt;
   &lt;/ds:KeyInfo&gt;
&lt;/ds:Signature&gt;
</PRE></DIV></DIV>
<H3 id=WSSIDRef>8.2 Element References in XML Signature</H3>
<P>The following specifications (or sections thereof) are referred to in this 
section of the Profile:</P>
<UL>
  <LI><A class=offsite 
  href="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0.pdf">Web 
  Services Security: SOAP Message Security Section 4</A></LI></UL>
<P><SPAN class=statement-target></SPAN>Element references are used to specify 
which portions of a SECURE_ENVELOPE are integrity protected. This Profile places 
the following constraints on the use of element references:</P>
<DIV class=refinement>
<H4 id=Reference_to_Elements_by_Shorthand_XPointer>8.2.1 Reference to Elements 
by Shorthand XPointer</H4>
<P class=statement><SPAN class=statement-id><A name=R3001>R3001</A></SPAN> When 
a ds:Reference in a <SPAN class=statement-target>SIGNATURE</SPAN> refers to an 
element that carries a wsu:Id attribute or a Local ID attribute defined by XML 
Signature or XML Encryption, a Shorthand XPointer Reference MUST be used to 
refer to that element. </P>
<P class=statement><SPAN class=statement-id><A name=R3003>R3003</A></SPAN> When 
a ds:Reference/@URI in a <SPAN class=statement-target>SIGNATURE</SPAN> is a 
Shorthand XPointer Reference to an XML Signature element, the reference value 
MUST be a Local ID defined by XML Signature. </P>
<P class=statement><SPAN class=statement-id><A name=R3004>R3004</A></SPAN> When 
a ds:Reference/@URI in a <SPAN class=statement-target>SIGNATURE</SPAN> is a 
Shorthand XPointer Reference to an XML Encryption element, the reference value 
MUST be a Local ID defined by XML Encryption. </P>
<P class=statement><SPAN class=statement-id><A name=R3005>R3005</A></SPAN> When 
a ds:Reference/@URI in a <SPAN class=statement-target>SIGNATURE</SPAN> is a 
Shorthand XPointer Reference to an element not defined by XML Signature or XML 
Encryption, the reference value SHOULD be a wsu:Id. </P></DIV>
<DIV class=refinement>
<H4 id=Reference_to_Elements_by_XPath_Expression>8.2.2 Reference to Elements by 
XPath Expression</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>Elements that do not have an attribute of 
type ID cannot be refered to by Shorthand XPointer References so a different 
referencing mechanism is needed. The XPath Filter 2.0 transform is more 
efficient than the original XPath transform from XML Digital Signature Syntax 
and Processing. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R3002>R3002</A></SPAN> When 
referring to an element in a SECURE_ENVELOPE that does NOT carry an attribute of 
type ID from a ds:Reference in a <SPAN class=statement-target>SIGNATURE</SPAN> 
the XPath Filter 2.0 Transform (http://www.w3.org/2002/06/xmldsig-filter2) MUST 
be used to refer to that element. </P>
<P class=example-banner>For example,</P>
<DIV class=example>
<P class=incorrect>INCORRECT: </P><PRE>&lt;!-- This example is incorrect because it uses the http://www.w3.org/TR/1999/REC-xpath-19991116 transform 
     to reference the Body which contains an ID attribute --&gt;

&lt;soap:Envelope xmlns:soap='http://schemas.xmlsoap.org/soap/envelope' &gt;
 &lt;soap:Header&gt;
   &lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd'
                  xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd'&gt;
     &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                               ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
     &lt;/wsse:BinarySecurityToken&gt;
     &lt;ds:Signature xmlns:ds='http://www.w3.org/2000/09/xmldsig#'&gt;
       &lt;ds:SignedInfo&gt;
         &lt;ds:CanonicalizationMethod Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#&quot; '&gt;
           &lt;c14n:InclusiveNamespaces xmlns:c14n='http://www.w3.org/2001/10/xml-exc-c14n#'
                                     PrefixList='wsse soap wsu' /&gt;
         &lt;/ds:CanonicalizationMethod&gt;
         &lt;ds:SignatureMethod Algorithm='http://www.w3.org/2000/09/xmldsig#rsa-sha1' /&gt;
         &lt;ds:Reference URI=''&gt;
           &lt;ds:Transforms&gt;
             &lt;ds:Transform Algorithm='http://www.w3.org/TR/1999/REC-xpath-19991116'&gt;
               &lt;ds:XPath&gt;/soap:Envelope/soap:Body/*&lt;/ds:XPath&gt;
             &lt;/ds:Transform&gt;
             &lt;ds:Transform Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#'&gt;
               &lt;c14n:InclusiveNamespaces xmlns:c14n='http://www.w3.org/2001/10/xml-exc-c14n#'
                                         PrefixList='soap wsu m' /&gt;
             &lt;/ds:Transform&gt;
           &lt;/ds:Transforms&gt;
           &lt;ds:DigestMethod Algorithm='http://www.w3.org/2000/09/xmldsig#sha1' /&gt;
           &lt;ds:DigestValue&gt;VEPKwzfPGOxh2OUpoK0bcl58jtU=&lt;/ds:DigestValue&gt;
         &lt;/ds:Reference&gt;
       &lt;/ds:SignedInfo&gt;
       &lt;ds:SignatureValue&gt;+diIuEyDpV7qxVoUOkb5rj61+Zs=&lt;/ds:SignatureValue&gt;
       &lt;ds:KeyInfo&gt;
         &lt;wsse:SecurityTokenReference&gt;
            &lt;wsse:Reference
              URI='#SomeCert'
              ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509&quot; /&gt;
         &lt;/wsse:SecurityTokenReference&gt;
       &lt;/ds:KeyInfo&gt;
     &lt;/ds:Signature&gt;
   &lt;/wsse:Security&gt;
 &lt;/soap:Header&gt;
 &lt;soap:Body xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd'
            wsu:Id='TheBody'&gt;
   &lt;m:SomeElement xmlns:m='http://example.org/ws' /&gt;
 &lt;/soap:Body&gt;
&lt;/soap:Envelope&gt;
</PRE></DIV>
<DIV class=example>
<P class=correct>CORRECT: </P><PRE>&lt;soap:Envelope xmlns:soap='http://schemas.xmlsoap.org/soap/envelope' &gt;
  &lt;soap:Header&gt;
    &lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd'
                   xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd'&gt;
      &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                                ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
      &lt;/wsse:BinarySecurityToken&gt;
      &lt;ds:Signature xmlns:ds='http://www.w3.org/2000/09/xmldsig#'&gt;
        &lt;ds:SignedInfo&gt;
          &lt;ds:CanonicalizationMethod Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#&quot; '&gt;
            &lt;c14n:InclusiveNamespaces xmlns:c14n='http://www.w3.org/2001/10/xml-exc-c14n#'
                                      PrefixList='wsse soap wsu' /&gt;
          &lt;/ds:CanonicalizationMethod&gt;
          &lt;ds:SignatureMethod Algorithm='http://www.w3.org/2000/09/xmldsig#rsa-sha1' /&gt;
          &lt;ds:Reference URI=''&gt;
            &lt;ds:Transforms&gt;
              &lt;ds:Transform Algorithm='http://www.w3.org/2002/06/xmldsig-filter2'
                            xmlns:dsxp='http://www.w3.org/2002/06/xmldsig-filter2'&gt;
                &lt;dsxp:XPath Filter='intersect'&gt;/soap:Envelope/soap:Body/*&lt;/dsxp:XPath&gt;
              &lt;/ds:Transform&gt;
              &lt;ds:Transform Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#'&gt;
                &lt;c14n:InclusiveNamespaces xmlns:c14n='http://www.w3.org/2001/10/xml-exc-c14n#'
                                          PrefixList='soap wsu m' /&gt;
              &lt;/ds:Transform&gt;
            &lt;/ds:Transforms&gt;
            &lt;ds:DigestMethod Algorithm='http://www.w3.org/2000/09/xmldsig#sha1' /&gt;
            &lt;ds:DigestValue&gt;VEPKwzfPGOxh2OUpoK0bcl58jtU=&lt;/ds:DigestValue&gt;
          &lt;/ds:Reference&gt;
        &lt;/ds:SignedInfo&gt;
        &lt;ds:SignatureValue&gt;+diIuEyDpV7qxVoUOkb5rj61+Zs=&lt;/ds:SignatureValue&gt;
        &lt;ds:KeyInfo&gt;
          &lt;wsse:SecurityTokenReference&gt;
            &lt;wsse:Reference
              URI='#SomeCert'
              ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509&quot; /&gt;
          &lt;/wsse:SecurityTokenReference&gt;
        &lt;/ds:KeyInfo&gt;
      &lt;/ds:Signature&gt;
    &lt;/wsse:Security&gt;
  &lt;/soap:Header&gt;
  &lt;soap:Body xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd'
             wsu:Id='TheBody'&gt;
    &lt;m:SomeElement xmlns:m='http://example.org/ws' /&gt;
  &lt;/soap:Body&gt;
&lt;/soap:Envelope&gt;
</PRE></DIV></DIV>
<H3 id=xmlSignatureAlgorithms>8.3 XML Signature Algorithms</H3>
<DIV class=refinement>
<H4 id=Use_Exclusive_C14N>8.3.1 Use Exclusive C14N</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>The use of Exclusive Canonicalization 
with c14n:InclusiveNamespaces/@Prefix addresses problems with both Inclusive 
Canonicalization and Exclusive Canonicalization without 
c14n:InclusiveNamespaces/@Prefix. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R5404>R5404</A></SPAN> Any 
ds:CanonicalizationMethod/@Algorithm attribute in a <SPAN 
class=statement-target>SIGNATURE</SPAN> MUST have a value of 
&quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot; indicating that is uses Exclusive C14N 
without comments for canonicalization. </P>
<P class=statement><SPAN class=statement-id><A name=R5406>R5406</A></SPAN> Any 
ds:CanonicalizationMethod element within a <SPAN 
class=statement-target>SIGNATURE</SPAN> that has an @Algorithm attribute whose 
value is &quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot; MUST have a 
c14n:InclusiveNamespaces child element with an @PrefixList attribute. </P>
<P class=statement><SPAN class=statement-id><A name=R5407>R5407</A></SPAN> Any 
ds:Transform element within a <SPAN class=statement-target>SIGNATURE</SPAN> that 
has an @Algorithm attribute whose value is 
&quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot; MUST have a c14n:InclusiveNamespaces 
child element with an @PrefixList attribute. </P>
<P class=statement><SPAN class=statement-id><A name=R5405>R5405</A></SPAN> Any 
c14n:InclusiveNamespaces/@PrefixList attribute within a <SPAN 
class=statement-target>SIGNATURE</SPAN> MUST contain the prefix of all in-scope 
namespaces for the element being signed and its descendants that are not visibly 
utilized, per Exclusive XML Canonicalization Version 1.0. </P>
<P class=statement><SPAN class=statement-id><A name=R5408>R5408</A></SPAN> Any 
c14n:InclusiveNamespaces/@PrefixList attribute within a <SPAN 
class=statement-target>SIGNATURE</SPAN> MUST contain the string &quot;#default&quot; if a 
default namespace is in-scope for the element being signed but is not visibly 
utilized, per Exclusive XML Canonicalization Version 1.0. </P>
<P class=example-banner>For example,</P>
<DIV class=example>
<P class=incorrect>INCORRECT: </P><PRE>&lt;!-- This example is incorrect because it uses the http://www.w3.org/TR/2001/REC-xml-c14n-20010315
canonicalization algorithm --&gt;

&lt;ds:CanonicalizationMethod Algorithm='http://www.w3.org/TR/2001/REC-xml-c14n-20010315' /&gt;
</PRE></DIV>
<DIV class=example>
<P class=incorrect>INCORRECT: </P><PRE>&lt;!-- This example is incorrect because the ds:CanonicalizationMethod elements are missing a c14n:InclusiveNamespaces child element --&gt;

&lt;ds:CanonicalizationMethod Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#&quot; ' /&gt;
</PRE></DIV>
<DIV class=example>
<P class=incorrect>INCORRECT: </P><PRE>&lt;!-- This example is incorrect because the PrefixList of the first c14n:InclusiveNamespaces element does not contain the 
     correct list of prefixes. It should contain the soap and wsu prefixes in addition to the wsse prefix. --&gt;

&lt;soap:Envelope xmlns:soap='http://schemas.xmlsoap.org/soap/envelope' &gt;
  &lt;soap:Header&gt;
    &lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd'
                   xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd'&gt;
      &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                                ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
      &lt;/wsse:BinarySecurityToken&gt;
      &lt;ds:Signature xmlns:ds='http://www.w3.org/2000/09/xmldsig#'&gt;
        &lt;ds:SignedInfo&gt;
          &lt;ds:CanonicalizationMethod Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#&quot; '&gt;
            &lt;c14n:InclusiveNamespaces xmlns:c14n='http://www.w3.org/2001/10/xml-exc-c14n#'
                                      PrefixList='wsse' /&gt;
          &lt;/ds:CanonicalizationMethod&gt;
          &lt;ds:SignatureMethod Algorithm='http://www.w3.org/2000/09/xmldsig#rsa-sha1' /&gt;
          &lt;ds:Reference URI='#TheBody'&gt;
            &lt;ds:Transforms&gt;
              &lt;ds:Transform Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#'&gt;
                &lt;c14n:InclusiveNamespaces xmlns:c14n='http://www.w3.org/2001/10/xml-exc-c14n#'
                                          PrefixList='soap wsu m' /&gt;
              &lt;/ds:Transform&gt;
            &lt;/ds:Transforms&gt;
            &lt;ds:DigestMethod Algorithm='http://www.w3.org/2000/09/xmldsig#sha1' /&gt;
            &lt;ds:DigestValue&gt;VEPKwzfPGOxh2OUpoK0bcl58jtU=&lt;/ds:DigestValue&gt;
          &lt;/ds:Reference&gt;
        &lt;/ds:SignedInfo&gt;
        &lt;ds:SignatureValue&gt;+diIuEyDpV7qxVoUOkb5rj61+Zs=&lt;/ds:SignatureValue&gt;
        &lt;ds:KeyInfo&gt;
          &lt;wsse:SecurityTokenReference&gt;
            &lt;wsse:Reference
              URI='#SomeCert'
              ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509&quot; /&gt;
          &lt;/wsse:SecurityTokenReference&gt;
        &lt;/ds:KeyInfo&gt;
      &lt;/ds:Signature&gt;
    &lt;/wsse:Security&gt;
  &lt;/soap:Header&gt;
  &lt;soap:Body xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd'
             wsu:Id='TheBody'&gt;
    &lt;m:SomeElement xmlns:m='http://example.org/ws' /&gt;
  &lt;/soap:Body&gt;
&lt;/soap:Envelope&gt;
</PRE></DIV>
<DIV class=example>
<P class=correct>CORRECT: </P><PRE>&lt;soap:Envelope xmlns:soap='http://schemas.xmlsoap.org/soap/envelope' &gt;
  &lt;soap:Header&gt;
    &lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd'
                   xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd'&gt;
      &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                                ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
      &lt;/wsse:BinarySecurityToken&gt;
      &lt;ds:Signature xmlns:ds='http://www.w3.org/2000/09/xmldsig#'&gt;
        &lt;ds:SignedInfo&gt;
          &lt;ds:CanonicalizationMethod Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#&quot; '&gt;
            &lt;c14n:InclusiveNamespaces xmlns:c14n='http://www.w3.org/2001/10/xml-exc-c14n#'
                                      PrefixList='wsse soap wsu' /&gt;
          &lt;/ds:CanonicalizationMethod&gt;
          &lt;ds:SignatureMethod Algorithm='http://www.w3.org/2000/09/xmldsig#rsa-sha1' /&gt;
          &lt;ds:Reference URI='#TheBody'&gt;
            &lt;ds:Transforms&gt;
              &lt;ds:Transform Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#'&gt;
                &lt;c14n:InclusiveNamespaces xmlns:c14n='http://www.w3.org/2001/10/xml-exc-c14n#'
                                          PrefixList='soap wsu m' /&gt;
              &lt;/ds:Transform&gt;
            &lt;/ds:Transforms&gt;
            &lt;ds:DigestMethod Algorithm='http://www.w3.org/2000/09/xmldsig#sha1' /&gt;
            &lt;ds:DigestValue&gt;VEPKwzfPGOxh2OUpoK0bcl58jtU=&lt;/ds:DigestValue&gt;
          &lt;/ds:Reference&gt;
        &lt;/ds:SignedInfo&gt;
        &lt;ds:SignatureValue&gt;+diIuEyDpV7qxVoUOkb5rj61+Zs=&lt;/ds:SignatureValue&gt;
        &lt;ds:KeyInfo&gt;
          &lt;wsse:SecurityTokenReference&gt;
            &lt;wsse:Reference
              URI='#SomeCert'
              ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509&quot; /&gt;
          &lt;/wsse:SecurityTokenReference&gt;
        &lt;/ds:KeyInfo&gt;
      &lt;/ds:Signature&gt;
    &lt;/wsse:Security&gt;
  &lt;/soap:Header&gt;
  &lt;soap:Body xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd'
             wsu:Id='TheBody'&gt;
    &lt;m:SomeElement xmlns:m='http://example.org/ws' /&gt;
  &lt;/soap:Body&gt;
&lt;/soap:Envelope&gt;
</PRE></DIV></DIV>
<DIV class=refinement>
<H4 id=Transform_required>8.3.2 Transform required</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>Canonicalization is critical to ensuring 
signatures are processed correctly, thus each ds:Reference will need at least 
one ds:Transform to specify the Exclusive C14N Canonicalization transform or a 
transform which itself incorporates Exclusive C14N Canonicalization. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R5410>R5410</A></SPAN> Any 
ds:Reference element in a <SPAN class=statement-target>SIGNATURE</SPAN> MUST 
have a ds:Transforms child element. </P>
<P class=statement><SPAN class=statement-id><A name=R5411>R5411</A></SPAN> Any 
ds:Transforms element in a <SPAN class=statement-target>SIGNATURE</SPAN> MUST 
have at least one ds:Transform child element. </P>
<P class=statement><SPAN class=statement-id><A name=R5412>R5412</A></SPAN> Any 
ds:Transforms element in a <SPAN class=statement-target>SIGNATURE</SPAN> MUST 
have as its last child a ds:Transform element which specifies Exclusive C14N 
Canonicalization as its output. </P>
<P class=example-banner>For example,</P>
<DIV class=example>
<P class=incorrect>INCORRECT: </P><PRE>&lt;!-- This example is incorrect because the ds:Reference element does not have a ds:Transforms child element --&gt;

&lt;ds:Reference URI='#TheBody'&gt;
   &lt;ds:DigestMethod Algorithm='http://www.w3.org/2000/09/xmldsig#sha1' /&gt;
   &lt;ds:DigestValue&gt;VEPKwzfPGOxh2OUpoK0bcl58jtU=&lt;/ds:DigestValue&gt;
&lt;/ds:Reference&gt;
</PRE></DIV>
<DIV class=example>
<P class=correct>CORRECT: </P><PRE>&lt;ds:Reference URI='#TheBody'&gt;
   &lt;ds:Transforms&gt;
      &lt;ds:Transform Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#'&gt;
         &lt;c14n:InclusiveNamespaces xmlns:c14n='http://www.w3.org/2001/10/xml-exc-c14n#'
                                   PrefixList='' /&gt;
      &lt;/ds:Transform&gt;
   &lt;/ds:Transforms&gt;
   &lt;ds:DigestMethod Algorithm='http://www.w3.org/2000/09/xmldsig#sha1' /&gt;
   &lt;ds:DigestValue&gt;+VTJraRYFT3pl7Z4uAWhmr5+bf4=&lt;/ds:DigestValue&gt;
&lt;/ds:Reference&gt;
</PRE></DIV></DIV>
<DIV class=refinement>
<H4 id=Permitted_algorithms>8.3.3 Permitted algorithms</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>These algorithms are chosen for their 
cryptographic strength, utility or because they address some security concern. 
</P></DIV>
<P class=statement><SPAN class=statement-id><A name=R5420>R5420</A></SPAN> Any 
ds:DigestMethod/@Algorithm element in a <SPAN 
class=statement-target>SIGNATURE</SPAN> MUST have the value 
&quot;http://www.w3.org/2000/09/xmldsig#sha1&quot; </P>
<P class=statement><SPAN class=statement-id><A name=R5421>R5421</A></SPAN> Any 
ds:SignatureMethod/@Algorithm element in a <SPAN 
class=statement-target>SIGNATURE</SPAN> based on a symmetric key MUST have the 
value &quot;http://www.w3.org/2000/09/xmldsig#hmac-sha1&quot; </P>
<P class=statement><SPAN class=statement-id><A name=R5422>R5422</A></SPAN> Any 
ds:SignatureMethod/@Algorithm element in a <SPAN 
class=statement-target>SIGNATURE</SPAN> based on an asymmetric key MUST have the 
value &quot;http://www.w3.org/2000/09/xmldsig#rsa-sha1&quot; </P>
<P class=statement><SPAN class=statement-id><A name=R5423>R5423</A></SPAN> Any 
ds:Transform/@Algorithm attribute in a <SPAN 
class=statement-target>SIGNATURE</SPAN> MUST have a value of 
&quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot; or 
&quot;http://www.w3.org/2002/06/xmldsig-filter2&quot; or 
&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#STR-Transform&quot; 
or &quot;http://www.w3.org/2000/09/xmldsig#enveloped-signature&quot; or 
&quot;http://docs.oasis-open.org/wss/2004/XX/oasis-2004XX-wss-swa-profile-1.0#Attachment-Content-Only-Transform&quot; 
or 
&quot;http://docs.oasis-open.org/wss/2004/XX/oasis-2004XX-wss-swa-profile-1.0#Attachment-Complete-Transform&quot; 
</P>
<P class=example-banner>For example,</P>
<DIV class=example>
<P class=correct>CORRECT: </P><PRE>&lt;soap:Envelope xmlns:soap='http://schemas.xmlsoap.org/soap/envelope' &gt;
  &lt;soap:Header&gt;
    &lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd'
                   xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd'&gt;
      &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                                ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
      &lt;/wsse:BinarySecurityToken&gt;
      &lt;xenc:EncryptedKey xmlns:xenc='http://www.w3.org/2001/04/xmlenc#' &gt;
        &lt;xenc:EncryptionMethod Algorithm='http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p' /&gt;
        &lt;ds:KeyInfo xmlns:ds='http://www.w3.org/2000/09/xmldsig#'&gt;
          &lt;wsse:SecurityTokenReference&gt;
            &lt;wsse:Reference
              URI='#SomeCert'
              ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509&quot; /&gt;
          &lt;/wsse:SecurityTokenReference&gt;
        &lt;/ds:KeyInfo&gt;
        &lt;xenc:CipherData&gt;
          &lt;xenc:CipherValue&gt;
            XZEEVABD3L9G+VNTCDiDTE7WB1a4kILtz5f9FT747eE=       
          &lt;/xenc:CipherValue&gt;
        &lt;/xenc:CipherData&gt;
      &lt;/xenc:EncryptedKey&gt;
      &lt;ds:Signature xmlns:ds='http://www.w3.org/2000/09/xmldsig#'&gt;
        &lt;ds:SignedInfo&gt;
          &lt;ds:CanonicalizationMethod Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#&quot; '&gt;
            &lt;c14n:InclusiveNamespaces xmlns:c14n='http://www.w3.org/2001/10/xml-exc-c14n#'
                                      PrefixList='wsse soap' /&gt;
          &lt;/ds:CanonicalizationMethod&gt;
          &lt;ds:SignatureMethod Algorithm='http://www.w3.org/2000/09/xmldsig#hmac-sha1' /&gt;
          &lt;ds:Reference URI='#TheBody'&gt;
            &lt;ds:Transforms&gt;
              &lt;ds:Transform Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#'&gt;
                &lt;c14n:InclusiveNamespaces xmlns:c14n='http://www.w3.org/2001/10/xml-exc-c14n#'
                                          PrefixList='' /&gt;
              &lt;/ds:Transform&gt;
            &lt;/ds:Transforms&gt;
            &lt;ds:DigestMethod Algorithm='http://www.w3.org/2000/09/xmldsig#sha1' /&gt;
            &lt;ds:DigestValue&gt;+VTJraRYFT3pl7Z4uAWhmr5+bf4=&lt;/ds:DigestValue&gt;
          &lt;/ds:Reference&gt;
        &lt;/ds:SignedInfo&gt;
        &lt;ds:SignatureValue&gt;+diIuEyDpV7qxVoUOkb5rj61+Zs=&lt;/ds:SignatureValue&gt;
      &lt;/ds:Signature&gt;
    &lt;/wsse:Security&gt;
  &lt;/soap:Header&gt;
  &lt;soap:Body xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd'
             wsu:Id='TheBody'&gt;
    &lt;m:SomeElement xmlns:m='http://example.org/ws' /&gt;
  &lt;/soap:Body&gt;
&lt;/soap:Envelope&gt;
</PRE></DIV>
<DIV class=example>
<P class=correct>CORRECT: </P><PRE>&lt;soap:Envelope xmlns:soap='http://schemas.xmlsoap.org/soap/envelope' &gt;
  &lt;soap:Header&gt;
    &lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd'
                   xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd'&gt;
      &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                                ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
      &lt;/wsse:BinarySecurityToken&gt;
      &lt;ds:Signature xmlns:ds='http://www.w3.org/2000/09/xmldsig#'&gt;
        &lt;ds:SignedInfo&gt;
          &lt;ds:CanonicalizationMethod Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#&quot; '&gt;
            &lt;c14n:InclusiveNamespaces xmlns:c14n='http://www.w3.org/2001/10/xml-exc-c14n#'
                                      PrefixList='wsse soap' /&gt;
          &lt;/ds:CanonicalizationMethod&gt;
          &lt;ds:SignatureMethod Algorithm='http://www.w3.org/2000/09/xmldsig#rsa-sha1' /&gt;
          &lt;ds:Reference URI='#TheBody'&gt;
            &lt;ds:Transforms&gt;
              &lt;ds:Transform Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#'&gt;
                &lt;c14n:InclusiveNamespaces xmlns:c14n='http://www.w3.org/2001/10/xml-exc-c14n#'
                                          PrefixList='' /&gt;
              &lt;/ds:Transform&gt;
            &lt;/ds:Transforms&gt;
            &lt;ds:DigestMethod Algorithm='http://www.w3.org/2000/09/xmldsig#sha1' /&gt;
            &lt;ds:DigestValue&gt;+VTJraRYFT3pl7Z4uAWhmr5+bf4=&lt;/ds:DigestValue&gt;
          &lt;/ds:Reference&gt;
        &lt;/ds:SignedInfo&gt;
        &lt;ds:SignatureValue&gt;+diIuEyDpV7qxVoUOkb5rj61+Zs=&lt;/ds:SignatureValue&gt;
        &lt;ds:KeyInfo&gt;
          &lt;wsse:SecurityTokenReference&gt;
            &lt;wsse:Reference
              URI='#SomeCert'
              ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509&quot; /&gt;
          &lt;/wsse:SecurityTokenReference&gt;
        &lt;/ds:KeyInfo&gt;
      &lt;/ds:Signature&gt;
    &lt;/wsse:Security&gt;
  &lt;/soap:Header&gt;
  &lt;soap:Body xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd'
             wsu:Id='TheBody'&gt;
    &lt;m:SomeElement xmlns:m='http://example.org/ws' /&gt;
  &lt;/soap:Body&gt;
&lt;/soap:Envelope&gt;
</PRE></DIV>
<P class=ednote><STRONG>Editors' note:</STRONG>Update the SwA Profile URIs when 
final.</P></DIV>
<H3 id=xmlSignatureSyntax>8.4 XML Signature Syntax</H3>
<P><SPAN class=statement-target></SPAN>XML-Signature Syntax and Processing 
defines many elements and attributes. This Profile places the following 
constraints on the syntax of signatures:</P>
<DIV class=refinement>
<H4 id=ds_HMACOutputLength>8.4.1 ds:HMACOutputLength</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>The ds:HMACOutputLength provides an input 
parameter to the HMAC-SHA1 algorithm specifying how many bits of the output to 
use. Disallowing use of this element results in ALL the bits of the output being 
used. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R5401>R5401</A></SPAN> The 
ds:HMACOutputLength element MUST NOT appear in a <SPAN 
class=statement-target>SIGNATURE</SPAN>. </P>
<P class=example-banner>For example,</P>
<DIV class=example>
<P class=incorrect>INCORRECT: </P><PRE>&lt;!-- This example is incorrect because the ds:SignatureMethod element has a ds:HMACOutputLength child element --&gt;
&lt;ds:SignatureMethod Algorithm='http://www.w3.org/2000/09/xmldsig#hmac-sha1'&gt;
   &lt;ds:HMACOutputLength&gt;128&lt;/ds:HMACOutputLength&gt;
&lt;/ds:SignatureMethod&gt;
</PRE></DIV>
<DIV class=example>
<P class=correct>CORRECT: </P><PRE>&lt;ds:SignatureMethod Algorithm='http://www.w3.org/2000/09/xmldsig#hmac-sha1' /&gt;
</PRE></DIV></DIV>
<DIV class=refinement>
<H4 id=ds_KeyInfo>8.4.2 ds:KeyInfo</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>The ds:KeyInfo element allows for many 
different child elements. This profile mandates a single element and restricts 
the list to wsse:SecurityTokenReference, which is needed to reference security 
tokens, and ds:MgmtData, which is needed to include inline unencrypted key info. 
The latter would only be used when tranmission occurs over a secure transport. 
</P></DIV>
<P class=statement><SPAN class=statement-id><A name=R5402>R5402</A></SPAN> A 
ds:KeyInfo element in a <SPAN class=statement-target>SIGNATURE</SPAN> MUST have 
exactly one child element. </P>
<P class=statement><SPAN class=statement-id><A name=R5424>R5424</A></SPAN> A 
ds:KeyInfo element in an <SPAN class=statement-target>ENCRYPTED_KEY</SPAN> MUST 
have exactly one child element. </P>
<P class=statement><SPAN class=statement-id><A name=R5425>R5425</A></SPAN> A 
ds:KeyInfo element in an <SPAN class=statement-target>ENCRYPTED_DATA</SPAN> MUST 
have exactly one child element. </P>
<P class=statement><SPAN class=statement-id><A name=R5409>R5409</A></SPAN> The 
child element of a ds:KeyInfo element in a <SPAN 
class=statement-target>SIGNATURE</SPAN> MUST be either a 
SECURITY_TOKEN_REFERENCE or a ds:MgmtData element. </P>
<P class=statement><SPAN class=statement-id><A name=R5426>R5426</A></SPAN> The 
child element of a ds:KeyInfo element in an <SPAN 
class=statement-target>ENCRYPTED_KEY</SPAN> MUST be either a 
SECURITY_TOKEN_REFERENCE or a ds:MgmtData element. </P>
<P class=statement><SPAN class=statement-id><A name=R5427>R5427</A></SPAN> The 
child element of a ds:KeyInfo element in an <SPAN 
class=statement-target>ENCRYPTED_DATA</SPAN> MUST be either a 
SECURITY_TOKEN_REFERENCE or a ds:MgmtData element. </P>
<P class=statement><SPAN class=statement-id><A name=R5428>R5428</A></SPAN> The 
child element of a ds:KeyInfo element in a <SPAN 
class=statement-target>SIGNATURE</SPAN> MUST be a SECURITY_TOKEN_REFERENCE if 
the ds:KeyInfo refers to a SECURITY_TOKEN. </P>
<P class=statement><SPAN class=statement-id><A name=R5429>R5429</A></SPAN> The 
child element of a ds:KeyInfo element in a <SPAN 
class=statement-target>ENCRYPTED_KEY</SPAN> MUST be a SECURITY_TOKEN_REFERENCE 
if the ds:KeyInfo refers to a SECURITY_TOKEN. </P>
<P class=statement><SPAN class=statement-id><A name=R5430>R5430</A></SPAN> The 
child element of a ds:KeyInfo element in a <SPAN 
class=statement-target>ENCRYPTED_DATA</SPAN> MUST be a SECURITY_TOKEN_REFERENCE 
if the ds:KeyInfo refers to a SECURITY_TOKEN. </P>
<P class=example-banner>For example,</P>
<DIV class=example>
<P class=correct>CORRECT: </P><PRE>&lt;ds:KeyInfo xmlns:ds='http://www.w3.org/2000/09/xmldsig#' &gt;
   &lt;wsse:SecurityTokenReference&gt;
      &lt;wsse:Reference URI='#SomeCert'
                      ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509&quot; /&gt;
   &lt;/wsse:SecurityTokenReference&gt;
&lt;/ds:KeyInfo&gt;
</PRE></DIV>
<DIV class=example>
<P class=correct>CORRECT: </P><PRE>&lt;ds:KeyInfo&gt;
   &lt;ds:MgmtData&gt;eMtKYL5PbZ59pu/zKtFkwQod0kA=&lt;/ds:MgmtData&gt;
&lt;/ds:KeyInfo&gt;
</PRE></DIV></DIV>
<DIV class=refinement>
<H4 id=ds_Manifest>8.4.3 ds:Manifest</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>The ds:Manifest element is designed for 
specific application level use cases that do not apply to the use of XML 
Signature in SOAP Message Security.</P></DIV>
<P class=statement><SPAN class=statement-id><A name=R5403>R5403</A></SPAN> A 
<SPAN class=statement-target>SIGNATURE</SPAN> MUST NOT contain a ds:Manifest 
element. </P>
<P class=example-banner>For example,</P>
<DIV class=example>
<P class=incorrect>INCORRECT: </P><PRE>&lt;!-- This example is incorrect because the ds:Signature element has a ds:Manifest grandchild element --&gt;

&lt;ds:Signature xmlns:ds='http://www.w3.org/2000/09/xmldsig#'&gt;
   &lt;ds:SignedInfo&gt;
      &lt;ds:CanonicalizationMethod Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#&quot; '&gt;
         &lt;c14n:InclusiveNamespaces xmlns:c14n='http://www.w3.org/2001/10/xml-exc-c14n#'
                                   PrefixList='wsse soap' /&gt;
      &lt;/ds:CanonicalizationMethod&gt;
      &lt;ds:SignatureMethod Algorithm='http://www.w3.org/2000/09/xmldsig#rsa-sha1' /&gt;
      &lt;ds:Reference URI='#TheManifest'&gt;
         &lt;ds:Transforms&gt;
            &lt;ds:Transform Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#'&gt;
               &lt;c14n:InclusiveNamespaces xmlns:c14n='http://www.w3.org/2001/10/xml-exc-c14n#'
                                         PrefixList='' /&gt;
            &lt;/ds:Transform&gt;
         &lt;/ds:Transforms&gt;
         &lt;ds:DigestMethod Algorithm='http://www.w3.org/2000/09/xmldsig#sha1' /&gt;
         &lt;ds:DigestValue&gt;OVuYKGY6KCGB0l0XHS3krj8vjek=&lt;/ds:DigestValue&gt;
      &lt;/ds:Reference&gt;
   &lt;/ds:SignedInfo&gt;
   &lt;ds:SignatureValue&gt;L7X0Zw23/zYQnX4+Z+p0gCygKQ0=&lt;/ds:SignatureValue&gt;
   &lt;ds:KeyInfo&gt;
      &lt;wsse:SecurityTokenReference&gt;
         &lt;wsse:Reference URI='#SomeCert'
                         ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509&quot; /&gt;
      &lt;/wsse:SecurityTokenReference&gt;
   &lt;/ds:KeyInfo&gt;
   &lt;ds:Object&gt;
      &lt;ds:Manifest Id='TheManifest'&gt;
         &lt;ds:Reference URI='#TheBody'&gt;
            &lt;ds:Transforms&gt;
               &lt;ds:Transform Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#'&gt;
                  &lt;c14n:InclusiveNamespaces xmlns:c14n='http://www.w3.org/2001/10/xml-exc-c14n#'
                                            PrefixList='' /&gt;
               &lt;/ds:Transform&gt;
            &lt;/ds:Transforms&gt;
            &lt;ds:DigestMethod Algorithm='http://www.w3.org/2000/09/xmldsig#sha1' /&gt;
            &lt;ds:DigestValue&gt;+VTJraRYFT3pl7Z4uAWhmr5+bf4=&lt;/ds:DigestValue&gt;
         &lt;/ds:Reference&gt;
      &lt;/ds:Manifest&gt;
   &lt;/ds:Object&gt;
&lt;/ds:Signature&gt;
</PRE></DIV></DIV>
<H3 id=xmlSignatureConsiderations>8.5 Security Considerations</H3>
<DIV class=refinement>
<H4 id=Sign_Security_Token>8.5.1 Sign Security Token</H4>
<P class=statement><SPAN class=statement-id><A name=C5440>C5440</A></SPAN> When 
the signer's SECURITY_TOKEN is an INTERNAL_SECURITY_TOKEN, the <SPAN 
class=statement-target>SIGNATURE</SPAN> SHOULD include a ds:Reference the refers 
to the signer's SECURITY_TOKEN in order to prevent substitution with another 
SECURITY_TOKEN that uses the same key. <SPAN class=statement-type>C</SPAN></P>
<P class=statement><SPAN class=statement-id><A name=C5441>C5441</A></SPAN> When 
the signer's SECURITY_TOKEN is an EXTERNAL_SECURITY_TOKEN, the <SPAN 
class=statement-target>SIGNATURE</SPAN> SHOULD include a ds:Reference that 
refers to the SECURITY_TOKEN_REFERENCE that refers to the signer's 
SECURITY_TOKEN using the Security Token Dereferencing Transform in order to 
prevent substitution of another SECURITY_TOKEN that uses the same key. <SPAN 
class=statement-type>C</SPAN></P></DIV>
<H2 id=xmlEncryption>9. XML Encryption</H2>
<P><SPAN class=statement-target></SPAN>Web Services Security: SOAP Message 
Security builds on XML Encryption, defining usage of various elements from XML 
Encryption and a processing model. This Profile places the constraints defined 
in this section on the use of XML Encryption with Web Services Security: SOAP 
Message Security. This Profile places no constraints on other use of XML 
Encryption.</P>
<P>This section of the Profile incorporates the following specifications by 
reference, and defines extensibility points within them: </P>
<UL>
  <LI><A class=offsite 
  href="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0.pdf">Web 
  Services Security: SOAP Message Security</A>
  <LI><A class=offsite href="http://www.w3.org/TR/xmlenc-core/">XML Encryption 
  Syntax and Processing</A><BR>Extensibility points: 
  <UL>
    <LI><SPAN class=statement-id id=E0008>E0008</SPAN> - Encryption Algorithm - 
    Additional encryption algorithms may be specified.</LI></UL></LI></UL>
<H3 id=xmlEncryptProcessing>9.1 XML Encryption Processing Model</H3>
<DIV class=refinement>
<H4 id=xenc_ReferenceList>9.1.1 xenc:ReferenceList</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>Some encryption steps might not produce 
an xenc:ReferenceList. For those that do produce an xenc:ReferenceList, there 
must be a separate xenc:ReferenceList for each such encryption step. When there 
is a xenc:ReferenceList either as a child of wsse:Security or as a child of 
xenc:EncryptedKey it must list all the corresponding xenc:EncryptedData elements 
by using xenc:DataReference elements.</P></DIV>
<P class=statement><SPAN class=statement-id><A name=R3205>R3205</A></SPAN> Each 
<SPAN class=statement-target>ENCRYPTION_REFERENCE_LIST</SPAN> produced as part 
of an encryption step MUST use a single key. </P>
<P class=statement><SPAN class=statement-id><A name=R3215>R3215</A></SPAN> An 
<SPAN class=statement-target>ENCRYPTION_REFERENCE_LIST</SPAN> MUST contain an 
xenc:DataReference element for each ENCRYPTED_DATA produced in the associated 
encryption step. </P>
<P class=statement><SPAN class=statement-id><A name=R3214>R3214</A></SPAN> An 
<SPAN class=statement-target>ENCRYPTED_KEY_REFERENCE_LIST</SPAN> MUST contain a 
xenc:DataReference for each ENCRYPTED_DATA produced in the associated encryption 
step. </P></DIV>
<DIV class=refinement>
<H4 id=xenc_EncryptedKey>9.1.2 xenc:EncryptedKey</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>To facilitate ease of processing, keys 
are required to appear inside wsse:Security headers and to appear before they 
are required for decryption of elements inside a wsse:Security header.</P></DIV>
<P class=statement><SPAN class=statement-id><A name=R3208>R3208</A></SPAN> An 
<SPAN class=statement-target>ENCRYPTED_KEY</SPAN> MUST precede any 
ENCRYPTED_DATA referenced by the associated ENCRYPTED_KEY_REFERENCE_LIST. </P>
<P class=example-banner>For example,</P>
<DIV class=example>
<P class=incorrect>INCORRECT: </P><PRE>&lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd'
               xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd' 
               xmlns:xenc='http://www.w3.org/2001/04/xmlenc#' 
               xmlns:ds='http://www.w3.org/2000/09/xmldsig#' &gt;
  &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                            ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
  &lt;/wsse:BinarySecurityToken&gt;
  &lt;xenc:EncryptedData Id='Enc1'&gt;
    &lt;xenc:EncryptionMethod Algorithm='http://www.w3.org/2001/04/xmlenc#tripledes-cbc' /&gt;
    &lt;xenc:CipherData&gt;
      &lt;xenc:CipherValue&gt;
9jFtYcLSlDZQBMjKfT7ctg6Jy+6sC8YORhiPeTvOjug7ozY2SRHGuLt8G/vf2f/f4IdF0ewiDOpq...
   &lt;/xenc:CipherValue&gt;
 &lt;/xenc:CipherData&gt;
&lt;/xenc:EncryptedData&gt;
&lt;xenc:EncryptedKey&gt;
  &lt;xenc:EncryptionMethod Algorithm='http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p' /&gt;
  &lt;ds:KeyInfo&gt;
    &lt;wsse:SecurityTokenReference&gt;
      &lt;wsse:Reference
        URI='#SomeCert'
        ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509&quot; /&gt;
    &lt;/wsse:SecurityTokenReference&gt;
  &lt;/ds:KeyInfo&gt;
  &lt;xenc:CipherData&gt;
    &lt;xenc:CipherValue&gt;
      XZEEVABD3L9G+VNTCDiDTE7WB1a4kILtz5f9FT747eE=
    &lt;/xenc:CipherValue&gt;
    &lt;xenc:ReferenceList&gt;
      &lt;xenc:DataReference URI='#Enc1' /&gt;
    &lt;/xenc:ReferenceList&gt;
  &lt;/xenc:CipherData&gt;
&lt;/xenc:EncryptedKey&gt;
&lt;/wsse:Security&gt;
</PRE></DIV>
<DIV class=example>
<P class=correct>CORRECT: </P><PRE>&lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd'
               xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd' 
               xmlns:xenc='http://www.w3.org/2001/04/xmlenc#' 
               xmlns:ds='http://www.w3.org/2000/09/xmldsig#' &gt;
  &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                            ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
  &lt;/wsse:BinarySecurityToken&gt;
  &lt;xenc:EncryptedKey&gt;
   &lt;xenc:EncryptionMethod Algorithm='http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p' /&gt;
   &lt;ds:KeyInfo&gt;
     &lt;wsse:SecurityTokenReference&gt;
       &lt;wsse:Reference
         URI='#SomeCert'
         ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509&quot; /&gt;
     &lt;/wsse:SecurityTokenReference&gt;
   &lt;/ds:KeyInfo&gt;
   &lt;xenc:CipherData&gt;
     &lt;xenc:CipherValue&gt;
       XZEEVABD3L9G+VNTCDiDTE7WB1a4kILtz5f9FT747eE=       
     &lt;/xenc:CipherValue&gt;
   &lt;/xenc:CipherData&gt;
   &lt;xenc:ReferenceList&gt;
     &lt;xenc:DataReference URI='#Enc1' /&gt;
   &lt;/xenc:ReferenceList&gt;
  &lt;/xenc:EncryptedKey&gt;
  &lt;xenc:EncryptedData Id='Enc1'&gt;
   &lt;xenc:EncryptionMethod Algorithm='http://www.w3.org/2001/04/xmlenc#tripledes-cbc' /&gt;
   &lt;xenc:CipherData&gt;
     &lt;xenc:CipherValue&gt;
9jFtYcLSlDZQBMjKfT7ctg6Jy+6sC8YORhiPeTvOjug7ozY2SRHGuLt8G/vf2f/f4IdF0ewiDOpq...
     &lt;/xenc:CipherValue&gt;
   &lt;/xenc:CipherData&gt;
  &lt;/xenc:EncryptedData&gt;
&lt;/wsse:Security&gt;
</PRE></DIV></DIV>
<H3 id=xmlEncryptionKeys>9.2 XML Encryption Syntax</H3>
<P>The following specifications (or sections thereof) are referred to in this 
section of the Profile:</P>
<UL>
  <LI><A class=offsite href="http://www.w3.org/TR/xmlenc-core/">XML Encryption 
  Syntax and Processing</A></LI></UL>
<P><SPAN class=statement-target></SPAN>XML Encryption Syntax and Processing 
defines many elements and attributes. This Profile places the following 
constraints on their use:</P>
<DIV class=refinement>
<H4 id=Placement>9.2.1 Placement</H4>
<P class=statement><SPAN class=statement-id><A name=R3216>R3216</A></SPAN> Any 
<SPAN class=statement-target>ENCRYPTED_KEY</SPAN> that is used in an encryption 
step MUST contain a ENCRYPTED_KEY_REFERENCE_LIST. </P>
<P class=example-banner>For example,</P>
<DIV class=example>
<P class=incorrect>INCORRECT: </P><PRE>&lt;!-- This example is incorrect because the xenc:EncryptedKey element is missing an xenc:ReferenceList child element --&gt;

&lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd'
               xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd' 
               xmlns:xenc='http://www.w3.org/2001/04/xmlenc#' 
               xmlns:ds='http://www.w3.org/2000/09/xmldsig#' &gt;
  &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                            ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
  &lt;/wsse:BinarySecurityToken&gt;
  &lt;xenc:EncryptedKey&gt;
    &lt;xenc:EncryptionMethod Algorithm='http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p' /&gt;
    &lt;ds:KeyInfo&gt;
      &lt;wsse:SecurityTokenReference&gt;
        &lt;wsse:Reference
          URI='#SomeCert'
          ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509&quot; /&gt;
      &lt;/wsse:SecurityTokenReference&gt;
    &lt;/ds:KeyInfo&gt;
    &lt;xenc:CipherData&gt;
      &lt;xenc:CipherValue&gt;
        XZEEVABD3L9G+VNTCDiDTE7WB1a4kILtz5f9FT747eE=       
      &lt;/xenc:CipherValue&gt;
    &lt;/xenc:CipherData&gt;
  &lt;/xenc:EncryptedKey&gt;
  &lt;xenc:ReferenceList&gt;
    &lt;xenc:DataReference URI='#Enc1' /&gt;
  &lt;/xenc:ReferenceList&gt;
  &lt;xenc:EncryptedData Id='Enc1'&gt;
    &lt;xenc:EncryptionMethod Algorithm='http://www.w3.org/2001/04/xmlenc#tripledes-cbc' /&gt;
    &lt;xenc:CipherData&gt;
      &lt;xenc:CipherValue&gt;
9jFtYcLSlDZQBMjKfT7ctg6Jy+6sC8YORhiPeTvOjug7ozY2SRHGuLt8G/vf2f/f4IdF0ewiDOpq...
      &lt;/xenc:CipherValue&gt;
    &lt;/xenc:CipherData&gt;
  &lt;/xenc:EncryptedData&gt;
&lt;/wsse:Security&gt;
</PRE></DIV>
<DIV class=example>
<P class=correct>CORRECT: </P><PRE>&lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd'
               xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd' 
               xmlns:xenc='http://www.w3.org/2001/04/xmlenc#' 
               xmlns:ds='http://www.w3.org/2000/09/xmldsig#' &gt;
  &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                            ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
  &lt;/wsse:BinarySecurityToken&gt;
  &lt;xenc:EncryptedKey&gt;
    &lt;xenc:EncryptionMethod Algorithm='http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p' /&gt;
    &lt;ds:KeyInfo&gt;
      &lt;wsse:SecurityTokenReference&gt;
        &lt;wsse:Reference
          URI='#SomeCert'
          ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509&quot; /&gt;
      &lt;/wsse:SecurityTokenReference&gt;
    &lt;/ds:KeyInfo&gt;
    &lt;xenc:CipherData&gt;
      &lt;xenc:CipherValue&gt;
        XZEEVABD3L9G+VNTCDiDTE7WB1a4kILtz5f9FT747eE=       
      &lt;/xenc:CipherValue&gt;
    &lt;/xenc:CipherData&gt;
    &lt;xenc:ReferenceList&gt;
      &lt;xenc:DataReference URI='#Enc1' /&gt;
    &lt;/xenc:ReferenceList&gt;
  &lt;/xenc:EncryptedKey&gt;
  &lt;xenc:EncryptedData Id='Enc1'&gt;
    &lt;xenc:EncryptionMethod Algorithm='http://www.w3.org/2001/04/xmlenc#tripledes-cbc' /&gt;
    &lt;xenc:CipherData&gt;
      &lt;xenc:CipherValue&gt;
9jFtYcLSlDZQBMjKfT7ctg6Jy+6sC8YORhiPeTvOjug7ozY2SRHGuLt8G/vf2f/f4IdF0ewiDOpq...
      &lt;/xenc:CipherValue&gt;
    &lt;/xenc:CipherData&gt;
  &lt;/xenc:EncryptedData&gt;
&lt;/wsse:Security&gt;
</PRE></DIV></DIV>
<DIV class=refinement>
<H4 id=xenc_EncryptedKey_attributes>9.2.2 xenc:EncryptedKey attributes</H4>
<P class=statement><SPAN class=statement-id><A name=R3209>R3209</A></SPAN> Any 
<SPAN class=statement-target>ENCRYPTED_KEY</SPAN> MUST NOT specify a Type 
attribute. </P>
<P class=statement><SPAN class=statement-id><A name=R5622>R5622</A></SPAN> Any 
<SPAN class=statement-target>ENCRYPTED_KEY</SPAN> MUST NOT specify a MimeType 
attribute. </P>
<P class=statement><SPAN class=statement-id><A name=R5623>R5623</A></SPAN> Any 
<SPAN class=statement-target>ENCRYPTED_KEY</SPAN> MUST NOT specify a Encoding 
attribute. </P></DIV>
<DIV class=refinement>
<H4 id=xenc_EncryptedData_attributes>9.2.3 xenc:EncryptedData attributes</H4>
<P class=statement><SPAN class=statement-id><A name=R5624>R5624</A></SPAN> Any 
<SPAN class=statement-target>ENCRYPTED_DATA</SPAN> MUST have an Id attribute. 
</P></DIV>
<DIV class=refinement>
<H4 id=References_from_xenc_EncryptedData>9.2.4 References from 
xenc:EncryptedData</H4>
<P class=statement><SPAN class=statement-id><A name=R3211>R3211</A></SPAN> Any 
SECURITY_TOKEN_REFERENCE inside an <SPAN 
class=statement-target>ENCRYPTED_DATA</SPAN> MUST NOT reference a ds:KeyInfo 
element. </P></DIV>
<DIV class=refinement>
<H4 id=xenc_EncryptionMethod_mandatory>9.2.5 xenc:EncryptionMethod 
mandatory</H4>
<DIV class=rationale>
<P></P></DIV>
<P class=statement><SPAN class=statement-id><A name=R5601>R5601</A></SPAN> Any 
<SPAN class=statement-target>ENCRYPTED_DATA</SPAN> MUST have an 
xenc:EncryptionMethod child element. </P>
<P class=statement><SPAN class=statement-id><A name=R5603>R5603</A></SPAN> Any 
<SPAN class=statement-target>ENCRYPTED_KEY</SPAN> MUST have an 
xenc:EncryptionMethod child element. </P>
<P class=example-banner>For example,</P>
<DIV class=example>
<P class=incorrect>INCORRECT: </P><PRE>&lt;!-- This example is incorrect because the xenc:EncryptedKey element is missing an xenc:EncryptionMethod child element --&gt;

&lt;xenc:EncryptedKey&gt;
   &lt;ds:KeyInfo&gt;
      &lt;wsse:SecurityTokenReference&gt;
         &lt;wsse:Reference URI='#SomeCert'
                         ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509&quot; /&gt;
      &lt;/wsse:SecurityTokenReference&gt;
   &lt;/ds:KeyInfo&gt;
   &lt;xenc:CipherData&gt;
      &lt;xenc:CipherValue&gt;
         XZEEVABD3L9G+VNTCDiDTE7WB1a4kILtz5f9FT747eE=       
      &lt;/xenc:CipherValue&gt;
   &lt;/xenc:CipherData&gt;
   &lt;xenc:ReferenceList&gt;
      &lt;xenc:DataReference URI='#Enc1' /&gt;
   &lt;/xenc:ReferenceList&gt;
&lt;/xenc:EncryptedKey&gt;
</PRE></DIV>
<DIV class=example>
<P class=incorrect>INCORRECT: </P><PRE>&lt;!-- This example is incorrect because the xenc:EncryptedData element is missing an xenc:EncryptionMethod child element --&gt;

&lt;xenc:EncryptedData Id='Enc1'&gt;
   &lt;xenc:CipherData&gt;
      &lt;xenc:CipherValue&gt;
9jFtYcLSlDZQBMjKfT7ctg6Jy+6sC8YORhiPeTvOjug7ozY2SRHGuLt8G/vf2f/f4IdF0ewiDOpq...
      &lt;/xenc:CipherValue&gt;
   &lt;/xenc:CipherData&gt;
&lt;/xenc:EncryptedData&gt;
</PRE></DIV>
<DIV class=example>
<P class=correct>CORRECT: </P><PRE>&lt;wsse:Security xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd'
               xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd' 
               xmlns:xenc='http://www.w3.org/2001/04/xmlenc#' 
               xmlns:ds='http://www.w3.org/2000/09/xmldsig#' &gt;
  &lt;wsse:BinarySecurityToken wsu:Id='SomeCert'
                            ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509&quot;&gt;
lui+Jy4WYKGJW5xM3aHnLxOpGVIpzSg4V486hHFe7sHET/uxxVBovT7JV1A2RnWSWkXm9jAEdsm/...
  &lt;/wsse:BinarySecurityToken&gt;
  &lt;xenc:EncryptedKey&gt;
    &lt;xenc:EncryptionMethod Algorithm='http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p' /&gt;
    &lt;ds:KeyInfo&gt;
      &lt;wsse:SecurityTokenReference&gt;
        &lt;wsse:Reference
          URI='#SomeCert'
          ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509&quot; /&gt;
      &lt;/wsse:SecurityTokenReference&gt;
    &lt;/ds:KeyInfo&gt;
    &lt;xenc:CipherData&gt;
      &lt;xenc:CipherValue&gt;
        XZEEVABD3L9G+VNTCDiDTE7WB1a4kILtz5f9FT747eE=       
      &lt;/xenc:CipherValue&gt;
    &lt;/xenc:CipherData&gt;
    &lt;xenc:ReferenceList&gt;
      &lt;xenc:DataReference URI='#Enc1' /&gt;
    &lt;/xenc:ReferenceList&gt;
  &lt;/xenc:EncryptedKey&gt;
  &lt;xenc:EncryptedData Id='Enc1'&gt;
    &lt;xenc:EncryptionMethod Algorithm='http://www.w3.org/2001/04/xmlenc#tripledes-cbc' /&gt;
    &lt;xenc:CipherData&gt;
      &lt;xenc:CipherValue&gt;
9jFtYcLSlDZQBMjKfT7ctg6Jy+6sC8YORhiPeTvOjug7ozY2SRHGuLt8G/vf2f/f4IdF0ewiDOpq...
      &lt;/xenc:CipherValue&gt;
    &lt;/xenc:CipherData&gt;
  &lt;/xenc:EncryptedData&gt;
&lt;/wsse:Security&gt;
</PRE></DIV></DIV>
<DIV class=refinement>
<H4 id=xenc_EncryptedKey/@Recipient>9.2.6 xenc:EncryptedKey/@Recipient</H4>
<DIV class=rationale>
<P></P></DIV>
<P class=statement><SPAN class=statement-id><A name=R5602>R5602</A></SPAN> Any 
<SPAN class=statement-target>ENCRYPTED_KEY</SPAN> MUST NOT contain a Recipient 
attribute. </P>
<P class=example-banner>For example,</P>
<DIV class=example>
<P class=incorrect>INCORRECT: </P><PRE>&lt;!-- This example is incorrect because the xenc:EncryptedKey element has a Recipient attribute  --&gt;

&lt;xenc:EncryptedKey Recipient='Bert'&gt;
   &lt;xenc:EncryptionMethod Algorithm='http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p' /&gt;
   &lt;ds:KeyInfo&gt;
      &lt;wsse:SecurityTokenReference&gt;
         &lt;wsse:Reference URI='#SomeCert'
                         ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509&quot; /&gt;
      &lt;/wsse:SecurityTokenReference&gt;
   &lt;/ds:KeyInfo&gt;
   &lt;xenc:CipherData&gt;
      &lt;xenc:CipherValue&gt;
         XZEEVABD3L9G+VNTCDiDTE7WB1a4kILtz5f9FT747eE=       
      &lt;/xenc:CipherValue&gt;
   &lt;/xenc:CipherData&gt;
   &lt;xenc:ReferenceList&gt;
      &lt;xenc:DataReference URI='#Enc1' /&gt;
   &lt;/xenc:ReferenceList&gt;
&lt;/xenc:EncryptedKey&gt;
</PRE></DIV></DIV>
<DIV class=refinement>
<H4 id=ds_KeyInfo/xenc_AgreementMethod_prohibited>9.2.7 
ds:KeyInfo/xenc:AgreementMethod prohibited</H4>
<P class=statement><SPAN class=statement-id><A name=R5604>R5604</A></SPAN> Any 
ds:KeyInfo elements in a <SPAN class=statement-target>ENCRYPTED_KEY</SPAN> MUST 
NOT have an xenc:AgreementMethod child element. </P>
<P class=statement><SPAN class=statement-id><A name=R5605>R5605</A></SPAN> Any 
ds:KeyInfo elements in a <SPAN class=statement-target>ENCRYPTED_DATA</SPAN> MUST 
NOT have an xenc:AgreementMethod child element. </P></DIV>
<DIV class=refinement>
<H4 id=xenc_EncryptedData>9.2.8 xenc:EncryptedData</H4>
<P class=statement><SPAN class=statement-id><A name=R5606>R5606</A></SPAN> 
Within a <SPAN class=statement-target>SECURE_ENVELOPE</SPAN>, encrypted element 
or element content encrypted as a result of an encryption step MUST be replaced 
by a corresponding ENCRYPTED_DATA. </P></DIV>
<DIV class=refinement>
<H4 id=SOAP_Envelope>9.2.9 SOAP Envelope</H4>
<P class=statement><SPAN class=statement-id><A name=R5607>R5607</A></SPAN> When 
encryption is used, the <SPAN class=statement-target>SECURE_ENVELOPE</SPAN> MUST 
still be a valid SOAP Envelope. Specifically, the Envelope, Header, or Body 
elements MUST NOT be encrypted. </P></DIV>
<H3 id=ElementReferencesinXMLEncryption>9.3 Element References in XML 
Encryption</H3>
<DIV class=refinement>
<H4 id=Reference_to_Elements_by_Shorthand_XPointer>9.3.1 Reference to Elements 
by Shorthand XPointer</H4>
<P class=statement><SPAN class=statement-id><A name=R5608>R5608</A></SPAN> When 
referring from an xenc:DataReference or xenc:KeyReference in an <SPAN 
class=statement-target>ENCRYPTION_REFERENCE_LIST</SPAN> to an element that 
carries a wsu:Id attribute or a Local ID attribute defined by either XML 
Signature or XML Encryption, a Shorthand XPointer Reference MUST be used to 
refer to that element. </P>
<P class=statement><SPAN class=statement-id><A name=R5613>R5613</A></SPAN> When 
referring from a an xenc:DataReference or xenc:KeyReference in an <SPAN 
class=statement-target>ENCRYPTED_KEY_REFERENCE_LIST</SPAN> to an element that 
carries a wsu:Id attribute or a Local ID attribute defined by either XML 
Signature or XML Encryption, a Shorthand XPointer Reference MUST be used to 
refer to that element. </P>
<P class=statement><SPAN class=statement-id><A name=R3006>R3006</A></SPAN> When 
a xenc:DataReference/@URI or xenc:KeyReference/@URI in a <SPAN 
class=statement-target>ENCRYPTION_REFERENCE_LIST</SPAN> is a Shorthand XPointer 
Reference to an XML Signature element, the reference value MUST be a Local ID 
defined by XML Signature. </P>
<P class=statement><SPAN class=statement-id><A name=R3007>R3007</A></SPAN> When 
a xenc:DataReference/@URI or xenc:KeyReference in a <SPAN 
class=statement-target>ENCRYPTED_KEY_REFERENCE_LIST</SPAN> is a Shorthand 
XPointer Reference to an XML Signature element, the reference value MUST be a 
Local ID defined by XML Signature. </P>
<P class=statement><SPAN class=statement-id><A name=R5609>R5609</A></SPAN> When 
an xenc:DataReference/@URI or xenc:KeyReference/@URI in an <SPAN 
class=statement-target>ENCRYPTION_REFERENCE_LIST</SPAN> is a Shorthand XPointer 
Reference to an XML Encryption element, the reference value MUST be a Local ID 
defined by XML Encryption. </P>
<P class=statement><SPAN class=statement-id><A name=R5610>R5610</A></SPAN> When 
an xenc:DataReference/@URI or xenc:KeyReference/@URI in an <SPAN 
class=statement-target>ENCRYPTED_KEY_REFERENCE_LIST</SPAN> is a Shorthand 
XPointer Reference to an XML Encryption element, the reference value MUST be a 
Local ID defined by XML Encryption. </P>
<P class=statement><SPAN class=statement-id><A name=R5611>R5611</A></SPAN> When 
an xenc:DataReference/@URI or xenc:KeyReference/@URI in an <SPAN 
class=statement-target>ENCRYPTION_REFERENCE_LIST</SPAN> is a Shorthand XPointer 
Reference to an element not defined by XML Signature or XML Encryption, the 
reference value SHOULD be a wsu:Id. </P>
<P class=statement><SPAN class=statement-id><A name=R5612>R5612</A></SPAN> When 
an xenc:DataReference/@URI or xenc:KeyReference/@URI in an <SPAN 
class=statement-target>ENCRYPTED_KEY_REFERENCE_LIST</SPAN> is a Shorthand 
XPointer Reference to an element not defined by XML Signature or XML Encryption, 
the reference value SHOULD be a wsu:Id. </P></DIV>
<H3 id=xmlEncryptionAlgorithms>9.4 XML Encryption Algorithms</H3>
<DIV class=refinement>
<H4 id=Permitted_Algorithms>9.4.1 Permitted Algorithms</H4>
<P class=statement><SPAN class=statement-id><A name=R5620>R5620</A></SPAN> Any 
xenc:EncryptionMethod/@Algorithm attribute in an <SPAN 
class=statement-target>ENCRYPTED_DATA</SPAN> MUST have a value of 
&quot;http://www.w3.org/2001/04/xmlenc#tripledes-cbc&quot;, 
&quot;http://www.w3.org/2001/04/xmlenc#aes128-cbc&quot; or 
&quot;http://www.w3.org/2001/04/xmlenc#aes256-cbc&quot; </P>
<P class=statement><SPAN class=statement-id><A name=R5621>R5621</A></SPAN> When 
used for Key Transport, any xenc:EncryptionMethod/@Algorithm attribute in an 
<SPAN class=statement-target>ENCRYPTED_KEY</SPAN> MUST have a value of 
&quot;http://www.w3.org/2001/04/xmlenc#rsa-1_5&quot; or 
&quot;http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p&quot; </P>
<P class=statement><SPAN class=statement-id><A name=R5625>R5625</A></SPAN> When 
used for Key Wrap, any xenc:EncryptionMethod/@Algorithm attribute in an <SPAN 
class=statement-target>ENCRYPTED_KEY</SPAN> MUST have a value of 
&quot;http://www.w3.org/2001/04/xmlenc#kw-tripledes&quot;, 
&quot;http://www.w3.org/2001/04/xmlenc#kw-aes128&quot;, or 
&quot;http://www.w3.org/2001/04/xmlenc#kw-aes256&quot; </P></DIV>
<H3 id=xmlEncryptionConsiderations>9.5 Security Considerations</H3>
<DIV class=refinement>
<H4 id=Encrypt_DigestValue>9.5.1 Encrypt DigestValue</H4>
<P class=statement><SPAN class=statement-id><A name=C5630>C5630</A></SPAN> A 
<SPAN class=statement-target>SIGNATURE</SPAN> computed over data that is 
subsequently encrypted SHOULD also be encrypted in order to prevent plaintext 
guessing attacks when the probable set of data values is small. </P></DIV>
<H2 id=algorithms>10. Algorithms</H2>
<P><SPAN class=statement-target></SPAN>This section provides guidance, and in 
some cases requirements, concerning the use of various categories of 
algorithms.</P>
<H3 id=tlssslalg>10.1 Transport Level Security Algorithms</H3>
<P><SPAN class=statement-target></SPAN>In SSL and TLS, choices of algorithms are 
expressed as ciphersuites. The following subsections specify ciphersuites that 
are required, recommended, discouraged and prohibited, respectively. The use of 
any other ciphersuite not discussed below is optional.</P>
<DIV class=refinement>
<H4 id=Mandatory_ciphersuites>10.1.1 Mandatory ciphersuites</H4>
<P class=statement><SPAN class=statement-id><A name=R5701>R5701</A></SPAN> A 
TLS-capable <SPAN class=statement-target>INSTANCE</SPAN> that is not FIPS 
compliant MUST support TLS_RSA_WITH_3DES_EDE_CBC_SHA </P>
<P class=statement><SPAN class=statement-id><A name=R5702>R5702</A></SPAN> A 
SSL-capable <SPAN class=statement-target>INSTANCE</SPAN> that is not FIPS 
compliant MUST support SSL_RSA_WITH_3DES_EDE_CBC_SHA </P>
<P class=statement><SPAN class=statement-id><A name=R5703>R5703</A></SPAN> A 
TLS-capable <SPAN class=statement-target>INSTANCE</SPAN> that is FIPS compliant 
MUST support TLS_RSA_FIPS_WITH_3DES_EDE_CBC_SHA </P>
<P class=statement><SPAN class=statement-id><A name=R5704>R5704</A></SPAN> A 
SSL-capable <SPAN class=statement-target>INSTANCE</SPAN> that is FIPS compliant 
MUST support SSL_RSA_FIPS_WITH_3DES_EDE_CBC_SHA </P></DIV>
<DIV class=refinement>
<H4 id=Recommended_ciphersuites>10.1.2 Recommended ciphersuites</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>As the AES encryption algorithm is 
intended to supercede the 3DES algorithm, it is recommended that TLS-capable 
implementations implement TLS_RSA_WITH_AES_128_CBC_SHA or the FIPS equivalent, 
and SSL-capable implementations implement SSL_RSA_WITH_AES_128_CBC_SHA or the 
FIPS equivalent.</P></DIV></DIV>
<DIV class=refinement>
<H4 id=Discouraged_ciphersuites>10.1.3 Discouraged ciphersuites</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>The ciphersuites defined in the SSL and 
TLS specifications that use anonymous Diffie-Helman ( i.e. those that have 
DH_anon in their symbolic name ) are vulnerable to man-in-the-middle attacks. It 
is recommended that such ciphersuites be avoided.</P>
<P><SPAN class=statement-target></SPAN>This profile recommends against the use 
of the following ciphersuites due to their lack of confidentiality services:</P>
<UL>
  <LI><SPAN class=statement-target></SPAN>SSL_RSA_WITH_NULL_SHA
  <LI><SPAN class=statement-target></SPAN>TLS_RSA_WITH_NULL_SHA
  <LI><SPAN class=statement-target></SPAN>SSL_RSA_WITH_NULL_MD5
  <LI><SPAN class=statement-target></SPAN>TLS_RSA_WITH_NULL_MD5</LI></UL>
<P><SPAN class=statement-target></SPAN>It is also recommended that ciphersuites 
that use 40 or 56 bit keys be avoided, due to their relative ease of compromise 
through brute-force attack.</P></DIV></DIV>
<DIV class=refinement>
<H4 id=Prohibited_ciphersuites>10.1.4 Prohibited ciphersuites</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>This profile does not prohibit the use of 
any transport layer security ciphersuites, but careful thought should be given 
prior to the use of any ciphersuites discussed under &quot;Discouraged ciphersuites&quot;. 
</P></DIV></DIV>
<H2 id=reltoBasicProfile>11. Relationship of Basic Security Profile as an 
Extension to Basic Profile</H2>
<P><SPAN class=statement-target></SPAN>The Basic Security Profile is an 
extension profile to the Basic Profile. This means it is consistent with the 
Basic Profile but profiles additional functionality - how to add conformant 
security features to the basic profile when needed.</P>
<P><SPAN class=statement-target></SPAN>As an extension of the Basic Profile, the 
Basic Security Profile is designed to support the addition of security 
functionality to SOAP messaging, in an interoperable manner. One example of such 
functionality is the confidentiality of selected SOAP header blocks and SOAP 
body elements through the use of OASIS Web Services Security encryption. The 
intent of such techniques is to change the nature of the SOAP message so that 
unintended parties cannot read such content. This means that the secured SOAP 
message is no longer obviously related to the original WSDL description, and is 
not intelligible without decryption. Other security mechanisms such as 
signatures may also modify the content of SOAP envelopes.</P>
<P><SPAN class=statement-target></SPAN>The Basic Profile includes requirements 
on the content of SOAP envelopes (or in BP 1.0 the format of SOAP messages). 
Testing conformance to these statements by using a &quot;man-in-the-middle&quot; 
interceptor as outlined in the WS-I Monitor Tool Functional Specification will 
not be possible if encryption has been applied to portions of the SOAP envelope 
and have not yet been decrypted. Even if interception is possible, some messages 
may have a different structure due to security.</P>
<P><SPAN class=statement-target></SPAN>Such SOAP messages still conform to the 
Basic Profile, since conformance to the Basic Profile means conformance once a 
receiver has reversed security changes introduced by a message sender. This is 
not obvious in some Basic Profile requirements, so this document further 
clarifies these requirements in the normative &quot;Basic Profile Clarifications&quot; 
section below.</P>
<P><SPAN class=statement-target></SPAN>It is helpful to visualize a SOAP message 
in light of a protocol layering model, such as the ISO seven layer protocol 
model [ Tanenbaum ]. This model shows how a protocol is in fact composed of 
different layers, and how to a given layer underlying layers are transparent. 
The implementation of a given protocol layer at an endpoint may be modeled as 
that implementation consuming a service of the underlying protocol layer, and 
providing a service to the layer above it. In this model no protocol layer need 
be aware of layers above or below it, making the layer implementations 
independent. This is illustrated in Figure 1.</P>
<P><IMG 
src="Basic Security Profile - Version 1_0 (WGD)_files/soap-stack-drawing.png"></P>
<P><SPAN class=statement-target></SPAN>Figure 1: Protocol Stack with SOAP 
Message Security</P>
<P><SPAN class=statement-target></SPAN>Traditionally, protocol layers have been 
distinguished by the use of protocol enveloping, where the message at one layer 
is conveyed as the body in the next lower layer. The sender passes a message to 
the lower level protocol implementation that packages it in a protocol envelope 
and sends it to the corresponding layer in the receiver. The sender and receiver 
at this lower layer perform whatever processing is necessary for delivery 
according to the specification of that layer, and finally the receiver passes 
the message up to the peer of the sender.</P>
<P><SPAN class=statement-target></SPAN>SOAP Security may be viewed as a lower 
layer with respect to the more general SOAP web services application layer. Thus 
a SOAP sender may pass a SOAP message to a lower layer SOAP security 
implementation that applies encryption (for example), and sends the message to 
the destination SOAP Security layer, which removes the encryption before passing 
the message up to the peer SOAP web services application layer.</P>
<P><SPAN class=statement-target></SPAN>Thus a Basic Profile interceptor and 
compliance monitoring activity should logically occur at a receiver at the 
interface between the SOAP security implementation and SOAP web services 
application layer.</P>
<P>This section of the Profile incorporates the following specifications by 
reference: </P>
<UL>
  <LI><A class=offsite 
  href="http://www.ws-i.org/Profiles/BasicProfile-1.0.html">Basic Profile 
  Version 1.0 (BP1.0)</A>
  <LI><A class=offsite 
  href="http://www.ws-i.org/Profiles/BasicProfile-1.0-errata.html">Basic Profile 
  Version 1.0 Errata</A>
  <LI><A class=offsite 
  href="http://www.ws-i.org/Profiles/BasicProfile-1.1.html">Basic Profile 
  Version 1.1 (BP1.1)</A>
  <LI><A class=offsite 
  href="http://www.ws-i.org/Profiles/SimpleSoapBindingProfile-1.0.html">Simple 
  SOAP Binding Profile Version 1.0 (SSBP1.0)</A>
  <LI><A class=offsite 
  href="http://www.ws-i.org/Profiles/AttachmentsProfile-1.0.html">Attachments 
  Profile Version 1.0 (AP1.0)</A>
  <LI><A class=offsite 
  href="http://www.ws-i.org/Testing/Specs/MonitorFunctionalSpecification_1.02.pdf">WS-I 
  Monitor Tool Functional Specification</A>
  <LI><A class=offsite 
  href="http://members.ws-i.org/NA">Computer 
  Networks, Andrew S. Tanenbaum</A></LI></UL>
<H3 id=bpclarify>11.1 Basic Profile Clarifications</H3>
<P><SPAN class=statement-target></SPAN>This section clarifies the BP1.0 
(including Errata), BP1.1, SSBP1.0, and AP1.0 statements that might be unclear 
when SOAP Message Security is applied in compliance with the Basic Security 
Profile.</P>
<P><SPAN class=statement-target></SPAN>This section lists each possibly 
confusing BP1.0, BP1.1, SSBP1.0, and AP1.0 requirement and an associated 
statement to clarify that requirement in the context of the basic security 
profile.</P>
<P><SPAN class=statement-target></SPAN>When these clarifying statements include 
the phrase &quot;reverse SOAP Message Security&quot; it means to remove various impacts of 
applying SOAP Message Security that may have been applied since the MESSAGE 
(BP1.0) or ENVELOPE (BP 1.1) was originally created for that recipient according 
to the BP. This may mean decrypting relevant portions of the XML or removing XML 
Signature elements or making other reverse transformations as appropriate to the 
aspects of SOAP Message Security that were applied in the specific circumstance. 
</P>
<P><SPAN class=statement-target></SPAN>Not all security must be reversed, only 
that for the intended recipient, as applied to the BP compliant envelope before 
sent to that recipient.</P>
<DIV class=refinement>
<H4 id=BP_Requirement_R2301>11.1.1 BP Requirement R2301</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>bp10:R2301 states &quot;The order of the 
elements in the soap:body of a MESSAGE MUST be the same as that of the 
wsdl:parts in the wsdl:message that describes it.&quot;</P>
<P><SPAN class=statement-target></SPAN>bp11:R2301 states &quot;The order of the 
elements in the soap:body of an ENVELOPE MUST be the same as that of the 
wsdl:parts in the wsdl:message that describes it.&quot;</P></DIV>
<P class=statement><SPAN class=statement-id><A name=R5800>R5800</A></SPAN> 
bp10:R2301 MUST be true after any SOAP Message Security has been reversed for 
the <SPAN class=statement-target>MESSAGE</SPAN> </P>
<P class=statement><SPAN class=statement-id><A name=R5801>R5801</A></SPAN> 
bp11:R2301 MUST be true after any SOAP Message Security has been reversed for 
the <SPAN class=statement-target>ENVELOPE</SPAN> </P></DIV>
<DIV class=refinement>
<H4 id=BP_Requirement_R2710>11.1.2 BP Requirement R2710</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>bp10:R2710 states &quot;The operations in a 
wsdl:binding in a DESCRIPTION MUST result in operation signatures that are 
different from one another.&quot;</P>
<P><SPAN class=statement-target></SPAN>bp11:R2710 states &quot;The operations in a 
wsdl:binding in a DESCRIPTION MUST result in operation signatures that are 
different from one another.&quot;</P></DIV>
<P class=statement><SPAN class=statement-id><A name=R5802>R5802</A></SPAN> 
bp10:R2710 MUST be true after SOAP Message Security processing has been reversed 
for the <SPAN class=statement-target>MESSAGE</SPAN> </P>
<P class=statement><SPAN class=statement-id><A name=R5803>R5803</A></SPAN> 
bp11:R2710 MUST be true after SOAP Message Security processing has been reversed 
for the <SPAN class=statement-target>ENVELOPE</SPAN> </P></DIV>
<DIV class=refinement>
<H4 id=BP_Requirement_R2712>11.1.3 BP Requirement R2712</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>bp10:R2712 states &quot;A document-literal 
binding MUST be serialized as a MESSAGE with a soap:Body whose child element is 
an instance of the global element declaration referenced by the corresponding 
wsdl:message part.&quot; </P>
<P><SPAN class=statement-target></SPAN>bp11:R2712 states &quot;A document-literal 
binding MUST be serialized as an ENVELOPE with a soap:Body whose child element 
is an instance of the global element declaration referenced by the corresponding 
wsdl:message part.&quot; </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R5804>R5804</A></SPAN> 
bp10:R2712 MUST be true after any SOAP Message Security has been reversed for 
the <SPAN class=statement-target>MESSAGE</SPAN> </P>
<P class=statement><SPAN class=statement-id><A name=R5805>R5805</A></SPAN> 
bp11:R2712 MUST be true after any SOAP Message Security has been reversed for 
the <SPAN class=statement-target>ENVELOPE</SPAN> </P></DIV>
<DIV class=refinement>
<H4 id=BP_Requirement_R2724>11.1.4 BP Requirement R2724</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>bp10:R2724 states &quot;If an INSTANCE 
receives a message that is inconsistent with its WSDL description, it SHOULD 
generate a soap:Fault with a faultcode of 'Client', unless a 'MustUnderstand' or 
'VersionMismatch' fault is generated.&quot; </P>
<P><SPAN class=statement-target></SPAN>bp11:R2724 states &quot;If an INSTANCE 
receives an envelope that is inconsistent with its WSDL description, it SHOULD 
generate a soap:Fault with a faultcode of 'Client', unless a 'MustUnderstand' or 
'VersionMismatch' fault is generated.&quot; </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R5806>R5806</A></SPAN> For 
bp10:R2724 &quot;Inconsistent&quot; MUST be taken to mean &quot;Inconsistent after SOAP Message 
security has been reversed&quot;, for the <SPAN class=statement-target>MESSAGE</SPAN> 
</P>
<P class=statement><SPAN class=statement-id><A name=R5807>R5807</A></SPAN> For 
bp11:R2724 &quot;Inconsistent&quot; MUST be taken to mean &quot;Inconsistent after SOAP Message 
security has been reversed&quot;, for the <SPAN 
class=statement-target>ENVELOPE</SPAN> </P></DIV>
<DIV class=refinement>
<H4 id=BP_Requirement_R2725>11.1.5 BP Requirement R2725</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>bp10:R2725 states &quot;If an INSTANCE 
receives a message that is inconsistent with its WSDL description, it MUST check 
for &quot;VersionMismatch&quot;, &quot;MustUnderstand&quot; and &quot;Client&quot; fault conditions in that 
order.&quot; </P>
<P><SPAN class=statement-target></SPAN>bp11:R2725 states &quot;If an INSTANCE 
receives an envelope that is inconsistent with its WSDL description, it MUST 
check for &quot;VersionMismatch&quot;, &quot;MustUnderstand&quot; and &quot;Client&quot; fault conditions in 
that order.&quot; </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R5808>R5808</A></SPAN> With 
respect to bp10:R2725 the <SPAN class=statement-target>INSTANCE</SPAN> must 
check for consistency of the MESSAGE per BP 1.0 after reversing SOAP Message 
Security. </P>
<P class=statement><SPAN class=statement-id><A name=R5809>R5809</A></SPAN> With 
respect to bp11:R2725 the <SPAN class=statement-target>INSTANCE</SPAN> must 
check for consistency of the ENVELOPE per BP 1.1 after reversing SOAP Message 
Security. </P></DIV>
<DIV class=refinement>
<H4 id=BP_Requirement_R2729>11.1.6 BP Requirement R2729</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>bp10:R2729 states &quot;A MESSAGE described 
with an rpc-literal binding that is a response message MUST have a wrapper 
element whose name is the corresponding wsdl:operation name suffixed with the 
string 'Response'.&quot; </P>
<P><SPAN class=statement-target></SPAN>bp11:R2729 states &quot;An ENVELOPE described 
with an rpc-literal binding that is a response MUST have a wrapper element whose 
name is the corresponding wsdl:operation name suffixed with the string 
'Response'.&quot; </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R5810>R5810</A></SPAN> With 
respect to bp10:R2729 the verification of the wrapper element name of the <SPAN 
class=statement-target>MESSAGE</SPAN> must be performed after reversing SOAP 
Message Security. </P>
<P class=statement><SPAN class=statement-id><A name=R5811>R5811</A></SPAN> With 
respect to bp11:R2729 the verification of the wrapper element name of the <SPAN 
class=statement-target>ENVELOPE</SPAN> must be performed after reversing SOAP 
Message Security. </P></DIV>
<DIV class=refinement>
<H4 id=BP_Requirement_R2738>11.1.7 BP Requirement R2738</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>bp10:R2738 states &quot;A MESSAGE MUST include 
all soapbind:headers specified on a wsdl:input or wsdl:output of a 
wsdl:operation of a wsdl:binding that describes it.</P>
<P><SPAN class=statement-target></SPAN>bp11:R2738 states &quot;An ENVELOPE MUST 
include all soapbind:headers specified on a wsdl:input or wsdl:output of a 
wsdl:operation of a wsdl:binding that describes it.&quot;</P></DIV>
<P class=statement><SPAN class=statement-id><A name=R5812>R5812</A></SPAN> With 
respect to bp10:R2738 verification of a <SPAN 
class=statement-target>MESSAGE</SPAN> must occur after SOAP Message Security has 
been reversed. </P>
<P class=statement><SPAN class=statement-id><A name=R5813>R5813</A></SPAN> With 
respect to bp11:R2738 verification of an <SPAN 
class=statement-target>ENVELOPE</SPAN> must occur after SOAP Message Security 
has been reversed. </P></DIV>
<DIV class=refinement>
<H4 id=BP_Requirement_R1029>11.1.8 BP Requirement R1029</H4>
<DIV class=rationale>
<P><SPAN class=statement-target></SPAN>This clarifies the Basic Profile's R1029 
to reflect the fact that transmission of security related faults may increase 
the vulnerablility to certain attacks and in some cases faults should not be 
transmitted. </P></DIV>
<P class=statement><SPAN class=statement-id><A name=R5814>R5814</A></SPAN> Where 
the normal outcome of processing a SECURE_ENVELOPE would have resulted in the 
transmission of a SOAP Response, but rather a fault is generated instead, a 
<SPAN class=statement-target>RECEIVER</SPAN> MAY transmit a fault or silently 
discard the message. </P></DIV>
<H2 id=attachsec>12. Attachment Security</H2>
<P>This section of the Profile incorporates the following specifications by 
reference: </P>
<UL>
  <LI><A class=offsite 
  href="http://www.ws-i.org/Profiles/Basic/2003-08/AttachmentsProfile-1.0.pdf">Attachments 
  Profile Version 1.0 (AP1.0)</A>
  <LI><A class=offsite 
  href="http://www.oasis-open.org/apps/org/workgroup/wss/download.php/10902/wss-swa-profile-1.0-cd-01.pdf">Web 
  Services Security: SOAP Messages with Attachments (SwA) Profile 
1.0</A></LI></UL>
<P><SPAN class=statement-target></SPAN>The section provides guidance for 
protecting attachments when they are used with SOAP Messages. As is explained in 
Section 3 Conformance all features described in this Profile, including support 
for attachments and security for attachments in any form by any instance is not 
required. </P>
<P><SPAN class=statement-target></SPAN>SSL/TLS may be used to provide 
authentication, integrity and confidentiality protection, on a hop-by-hop basis, 
for an entire HTTP Message. This includes HTTP Headers, the SOAP Envelope, and 
all MIME Parts including MIME Headers. </P>
<P><SPAN class=statement-target></SPAN>SSL/TLS does not provide protection, 
except between adjacent HTTP Nodes, for HTTP Messages when the SOAP Message Path 
contains SOAP Intermediaries. An instance should not use SSL/TLS without WSS 
with Message Exchange Patterns (MEPs) that may contain SOAP intermediaries or 
when these security functions are required to be performed independently of the 
connection. </P>
<P><SPAN class=statement-target></SPAN>WSS may be used to provide 
authentication, integrity and confidentiality protection for a subset of the 
SOAP Message and associated attachments.WSS provides protection for SOAP 
Messages and attachments when the SOAP Message Path contains SOAP 
Intermediaries. An instance should use WSS with MEPs that may contain SOAP 
Intermediaries or when these security functions are required to be performed 
independently of the transport layer connection. </P>
<P><SPAN class=statement-target></SPAN>An instance may use SSL/TLS in 
conjunction with WSS if warranted by application security requirements. This 
combination provides integrity and confidentiality protection for the entire 
HTTP Message (on a hop-by-hop basis) including HTTP Headers, SOAP Envelope, and 
all MIME Parts including MIME Headers. </P>
<P><SPAN class=statement-target></SPAN>Application level security mechanisms, 
including XML Signature, XML Encryption, PKCS#7, S/MIME, etc. for attachment 
data may also be used by a instance where appropriate, but statements regarding 
the interoperability of such mechanisms are out of scope for this Profile. </P>
<P><SPAN class=statement-target></SPAN>Attachment security conformance claim 
URIs (as defined in 12.1) constitute an extensibility point of the Basic 
Security Profile. Profiles for other mechanisms for dealing with attachments and 
attachment security MUST define a URI for claiming conformance. </P>
<P><SPAN class=statement-target></SPAN>This Profile describes one attachment 
security mechanism and URI. </P>
<H3 id=swa>12.1 SOAP with Attachments</H3>
<P>The following specifications (or sections thereof) are referred to in this 
section of the Profile:</P>
<UL>
  <LI><A class=offsite 
  href="http://www.ws-i.org/Profiles/Basic/2003-08/AttachmentsProfile-1.0.pdf">Attachments 
  Profile Version 1.0 (AP1.0)</A>
  <LI><A class=offsite 
  href="http://www.oasis-open.org/apps/org/workgroup/wss/download.php/10902/wss-swa-profile-1.0-cd-01.pdf">Web 
  Services Security: SOAP Messages with Attachments (SwA) Profile 
1.0</A></LI></UL>
<DIV class=refinement>
<H4 id=Conformance>12.1.1 Conformance</H4>
<P class=statement><SPAN class=statement-id><A name=R6000>R6000</A></SPAN> 
Conformance to this section of the profile MUST be indicated by placing a 
ConformanceClaim element on the wsdl:port or wsdl:binding (per BP 1.0 Section 
3.3) in the WSDL <SPAN class=statement-target>DESCRIPTION</SPAN> of the service 
with the following URI: http://ws-i.org/profiles/basic-security/swa/1.0. </P>
<P class=statement><SPAN class=statement-id><A name=R6001>R6001</A></SPAN> The 
<SPAN class=statement-target>SECURE_MESSAGE</SPAN> MUST conform to Attachments 
Profile 1.0. </P></DIV>
<DIV class=refinement>
<H4 id=Scope>12.1.2 Scope</H4>
<P class=statement><SPAN class=statement-id><A name=R6002>R6002</A></SPAN> A 
signed and/or encrypted MIME Part in a <SPAN 
class=statement-target>SECURE_MESSAGE</SPAN> MUST be at the same MIME level as 
the root MIME Part containing the SECURE_ENVELOPE. </P>
<P class=statement><SPAN class=statement-id><A name=R6003>R6003</A></SPAN> A 
Root MIME Part of a <SPAN class=statement-target>SECURE_MESSAGE</SPAN> MUST NOT 
be signed or encrypted. </P></DIV>
<H3 id=signedAttachments>12.2 Signed Attachments</H3>
<DIV class=refinement>
<H4 id=Reference>12.2.1 Reference</H4>
<P class=statement><SPAN class=statement-id><A name=R6100>R6100</A></SPAN> A 
signed MIME Part MUST be referenced from within the <SPAN 
class=statement-target>SECURE_ENVELOPE</SPAN> using a ds:Signature//ds:Reference 
element with a URI attribute of the &quot;cid:partToBeSigned&quot;. </P></DIV>
<DIV class=refinement>
<H4 id=Transform>12.2.2 Transform</H4>
<P class=statement><SPAN class=statement-id><A name=R6101>R6101</A></SPAN> A 
ds:Reference within a <SPAN class=statement-target>SECURE_ENVELOPE</SPAN> to a 
signed MIME Part MUST use a MIME Part Reference Transform designated by the URI 
&quot;...#Attachment-Content-Only-Transform&quot; or &quot;...#Attachment-Complete-Transform&quot;. 
This MIME Part Reference Transform and URI will be specified before the final 
version of this Profile is released. The anticipated venue to define this 
Transform is the OASIS WSS TC. </P>
<P class=statement><SPAN class=statement-id><A name=R6102>R6102</A></SPAN> XML 
canonicalization MUST NOT be applied when signing MIME Parts in a <SPAN 
class=statement-target>SECURE_MESSAGE</SPAN> containing XML. </P>
<P class=statement><SPAN class=statement-id><A name=R6104>R6104</A></SPAN> 
Signed non-XML MIME Parts in a <SPAN 
class=statement-target>SECURE_MESSAGE</SPAN> MUST be MIME canonicalized 
according to the requirements of the MIME Type. </P>
<P class=statement><SPAN class=statement-id><A name=R6105>R6105</A></SPAN> 
Signed XML MIME Parts in a <SPAN class=statement-target>SECURE_MESSAGE</SPAN> 
(other than the Root MIME Part containing the Primary SOAP Envelope) MUST be 
MIME canonicalized according to the requirements of the &quot;text&quot; MIME Type. </P>
<P class=statement><SPAN class=statement-id><A name=R6106>R6106</A></SPAN> When 
using the &quot;...#Attachment-Complete-Transform&quot; the MIME Part in a <SPAN 
class=statement-target>SECURE_MESSAGE</SPAN> MUST have a Content-Type header. 
</P></DIV>
<H3 id=encryptedAttachments>12.3 Encrypted Attachments</H3>
<DIV class=refinement>
<H4 id=Reference>12.3.1 Reference</H4>
<P class=statement><SPAN class=statement-id><A name=R6201>R6201</A></SPAN> An 
encrypted MIME Part in a <SPAN class=statement-target>SECURE_MESSAGE</SPAN> MUST 
be referenced using an ENCRYPTED_DATA in the SECURE_ENVELOPE with a Type 
attribute with the value &quot;...#Attachment-Content-Only&quot; or 
&quot;...#Attachment-Complete&quot;. </P>
<P class=statement><SPAN class=statement-id><A name=R6202>R6202</A></SPAN> The 
ENCRYPTED_DATA element in a <SPAN class=statement-target>SECURE_ENVELOPE</SPAN> 
that references an encrypted MIME Part in a SECURE_MESSAGE MUST contain a 
xenc:CipherData/xenc:CipherReference element with a URI attribute having the 
same URI as the original MIME Part. </P></DIV>
<DIV class=refinement>
<H4 id=Content>12.3.2 Content</H4>
<P class=statement><SPAN class=statement-id><A name=R6203>R6203</A></SPAN> The 
content of an MIME Part in a <SPAN class=statement-target>SECURE_MESSAGE</SPAN> 
encrypted using WSS MUST be replaced by the result of encrypting the content of 
the MIME Part. </P></DIV>
<H2 id=seccon>13. Security Considerations</H2>
<P><SPAN class=statement-target></SPAN>This section lists a number of security 
considerations that should be taken into account when using one or more of the 
technologies discussed in this profile.</P>
<DL>
  <DT><SPAN class=statement-target></SPAN>SOAPAction Header
  <DD><SPAN class=statement-target></SPAN>The use of the SOAPAction header in 
  situations where the message content is being integrity or confidentiality 
  protected can result in security risks when the transport layer does not 
  provide the same protection to the SOAPAction header. The most obvious risk is 
  that the SOAPAction header can potentially expose sensitive information about 
  a SOAP message such as the URI of the service, or the context of the 
  transaction that is taking place. Another, more subtle risk occurs in a 
  situation where message routing is done based on the value of the SOAPAction 
  header. By modifying the value, an attacker could cause the message to be 
  directed to a different receiver. This could potentially defeat a replay 
  detection mechanism that was based on the assumption that the message would 
  always be routed to the same place. There is also the additional risk where 
  some processing is performed by an intermediary based on the SOAPAction value. 
  Changing the value of the SOAPAction may cause incorrect processing by the 
  intermediary. This is especially important when the intermediary is performing 
  security processing.
  <DT><SPAN class=statement-target></SPAN>Clock Synchronization
  <DD><SPAN class=statement-target></SPAN>The specifications covered by this 
  profile use time-based mechanisms to prevent replay attacks. These mechanisms 
  will be ineffective unless the system clocks of the various network nodes are 
  synchronized. Since the technology to perform distributed clock 
  synchronization are well known and widely available and are not among the 
  technologies being profiled here, this document does not specify how clock 
  synchronization should be done. However, the recommendation of the use of 
  time-based security mechanisms implies that synchronization is being done.
  <DT><SPAN class=statement-target></SPAN>Key Identifiers and Token Substitution
  <DD><SPAN class=statement-target></SPAN>If a message is signed using a 
  Security Token that binds a public verification key with other claims, and 
  specific processing is performed based on those claims, then in order to 
  protect against post-signature substitution of the Security Token with one 
  that binds the same key to different claims, Security Token itself should be 
  part of the signature computation. This can be acheived by putting a child 
  ds:Reference element whose URI attribute contains a shorthand XPointer 
  reference to the wsse:SecurityTokenReference that specifies the Security Token 
  into the ds:SignedInfo element of a signature.
  <DT><SPAN class=statement-target></SPAN>Binding Security Tokens to Signatures
  <DD><SPAN class=statement-target></SPAN>If a ds:SignedInfo contains one or 
  more ds:Reference children whose URI attribute contains a shorthand XPointer 
  reference to a wsse:SecurityTokenReference that uses a potentially ambiguous 
  mechanism to refer to the Security Token (e.g. KeyIdentifier), then in order 
  to protect against post-signature substitution of the Security Token with one 
  that binds the same key to different claims, it is recommended that at least 
  one ds:Reference use the wsse:SecurityTokenReference deferencing transform. 
  Other references to the wsse:SecurityTokenReference that do not use the 
  wsse:SecurityTokenReference dereferencing transform may also appear. 
  <DT><SPAN class=statement-target></SPAN>Uniqueness of ID attributes
  <DD><SPAN class=statement-target></SPAN>XML 1.0 requires that all attributes 
  of type ID in a given XML document have unique values, but only validating XML 
  processors have such type information. As various aspects of SOAP Message 
  Security use ID based references it is recommended that applications ensure 
  that ID attributes are unique by some mechanism.
  <DT><SPAN class=statement-target></SPAN>Encryption Key Substitution
  <DD><SPAN class=statement-target></SPAN>When a key is provided in band within 
  a Token or otherwise for the purpose of specifying a key to be used by another 
  node for encrypting information to be sent in a future message, it is 
  recommended that the sender of the key cryptographicaly bind the key to the 
  message in which it is transmitted. This can be done either by using the key 
  to perform a Signature or HMAC over critical elements of the message body or 
  by including the key under a signature covering critical elements of the 
  message body which uses some other key. If a key is sent in a message which 
  the receiver is expected to use to encrypt data in some future message, there 
  is a risk that an attacker could substitute some other key and thereby be able 
  to read unauthorized data. This is true even if the key is contained in a 
  signed certificate, but is not bound to the current message in some way. If 
  the future encryption key is used to sign the initial request, by verifying 
  the signature, the receiver can determine that the key is the one that was 
  intended. 
  <DT><SPAN class=statement-target></SPAN>Signing Security Tokens
  <DD><SPAN class=statement-target></SPAN>In general, tokens contain claims made 
  by an authority, usually about some system entity. Obviously a party relying 
  on these claims must trust that authority to make them. The relying party must 
  generally verify these claims. The method of doing this depends on the token 
  type and is specified by the corresponding token profile.
  <DT><SPAN class=statement-target></SPAN>Signing Username Tokens
  <DD><SPAN class=statement-target></SPAN>When a wsse:UsernameToken contains 
  only a wsse:Username and wsse:PasswordText and is simply presented for 
  Authentication where replay is not a concern, it does not need to be signed 
  because the act of checking it against a stored value has the effect of 
  verifying it. When a wsse:Nonce and/or wsu:Created are used with the 
  wsse:Username and wsse:PasswordText to prevent replay, the wsse:UsernameToken 
  must be signed to prevent undetected alteration of these fields. If a 
  wsse:PasswordText is being used to derive a key for a subsequent encryption of 
  a response, it should be signed to ensure that an attacker does not substitute 
  an alternative, but valid wsse:Username and wsse:PasswordText. This is 
  equivalent to the key substitution attack available when an X.509 Token is 
  used for a similiar purpose.
  <DT><SPAN class=statement-target></SPAN>Signing Binary Tokens
  <DD><SPAN class=statement-target></SPAN>The content of a binary token will be 
  a binary object which is integrity protected by a mechanism specific to the 
  object type. For example, an X.509 certificate will be signed by the issuing 
  authority. The outer wrapper of the binary token merely contains type 
  indication information which does not have to be integrity protected in order 
  to be able to rely in the claims.
  <DT><SPAN class=statement-target></SPAN>Signing XML Tokens
  <DD><SPAN class=statement-target></SPAN>XML tokens should be digitally signed 
  in a manner described by their profile (or documents referenced by it), or 
  delivered directly from their issuer over an integrity protected channel.
  <DT><SPAN class=statement-target></SPAN>Replay of Username Token
  <DD><SPAN class=statement-target></SPAN>A sender that includes a Nonce child 
  in a UsernameToken element should anticipate that the receiver may refuse to 
  process the message due to either an accidental collision or transport layer 
  delays. Therefore, if it decides to retry transmission, it should do so with a 
  new Nonce.
  <DD><SPAN class=statement-target></SPAN>Unless other mechanisms are used to 
  protect against replay of the username token, service providers should retain 
  nonces in a store that is shared between all SOAP nodes (and within a 
  distributed SOAP node all &quot;components&quot;) that can be authorized using the same 
  passwords.
  <DD><SPAN class=statement-target></SPAN>The policy that allows service 
  providers to forget nonces may be based on any considerations that the service 
  considers relevant. When a nonce is forgotten the server should ensure that in 
  the future it rejects UsernameTokens with a Created time that is earlier than 
  the forgotten nonce.
  <DT><SPAN class=statement-target></SPAN>Use of password digests vs cleartext 
  password
  <DD><SPAN class=statement-target></SPAN>A sending application utilizing 
  password authentication must decide whether to use a cleartext password or a 
  password digest (The sender needs to know via some out-of-band mechanism 
  and/or prior arrangement which mechanisms the receiver supports). The digest 
  should always be prefered if it can be used, as the digest algorithm does not 
  reveal the password and can protect against replay of the password. (It does 
  not however, protect against offline guessing or brute force attacks.)
  <DD><SPAN class=statement-target></SPAN>Password digests can only be used in 
  situations where both sender and receiver can start with the same secret value 
  (e.g., the cleartext password or a hash of the password). The following are 
  criteria for considering when to use digests vs. cleartext:
  <DD><SPAN class=statement-target></SPAN>1. If the receiver can access the 
  cleartext password, a digest may be used. 
  <DD><SPAN class=statement-target></SPAN>2. If the receiver can access a value 
  that can be derived by the sender directly from the cleartext password (e.g., 
  the receiver has access to a SHA1 hash of the password), the derived value 
  (e.g. the hash) may be used in the digest. 
  <DD><SPAN class=statement-target></SPAN>3. If the sender needs extra 
  information to derive the value available to the receiver, it will not be 
  feasible to use password digest, even though the information is not 
  intentionally secret. For example, UNIX systems add a salt value to each 
  password before hashing it. It is infeasible for the sender to discover the 
  salt value required for a specific username.
  <DD><SPAN class=statement-target></SPAN>4. If the receiver does not have 
  access to any password value, derived or otherwise, but merely the ability to 
  test a username/password combination for validity, a digest may not be used. 
  An example of this is when the username/password combination is presented to a 
  database, directory or mainframe system for verification.
  <DD><SPAN class=statement-target></SPAN>When sending any form of a password, 
  cleartext or digest, confidentiality services are strongly recommended to 
  prevent its value from being revealed or from offline guessing.
  <DT><SPAN class=statement-target></SPAN>Encryption with signature
  <DD><SPAN class=statement-target></SPAN>When a message contains a data value 
  which does not have a significant number of probable variations and that data 
  is signed and then encrypted, it is recommended that the sender either include 
  some suitably random value such as a wsse:Nonce in the data, or encrypt the 
  related ds:DigestValue element in order to protect the confidentiality of the 
  data.
  <DD><SPAN class=statement-target></SPAN>An adversary can compute the digest 
  for each data values and compare them against the digests in the signature 
  thereby deducing the encrypted data value. This type of attack is most likely 
  to be successful when there are a relatively small set of probable data 
  values. Therefore the threat can be mitigated by introduction of some random 
  value into the original data or encryption of the digest.</DD></DL>
<H2 id=references>Appendix A: Referenced Specifications</H2>
<P>The following specifications' requirements are incorporated into the Profile 
by reference, except where superseded by the Profile:</P>
<UL>
  <LI><A class=offsite href="http://www.ietf.org/rfc/rfc2818.txt">HTTP over 
  TLS</A>
  <LI><A class=offsite href="http://www.ietf.org/rfc/rfc2246.txt">The TLS 
  Protocol Version 1.0</A>
  <LI><A class=offsite href="http://wp.netscape.com/eng/ssl3/ssl-toc.html">The 
  SSL Protocol Version 3.0</A>
  <LI><A class=offsite 
  href="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0.pdf">Web 
  Services Security: SOAP Message Security</A>
  <LI><A class=offsite 
  href="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0.pdf">Web 
  Services Security: Username Token Profile</A>
  <LI><A class=offsite 
  href="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0.pdf">Web 
  Services Security: X.509 Token Profile</A>
  <LI><A class=offsite href="http://www.ietf.org/rfc/rfc2818.txt">RFC2459: 
  Internet X.509 Public Key Infrastructure Certificate and CRL Profile</A>
  <LI><A class=offsite href="http://www.w3.org/TR/xmldsig-core/">XML-Signature 
  Syntax and Processing</A>
  <LI><A class=offsite 
  href="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0.pdf">Web 
  Services Security: SOAP Message Security</A>
  <LI><A class=offsite href="http://www.w3.org/TR/xmlenc-core/">XML Encryption 
  Syntax and Processing</A>
  <LI><A class=offsite 
  href="http://www.ws-i.org/Profiles/BasicProfile-1.0.html">Basic Profile 
  Version 1.0 (BP1.0)</A>
  <LI><A class=offsite 
  href="http://www.ws-i.org/Profiles/BasicProfile-1.0-errata.html">Basic Profile 
  Version 1.0 Errata</A>
  <LI><A class=offsite 
  href="http://www.ws-i.org/Profiles/BasicProfile-1.1.html">Basic Profile 
  Version 1.1 (BP1.1)</A>
  <LI><A class=offsite 
  href="http://www.ws-i.org/Profiles/SimpleSoapBindingProfile-1.0.html">Simple 
  SOAP Binding Profile Version 1.0 (SSBP1.0)</A>
  <LI><A class=offsite 
  href="http://www.ws-i.org/Profiles/AttachmentsProfile-1.0.html">Attachments 
  Profile Version 1.0 (AP1.0)</A>
  <LI><A class=offsite 
  href="http://www.ws-i.org/Testing/Specs/MonitorFunctionalSpecification_1.02.pdf">WS-I 
  Monitor Tool Functional Specification</A>
  <LI><A class=offsite 
  href="http://members.ws-i.org/NA">Computer 
  Networks, Andrew S. Tanenbaum</A>
  <LI><A class=offsite 
  href="http://www.ws-i.org/Profiles/Basic/2003-08/AttachmentsProfile-1.0.pdf">Attachments 
  Profile Version 1.0 (AP1.0)</A>
  <LI><A class=offsite 
  href="http://www.oasis-open.org/apps/org/workgroup/wss/download.php/10902/wss-swa-profile-1.0-cd-01.pdf">Web 
  Services Security: SOAP Messages with Attachments (SwA) Profile 
1.0</A></LI></UL>
<H2 id=points>Appendix B: Extensibility Points</H2>
<P>This section identifies extensibility points, as defined in &quot;Scope of the 
Profile,&quot; for the Profile's component specifications.</P>
<P>These mechanisms are out of the scope of the Profile; their use may affect 
interoperability, and may require private agreement between the parties to a Web 
service.</P>
<P>In <A class=offsite href="http://www.ietf.org/rfc/rfc2246.txt">The TLS 
Protocol Version 1.0:</A></P>
<UL>
  <LI><SPAN class=statement-id>E0009</SPAN> - <STRONG>TLS Ciphersuites</STRONG> 
  - TLS allows for the use of arbitrary encryption algorithms. Note that while 
  section 10.1 of this Profile mandates, recommends, and discourages support for 
  certain ciphersuites, this Profile does not prohibit use of any specific 
  ciphersuite.
  <LI><SPAN class=statement-id>E0010</SPAN> - <STRONG>TLS Extensions</STRONG> - 
  TLS allows for extensions during the handshake phase.</LI></UL>
<P>In <A class=offsite href="http://wp.netscape.com/eng/ssl3/ssl-toc.html">The 
SSL Protocol Version 3.0:</A></P>
<UL>
  <LI><SPAN class=statement-id>E0011</SPAN> - <STRONG>SSL Ciphersuites</STRONG> 
  - SSL allows for the use of arbitrary encryption algorithms. Note that while 
  section 10.1 of this Profile mandates, recommends, and discourages support for 
  certain ciphersuites, this Profile does not prohibit use of any specific 
  ciphersuite.</LI></UL>
<P>In <A class=offsite 
href="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0.pdf">Web 
Services Security: SOAP Message Security:</A></P>
<UL>
  <LI><SPAN class=statement-id>E0002</SPAN> - <STRONG>Security Tokens</STRONG> - 
  Security tokens may be specified in additional security token 
profiles.</LI></UL>
<P>In <A class=offsite href="http://www.ietf.org/rfc/rfc2818.txt">RFC2459: 
Internet X.509 Public Key Infrastructure Certificate and CRL Profile:</A></P>
<UL>
  <LI><SPAN class=statement-id>E0012</SPAN> - <STRONG>Certificate 
  Authority</STRONG> - The choice of the Certificate Authority is a private 
  agreement between parties.
  <LI><SPAN class=statement-id>E0013</SPAN> - <STRONG>Certificate 
  Extensions</STRONG> - X.509 allows for arbitrary certificate 
extensions.</LI></UL>
<P>In <A class=offsite href="http://www.w3.org/TR/xmlenc-core/">XML Encryption 
Syntax and Processing:</A></P>
<UL>
  <LI><SPAN class=statement-id>E0008</SPAN> - <STRONG>Encryption 
  Algorithm</STRONG> - Additional encryption algorithms may be 
specified.</LI></UL>
<H2 id=acks>Appendix C: Acknowledgements</H2>
<P>This document is the work of the WS-I Basic Security Profiles Working Group, 
whose members have included:</P>
<P>Steve Anderson (OpenNetwork), Paula Austel (IBM), Siddharth Bajaj (Verisign), 
Frank Balluffi (Deutsche Bank), Abbie Barbir (Nortel Networks), David Baum 
(Kantega AS), Randy Bias (Grand Central Communications), Tim Bond (webMethods, 
Inc.), Heidi Buelow (Quovadx), David Burdett (Commerce One, Inc.), Ted Burghart 
(Hitachi, Ltd.) Symon Chang (Commerce One, Inc.), Richard Chennault, (Kaiser 
Permanente), Dipak Chopra (SAP AG), Jamie Clark (OASIS), Edward Cobb (BEA 
Systems, Inc.), David Cohen (Merrill Lynch), Brett Cooper, (Accenture), Ugo 
Corda (SeeBeyond Technology), Paul Cotton (Microsoft Corporation), Suresh 
Damodaran, (Rosettanet), Mark Davis (Sarvega, Inc.), Alex Deacon (Verisign), 
Thomas DeMartini (ContentGuard, Inc.), Blake Dournaee (Sarvega, Inc.), Rob Drew 
(Charlse Schwab), Gregory Elkins (Reed Elsevier), Mark Ericson (Mindreef), Jon 
Oyvind Eriksen (Kantega AS), Chris Ferris (IBM), Bob Freund, (Hitachi), Edwin 
Goei (Sun Microsystems), Grant Goodale (Reactivity, Inc.), Marc Goodner (SAP 
AG), Phil Goodwin (Sun Microsystems), Marc Graveline (Cognos, Inc.), Eric 
Gravengaard (Reactivity, Inc.), Thomas Gross (IBM), Martin Gudgin (Microsoft 
Corporation), Marc Hadley (Sun Microsystems), Mark Hapner (Sun Microsystems), 
Nathan Harris (Kaiser Permanente), Bret Hartman (Datapower Technology, Inc.), 
Frederick Hirsch (Nokia), Jason Hogg (Microsoft Corporation), Maryann Hondo 
(IBM), Lawrence Hsiung (Quovadx), Tony Huber (Commerce Quest), Jim Hughes 
(Hewlett-Packard), Michael Hui (Computer Associates), Brian Jackson (Avanade, 
Inc.), Steve Jenisch (SAS Institute), Erik Johnson (Epicor), Chris Kaler 
(Microsoft Corporation), Anish Karmarkar (Oracle Corporation), Dana Kaufman, 
(Forum Systems), Manveen Kaur (Sun Microsystems), Slava Kavsan (RSA Security), 
Paul Knight (Nortel Networks), Chris Kurt (Microsoft Corporation), Kelvin 
Lawrence (IBM), Hal Lockhart (BEA Systems), Brad Lund (Intel Corporation), Jim 
Luth (OPC Foundation), Paul Madsen (Entrust, Inc.), Eve Maler (Sun 
Microsystems), Skip Marler (Parasoft), Axl Mattheus (Sun Microsystems), Michael 
McIntosh (IBM), Craig Milhiser, (Ascential), Chris Miller (Accenture), Dale 
Moberg (Cyclone Commerce), Ron Monzillo (Sun Microsystems), K. Scott Morrison, 
(Layer 7) Tim Moses (Entrust, Inc.), Tony Nadalin (IBM), Nataraj Nagaratnam 
(IBM), Andrew Nash (RSA Security), Hsin Ning (Bestning Technologies), Eisaku 
Nishiyama (Hitachi, Ltd.), Mark Nottingham (BEA Systems, Inc.), TJ Pannu 
(ContentGuard, Inc.), Martine Pean (Quovadx), Robert Philpott (RSA Security), 
Dave Prout (BT), Joe Pruitt (F5 Networks, Inc.), Eric Rejkovic (Oracle 
Corporation), Matt Recupito (Accenture), Jason Rouault (Hewlett-Packard), Rich 
Salz (Datapower Technology, Inc.), Matt Sanchez (Webify Solutions, Inc. ), Jerry 
Schwarz (Oracle Corporation), Senthil Sengodan (Nokia), Shawn Sharp (Cyclone 
Commerce), Aslak Siira (F5 Networks, Inc.), David Solo (Citigroup, Inc. ), 
Davanum Srinivas (Computer Associates), Raghavan Srinivas (Sun Microsystems), 
John Stanton (Defense Information Systems Agency), Andrew Stone (Accenture), 
Julie Surer (MITRE), Wes Swenson (Forum Systems), Dino Vitale (Citigroup, Inc.), 
Jonathan Wenocur (Datapower Technology, Inc.), Pete Wenzel (SeeBeyond 
Technology), Ian White (Micro Focus) </P></BODY></HTML>
